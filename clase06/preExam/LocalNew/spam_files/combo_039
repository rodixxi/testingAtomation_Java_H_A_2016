YUI.add("_shared_module_compose_template_retrieve",function(e){e.namespace("ui.Templates"),e.ui.Templates._shared_module_compose_template_retrieve={base:"{{templateList}}",templateOptions:'<li><a href="#" aria-selected="false" class="x-gap btn btn-trash" role="menuitem" title="{{subject}}"> <span data-action="select-template" data-template-name="{{subject}}" class="template-name">{{subject}}</span> <span class="delplacement"> <span class="btn icon icon-small-delete" data-action="delete-template" data-template-name="{{subject}}"> </span> </span> </a></li> ',noTemplate:'<div class="second-msg-no-template"> {{str_no_templates_nextlines}} </div> ',templateList:'<div id="menu-templates" class="menu-group optionMenu"> <ul> <li data-action="save-template"><a href="#"><span>{{str_save_template}}</span></a></li> </ul> <ul id="menu-move-templates" role="group" class="folder-menu-group"> {{templateOptions}} </ul> {{noTemplate}} </div>'}},"1.0.0");
YUI.add("_shared_module_rte_well_tabs_compose_fresh",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_rte_well_tabs_compose_fresh={base:'<div class="rte"> <ul role="tablist" aria-describedby="tablist-instr"> </ul></div>'};},"1.0.0");YUI.add("_shared_module_compose_dropzone",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_compose_dropzone={base:'<div class="compose-droparea"> <div class="dropzone-text"> <span class="icon icon-attachment"></span> <span>{{str_comp_drag_here}}</span> </div></div>'};},"1.0.0");YUI.add("_shared_module_offscreen_bin_compose_menu_list",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_compose_menu_list={base:'<div id="menu-list" class="optionMenu rte-menu"> <ul> <li data-action="insertunorderedlist"><a href="#" title="{{str_rte_bullet_list_attr}}"><i class="icon icon-list-bullets" title="{{str_rte_bullet_list_attr}}"></i></a></li> <li data-action="insertnumberedlist"><a href="#" title="{{str_rte_numbered_list_attr}}"><i class="icon icon-list-numbers" title="{{str_rte_numbered_list_attr}}"></i></a></li> </ul></div>'};},"1.0.0");YUI.add("_shared_module_offscreen_bin_compose_menu_text_align",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_compose_menu_text_align={base:'<div id="menu-text-align" class="optionMenu rte-menu"> <ul> <li data-action="align-l"><a href="#"><i class="icon icon-align-left" title="{{str_rte_align_l}}"></i></a></li> <li data-action="align-c"><a href="#"><i class="icon icon-align-center" title="{{str_rte_align_c}}"></i></a></li> <li data-action="align-r"><a href="#"><i class="icon icon-align-right" title="{{str_rte_align_r}}"></i></a></li> </ul></div>'};},"1.0.0");YUI.add("_shared_module_offscreen_bin_compose_menu_indent",function(A){A.namespace("ui.Templates");A.ui.Templates._shared_module_offscreen_bin_compose_menu_indent={base:'<div id="menu-indent" class="optionMenu rte-menu"> <ul> <li data-action="indent"><a href="#" title="{{str_rte_indentation_more_attr}}"><i class="icon icon-indent" title="{{str_rte_indentation_more_attr}}"></i></a></li> <li data-action="outdent"><a href="#" title="{{str_rte_indentation_less_attr}}"><i class="icon icon-outdent" title="{{str_rte_indentation_less_attr}}"></i></a></li> </ul></div>'};},"1.0.0");YUI.add("mail-captcha-turnkey-iframe",function(B){var A=B.namespace("Mail.Captcha.Turnkey").Iframe=function(E,C){this.el=document.createElement("iframe");var D=B.one(this.el);D.setAttribute("frameborder",0);D.setAttribute("scrolling",0);D.setAttribute("width",E);D.setAttribute("height",C);};B.mix(A.prototype,{cleanup:function(){this.el.parentNode.removeChild(this.el);},getDoc:function(){return this.el.contentDocument;},getBody:function(){return this.getDoc().body;},getHead:function(){return this.getDoc().head;},write:function(C){var D=B.common.Utils.unescapeHtml(C);D=D.replace(/http:\/\/l.yimg.com\//g,"https://s.yimg.com/");this.getDoc().write(D);},makeIframeContent:function(C){return""+"<html><head><style>"+(C.css||"")+"</style><script>"+(C.js||"")+"<\/script></head><body>"+(C.html||"")+"</body></html>";},exec:function(E){var C=Array.prototype.slice.call(arguments,1),D=this.getIn(E);if(typeof D!=="function"){throw new Error(typeof(D)+" is not a function");}return D.apply(this,C);},getIn:function(D,C){if(!D){return;}if(!C){C=this.el.contentWindow;}if(typeof D==="string"){D=D.split(".");}if(D.length===1){return C[D[0]];}var E=D.splice(0,1)[0];C=C[E];if(!C){return;}return this.getIn(D,C);},assocIn:function(E,D,C){if(!E){return;}if(!C){C=this.el.contentWindow;}if(typeof E==="string"){E=E.split(".");}if(E.length===1){C[E[0]]=D;return(C[E[0]]);}var F=E.splice(0,1)[0];C=C[F]||(C[F]={});return this.assocIn(E,D,C);}});},"0.0.1",{requires:["node","common-utils"]});YUI.add("mail-captcha-turnkey-view",function(E){var B=350,C=180,A='<div style="width:'+B+"px;height:"+C+'px;"></div>',F={X:50,Y:130};var D=E.namespace("Mail.Captcha.Turnkey").View=function(G){var H=this;this.markup=G.markup;this.script=G.script;this.css=G.css;this.el=document.createElement("div");this.yel=E.one(this.el);this.iframe=new E.Mail.Captcha.Turnkey.Iframe(B,C);this._onComplete=E.bind(this._onComplete,this);this._onReject=E.bind(this._onReject,this);this.content=G.content;E.Object.each(this.events,function(I,J){H.yel.on(J,E.bind(H[I],H));});};E.mix(D.prototype,{COMPLETE_CALLBACK:"YAHOO.CAPTCHA.hook.complete",REJECT_CALLBACK:"YAHOO.CAPTCHA.hook.reject",TEMPLATE:'<div class="captcha-iframe"></div>',events:{"click":"_submitHandler"},_submitHandler:function(){this.injectCallbacks();this.iframe.exec("YAHOO.CAPTCHA.hook");if(this.captchaDlg){this.captchaDlg.destroy();}},_createCaptchaDialog:function(I){var J=this,G={hd:strings.str_comp_captcha_modal_header,bd:A,centered:true},H={ok:{handler:I.okCallback,stopDestroy:true},cancel:{handler:I.cancelCallback,stopDestroy:false}};E.common.ui.DialogHelper.confirm(G,H,function(L){var K=L._parentNode.one(".modal-bd");L.set("width",I.width+"px");L.set("height",I.height+"px");L._parentNode.one(".modal").setStyle("width",I.width+"px");J.el.innerHTML=J.TEMPLATE;E.one(J.el).one(".captcha-iframe").appendChild(J.iframe.el);K.setContent("");K.appendChild(J.el);J.embedTurnkeyCaptcha();if(typeof(I.createdCallback)==="function"){I.createdCallback(L);}});},_createInvisibleCaptcha:function(){this.invisibleCaptchanNode=E.Node.create('<div class="invisible-captcha-node"></div>');this.invisibleCaptchanNode.appendChild(this.iframe.el);E.one("body").appendChild(this.invisibleCaptchanNode);this.embedTurnkeyCaptcha();this._submitHandler();E.all(".invisible-captcha-node").setStyle("display","none");},render:function(){var H=this,G={okCallback:E.bind(this._submitHandler,this),cancelCallback:function(I){H._reject(I);},width:(B+F.X),height:(C+F.Y),createdCallback:function(I){H.captchaDlg=I;}};if(H.content.Mode==="invisible"){H._createInvisibleCaptcha();}else{H._createCaptchaDialog(G);}},invoke:function(H,G){this._resolve=H;this._reject=G;},embedTurnkeyCaptcha:function(){var G=this.iframe.makeIframeContent({html:this.markup,css:this.css,js:this.script});this.iframe.write(G);},injectCallbacks:function(){this.iframe.assocIn(this.COMPLETE_CALLBACK,this._onComplete);this.iframe.assocIn(this.REJECT_CALLBACK,this._onReject);},cleanup:function(){this.el.parentNode.removeChild(this.el);},_onComplete:function(G){this._resolve(G);},_onReject:function(G){this._reject(G);}});},"0.0.1",{requires:["common-ui-dialog-helper","mail-captcha-turnkey-iframe","oop","node"]});YUI.add("mail-views-send-validation-error-handlers",function(e){function t(e){this.composeView=e}t.prototype={SEND_STATES:{ADDRESS_INVALID:"addInvld",ADDRESS_EMPTY:"addEmpty",SUBJECT_AND_CONTENT_INVALID:"sbCntInvld",SPAM_DETECTED:"spame"},_makeInvalidAddressMessage:function(t){return strings.str_comp_invalidAddressA+"<br><br>"+e.common.Utils.escapeHtml(t)+"<br><br>"+e.common.Utils.substitute(strings.str_comp_invalidAddressB,null,null,null,strings)},handleAddressInvalid:function(e){var t=strings.str_comp_title_invalidAddr,n=this._makeInvalidAddressMessage(e);this.composeView._alertProblem(t,n),this.composeView.lastSendState=this.SEND_STATES.ADDRESS_INVALID},handleNoRecipients:function(){var t=strings.str_comp_title_emptyToField,n=strings.str_comp_emptyToField;this.composeView._alertProblem(t,n),this.composeView._registerFocus(e.one("#to-field")),this.composeView.lastSendState=this.SEND_STATES.ADDRESS_EMPTY},handleTooManyRecipients:function(){var e=strings.str_comp_dialogheader,t=strings.str_comp_send_toomanyrecipients;this.composeView._alertProblem(e,t)},handleUploadInProgress:function(){var e=strings.str_comp_dialogheader,t=strings.str_comp_still_uploading;this.composeView._alertProblem(e,t)},handleBadAttachments:function(e){var t=e?strings.str_rte_attachments_alert_virus_title:strings.str_comp_dialogtitle_invalidSendAttachments,n=e?strings.str_rte_attachments_alert_virus:strings.str_comp_dialogbody_invalidSendAttachments;this.composeView._alertProblem(t,n)},handleEmptyMessage:function(t,n){var r=strings.str_modal_send_msg_title,i=strings.str_comp_invalidSubject,s=strings.str_comp_send,o=this;this.composeView.confirm(r,i,function(){t()},function(){n(),o.composeView.restoreAfterDialog(e.one("#subject-field"))},s),this.composeView.lastSendState=this.SEND_STATES.SUBJECT_AND_CONTENT_INVALID},handleSpame:function(){var e=strings.str_comp_title_spame,t=strings.str_comp_spame_general;this.composeView._alertProblem(e,t),this.composeView.lastSendState=this.SEND_STATES.SPAM_DETECTED},handleCaptcha:function(t,n,r){r.captchaAnswer=null;var i=r.captcha.captchaPayload.createResponse.Content,s=new e.Mail.Captcha.Turnkey.View({markup:i.Turnkey,script:i.Javascript.CONTENT,css:i.CSS.CONTENT,content:i});(new Promise(function(e,t){s.render(),s.invoke(e,t)})).then(function(e){r.captchaAnswer=e,t()})["catch"](n)},handleNewRecipients:function(t,n,r){var i=e.mail.Controller.ReplyProcessor,s=r.draft,o={to:s.to,cc:s.cc},u,a;u=i.getParentMsg(s,{fetchGDM:!0}),u.then(function(f){var l=new e.Mail.Models.Serializers.DraftGdmUnserializer,c={},h={},p,d,v;c.oMsg=f,c.action="reply_all",c.fid=e.common.Utils.getVal(s,"origin.parentMsg.fid"),p=i.getHeaderContent(c),d=i.matchRecipients(o,p),d.hasNewRecipients&&l.hasNonInlineAttachments(c.oMsg)?(a={ok:function(){e.fire("mt:click",{action:"cmps_dlg_attch_rply_ok"}),l.addNonInlineAttachments(s,f),r&&(r.attachOnSend=!0),t()},cancel:function(r){v=e.common.Utils.getVal(r,"item").hasClass("icon")&&e.common.Utils.getVal(r,"item").hasClass("close"),v?(e.fire("mt:click",{action:"cmps_dlg_attch_rply_cls"}),n()):(e.fire("mt:click",{action:"cmps_dlg_attch_rply_no"}),t()),t()}},h={hd:strings.str_comp_new_recipient_added,bd:strings.str_comp_new_recipient_body,suppressRestoreFocus:!0},e.common.ui.DialogHelper.confirm(h,{ok:{text:strings.str_comp_new_recipient_dialogue_ok_button,handler:a.ok},cancel:{text:strings.str_comp_new_recipient_dialogue_cancel_button,handler:a.cancel}})):t(f)},function(t){n(t)})}},e.namespace("mail.Views").SendValidationErrorHandlers=t},"1.0.0",{requires:["common-utils","node","mail-captcha-turnkey-view","mail-controller-reply-processor","mail-models-serializers-draft-gdm-unserializer"]});
YUI.add("minty_module_offscreen_bin_cloud_toolbar_callout",function(e){e.namespace("ui.Templates"),e.ui.Templates.minty_module_offscreen_bin_cloud_toolbar_callout={base:'<div class="img-cloud-provider"> <span class="dropbox"></span> <span class="gdrive"></span></div>{{str_cloud_toolbar_callout_hd}}'}},"1.0.0");
YUI.add("minty_module_offscreen_bin_compose_toolbar_callout",function(e){e.namespace("ui.Templates"),e.ui.Templates.minty_module_offscreen_bin_compose_toolbar_callout={base:'<div class="callout-default" tabindex="0"> <span class="icon icon-close close" title="{{str_close}}"></span> <div class="photo"> <img src="https://s.yimg.com/nq/onboarding/3/onboarding/compose/compose-nux-callout.gif" /> </div> <div class="content"> <div class="header">{{str_new_user_toolbar_callout_hd}}<div> <div class="body">{{str_new_user_toolbar_callout_bd}}</div> </div></div>'}},"1.0.0");
YUI.add("mail-ui-workspace-ext",function(e){e.mix(e.mail.ui.Workspace,{_isComposeSaved:function(e){var t=this,n=function(){t.getComposeDirtyCount(1,n)===0&&e&&e()},r=this.getComposeDirtyCount(1,n);return r!==0?0:1},_switchDensity:function(t){var n=t.density,r=e.one("#msg-list"),i=e.all(".result.content"),s={"ml-regular":0,"ml-compact":1,"ml-open":2},o=0,u="",a;if(n){n=n.replace(/density/,"ml");if(r){for(a in s)if(r.hasClass(a)){u=a;break}o=s[n]||0,NeoConfig.msgListDensity=o,e.common.persist.UserData.set("userUIPref.msgListDensity",o),e.Lang.later(0,0,function(){r.replaceClass(u,n),NeoConfig.timeChunk&&e.fire("updateDensity")}),e.fire("messageDensityChange",{density:s[n]})}i&&e.Lang.later(0,0,function(){i.replaceClass(u,n)})}},setUdbKey:function(t,n){var r,i,s=document.location,o=e.common.net.SessionMgr,u=s.protocol+"//"+s.host+"/neo/mailoptions?storm=1";i='{"method":"SetUDBData","prefs":'+e.JSON.stringify(t)+"}",r={success:function(e){n&&n.success&&n.success(e)},failure:function(e){n&&n.failure&&n.failure(e)},suppressCodes:["*"]},o.request(u,i,r,"POST",null,!0)},_setupNavigationSwitchForNav:function(t,n){var r=e.one("body"),i=t.type,s,o,u={notepad:!0,calendar:!0,contacts:!0,searchNav:!0,"empty-search":!0,newsfeed:!0};u[i]?e.one("body").setAttribute("data-open",t.type):e.one("body").removeAttribute("data-open")}},1)},"1.0.0",{requires:["mail-ui-workspace-base"]});
YUI.add("mail-ui-onboarding-richcompose",function(e){var t=e.common.Utils,n=t.features,r=e.ui.Templates,i,s,o=t.getBootcampURL(),u="YahooMailNeoPensive",a=null;s=function(){},e.mix(s.prototype,{canRegisterCallout:function(){return e.mail.ui.onboarding.dispatcher.isScoutActive()},showCloudAccountsCallout:function(t){this.canRegisterCallout()&&e.mail.ui.Onboarding.registerDefaultOnboarding({name:"cloudAccountsCallout",node:e.one(t),offset:[-230,0],closeOnExternalClick:!0,pointer:"right",fireInit:!0,hdText:strings.str_cloud_accounts_callout,autoFocus:!1})},showNewUserToolbarCallout:function(t){this.canRegisterCallout()&&e.mail.ui.Onboarding.registerDefaultOnboarding({name:"newUserToolbarCallout",node:t,offset:[-90,-135],pointer:"bottom",fireInit:!0,template:r.minty_module_offscreen_bin_compose_toolbar_callout,autoFocus:!1})},showExistingUserToolbarCallout:function(t){this.canRegisterCallout()&&e.mail.ui.Onboarding.registerDefaultOnboarding({name:"existingUserToolbarCallout",node:t,offset:[-138,-120],pointer:"bottom",fireInit:!0,hdText:strings.str_existing_user_toolbar_callout_hd,bdText:strings.str_existing_user_toolbar_callout_bd,autoFocus:!1})},registerCloudToolbarCallout:function(n,i){var s=r.minty_module_offscreen_bin_cloud_toolbar_callout,o=t.ezSub(s.base,{},s);this.canRegisterCallout()&&e.mail.ui.Onboarding.registerDefaultOnboarding({name:"cloudToolbarCallout",node:n,offset:[-285,-82],closeOnExternalClick:!0,onSuccess:i,pointer:"right",btnPrimaryText:strings.str_cloud_toolbar_callout_try,hdText:o,fireInit:!0,bdText:strings.str_cloud_toolbar_callout_bd,autoFocus:!1})},initBootcamp:function(){var e=require("BootcampAPIUtilsV2");return a||(a=new e({bucketId:NeoConfig.expBucketId,wssid:NeoConfig.wssid,mailboxId:NeoConfig.V3MailboxId,isForceUser:NeoConfig.forceDS,hasMultipleAccounts:NeoConfig.multipleAccounts,searchResultsLinksEnabled:!1,lmv3Enabled:n.enabled("LMV3"),clientId:u,bcHost:o})),a},checkCloudConnectionStatusAndShowCallout:function(e,t){var n=this;n.initBootcamp(),a.getExternalAccounts().then(function(r){var i=r&&r.data,s=!1,o=["gdrive","dropbox","amazon"],u;for(u=0;u<i.length;u++)o.indexOf(i[u].name)>-1&&i[u].isConnected&&(s=!0);s||n.registerCloudToolbarCallout(e,t)})},showCloudToolbarCallout:function(e,t){this.canRegisterCallout()&&this.checkCloudConnectionStatusAndShowCallout(e,t)},showPensiveCalloutOnToolbar:function(t){this.canRegisterCallout()&&e.mail.ui.Onboarding.registerDefaultOnboarding({name:"pensiveCalloutOnToolbar",node:t,offset:[-155,-50],pointer:"bottom",fireInit:!0,hdText:strings.str_new_pensive_callout_OnToolbar,autoFocus:!1})}}),i=new s,e.namespace("mail.ui.onboarding").richCompose=i},"1.0.0",{requires:["common-utils","mail-ui-onboarding","minty_module_offscreen_bin_cloud_toolbar_callout","minty_module_offscreen_bin_compose_toolbar_callout","mail-ui-workspace-ext","rich-compose-onboarding_css","mail-ui-onboarding-dispatcher"]});
YUI.add("mail-ui-composetictacapi",function(e){function a(e,t){var n=e.iconClassName,r="";return u&&n&&(r='<span data-action="'+t+'" class="'+n+'"></span>'),r}function f(e,t){var n=e.className,r=e.label,i=typeof t!="undefined"?t:"attachFromParent";return'<ul><li class="'+n+'" role="presentation">'+a(e,t)+'<a role="menuitem" data-action="'+i+'" tabindex="-1">'+r+"</a></li> </ul>"}function l(e){var t=[],n=e.map(function(e,n){var r=e.label,i=e.className||"",s=u&&i.indexOf("menu-attach-file-from-computer")!==-1;if(i!=="parent-attach-file"&&!s)return'<li class="'+i+'" role="presentation">'+a(e,n)+'<a role="menuitem" data-action="'+n+'" tabindex="-1">'+r+"</a></li>";t.push(f(e,s?n:undefined))});return n.unshift("<ul>"),n.push("</ul>"),t.unshift(n.join("")),t.join("")}function c(e){var t=this;t._handles=[],t.editor=e,t.editor.once("ready",function(){s.get("composeEditor").forEach(t._plugEditorPlugin,t),t._handles.push(s.on("added:composeEditor",t._plugEditorPlugin,t))})}var t=e.common.ui.MenuHelper,n=e.mail.Controller.ReplyProcessor,r=e.common.Utils.features,i=e.common.Utils,s=e.Mail.Services.Plugins,o=r.enabled("attachMenuInOldToolbar",!1),u=o?!0:!1;c.prototype={render:function(e){var t=this;t._parent=e,t._renderMenu(),t._handles.push(s.on("added:composeUploader",t._renderMenu,t))},bindUI:function(){var t=this,n=t.editor.composeView,r;t.editor.on("invoke:richcompose",function(i){r=n.getRichComposeView(),i.mimeType=i.mimeType||"docs",r&&r.composeAssistantVisibility?r.mimeType===i.mimeType&&!i.isMenu?(i.clickSource="tlbr_ca_"+i.mimeType+"_close",r.toggleComposeAssist(i)):(i.clickSource&&e.fire("mt:click",{action:i.clickSource}),n.fire("composeAssist:submitQuery",{query:"",mime:i.mimeType})):t._openComposeAssist(i),i.updateState&&i.updateState(r.composeAssistantVisibility)},t)},destroy:function(){var e=this;e._menuContainer&&(e._menuContainer.remove(),e._menuContainer.destroy(!0)),e._handles.forEach(function(e){e.detach()})},_plugEditorPlugin:function(e){var t=this;e.getPlugin().then(function(e){if(r.enabled("enhancrV2")&&e.NAME==="cards")return;t.editor.getRTE().plug(e)})},_openComposeAssist:function(e){var t=e.context||this,n=t.editor.composeView,r,i,s;return n.get("isQuickReply")&&n.neoFire("composeEvent",{action:"setActiveCompose",cv:n,noDelay:!0}),new Promise(function(t){function o(){n.fire("composeAssist:submitQuery",{query:"",mime:e.mimeType})}s="tlbr_ca_"+e.mimeType+"_open",e.clickSource&&(s=e.clickSource),n.fire("showComposeAssist",{clickSource:s}),o(),i=n.on("composeAssist:rootMounted",function(){o(),clearTimeout(r),i.detach()}),r=setTimeout(function(){i.detach()},1e4),t({})})},_attachFromComputerMenuitem:function(){var e=this,t="menu-attach-file-from-computer";return u&&(t+=" menu-with-icon"),{label:u?strings.str_comp_action_attach_files_from_computer:strings.str_comp_attachment_from_computer,className:t,iconClassName:"icon icon-desktop-attachment menu-with-icon",choose:function(){return window.setTimeout(function(){e._parent.one("#attachment-button-input").getDOMNode().click()},1),Promise.resolve([])}}},_attachFromRecentAttachments:function(){var e=this;return e._composeAssistLoaded=!1,{label:strings.str_comp_browse_recent_attachments,className:"menu-attach-file-from-recent-attachments",choose:function(t){return e._openComposeAssist({mimeType:"docs",context:t})}}},_attachFromComposeAssist:function(e){var t=this,n,r;t._composeAssistLoaded=!1;switch(e){case"docs":n=strings.str_comp_action_share_files_from_email,r="icon-doc-20";break;case"images":o&&NeoGV.isPensiveUser===1?(n=strings.str_comp_action_share_photo_from_phone,r="icon-mobile-photos"):(n=strings.str_comp_action_add_photos_from_email,r="icon-image-20");break;case"gifs":n=strings.str_comp_action_insert_animated_gifs,r="icon-gif";break;default:}return{label:n,className:"menu-attach-file menu-with-icon",iconClassName:r+" icon",choose:function(){return t.editor.fire("invoke:richcompose",{mimeType:e,isMenu:!0,clickSource:"cmps_att_"+e+"_open"}),Promise.resolve([])}}},_showIncludeOriginalAttachOptn:function(t){var r=this,s=i.getVal(r,"editor.composeView.draft"),o=i.getVal(r,"editor.composeView.draft.origin"),u=i.getVal(o,"action"),a,l,c,h,p;l=e.common.Utils.getVal(s,"attachments"),l.forEach(function(e){e.isInline()||(a=!0)}),u==="edit"&&!a&&(p=s.makeInReplyTo(),i.getVal(p,"replied")&&(u="reply_sender")),h=n.getParentMsg(s,{fetchGDM:!1}),h.then(function(n){var i=0,s,o;if(!n)return;s=n.attachments;for(i=0;i<s.length;i++){o=s[i];if(o.disposition!=="inline"&&o.referencedInline!==!0){c=!0;break}}r._menuContainer&&(!a&&c&&u==="reply_all"||u==="reply_sender")&&(t.push(r._includeParentAttachment()),r._menuContainer.append(f(r._includeParentAttachment())))},function(){})},_includeParentAttachment:function(){var t=this,r=i.getVal(t,"editor.composeView.controller"),s="parent-attach-file",o;return u&&(s+=" menu-with-icon"),{label:strings.str_comp_attach_parent,className:s,iconClassName:"icon icon-doc-20",attachmentHandler:function(){var i=t.editor.rte.composeView.draft;o=n.includeAttachment(i,{fetchGDM:!0}),o.then(function(){var n=e.one(".parent-attach-file");n&&(n.addClass("disabled"),r.attachInReply=!1),Promise.resolve([])},function(){Promise.reject([])})}}},showCloudToolbarCallout:function(){var t=this;e.use("mail-ui-onboarding-richcompose",function(e){e.mail.ui.onboarding.richCompose.showCloudToolbarCallout(t._menuContainer.one(".icon-doc-20"),function(){t.editor.composeView.editor.fire("invoke:richcompose",{mimeType:"docs"})})})},_renderMenu:function(){var n=this,o=i.getVal(n,"editor.composeView.draft.origin"),a=function(r){e.fire("compose:attach-menu-click"),r.currentTarget.menu||t.create(r.currentTarget,{menu:n._menuContainer,blur:!0},function(){r.preventDefault(),!i.isCalloutShown("cloudToolbarCallout")&&(i.isCalloutShown("newUserToolbarCallout")||i.isCalloutShown("existingUserToolbarCallout"))&&n.showCloudToolbarCallout(),n._menuContainer.on("menuSelected",function(t){var r,i=t&&t.item&&t.item.get("parentNode")._node,s=n._uploaders.length
;i&&(i.className.indexOf("attach-flickr")!==-1?e.fire("mt:click",{action:"cmps_attflk",append:{t1:"cmpsTb"}}):i.className.indexOf("attach-dropbox")!==-1?e.fire("mt:click",{action:"cmps_attlgfl",append:{t1:"cmpsTb"}}):i.className.indexOf("attach-file-from-computer")!==-1&&e.fire("mt:click",{action:"cmps_attflmnu",append:{t1:"cmpsTb"}})),t.dataAction==="attachFromParent"?(r=n._menuContainer.one(".parent-attach-file"),r&&!r.hasClass("disabled")&&(e.fire("mt:click",{action:"cmps_attchReply_mnu"}),n._uploaders[s-1].attachmentHandler())):n._uploadMenuOptionSelected(t.dataAction)}),n._menuContainer.on("menu:display-state",function(e){n.editor.fire("attachmentmenu:state",e)})})};if(u)n._uploaders=[];else{n._uploaders=s.get("composeUploader");if(n._uploaders.length===0)return}window.FormData&&window.FileReader&&(u?n.buildMenuItem():r.enabled("attachFromAnotherEmail")&&n._uploaders.unshift(n._attachFromRecentAttachments()),n._uploaders.unshift(n._attachFromComputerMenuitem())),r.enabled("attachInReply")&&e.common.Utils.getVal(o,"parentMsg.flags.hasAttachment")&&!u&&n._showIncludeOriginalAttachOptn(n._uploaders),n._menuContainer||(n._menuBtn=n._parent.one(".attach-btn-menu"),n._menuBtn.removeClass("disabled"),u&&(n._menuBtn=n._parent.one(".attach-menu-plus")),n._menuBtn.on("click",a),n._menuContainer=e.Node.create('<div id="attachment-menu" class="optionMenu"></div>'),n._menuContainer.append(l(n._uploaders)),e.one("body").append(n._menuContainer))},_uploadMenuOptionSelected:function(e){var t=this,n=t._uploaders[e];n.choose(t).then(function(e){t.editor.getRTE().fire("cardify",e.cardInfo,e.type)},function(){})},buildMenuItem:function(){var e=this;e._uploaders.push(e._attachFromComposeAssist("docs")),e._uploaders.push(e._attachFromComposeAssist("images")),e._uploaders.push(e._attachFromComposeAssist("gifs"))}},e.namespace("mail.Views").ComposeTictacApi=c},"1.0.0",{requires:["event-custom","common-ui-menu-helper","mail-services-plugins","mail-controller-reply-processor","mail-common-utils-features","mail-ui-onboarding-richcompose"]});
YUI.add("rte-file-utils",function(e){var t="Files",n={dragObjContainsFiles:function(e){var t=0;if(e.dataTransfer.types)for(t=0;t<e.dataTransfer.types.length;t++)if(e.dataTransfer.types[t]==="Files")return!0;return!1},dragObjContainsOnlyImages:function(e){var t=0,n;if(!e.dataTransfer||!e.dataTransfer.types||!e.dataTransfer.items&&!e.dataTransfer.files)return!1;n=e.dataTransfer.items||e.dataTransfer.files;for(t=0;t<n.length;t++)if(n[t].type.indexOf("image")!==0)return!1;return!0},dragShouldShowDropzone:function(n,r,i){var s=0,o={},u=!1,a=!1,f=e.mail.DataTransferUtils,l,c,h;if(f){if(f.hasData(t,n)||f.hasData("showdroptarget",n))u=!0,a=f.hasData(t,n);for(l in i)o[i[l]]=f.hasData(i[l],n);r&&typeof r=="function"&&!f.hasData(t,n)&&(u=u&&r(o))}else{if(n.dataTransfer.types){c=n.dataTransfer.types.length;for(s=0;s<c;s++){h=n.dataTransfer.types[s];if(h===t||h==="showdroptarget")u=!0,h===t&&(a=!0);o[h]=!0}}r&&!a&&(u=u&&r(o))}return u},dragObjectIsOnlyText:function(e){var t=0,n=e.dataTransfer,r;if(n&&n.types)for(t=0;t<n.types.length;t++){r=n.types[t];if(r!=="text/plain"&&r!=="text/html"&&r!=="text/_moz_htmlinfo"&&r!=="text/_moz_htmlcontext"&&r.toLowerCase()!=="text"&&r.toLowerCase()!=="public.utf8-plain-text"&&n.getData(r))return!1}return!0},getFilteredFile:function(e,t){var n=e.dataTransfer&&e.dataTransfer.files||[],r=[];return n=[].slice.call(n),r=n.filter(function(e){switch(t){case"image":return e.type.indexOf("image")>=0;case"nonimage":return e.type.indexOf("image")<0;default:return!0}}),r},inlineImageEnabled:function(){return window.FileReader&&window.URL&&e.mail.Core.feature("inlineimage").isOn()&&e.mail.Core.feature("ymrte").isOn()},canProcessImage:function(e){return e.dataTransfer&&e.dataTransfer.types&&window.FileReader&&window.URL?!0:!1},doesClipboardContainFiles:function(e){var n=e.clipboardData&&e.clipboardData.types;return n&&n.length>0?(n=Array.prototype.slice.call(n,0),n&&n.indexOf(t)>=0?!0:!1):!1},getFileFromDataURI:function(e){var t=e.match(/^data:(.+)?;(.+?),/),n,r,i,s,o,u,a;if(!t||!window.atob)return null;i=e.split(",")[1],t[2]==="base64"?n=atob(i):n=window.unescape(i),u=n.length,r=t[1],s=new Uint8Array(u);for(o=0;o<u;o++)s[o]=n.charCodeAt(o);return a=new Blob([s],{type:r}),a.name="datauri-file."+r.substring(6),a},getFilesfrmDragObj:function(e){return e.dataTransfer.files||[]},getImageFilesfrmClipBoard:function(e){var t=0,n=[],r,i;i=e.clipboardData.items||e.clipboardData.files;for(t=0;t<i.length;t++){r=i[t].getAsFile?i[t].getAsFile():i[t];if(!(r&&r.type.indexOf("image")>=0))return[];r.name="blob.jpg",n.push(r)}return n}};e.namespace("mail.rte").fileUtil=n},"0.0.1",{requires:[]});
YUI.add("_shared_module_compose_signature_tweet",function(e){e.namespace("ui.Templates"),e.ui.Templates._shared_module_compose_signature_tweet={base:'<br><table role="presentation" class="yahoo-compose-assist-card ymail-preserve-class" style="table-layout:fixed;font-family:Arial;font-size:13px;border:1px solid #e6e6e6;background-color:white;width:300px;border-spacing:0!important;border-spacing:0;color:black"> <tr>  <td style="padding:15px 15px 10px 15px"> <table style="table-layout:fixed;border-collapse:collapse;width:100%;font-family:Arial;font-size:13px"> <tr>  <td style="width:36px;padding-right:10px"><a title="{{str_hovercard_twitter_profile}}" rel="nofollow noreferrer" href="https://twitter.com/{{accountHandle}}"><img border="0" width="36" height="36" class="yahoo-ignore-inline-image" src="{{profileImgUrl}}"></a></td> <td style="width:202px;vertical-align:top">  <div><a title="{{str_hovercard_twitter_profile}}" rel="nofollow noreferrer" style="color:#444;font-weight:bold;text-decoration:none!important;text-decoration:none" href="https://twitter.com/{{accountHandle}}">{{userName}}</a></div> <a title="{{str_hovercard_twitter_profile}}" rel="nofollow noreferrer" style="color:#b2b2b2;text-decoration:none!important;text-decoration:none" href="https://twitter.com/{{accountHandle}}">@{{accountHandle}}</a></div> </td>  <td style="width:10%;text-align:right;vertical-align:top"><a title="{{str_comp_signature_twitter_link}}" href="https://twitter.com" rel="nofollow noreferrer"><img class="yahoo-ignore-inline-image" border="0" width="16" height="16" src="https://s.yimg.com/nq/a/img/twitter32_2.png"></a></td> </tr> </table> </td> </tr> <tr><td style="white-space:pre-wrap;word-wrap:break-word;width:100%;padding:0 15px">{{tweetText}}</td></tr> <tr>  <td style="padding:10px 15px"> <table style="table-layout:fixed;border-collapse:collapse;width:100%;font-family:Arial"> <tr> <td style="width:70%"><a style="color:#b2b2b2;font-size:11px;text-decoration:none!important;text-decoration:none" title="{{str_comp_signature_twitter_tweet_permalink}}" href="https://twitter.com/{{accountHandle}}/status/{{tweetId}}">{{tweetDate}}</a></td>  <td style="text-align:left"><a title="{{str_comp_signature_twitter_reply}}" rel="nofollow noreferrer" href="https://twitter.com/intent/tweet?in_reply_to={{tweetId}}"><img border="0" width="16" height="16" class="yahoo-ignore-inline-image" src="https://s.yimg.com/nq/a/img/twitter_reply16_1.png"></a></td> <td style="text-align:center"><a title="{{str_comp_signature_twitter_retweet}}" rel="nofollow noreferrer" href="https://twitter.com/intent/retweet?tweet_id={{tweetId}}"><img border="0" width="16" height="16" class="yahoo-ignore-inline-image" src="https://s.yimg.com/nq/a/img/twitter_retweet16_1.png"></a></td> <td style="text-align:right"><a title="{{str_comp_signature_twitter_favorite}}" rel="nofollow noreferrer" href="https://twitter.com/intent/favorite?tweet_id={{tweetId}}"><img border="0" width="16" height="16" class="yahoo-ignore-inline-image" src="https://s.yimg.com/nq/a/img/twitter_favorite16_1.png"></a></td> </td> </tr> </table> </td> </tr></table>'}},"1.0.0");
YUI.add("isXobnifiedCheck",function e(t){function p(n){e.isXobniAvailable=n,t.fire(s,n)}function d(n){e.isXobnified=n,t.fire(o,n)}function v(){n.ymmastats.stat("xobni_call_result","success="+e.isXobniAvailable+",xobnified="+e.isXobnified)}var n=t.common.Utils,r=t.mail.persist.MetaData,i=t.namespace("xobniContacts"),s="xobni:xobniStatusDetermined",o="xobni:xobnifiedDetermined",u="isXobnified",a=r.get(u),f='"ready"',l=0,c,h;NeoConfig.isXobniOverride==="yes"?e.isXobnified=!0:NeoConfig.isXobniOverride==="no"&&(e.isXobnified=!1),t.Lang.isUndefined(e.isXobnified)?(h=t.xobniContacts.Utils.getXobnifiedUrlObj(),c={timeout:5e3,xdr:h.xdr,on:{success:function(t,n){p(!0),a||(d(n.responseText===f),e.isXobnified&&(r.set(u,!0),r.save())),v()},failure:function(){if(l>=1){a||d(!1),p(!1),v();return}l++,h=t.xobniContacts.Utils.getXobnifiedUrlObj(),setTimeout(function(){t.io(h.url,c)},500)},complete:function(){var e=window.performance,n={m:"xobni_request_latency",browserInfo:NeoConfig.browser,colo:NeoConfig.colo,farm:NeoConfig.farm,retryNum:l},r=["startTime","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","duration"],i;e&&e.getEntriesByName&&(i=e.getEntriesByName(h.url).pop(),i&&(r.forEach(function(e){n[e]=i[e]}),t.fire("MailLog",n)))}}},a&&d(!0),t.io(h.url,c)):t.fire(o,e.isXobnified),i.isXobnified=function(n){return typeof n=="function"&&(e.isXobnified===undefined?t.once(o,function(){n(e.isXobnified)}):n(e.isXobnified)),e.isXobnified},i.isXobniAvailable=function(n){return typeof n=="function"&&(typeof e.isXobniAvailable=="undefined"?t.once(s,function(){n(e.isXobniAvailable)}):n(e.isXobniAvailable)),e.isXobniAvailable},i.isXobnifiedAndAvailable=function(t){return typeof t=="function"&&i.isXobnified(function(e){e?i.isXobniAvailable(t):t(e)}),e.isXobnified&&e.isXobniAvailable}},"1.0.0",{requires:["io-base","common-utils","xobni-utilities","ymma-stats","mail-persist-meta-data"]});
YUI.add("xobni-contacts-search-api",function(e){function u(e){var t;try{e&&e.responseText&&e.responseText.length&&(t=i.json.tryParse(e.responseText))}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-comms-shared-src-xobniContacts-xobni-contacts-search-api:1",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-comms-shared-src-xobniContacts-xobni-contacts-search-api:1")}return t}function a(){return s.stringify(t.getDefaultParams())}var t=e.xobniContacts.Utils,n=t.getXobniBaseURL(),r=e.common.Utils.ymmastats,i=e.common.Utils,s=e.QueryString,o;e.namespace("xobniContacts").searchAPI={fetch:function(i,s,a){var f=i.timeout||2e3,l="limit"in i?i.limit:5,c,h,p,d;return c=n.url+"/v4/contacts/s?",h=e.mix(t.getDefaultParams(),{q:i.query,l:i.limit||l}),p=e.QueryString.stringify(h),o=Date.now(),d={on:{success:function(t,n){var i=u(n),a=i&&e.Lang.isArray(i.r)?i.r:[];r.stat("xobni_contacts_s_latency","","milliseconds","duration",Date.now()-o),s&&s(a)},failure:function(e,t){t.statusText!=="abort"&&(t.statusText==="timeout",a&&a())}},timeout:f},n.xdr&&(d.xdr=n.xdr),i.origin?r.stat("search_xobnicontact","type=>searchsuggestion"):r.stat("search_xobnicontact","type=>normal"),e.io(c+p,d)},getImportantContacts:function(i,s,a){var f=n.url+"/v4/contacts/important?",l={include_types:"smtp",exclude_known_entities:!0,no_me_endpoint:!0,max_count:20,include_favorite:!0},c=e.merge(l,i,t.getDefaultParams()),h=e.QueryString.stringify(c),p;return o=Date.now(),p={on:{success:function(t,n){var i=u(n),a=i&&i["contacts-with-ranks"];a=e.Lang.isArray(a)?a:[],r.stat("xobni_contacts_important_latency","","milliseconds","duration",Date.now()-o),s&&s(a)},failure:function(e,t){var n=u(t);t.statusText!=="abort"&&t.statusText==="timeout",a(n)}}},n.xdr&&(p.xdr=n.xdr),e.io(f+h,p)},edit:function(t,i,s){var f,l;return f=n.url+"/v4/contacts/edit?"+a()+"&y-dc=hc-"+NeoConfig.buildNumber,o=Date.now(),l={method:"POST",data:e.JSON.stringify(t.data),headers:{"Content-Type":"text/plain"},on:{success:function(e,t){var n=u(t);r.stat("xobni_edit_latency","","milliseconds","duration",Date.now()-o),i&&i(n)},failure:function(e,t){var n=u(t);s(n)}}},n.xdr&&(l.xdr=n.xdr),e.io(f,l)},removePhoto:function(t,i,s){var f,l;return f=n.url+"/v4/contacts/removePhoto?"+a()+"&y-dc=hc-"+NeoConfig.buildNumber,o=Date.now(),l={method:"POST",data:e.JSON.stringify(t.data),headers:{"Content-Type":"text/plain"},on:{success:function(e,t){var n=u(t);r.stat("xobni_removePhoto_latency","","milliseconds","duration",Date.now()-o),i&&i(n)},failure:function(e,t){var n=u(t);s(n)}}},n.xdr&&(l.xdr=n.xdr),e.io(f,l)},contactsByEp:function(t,i,s){var f,l;return f=n.url+"/v4/contacts/by/ep?"+a()+"&y-dc=hc-"+NeoConfig.buildNumber,o=Date.now(),l={method:"POST",data:e.JSON.stringify({ep:t.eps,is_composing:t.isCompose,enable_tmp:!0,contact_limit:1}),headers:{"Content-Type":"text/plain"},on:{success:function(e,t){var n=u(t);r.stat("xobni_contactsByEp_latency","","milliseconds","duration",Date.now()-o),i&&i(n)},failure:function(e,t){var n=u(t);s(n)}}},n.xdr&&(l.xdr=n.xdr),e.io(f,l)},workflow:function(t,i,s){var f,l;return f=n.url+"/credentials/workflow?source="+t+"&"+a(),o=Date.now(),l={method:"POST",on:{success:function(e,t){var n=u(t);r.stat("xobni_workflow_latency","","milliseconds","duration",Date.now()-o),i&&i(n)},failure:function(e,t){var n=u(t);s(n)}}},n.xdr&&(l.xdr=n.xdr),e.io(f,l)},formatted:function(t,i){var s,f;return s=n.url+"/v4/util/credentials/formatted?"+a(),o=Date.now(),f={on:{success:function(e,n){var i=u(n);r.stat("xobni_formatted_latency","","milliseconds","duration",Date.now()-o),t&&t(i)},failure:function(e,t){var n=u(t);i&&i(n)}}},n.xdr&&(f.xdr=n.xdr),e.io(s,f)},photo:function(i,u,a){var f,l=t.getDefaultParams(),c;return delete l.ymreqid,f=n.url+"/v4/contacts/"+i.id+"/photo?spsize=10X10&badge=true&u="+i.updated+"&y-dc=hc-"+NeoConfig.buildNumber+"&"+s.stringify(l),o=Date.now(),c={method:"GET",on:{success:function(e,t){var n=t.getResponseHeader("x-image-source");r.stat("xobni_photo_latency","","milliseconds","duration",Date.now()-o),u&&u(n)},failure:function(e,t){a&&a()}}},n.xdr&&(c.xdr=n.xdr),e.io(f,c)}}},"1.0.0",{requires:["io-base","querystring-stringify-simple","json","ymma-stats","xobni-utilities","common-utils-jsonparse","common-net-session"]});
YUI.add("common-utils-rapid-clickmap",function(e){e.namespace("common.Utils").RapidCM={ml_srch:["hdr","hdr","srchMlLnk"],ml_srch_sugg:["hdr","hdr","sggstnLnk"],uh_signout_lnk:["hdr","hdr","signout"],uh_themes_lnk:["hdr","hdr","thmsLnk"],uh_options_lnk:["hdr","hdr","mlOptnsLnk"],uh_msgr_options_lnk:["hdr","hdr","mssngrOptnsLnk"],uh_Calendar_options_lnk:["hdr","hdr","clndrOptnsLnk"],uh_upgrade_lnk:["hdr","hdr","upgrdLnk"],uh_help_lnk:["hdr","hdr","hlpLnk"],uh_feedback_lnk:["hdr","hdr","fdbckLnk"],uh_privacy_lnk:["hdr","hdr","prvcyLnk"],uh_legal_lnk:["hdr","hdr","lglLnk"],uh_copyright_lnk:["hdr","hdr","cpyRghtLnk"],uh_ads_lnk:["hdr","hdr","adsLnk"],uh_fullmail_lnk:["hdr","hdr","fllLnk"],uh_help_upgrade_lnk:["hdr","hdr","upgrdLnk"],mail_search:["hdr","hdr","srchMailBtn"],launch:["launch"],first_time_launch:["launch","firstTime","newUser"],folder_tab:["tabs","{{activeTab}}","tab"],messageread_tab:["tabs","msgRdTb","tab"],compose_menu_toolbar:["msgLstTlbr","{{activeTab}}","tlbr","cmpsMnu"],compose_menu_toolbar_sel:["msgLstTlbr","{{activeTab}}","tlbr","cmpsMnuSel"],compose_new_nav_toolbar:["msgLstTlbr","{{activeTab}}","tlbr","cmpsBtn"],"tlbr_selectAll-message":["msgLstTlbr","{{activeTab}}","tlbr","selectAll"],tlbr_delete:["msgLstTlbr","{{activeTab}}","tlbr","dltBtn"],tlbr_reply_sender:["msgLstTlbr","{{activeTab}}","tlbr","rplyBtn"],tlbr_reply_all:["msgLstTlbr","{{activeTab}}","tlbr","rplyAllBtn"],tlbr_forward:["msgLstTlbr","{{activeTab}}","tlbr","frwrdBtn"],tlbr_spam:["msgLstTlbr","{{activeTab}}","tlbr","spmBtn"],"tlbr_menubtn-spam":["msgLstTlbr","{{activeTab}}","tlbr","spmMnu"],"tlbr_menusel-spam":["msgLstTlbr","{{activeTab}}","tlbr","spmMnuSel"],"tlbr_menubtn-move":["msgLstTlbr","{{activeTab}}","tlbr","mvMsgMnu"],"tlbr_menusel-move":["msgLstTlbr","{{activeTab}}","tlbr","mvMsgMnuSel"],"tlbr_menubtn-actions":["msgLstTlbr","{{activeTab}}","tlbr","actnMnu"],"tlbr_menusel-actions":["msgLstTlbr","{{activeTab}}","tlbr","actnMnuSel"],"tlbr_select-dd":["msgLstTlbr","{{activeTab}}","tlbr","slctMnuBtn"],"tlbr_menubtn-conv-view":["msgLstTlbr","{{activeTab}}","tlbr","vwMnuBtn"],tlbr_themes:["msgLstTlbr","{{activeTab}}","tlbr","vwMnu","thms"],tlbr_tab:["msgLstTlbr","{{activeTab}}","tlbr","vwMnu","tb"],tlbr_recent:["msgLstTlbr","{{activeTab}}","tlbr","vwMnu","rcnt"],tlbr_date:["msgLstTlbr","{{activeTab}}","tlbr","vwMnu","srtDt"],"tlbr_date-asc":["msgLstTlbr","{{activeTab}}","tlbr","vwMnu","srtDtAsc"],"tlbr_date-desc":["msgLstTlbr","{{activeTab}}","tlbr","vwMnu","srtDtDesc"],tlbr_unRead:["msgLstTlbr","{{activeTab}}","tlbr","vwMnu","srtUnrd"],tlbr_attachment:["msgLstTlbr","{{activeTab}}","tlbr","vwMnu","srtAtt"],"tlbr_sort-flagged":["msgLstTlbr","{{activeTab}}","tlbr","vwMnu","srtFlg"],"tlbr_menusel-conv-view":["msgLstTlbr","{{activeTab}}","tlbr","vwMnu","vwChng"],"tlbr_reply-im":["msgLstTlbr","{{activeTab}}","tlbr","rplyBtn"],"tlbr_menubtn-conv-actions":["msgLstTlbr","{{activeTab}}","tlbr","actnMnu",{t1:"chtTb"}],"tlbr_menusel-conv-actions":["msgLstTlbr","{{activeTab}}","tlbr","actnMnuSel",{t1:"chtTb"}],tlbr_edit:["msgLstTlbr","drftTb","tlbr","edtDrft"],tlbr_notspam:["msgLstTlbr","spmTb","tlbr","ntSpmBtn"],msglist_selectMnu:["msgLst","{{activeTab}}","msgLst","selectMnu"],msglist_retry:["msgLst","{{activeTab}}","msgLst","retry"],flag_message:["msgLst","{{activeTab}}","msgLst","flg"],unflag_message:["msgLst","{{activeTab}}","msgLst","unflg"],msglist_delBtn:["msgLst","{{activeTab}}","msgLst","delBtn"],msglist_archiveBtn:["msgLst","{{activeTab}}","msgLst","archiveBtn"],msglist_sortMnu:["msgLst","{{activeTab}}","msgLst","sortMnu"],open_msg:["msgLst","{{activeTab}}","msgLst","msg"],rt_click_msglst_preview:["msgLst","{{activeTab}}","msgLst","rtClkMenuPreview"],rt_click_msglst:["msgLst","{{activeTab}}","msgLst","rtClkMenu"],click_select:["msgLst","{{activeTab}}","msgLst","slctMsg"],mas_frm_srch:["msgLst","{{activeTab}}","msgLst","frmSrch"],mas_sbj_srch:["msgLst","{{activeTab}}","msgLst","sbjSrch"],msglist_delBtn_thrd:["msgLst","{{activeTab}}","msgLst","delBtnThrd"],msglist_archiveBtn_thrd:["msgLst","{{activeTab}}","msgLst","archiveBtnThrd"],click_select_thrd:["msgLst","{{activeTab}}","msgLst","selThrd"],flag_thrd:["msgLst","{{activeTab}}","msgLst","flgThrd"],unflag_thrd:["msgLst","{{activeTab}}","msgLst","unflgThrd"],expand_thrd:["msgLst","{{activeTab}}","msgLst","expThrd"],retry_expand_thrd:["msgLst","{{activeTab}}","msgLst","retryExpThrd"],collapse_thrd:["msgLst","{{activeTab}}","msgLst","clpseThrd"],flag_thrd_msg:["msgLst","{{activeTab}}","msgLst","thrdLst","flg"],unflag_thrd_msg:["msgLst","{{activeTab}}","msgLst","thrdLst","unflg"],msglist_delBtn_thrd_msg:["msgLst","{{activeTab}}","msgLst","thrdLst","delBtn"],msglist_archiveBtn_thrd_msg:["msgLst","{{activeTab}}","msgLst","thrdLst","archiveBtn"],open_thrd_msg:["msgLst","{{activeTab}}","msgLst","thrdLst","msg"],open_thrd_drftMsg:["msgLst","{{activeTab}}","msgLst","thrdLst","drftMsg"],move_thrd_msg:["msgLst","{{activeTab}}","msgLst","thrdLst","move"],account_switch_primary:["acctLst","leftRail","acctLst","acctSwtchPrmr"],account_switch_external:["acctLst","leftRail","acctLst","acctSwtchExtrnl"],toggle_account_list_expand:["acctLst","leftRail","acctLst","tgglAcctLstExpnd"],toggle_account_list_collapse:["acctLst","leftRail","acctLst","tgglAcctLstCllps"],imap_upsell_generic:["acctLst","leftRail","acctLst","genUpsell"],norrin_optin_shown:["fldrLst","leftRail","fldrLst","norrinOnboard","shown"],norrin_optin_clicked:["fldrLst","leftRail","fldrLst","norrinOnboard","click"],norrin_optin_status:["fldrLst","leftRail","fldrLst","norrinOnboard","complete"],norrin_optin_hidden:["fldrLst","leftRail","fldrLst","norrinOnboard","close"],add_mailbox_link_shown:["fldrLst","leftRail","fldrLst","addMbox","shown"],add_mailbox_link_success:["fldrLst","leftRail","fldrLst","addMbox","click"],add_mailbox_link_imap:["fldrLst","leftRail","fldrLst","addMbox","imap"],add_mailbox_link_close:["fldrLst","leftRail","fldrLst","addMbox","close"],inbox_fldr:["fldrLst","leftRail","fldrLst","fldrInbx"],conversations_fldr
:["fldrLst","leftRail","fldrLst","fldrCnv"],drafts_fldr:["fldrLst","leftRail","fldrLst","fldrDrft"],sent_fldr:["fldrLst","leftRail","fldrLst","fldrSnt"],archive_fldr:["fldrLst","leftRail","fldrLst","fldrArchv"],spam_fldr:["fldrLst","leftRail","fldrLst","fldrSpm"],trash_fldr:["fldrLst","leftRail","fldrLst","fldrTrsh"],inbox_leftnav:["fldrLst","leftRail","fldrLst","inbxBtn"],calendar_leftnav:["fldrLst","leftRail","fldrLst","cldrBtn"],contacts_leftnav:["fldrLst","leftRail","fldrLst","cntctBtn"],notepad_leftnav:["fldrLst","leftRail","fldrLst","ntpdBtn"],msngr_nav:["fldrLst","leftRail","fldrLst","msngrBtn"],custom_expand:["fldrLst","leftRail","fldrLst","cstmexpnd"],custom_collapse:["fldrLst","leftRail","fldrLst","cstmclps"],checkmail_btn:["fldrLst","leftRail","fldrLst","chkMlBtn"],mim_toggle:["fldrLst","leftRail","fldrLst","togYFrnds"],mim_frnd:["fldrLst","leftRail","fldrLst","chtYFrnd"],mim_message_send:["fldrLst","leftRail","fldrLst","mimMsgSnd"],mim_message_receive:["fldrLst","leftRail","fldrLst","mimMsgRcv"],usr_fldr:["fldrLst","leftRail","fldrLst","fldrUser"],toggle_smartviews_collapse:["fldrLst","leftRail","fldrLst","tgglSmtVwsCllps"],toggle_smartviews_expand:["fldrLst","leftRail","fldrLst","tgglSmtVwsExpnd"],emptyspam_btn:["fldrLst","leftRail","fldrLst","emptySpmBtn"],emptytrash_btn:["fldrLst","leftRail","fldrLst","emptyTrshBtn"],fldr_add:["fldrLst","leftRail","fldrLst","fldrAdd"],fldr_edit_close:["fldrLst","leftRail","fldrLst","fldrEdtCls"],fldr_srch_open:["fldrLst","leftRail","fldrLst","fldrSrchOpn"],fldr_srch_close:["fldrLst","leftRail","fldrLst","fldrSrchCls"],fldr_srch:["fldrLst","leftRail","fldrLst","fldrSrch"],cntxt_mnu_fldr:["fldrLst","leftRail","fldrLst","cntxtMnuFldrOpn"],"cntxt_mnu_fldr_itm_folder-new":["fldrLst","leftRail","fldrLst","cntxtMnuFldr","fldrAdd"],"cntxt_mnu_fldr_itm_folder-new-subfolder":["fldrLst","leftRail","fldrLst","cntxtMnuFldr","sbfldrAdd"],"cntxt_mnu_fldr_itm_folder-rename":["fldrLst","leftRail","fldrLst","cntxtMnuFldr","fldrRnm"],"cntxt_mnu_fldr_itm_folder-remove":["fldrLst","leftRail","fldrLst","cntxtMnuFldr","fldrRmv"],"cntxt_mnu_fldr_itm_folder-allread":["fldrLst","leftRail","fldrLst","cntxtMnuFldr","fldrMrkRd"],"cntxt_mnu_fldr_itm_folder-empty-spam":["fldrLst","leftRail","fldrLst","cntxtMnuFldr","fldrMtSpm"],"cntxt_mnu_fldr_itm_folder-empty-trash":["fldrLst","leftRail","fldrLst","cntxtMnuFldr","fldrMtTrsh"],cntxt_mnu_sys_fldr:["fldrLst","leftRail","fldrLst","cntxtMnuSysFldrOpn"],"cntxt_mnu_sys_fldr_itm_folder-new":["fldrLst","leftRail","fldrLst","cntxtMnuSysFldr","fldrAdd"],"cntxt_mnu_sys_fldr_itm_folder-allread":["fldrLst","leftRail","fldrLst","cntxtMnuSysFldr","fldrMrkRd"],"cntxt_mnu_sys_fldr_itm_folder-empty-spam":["fldrLst","leftRail","fldrLst","cntxtMnuSysFldr","fldrMtSpm"],"cntxt_mnu_sys_fldr_itm_folder-empty-trash":["fldrLst","leftRail","fldrLst","cntxtMnuSysFldr","fldrMtTrsh"],cntxt_mnu_fldr_v3:["fldrLst","leftRail","fldrLst","cntxtMnuFldrV3Opn"],"cntxt_mnu_fldr_v3_itm_folder-new":["fldrLst","leftRail","fldrLst","cntxtMnuFldrV3","fldrAdd"],"cntxt_mnu_fldr_v3_itm_folder-new-subfolder":["fldrLst","leftRail","fldrLst","cntxtMnuFldrV3","sbfldrAdd"],"cntxt_mnu_fldr_v3_itm_folder-rename":["fldrLst","leftRail","fldrLst","cntxtMnuFldrV3","fldrRnm"],"cntxt_mnu_fldr_v3_itm_folder-remove":["fldrLst","leftRail","fldrLst","cntxtMnuFldrV3","fldrRmv"],"cntxt_mnu_fldr_v3_itm_folder-allread":["fldrLst","leftRail","fldrLst","cntxtMnuFldrV3","fldrMrkRd"],"cntxt_mnu_fldr_v3_itm_folder-empty-spam":["fldrLst","leftRail","fldrLst","cntxtMnuFldrV3","fldrMtSpm"],"cntxt_mnu_fldr_v3_itm_folder-empty-trash":["fldrLst","leftRail","fldrLst","cntxtMnuFldrV3","fldrMtTrsh"],"cntxt_mnu_fldr_v3_itm_find-folder":["fldrLst","leftRail","fldrLst","cntxtMnuFldrV3","fndFldr"],"cntxt_mnu_imap_acct_itm_account-new":["acctLst","leftRail","acctLst","cntxtMnuImpAcctNw"],"cntxt_mnu_imap_acct_itm_account-rename":["acctLst","leftRail","acctLst","cntxtMnuImpAcctRnm"],"cntxt_mnu_imap_acct_itm_account-edit":["acctLst","leftRail","acctLst","cntxtMnuImpAcctEdt"],recentTabs_expand:["fldrLst","leftRail","fldrLst","recentTabs",{ltxt:"expand"}],left_rail_scroll:["fldrLst","leftRail","fldrLst","lftRlScrll"],themechooser_select:["thmDlg","dialog","thmDlg","selectTheme"],themechooser_exit_done:["thmDlg","dialog","thmDlg","done"],themechooser_exit_close:["thmDlg","dialog","thmDlg","close"],themechooser_exit_outside:["thmDlg","dialog","thmDlg","outside"],cmps_tab_cls:["tabs","cmpsTb","tbCls"],tlbr_send:["cmpsTlbr","cmpsTb","tlbr","snd",{t1view:"{{listMode}}"}],tlbr_att_send:["cmpsTlbr","{{activeTab}}","tlbr","attSnd"],msg_send:["cmpsTlbr","cmpsTb","tlbr","sent"],tlbr_cancelcompose:["cmpsTlbr","cmpsTb","tlbr","cncl"],tlbr_savedraft:["cmpsTlbr","cmpsTb","tlbr","svdft"],cmps_addrec:["cmpsHdr","cmpsTb","cmpsHdr","addrec"],cmps_addcc:["cmpsHdr","cmpsTb","cmpsHdr","addcc"],cmps_addbcc:["cmpsHdr","cmpsTb","cmpsHdr","addbcc"],cmps_shwcc:["cmpsHdr","cmpsTb","cmpsHdr","shwcc"],cmps_hdcc:["cmpsHdr","cmpsTb","cmpsHdr","hdcc"],cmps_shwbcc:["cmpsHdr","cmpsTb","cmpsHdr","shwbcc"],cmps_hdbcc:["cmpsHdr","cmpsTb","cmpsHdr","hdbcc"],cmps_rplysndr:["cmpsHdr","cmpsTb","cmpsHdr","rplysndr"],cmps_rplyall:["cmpsHdr","cmpsTb","cmpsHdr","rplyall"],ac_del:["cmpsHdr","cmpsTb","cmpsHdr","ac_del"],ac_select:["cmpsHdr","cmpsTb","cmpsHdr","ac_select"],cmps_emo:["emo","cmpsTb","well"],cmps_fmt:["fmt","cmpsTb","well"],cmps_attch:["attch","cmpsTb","well"],cmps_attchReply_mnu:["attch","cmpsTb","well","attprntmnu"],cmps_attflmnu:["attch","cmpsTb","well","attflmnu"],cmps_attfl:["attch","cmpsTb","well","attfl"],cmps_attlgfl:["attch","cmpsTb","well","attlgfl"],cmps_attflk:["attch","cmpsTb","well","attflk"],cmps_att_docs_open:["attch","cmpsTb","well","att_docs_open"],cmps_att_images_open:["attch","cmpsTb","well","att_images_open"],cmps_att_gifs_open:["attch","cmpsTb","well","att_gifs_open"],"cmps_wl_btn-fontname":["fmt","cmpsTb","well","fnttyp"],"cmps_wl_btn-fontsize":["fmt","cmpsTb","well","fntsz"],cmps_wl_bold:["fmt","cmpsTb","well","bld"],cmps_wl_italic
:["fmt","cmpsTb","well","itlcs"],cmps_wl_underline:["fmt","cmpsTb","well","undrln"],"cmps_wl_btn-forecolor":["fmt","cmpsTb","well","fntclr"],"cmps_wl_btn-backcolor":["fmt","cmpsTb","well","fnthglght"],"cmps_wl_align-l":["fmt","cmpsTb","well","algnlft"],"cmps_wl_align-c":["fmt","cmpsTb","well","algnctr"],"cmps_wl_align-r":["fmt","cmpsTb","well","algnrght"],"cmps_wl_btn-indent":["fmt","cmpsTb","well","indent"],"cmps_wl_btn-text-align":["fmt","cmpsTb","well","alignmn"],cmps_wl_indent:["fmt","cmpsTb","well","incindnt"],cmps_wl_outdent:["fmt","cmpsTb","well","decindnt"],cmps_wl_insertunorderedlist:["fmt","cmpsTb","well","bllt"],cmps_wl_insertorderedlist:["fmt","cmpsTb","well","blltOrdr"],cmps_wl_insertnumberedlist:["fmt","cmpsTb","well","num"],cmps_wl_insertlink:["fmt","cmpsTb","well","hyprlnk"],cmps_wl_emoticon:["fmt","cmpsTb","well","emomnu"],cmps_wl_spellcheck:["fmt","cmpsTb","well","spllchk"],"cmps_wl_btn-spell-langs":["fmt","cmpsTb","well","spllchkmnu"],cmps_wl_bidi_ltr:["fmt","cmpsTb","well","bidi_ltr"],cmps_wl_bidi_rtl:["fmt","cmpsTb","well","bidi_rtl"],cmps_stchpt:["fmt","cmpsTb","well","stchpt"],cmps_qtd_txt:["cmpsBdy","cmpsTb","cmpsBdy","expndTxt"],"cmps_wl_btn-fontnamesize":["fmt","cmpsTb","well","fntSz"],"cmps_wl_btn-insertunordered":["fmt","cmpsTb","well","blltLstMnu"],cmps_wl_fmt_tlbr_open:["fmt","cmpsTb","well","fmtTlbr_open"],cmps_wl_fmt_tlbr_close:["fmt","cmpsTb","well","fmtTlbr_close"],cmps_dlg_attch_rply_cls:["rcpntDlg","dialog","rcpntDlg","close"],cmps_dlg_attch_rply_no:["rcpntDlg","dialog","rcpntDlg","no"],cmps_dlg_attch_rply_ok:["rcpntDlg","dialog","rcpntDlg","yes"],stnry_open:["cmpsTlbr","{{activeTab}}","tlbr","stn_open"],stnry_close:["cmpsTlbr","{{activeTab}}","tlbr","stn_close"],stnry_action:["cmpsTlbr","{{activeTab}}","tlbr","stn_actn"],stn_category:["cmpsTlbr","{{activeTab}}","tlbr","stn_category"],stn_chooseThm:["cmpsTlbr","{{activeTab}}","tlbr","stn_chooseThm"],stn_clear:["cmpsTlbr","{{activeTab}}","tlbr","stn_clear"],stn_nav:["cmpsTlbr","{{activeTab}}","tlbr","stn_nav"],att_cmps_exp:["attch","cmpsTb","well","attExp"],att_cmps_cll:["attch","cmpsTb","well","attCll"],att_cmps_rmv:["attch","cmpsTb","well","attRmv"],att_cmps_nrtn:["attch","cmpsTb","well","attNrtn"],att_cmps_mnu_rmv:["attch","cmpsTb","well","attMnuRmv"],att_cmps_dnd_mlti:["attch","cmpsTb","well","attDndMlti"],db_dropbox_link_ok:["attch","cmpsTb","well","attDbOk"],db_dropbox_link_cancelled:["attch","cmpsTb","well","attDbCnl"],db_dropbox_share_from_activated:["attch","cmpsTb","well","attDbAc"],db_dropbox_alf_enable_ok:["attch","cmpsTb","well","attDbAlfAc"],att_save_to_dropbox:["attch","cmpsTb","well","attSvtDb"],enhancr_autolink_count:["attch","cmpsTb","well","attEnAL"],tlbr_print:["msgReadTlbr","msgRdTb","tlbr","prntBtn"],tlbr_prev:["msgReadTlbr","msgRdTb","tlbr","navBtn",{ltxt:"up"}],tlbr_next:["msgReadTlbr","msgRdTb","tlbr","navBtn",{ltxt:"down"}],tlbr_left:["msgReadTlbr","msgRdTb","tlbr","navBtn",{ltxt:"left"}],tlbr_right:["msgReadTlbr","msgRdTb","tlbr","navBtn",{ltxt:"right"}],"tlbr_menubtn-msg-actions":["msgReadTlbr","msgRdTb","tlbr","actnMnu"],"tlbr_menusel-msg-actions":["msgReadTlbr","msgRdTb","tlbr","actnMnuSel"],"tlbr_thread-toggle":["msgReadTlbr","msgRdTb","tlbr","thrdTgl"],tlbr_closemsg:["msgReadTlbr","msgRdTb","tlbr","clsMsg"],subject:["msgRead","msgRdTb","msgHdr","sbjct"],frm_srch:["msgRead","msgRdTb","msgHdr","frmSrch"],download_paperclip:["msgRead","msgRdTb","msgHdr","dlPcBtn"],lozenge_add:["msgRead","msgRdTb","msgHdr","lzngAddBtn"],lozenge_more:["msgRead","msgRdTb","msgHdr","lzngMoreBtn"],lozenge_menu:["msgRead","msgRdTb","msgHdr","lzngMnu"],details:["msgRead","msgRdTb","msgHdr","dtlsBtn"],read_toggle:["msgRead","msgRdTb","msgHdr","readInfo"],flag:["msgRead","msgRdTb","msgHdr","flg"],retry:["msgRead","msgRdTb","msgBody","retryBtn"],show_images:["msgRead","msgRdTb","msgBody","shwImgBtn"],options:["msgRead","msgRdTb","msgBody","optnBtn"],show_fullmsg:["msgRead","msgRdTb","msgBody","fullMsgBtn"],download_all:["msgRead","msgRdTb","msgBody","dlAllBtn"],download_single:["msgRead","msgRdTb","msgBody","dlSglBtn"],atm_norton:["msgRead","msgRdTb","msgHdr","atmNorton"],atm_slideshow_next:["msgRead","msgRdTb","msgHdr","atmSsNext"],atm_slideshow_prev:["msgRead","msgRdTb","msgHdr","atmSsPrev"],atm_download_thumbnail_selected:["msgRead","msgRdTb","msgHdr","atmDlTnSel"],atm_download_menu_selected:["msgRead","msgRdTb","msgHdr","atmDlMnSel"],atm_download_all_selected:["msgRead","msgRdTb","msgHdr","atmDlAllSel"],atm_slideshow_thumbnail_selected:["msgRead","msgRdTb","msgHdr","atmSsTnSel"],atm_slideshow_file_selected:["msgRead","msgRdTb","msgHdr","atmSsFlSel"],atm_slideshow_photo_selected:["msgRead","msgRdTb","msgHdr","atmSsPhSel"],atm_slideshow_all_selected:["msgRead","msgRdTb","msgHdr","atmSsAllSel"],atm_slideshow_download_single:["msgRead","msgRdTb","msgHdr","atmSsDlSi"],atm_download_success:["msgRead","msgRdTb","msgHdr","atmDlSuc"],atm_download_error_general:["msgRead","msgRdTb","msgHdr","atmDlErrGen"],atm_download_error_json:["msgRead","msgRdTb","msgHdr","atmDlErrJson"],atm_download_success_warnings:["msgRead","msgRdTb","msgHdr","atmDlSucWarns"],atm_download_success_errors:["msgRead","msgRdTb","msgHdr","atmDlSucErrs"],atm_download_success_warning:["msgRead","msgRdTb","msgHdr","atmDlSucWarn"],atm_download_success_error:["msgRead","msgRdTb","msgHdr","atmDlSucErr"],atm_download_success_success:["msgRead","msgRdTb","msgHdr","atmDlSucSuc"],atm_dropbox_saveto_selected:["msgRead","msgRdTb","msgHdr","atmDpSvtSel"],atm_dropbox_saveall_selected:["msgRead","msgRdTb","msgHdr","atmDpSvlSel"],msg_lnk_clk:["msgRead","msgRdTb","msgBody","mLnkClk"],flag_thrd_hdr:["thrdRead","thrdRdTb","thrdHdr","flg"],unflag_thrd_hdr:["thrdRead","thrdRdTb","thrdHdr","unflg"],read_thrd_hdr:["thrdRead","thrdRdTb","thrdHdr","read"],unread_thrd_hdr:["thrdRead","thrdRdTb","thrdHdr","unread"],retry_thrd_hdr:["thrdRead","thrdRdTb","thrdHdr","retryBtn"],flag_thrd_msg_hdr:["thrdRead","thrdRdTb","msg","msgHdr","flg"],unflag_thrd_msg_hdr:["thrdRead"
,"thrdRdTb","msg","msgHdr","unflg"],read_thrd_msg_hdr:["thrdRead","thrdRdTb","msg","msgHdr","read"],unread_thrd_msg_hdr:["thrdRead","thrdRdTb","msg","msgHdr","unread"],expand_thrd_msg_hdr:["thrdRead","thrdRdTb","msg","msgHdr","expMsg"],collapse_thrd_msg_hdr:["thrdRead","thrdRdTb","msg","msgHdr","clpseMsg"],show_images_thrd_msg:["thrdRead","thrdRdTb","msg","msgBody","shwImgBtn"],expand_qtd_thrd_msg:["thrdRead","thrdRdTb","msg","msgBody","expQtd"],collapse_qtd_thrd_msg:["thrdRead","thrdRdTb","msg","msgBody","clpseQtd"],retry_thrd_msg:["thrdRead","thrdRdTb","msg","msgBody","retryBtn"],options_thrd_msg:["thrdRead","thrdRdTb","msg","msgBody","optnBtn"],thrd_msg_lnk_clk:["thrdRead","thrdRdTb","msg","msgBody","tmLnkClk"],reply_sender_thrd_msg:["thrdRead","thrdRdTb","msg","tlbr","rplyBtn"],reply_all_thrd_msg:["thrdRead","thrdRdTb","msg","tlbr","rplyAllBtn"],quick_reply_sender_tlbr_thrd_msg:["thrdRead","thrdRdTb","msg","qRply","qrRplyBtn"],quick_reply_all_tlbr_thrd_msg:["thrdRead","thrdRdTb","msg","qRply","qrRplyAllBtn"],quick_forward_tlbr_thrd_msg:["thrdRead","thrdRdTb","msg","qRply","qrFwdBtn"],quick_reply_all_thrd_msg:["thrdRead","thrdRdTb","msg","qRply","rplyAllBtn"],forward_thrd_msg:["thrdRead","thrdRdTb","msg","tlbr","frwrdBtn"],delete_thrd_msg:["thrdRead","thrdRdTb","msg","tlbr","dltBtn"],actnMnu_thrd_msg:["thrdRead","thrdRdTb","msg","tlbr","actnMnu"],spam_thrd_msg:["thrdRead","thrdRdTb","msg","tlbr","spamBtn"],print_thrd_msg:["thrdRead","thrdRdTb","msg","tlbr","print"],fullheader_thrd_msg:["thrdRead","thrdRdTb","msg","tlbr","fullheader"],rawmessage_thrd_msg:["thrdRead","thrdRdTb","msg","tlbr","rawmsg"],set_encodings_thrd_msg:["thrdRead","thrdRdTb","msg","tlbr","set_encodings"],reply_card_menu_reply_all:["thrdReply","thrdRdTb","compose","thrdReplyHdr","replyAllMenu"],reply_card_menu_reply_sender:["thrdReply","thrdRdTb","compose","thrdReplyHdr","replySenderMenu"],reply_card_menu_forward:["thrdReply","thrdRdTb","compose","thrdReplyHdr","fwdMenu"],"reply_card_switch-to-fullcompose":["thrdReply","thrdRdTb","compose","thrdReplyHdr","switchToTallBtn"],"reply_card_reply-mode-change":["thrdReply","thrdRdTb","compose","thrdReplyHdr","replyModeBtn"],"reply_card_qr-cancel":["thrdReply","thrdRdTb","compose","thrdReplyHdr","cancelBtn"],compose_hdr_close_confirm_cc:["thrdReply","thrdRdTb","compose","thrdReplyHdr","closeCcConfirm"],compose_hdr_close_confirm_bcc:["thrdReply","thrdRdTb","compose","thrdReplyHdr","closeBccConfirm"],srch_flt:["leftRail","srchTb","flt"],srch_tgl:["leftRail","srchTb","tgl"],mb_ad:["msgLst","{{activeTab}}","msgLst","mbAds"],mb_ad_thrd:["msgLst","{{activeTab}}","msgLst","mbAds"],gta_get:["signup","leftRail","mblzr","gta-btn",{cat:"gtaa"}],gta_send:["signup","leftRail","mblzr","send",{cat:"gtaa"}],autosuggest_auth_facebook:["cmpsHdr","cmpsTb","cmpsHdr","asFbFtr"],autosuggest_auth_linkedin:["cmpsHdr","cmpsTb","cmpsHdr","asLiFtr"],autosuggest_auth_twitter:["cmpsHdr","cmpsTb","cmpsHdr","asTwFtr"],autocompose_invoke:["msgLstTlbr","{{activeTab}}","tlbr","autocomposeBtn"],autocompose_refresh:["cmpsTlbr","cmpsTb","tlbr","autocomposeRefresh"],autocompose_friendlylove:["cmpsTlbr","cmpsTb","tlbr","autocomposeFriendlyLove"],autocompose_crazyinlove:["cmpsTlbr","cmpsTb","tlbr","autocomposeCrazyInLove"],autocompose_allouttalove:["cmpsTlbr","cmpsTb","tlbr","autocomposeAllOuttaLove"],autocompose_send:["cmpsTlbr","cmpsTb","tlbr","autocomposeSnd"],autocompose_sendmore:["sentNf","{{activeTab}}","sentNf","autocomposeSndMore"],cmps_ev2_small:["cmpsBdy","cmpsTb","cmpsBdy","enhancrV2"],cmps_ev2_medium:["cmpsBdy","cmpsTb","cmpsBdy","enhancrV2"],cmps_ev2_large:["cmpsBdy","cmpsTb","cmpsBdy","enhancrV2"],cmps_ev2_append:["cmpsBdy","cmpsTb","cmpsBdy","enhancrV2"],cmps_ev2_deappend:["cmpsBdy","cmpsTb","cmpsBdy","enhancrV2"],cmps_ev2_remove:["cmpsBdy","cmpsTb","cmpsBdy","enhancrV2"],cmps_ev2_card_added:["cmpsBdy","cmpsTb","cmpsBdy","enhancrV2"],msgRd_ev2_share_mail:["msgRead","msgRdTb","msgBody","enhancrV2"],msgRd_ev2_share_facebook:["msgRead","msgRdTb","msgBody","enhancrV2"],msgRd_ev2_share_twitter:["msgRead","msgRdTb","msgBody","enhancrV2"],msgRd_ev2_share_tumblr:["msgRead","msgRdTb","msgBody","enhancrV2"],msgRd_ev2_play:["msgRead","msgRdTb","msgBody","enhancrV2"],msgRd_ev2_play_stop:["msgRead","msgRdTb","msgBody","enhancrV2"],jtc_article_click:["jtc","rightRail","snpt"],jtc_cta_click:["jtc","rightRail","ftr","Join the conversation"],jtc_arrow_click:["jtc","rightRail","ftr","arrows"],inlineinstall_widermail_install:["inlineInstallDlg","dialog","inlineInstallDlg","install"],inlineinstall_widermail_cancel:["inlineInstallDlg","dialog","inlineInstallDlg","cancel"],inlineinstall_widermail_install_retargeting:["inlineInstallDlg","dialog","inlineInstallDlg","install"],inlineinstall_widermail_cancel_retargeting:["inlineInstallDlg","dialog","inlineInstallDlg","cancel"],mView_right_prv:["mailView","msgList","mailView","mView_right_prv"],mView_bottom_prv:["mailView","msgList","mailView","mView_bottom_prv"],mView_no_prv:["mailView","msgList","mailView","mView_no_prv"]}},"1.0.0",{requires:[]});
YUI.add("mail-common-connected-accounts-ult",function(e){e.mix(e.common.Utils.RapidCM,{ln_interstitial:["dialog","dialog","lnkdnDlg","show"],ln_interstitial_close:["dialog","dialog","lnkdnDlg","cls"],linkedin_oauth_popup:["popup","popup","lnkdnOAuth","wndwOpnd"],linkedin_link_done:["popup","popup","lnkdnOAuth","cnnct","done"],linkedin_link_declined:["popup","popup","lnkdnOAuth","cnnct","dclnd"],linkedin_link_error:["popup","popup","lnkdnOAuth","cnnct","err"],linkedin_unlink_done:["popup","popup","lnkdnOAuth","dscnnct","done"],linkedin_unlink_error:["popup","popup","lnkdnOAuth","dscnnct","err"],facebook_oauth_popup:["popup","popup","fcbkOAuth","wndwOpnd"],facebook_link_done:["popup","popup","fcbkOAuth","cnnct","done"],facebook_link_declined:["popup","popup","fcbkOAuth","cnnct","dclnd"],facebook_link_error:["popup","popup","fcbkOAuth","cnnct","err"],facebook_unlink_done:["popup","popup","fcbkOAuth","dscnnct","done"],facebook_unlink_error:["popup","popup","fcbkOAuth","dscnnct","err"],twitter_oauth_popup:["popup","popup","twttrOAuth","wndwOpnd"],twitter_link_done:["popup","popup","twttrOAuth","cnnct","done"],twitter_link_declined:["popup","popup","twttrOAuth","cnnct","dclnd"],twitter_link_error:["popup","popup","twttrOAuth","cnnct","err"],twitter_unlink_done:["popup","popup","twttrOAuth","dscnnct","done"],twitter_unlink_error:["popup","popup","twttrOAuth","dscnnct","err"]})},"1.0.0",{requires:["common-utils-rapid-clickmap"]});
YUI.add("_shared_module_offscreen_bin_modal_connected_accounts",function(e){e.namespace("ui.Templates"),e.ui.Templates._shared_module_offscreen_bin_modal_connected_accounts={base:'<div id="modal-conn-accounts" class="modal"> <h2 class="modal-hd"> {{_shared_module_offscreen_bin_modal_close_icon}} </h2> <div class="modal-bd"> {{oauth_success}} {{oauth_failure}} </div> <div class="modal-ft"> {{_shared_module_offscreen_bin_modal_btn_ok}} </div></div>',fb_disclaimer:"<div>{{str_facebook_disclaimer}}</div> ",tw_disclaimer:'<div>{{str_twitter_disclaimer}}</div> <div class="signature-upsell">{{str_twitter_signature_upsell}}</div> ',ln_disclaimer:"<div>{{str_linkedin_disclaimer}}</div> ",oauth_success:'<div class="header {{service}}"> <span></span> </div> <div class="bd">{{str_oauth_conn_success}}</div> <div class="disclaimer"> {{fb_disclaimer}} {{tw_disclaimer}} {{ln_disclaimer}} </div> ',oauth_failure:'<div class="header"></div> <div class="bd"> <span> {{str_oauth_conn_failed_title}} </span> </div> <div class="disclaimer"> <div>{{str_oauth_conn_failed}}</div> </div> '}},"1.0.0",{requires:["_shared_module_offscreen_bin_modal_close_icon","_shared_module_offscreen_bin_modal_btn_ok"]});
YUI.add("_shared_module_offscreen_bin_notification_refresh_dialog",function(e){e.namespace("ui.Templates"),e.ui.Templates._shared_module_offscreen_bin_notification_refresh_dialog={base:'<div class="nf-container"> <div class="nf-hd">{{str_reconnect_hd}}</div> <div class="nf-bd">{{str_reconnect_msg}}</div> <div class="nf-ft"> <a href="#" data-action="link">{{str_reconnect}}</a> </div></div>'}},"1.0.0");
YUI.add("mail-common-connected-accounts",function(e){var t,n=e.xobniContacts,r=e.common.Utils,i=e.common.net.SessionMgr,s=n.searchAPI,o=e.ui.Templates,u=e.mail.persist.MetaData,a=n.Utils.getXobniBaseURL(),f="/neo/oauth",l=r.substitute,c=o._shared_module_offscreen_bin_modal_connected_accounts,h=o._shared_module_offscreen_bin_notification_refresh_dialog,p="facebook",d="linkedin",v="twitter",m=[p,d,v],g="autosuggesthideFacebookFooter",y="autosuggesthideLinkedinFooter",b="hideLinkedinReconnect",w=r.settings.value("facebook_credstore_spid"),E=r.settings.value("twitter_credstore_spid"),S=r.settings.value("linkedin_credstore_spid"),x=[];t=function(t){var n=this;x.push(e.once("CS:TOKEN_STATUS",n.validateTokenStatus,n))},t.prototype={upsellProvider:null,isHidden:!1,formattedStatus:null,dialog:null,checkStatusTimer:null,setup:function(){var e=this;n.isXobnified&&n.isXobnified(function(t){t===!0&&e.fetchFormattedStatus()})},linkTo:function(t,n){var r=this,i=f+"?service="+t+"&cmd=link&wssid="+encodeURIComponent(NeoConfig.wssid),s=t===d?500:700,o=t===d?600:500,u=screen.width/2-s/2,a=screen.height/2-o/2,l,c;if(r.isValidServiceProvider(t)){c=t+"_oauth_popup";for(l in x)x[l].detach();x=[],e.fire("mt:click",{action:c}),t===d?e.fire("util:ymstats",{name:"oauth_"+c,tags:{reconnect:r.forceReconnect()}}):e.fire("util:ymstats",{name:"oauth_"+c}),x.push(e.once("OAUTH:CONN_ACCOUNT",r._handleOAuthResponse,r,n)),e.UA.ie&&(clearTimeout(r.checkStatusTimer),r.checkCookieStatus()),window.open(i,"_blank","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+s+", height="+o+", top="+a+", left="+u)}},checkCookieStatus:function(t){var n=this;t=t||0,t<300&&(t++,n.checkStatusTimer=setTimeout(function(){var r="YM.OAUTH",i=e.JSON.parse(e.Cookie.get(r));i?(e.fire("OAUTH:CONN_ACCOUNT",i),e.Cookie.remove(r)):n.checkCookieStatus(t)},1e3))},unlinkFrom:function(t,n){var r=this,i,s,o;if(r.isValidServiceProvider(t)){i="?service="+t+"&cmd=unlink&ymreqid="+(e.common.net.Session.genReqID?e.common.net.Session.genReqID():"NO_YMREQID_LOADED")+"&wssid="+NeoConfig.wssid,s={method:"GET",on:{complete:function(n,r){var i=r.responseText&&r.responseText.length&&e.JSON.parse(r.responseText);i||(i={service:t,command:"unlink",status:0}),e.fire("OAUTH:CONN_ACCOUNT",i)}}};for(o in x)x[o].detach();return x=[],x.push(e.once("OAUTH:CONN_ACCOUNT",r._handleOAuthResponse,r,n)),e.io(f+i,s)}},_handleOAuthResponse:function(t,n){var r=this,i=t.service,s=t.command,o=parseInt(t.status,10),a,f;e.UA.ie&&clearTimeout(r.checkStatusTimer),(s==="done"||o===-9999)&&t.wssid&&(NeoConfig.wssid=t.wssid),o==200&&o<300&&s==="done"&&(r.upsellProvider===i&&(r.isHidden=!0),i===d&&(u.set(y,"false"),u.set(b,"false"),u.save()),r.pingWorkflow(i),r.showDialog(t)),o==200&&s==="unlink"&&r.pingWorkflow(i),!(o==200&&o<300)&&o!==412&&s!=="unlink"&&r.showDialog(t,n);if(s==="done"||s==="unlink")o==200&&o<300?a="done":o===412?a="declined":a="error",s=s==="done"?"link":s,f=i+"_"+s+"_"+a,e.fire("mt:click",{action:f}),i===d&&s==="done"?e.fire("util:ymstats",{name:"oauth_"+f,tags:{reconnect:r.forceReconnect()}}):e.fire("util:ymstats",{name:"oauth_"+f});r.fetchFormattedStatus(),n&&n(t)},showDialog:function(t,n){var r=this,i,s,u={twitter:strings.str_branding_twitter,facebook:strings.str_branding_facebook,linkedin:strings.str_branding_linkedin};s={oauth_success:function(e,t,n){var r=n,i=parseInt(e.status,10);return i>=200&&i<300?(e={service:e.service,service_provider:u[e.service]},l(c.oauth_success,e,s,{},strings,o,r)):""},fb_disclaimer:function(e,t,n){return e.service===p?l(c.fb_disclaimer,e,s,{},strings):""},tw_disclaimer:function(e,t,n){return e.service===v?l(c.tw_disclaimer,e,s,{},strings):""},ln_disclaimer:function(e,t,n){return e.service===d?l(c.ln_disclaimer,e,s,{},strings):""},oauth_failure:function(e,t,n){var r=parseInt(e.status,10);return r>=200&&r<300?"":(e={service:e.service,service_provider:u[e.service]},l(c.oauth_failure,e,s,{},strings))}},i=l(c.base,t,s,{},strings,o,r),r.dialog=new e.comms.ui.Dialog({template:i,centered:!0,zIndex:39e3,focusedNode:".modal"}),r.dialog.render(),r.bindDialogUI(n),r.dialog.show()},bindDialogUI:function(t){var n=this,i=n.dialog.get("contentBox"),s;for(s in x)x[s].detach();x=[],x.push(i.delegate("click",function(i){var s=r.getDataAction(i),o=s.action,u;switch(o){case"retry":u=s.node.getAttribute("data-value"),e.fire("util:ymstats",{name:"connected_accounts_retry",tags:{service:u}}),n.destroyDialog(),n.linkTo(u,t);break;case"twitter-upsell":n.destroyDialog(),NeoConfig.am?e.fire("openOptions",{view:"accounts",subView:{sid:"edit",accId:e.mail.model.DataStore.Accounts.getPrimaryAccount().id}}):e.fire("openOptions",{view:"writing_email"});break;case"connect-ln":n.destroyDialog(),n.linkTo("linkedin",t);break;case"ok":case"cancel":n.destroyDialog(o)}},"*[data-action]")),x.push(n.dialog.on("dialog:action",function(e){var t=e.dataAction;t==="cancel"&&n.destroyDialog(t)}))},destroyDialog:function(e){var t=this,n;if(t.dialog){for(n in x)x[n].detach();x=[],t.dialog.destroy(),t.dialog=null}},getStatusBySPID:function(e){var t=this,n,r,i=!!t.formattedStatus;return i&&(r=t.formattedStatus.results,r&&r[e]?n=!r[e].is_expired:n=!1),n},getStatus:function(t,n){var r=this,i=!!r.formattedStatus;return typeof n=="function"&&(i===!1?e.once("CS:TOKEN_STATUS",function(){n(r.getStatusBySPID(t))}):n(r.getStatusBySPID(t))),r.getStatusBySPID(t)},getAllSPIDStatus:function(t){var n=this,r=!!n.formattedStatus;return typeof t=="function"&&(r===!1?e.once("CS:TOKEN_STATUS",function(){t(n.formattedStatus)}):t(n.formattedStatus)),n.formattedStatus},fetchFormattedStatus:function(){var t=this,n,r;n=function(n){t.formattedStatus=n,e.fire("CS:TOKEN_STATUS",t.formattedStatus),e.fire("util:ymstats",{name:"connected_accounts",tags:{api:"formatted",result:"success"}})},r=function(t){var n=this;n.formattedStatus=null,e.fire("util:ymstats",{name:"connected_accounts",tags:{api:"formatted",result:"failure"}})},s.formatted(e.bind(n,t),e.bind(r,t
))},getUpsell:function(){var e=this,t=[],n;return e.isHidden?!1:e.upsellProvider?e.upsellProvider:e.forceReconnect()===!0&&u.get(y)!=="true"?(e.upsellProvider=d,e.upsellProvider):(u.get(g)!=="true"&&e.getStatusBySPID(w)===!1&&t.push(p),u.get(y)!=="true"&&e.getStatusBySPID(S)===!1&&r.features.enabled("linkedinfy")&&t.push(d),n=t.length,n?(e.upsellProvider=t[Math.floor(Math.random()*n)],e.upsellProvider):!1)},hideUpsell:function(e){var t=this,n;e===p?n=g:e===d&&(n=y),n&&(t.isHidden=!0,u.set(n,"true"),u.save())},pingWorkflow:function(t){var n=this,r,i;r=function(n){e.fire("util:ymstats",{name:"connected_accounts",tags:{api:"workflow",source:t,result:"success"}})},i=function(n){e.fire("util:ymstats",{name:"connected_accounts",tags:{api:"workflow",source:t,result:"failure"}})},s.workflow(t,e.bind(r,n),e.bind(i,n))},isValidServiceProvider:function(t){return e.Array.indexOf(m,t)>=0?!0:!1},validateTokenStatus:function(){var t=this;e.use("mail-common-token-refresh",function(e){e.mail.common.TokenRefresh.init()}),t.showReconnectNotification(),e.fire("util:ymstats",{name:"credstore_token_status",tags:{facebook:t.getStatusBySPID(w),twitter:t.getStatusBySPID(E),linkedin:t.getStatusBySPID(S),isCorp:NeoConfig.isCorpmail}})},isStaleToken:function(){var e=this,t=864e5,n=r.settings.value("tokenRefreshThreshold"),i,s,o,u;if(r.features.enabled("refreshLinkedInToken")){u=!!e.formattedStatus;if(u){i=e.formattedStatus.results&&e.formattedStatus.results[S];if(i&&i.is_expired===!1){s=i.expiry_ts*1e3,o=Math.round((s-Date.now())/t);if(o<n.linkedin.value)return!0}}}return!1},isExpiredToken:function(){var e=this,t,n,r=!!e.formattedStatus;return r&&(t=e.formattedStatus.results&&e.formattedStatus.results[S],t&&(n=t.is_expired)),n},forceReconnect:function(){var e=this;return r.features.enabled("refreshLinkedInToken")&&(e.isStaleToken()||e.isExpiredToken())},showReconnectNotification:function(){var t=this;r.isLaunchOnboardingShown()===!1&&r.features.enabled("refreshLinkedInToken")&&u.get(b)!=="true"&&t.forceReconnect()===!0&&(r.setLaunchOnboardingShown(!0),e.use("common-ui-notification-v2",function(e){var n=function(n,r){r==="closeNotification"?(u.set(b,"true"),u.save(),e.fire("util:ymstats",{name:"ln_refresh_dialog",tags:{action:"close"}})):r==="link"&&(t.linkTo(d),e.fire("util:ymstats",{name:"ln_refresh_dialog",tags:{action:"link"}}))};e.common.ui.NotificationV2.notify(l(h.base,{},null,{},strings),{type:"attention",close:!0,closeOnExternalClick:!0,cbk:n,cbkOnClose:!0,customClass:"nf-multiline"}),e.fire("util:ymstats",{name:"ln_refresh_dialog",tags:{action:"show"}})}))}},e.namespace("mail.common"),window.ConnectedAccounts=window.ConnectedAccounts||new t,e.mail.common.ConnectedAccounts=window.ConnectedAccounts,e.mail.common.ConnectedAccounts.setup()},"0.0.1",{requires:["io-base","node-base","ymma-stats","xobni-utilities","common-net-session","mail-model-datastore","xobni-utilities","isXobnifiedCheck","xobni-contacts-search-api","common-ui-dialog-helper","mail-common-connected-accounts-ult","_shared_module_offscreen_bin_modal_connected_accounts","_shared_module_offscreen_bin_notification_refresh_dialog"]});
YUI.add("mail-ui-signature-tweet-view",function(e){"use strict";function f(r){var i=this;r&&n.get("enableTweet")==="on"&&e.mail.common.ConnectedAccounts.getAllSPIDStatus(function(e){var n=e&&e.results,s=t.settings.value("twitter_credstore_spid");n&&n[s]&&!n[s].is_expired&&i._addTweet(r,n[s].external_id)})}var t=e.common.Utils,n=e.mail.persist.MetaData,r=12e4,i="/neo/lastTweet",s=".signature-tweet",o=5e3,u=null,a=0;e.mix(f.prototype,{removeTweet:function(e){if(!e)return;var t=e.one(s);t&&t.remove(!0)},_getHTML:function(n){return t.ezSub(e.ui.Templates._shared_module_compose_signature_tweet.base,{accountHandle:n.handle,profileImgUrl:n.img_url,tweetText:n.text,tweetId:n.id,tweetDate:t.dateFormatter(new Date(n.creation_time),strings.str_tog_dateformat_messagelist_yesyear_l10n),userName:n.name})},_addTweet:function(t,f){var l=this,c;Date.now()-a>=r||!u?e.io(i+"?wssid="+NeoConfig.wssid+"&user_id="+f,{timeout:o,on:{success:function(e,r){var i;c=t.one(s);if(!r||r.status!==200||!r.responseText||!c||n.get("enableTweet")!=="on")return;try{i=JSON.parse(r.responseText)}catch(o){return}if(!i.success){i.hasOwnProperty("newWssid")&&(NeoConfig.wssid=i.newWssid);return}u=l._getHTML(i.tweet),a=Date.now(),c.set("innerHTML",u)},timeout:function(){e.fire("util:ymstats",{name:"compose_lastTweet_client_timeout"})}}}):(c=t.one(s),c&&c.set("innerHTML",u))}}),e.namespace("mail.Views").SignatureTweetView=f},"1.0.0",{requires:["io-base","common-utils","_shared_module_compose_signature_tweet","mail-persist-meta-data","mail-common-connected-accounts"]});
YUI.add("mail-ui-fullcompose-v3",function(e){function M(t){var n=this,r,i;n.composeViewRendered&&(n.isDraft?r="draft":(i=n.draft&&n.draft.get&&n.draft.origin,r=i?i.action:null),r=r||"new",e.Lang.later(90,null,function(){n.neoFire("composeEvent",{action:"darlaEvent",type:"compose_"+r})})),t.cbk&&t.cbk()}function _(e){var t=this;t.get("isQuickReply")||t.header.hideACWidget(),t.dirty&&t.dirty!=="ForceClose"&&NeoConfig.saveOnHideCompose&&(t.isAutoSave=!0,t.save()),t.hiliteCP&&t.hiliteCP.hide(),t.textCP&&t.textCP.hide(),e.cbk&&e.cbk()}function D(){var e=this,n=e.baseNode,r=n.one(".cm-subject-field"),i=n.one("input.cm-subject-field");return i.ancestor("div").removeClass(b),{subjectVal:t(r.get("value")),subjectDir:NeoConfig.bidi?r.getStyle("direction"):null}}function P(){var t=this,n=t.draft,r=t.closeSrc,i,s=n.origin;s&&s.action!==null?s=s.action:s="new",i={action:"cmps_tab_cls",append:{t1:"cmpsTb",ltxt:s,cmpsType:t.get("isQuickReply")?"QR":"fullCmps"}};switch(r){case"closeBtn":break;case"escKey":i.append.actn="keybrd";break;case"cancelBtn":i.action="tlbr_cancelcompose"}t.editor&&t.editor.detachEvents(),t.set("close",1),e.fire("mt:click",i)}function H(){var t=this,n=t.attComposer,r;t.blockSave=!0,t.saveTimer&&t.saveTimer.cancel(),t.adRotationTimer&&t._cancelAdRotationTimer(),t.resizeRTEDelayTimer&&t.resizeRTEDelayTimer.cancel(),t._clearOriginTimers(),t.hiliteCP&&t.hiliteCP.hide(),t.textCP&&t.textCP.hide(),!e.Lang.isNull(t.spellCheckView)&&!e.Lang.isUndefined(t.spellCheckView)&&t.spellCheckView.destroy(),t.spellCheckView=null,n&&(n.cleanup(),t.attComposer=null),t.tray&&t.tray.destroy(),r=t.rteFormatter,r&&(r.fontFamilyOptions&&r.fontFamilyOptions.remove().destroy(!0),r.fontSizeMenu&&r.fontSizeMenu.remove().destroy(!0),r.fontNameMenu&&r.fontNameMenu.remove().destroy(!0),r.formatButtons&&r.formatButtons.remove().destroy(!0),r.fontColorMenu&&r.fontColorMenu.remove().destroy(!0),r.textIndentation&&r.textIndentation.remove().destroy(!0),r.textAlignment&&r.textAlignment.remove().destroy(!0),r.textLists&&r.textLists.remove().destroy(!0),r.emotionMenu&&r.emotionMenu.remove().destroy(!0)),t.rtSwitch=null,t.baseNode&&(e.each(t.handles,function(e){e.detach()}),t.handles=null,t.baseNode.remove().destroy(!0)),t.composeTictacApi.destroy(),t.rteFormatter&&(t.rteFormatter.destroy(),t.rteFormatter=null),t.header=null,t.formatters=null,t.container=null,t.editor=null,e.fire("compose:rte:blur"),O.superclass.ondestroy.call(this,arguments)}function B(){var e=this,t,n=e.baseNode.one(".ac-input.focus .recipient-input input");n&&e.header._lozengeIt(n),t=e.baseNode.all(".compose-header .field .hLozenge");if(t.size()>100){this._warnTooManyRecipients();return}e._invokeSend(!0)}function j(){var e=this;e._cancelSaveTimer(),e.controller.send()}function F(){e.use("common-ui-dialog-helper",function(){a.ui.DialogHelper.alert({hd:strings.str_comp_dialogheader,bd:strings.str_comp_send_toomanyrecipients,suppressRestoreFocus:!0},{ok:{handler:function(){}},cancel:{handler:function(){}}})})}function I(t){if(!this.dropzone){var n=d(v._shared_module_compose_dropzone.base,{},0,0,strings);this.dropzone=e.Node.create(n),t?(this.baseNode.one(".footer-separator").appendChild(this.dropzone),this.baseNode.one(".footer-separator").setStyles({position:"relative",maxHeight:"200px"}),this.baseNode.one(".bottomToolbar").removeClass("smartFixed")):this.baseNode.appendChild(this.dropzone)}}function q(){this.dropzone&&(this.dropzone.remove(),this.dropzone=null,o.inlineImageEnabled()&&(this.baseNode.one(".footer-separator").setStyles({position:null,maxHeight:null}),this.doResizeRTE(),e.fire("recalculateScrollToRepositionSend")))}function R(e){var t=e.cloneNode(!0),n=e.parentNode;return t.value=null,n.replaceChild(t,e)}function U(){function a(e){return"quoted-text"===e.getAttribute("data-action")}function c(n){var r=n.keyCode;if(r&&r!==13){(r===8||r===46)&&n.stopImmediatePropagation();return}a(n.target)&&(t._expandQuotedReply(),e.fire("mt:click",{action:"cmps_qtd_txt"}))}var t=this,n=t.draft,s=t.handles,u;t.attachIcon=t.baseNode.one(".attachment-button-attach"),NeoConfig.backButtonFull||e.fire("initPage"),t.setDraftDirtyDebounced=f.debounce(function(){t._setDirty()},T),s.push(t.editor.on({keyDown:function(n){var r=!1;e.fire("HoverCard:hideHoverCard");if(n.ctrlKey||n.metaKey||n.altKey||n.shiftKey||n.keyCode===27||n.keyCode===40)r=t.get("keydownHandler")?t.get("keydownHandler")(n):t.onKeyDown(n);r?n.halt():(t._lastActivityTime=Date.now(),t.setDraftDirtyDebounced(),t.uploadFormDirty&&W(t),setTimeout(function(){t.get("isQuickReply")&&t.resizeRTE()},0))},focus:function(e){t._registerFocus(e.editor),t.header._removeLozengeHighlights(),t.neoFire("composeEvent",{action:"setActiveCompose",cv:t,editor:e.editor})},blur:function(n){e.fire("compose:rte:blur",{editor:n.editor,cv:t})},nodeChange:function(e){e&&(e.type==="paste"||e.type==="drop"||e.type==="undoLoadState")&&t.setDraftDirtyDebounced()},ready:function(){t.postRender(),t.focusNode&&t.setFocus(t.focusNode)}})),s.push(n.on("compose:restoreFocus",function(){t.focusNode instanceof e.Node?t._restoreFocus():t.setFocus("body",0,1)},t)),s.push(t.baseNode.delegate("click",function(n){var r=n.currentTarget,i=r.get("parentNode"),s=i.hasClass("cc-btn")?"cc":"bcc",o=i.get("id"),u=o==="btn-show-"+s+"-in-to",a="cmps_"+(u?"shw"+s:"hd"+s);n.halt(!1),t.header._cmdBccSwitch(u,"bcc"),t.header._cmdBccSwitch(u,"cc"),l.enabled("stickyCcBcc",!1)&&!t.get("isQuickReply")&&(p?(h.set("attributes.web.composeShowCc",u?!0:!1),h.set("attributes.web.composeShowBcc",u?!0:!1)):k.set("neo.pref.compose.showCcBcc",u?"1":"0")),e.fire("mt:click",{action:a,append:{t1:"cmpsTb"}}),t._restoreFocus()},"span.cc-btn a, span.bcc-btn a")),s.push(t.compArea.on("click",c)),s.push(t.compArea.on("keydown",c)),s.push(t.compArea.on("key",function(e){var n,r;e.keyCode===38?a(e.target)?t.editor.setFocus():e.target.ancestor(".attachments-well",!0,"#rtetext")&&(r=t.baseNode.one(".compose-quoted-text:not(.hidden) .qtd-expansion-text"),r?r.focus():t.editor.setFocus()
):e.keyCode===40&&a(e.target)&&(n=t.baseNode.one(".attachments-well:not(.hidden)"),n&&n.focus()),e.stopPropagation()},"down:38,40")),s.push(t.baseNode.delegate("click",function(){t._clearOriginTimers(),t._displayLoading(),i.fetchOrigin(n,t.isDraft,t._getTextMode())},"a.retryOrigin")),t.on("renderComplete",function(){l.enabled("lastTweetSignature")&&!t.signatureTweetView&&(t.signatureTweetView=new r.Views.SignatureTweetView(t.compArea)),t.contentLoaded=!0,e.use("mail-controller-sendconfirm","mail-ui-sendconfirmview-base-conv",function(){}),l.enabled("cannedResponse")&&!f.isCalloutShown("composeTemplateCallout")&&!t.get("isQuickReply")&&e.use("mail-ui-mailcompose-templates",function(e){e.mail.Views.composeTemplates.showCalloutTemplate(t)})}),t._addFocusListenersFresh(),s.push(t.baseNode.on("keydown",function(e){var n,r=e.target;e.keyCode===13&&r.ancestor("div.rte-well-container")&&(e.halt(),t.focusNode=r,n=r.one("b"),n&&n.simulate("click"))})),s.push(t.baseNode.delegate("click",function(e){var n=f.getDataAction(e).action;t.handleComposeAction(n,e)},".bottomToolbar > span")),s.push(t.baseNode.delegate({click:function(){W(t),e.fire("mt:click",{action:"cmps_attfl"})},focus:function(){var e=t.baseNode.one("#attachment-button-input");e.ancestor("span").addClass("focused")},blur:function(){var e=t.baseNode.one("#attachment-button-input");e.ancestor("span").removeClass("focused")},change:function(){var e=this.getDOMNode();window.FormData&&window.FileReader?t.fire("attachmentUpload",{files:[].slice.call(e.files)}):e.value!==""&&(this.uploadFormDirty=!0,t.fire("attachmentUploadForm",{inputEl:e}))}},"#attachment-button-input")),t.baseNode.one(".attachments-pane").removeClass("hidden"),s.push(t.baseNode.on("drop",function(e){var n=e._event.dataTransfer.files;n&&n.length&&t.fire("attachmentUpload",{files:[].slice.call(n)})})),u={dragover:function(e){var n=o.inlineImageEnabled(),r=function(e){return e.isinlineattachonly?!1:!0};o.dragShouldShowDropzone(e._event,r,["isinlineattachonly"])&&(clearTimeout(t._dragTimer),t._showDropzone(n)),e.preventDefault()},dragleave:function(e){var n=window.innerWidth,r=window.innerHeight,i=e.clientX,s=e.clientY;i<=0||i>=n||s<=0||s>=r?t._hideDropzone():(clearTimeout(t._dragTimer),t._dragTimer=setTimeout(function(){t._hideDropzone()},300))},drop:function(n){t._hideDropzone(),e.fire("dropHandled"),n.preventDefault()}},window.FileReader&&s.push(e.one("body").on(u)),s.push(e.on("dropHandled",function(){t._hideDropzone()})),s.push(e.on("windowresize",function(){t.resizeRTE()})),t._showSendBtn(!1),t.composeTictacApi.bindUI()}function z(){var t=this.baseNode.one(".attachment-button-form"),n=t.one("#jsonString"),r=2,i=this.draft.attachments.filter(function(e){return e.state()==="pending"}),s=JSON.parse(this.draft.jsonify({iframeUpload:{multipartName:"uploadfile"}}));s.actions.responseContentType="text/plain",i.forEach(function(e){e.setPartId(r),r++,e.setProgress(.5)}),n||(n=e.Node.create('<input type="hidden" name="jsonString" id="jsonString">'),t.insertBefore(n,t.get("firstChild"))),n.set("value",JSON.stringify(s)),this.draft.formId=t.get("id")}function W(e){var t=e.baseNode.one(".attachment-button-form");t&&t._node.reset(),e.uploadFormDirty=!1}function X(e){e?this.neoFire("composeEvent",{action:"showSendBtn"}):this.neoFire("composeEvent",{action:"hideSendBtn"})}function V(){var e=this,t=e.rteFormatter,n=e.handles;t.bindUI(),n.push(t.on("formatter:action",function(t){e._setDirty(),l.enabled("saveFontSelection")&&e._setComposePreference(t.act,t.val)})),n.push(e.after("isRichTextChanged",function(){e.editor.set("isRich",!NeoConfig.low_bandwidth&&e.isRichText),e.rteFormatter&&e.rteFormatter._switchEditMode(e.isRichText)})),e._intlBindUIRTE()}function $(){var t=this,n=l.enabled("spellCheck"),r,i,s,o;r=t.rteFormatter=new e.mail.ui.RTEFormatter({isBidi:NeoConfig.bidi,isSpellCheckEnabled:n,editor:t.editor,globalPathImage:t.formatters.global_path_img()}),r.renderUI(t.baseNode.one(".rte-well-container")),r._switchEditMode(t._isRTEActive()),t._bindWellUIFresh(),i=t.richFontInfo.fontFamily,s=t.richFontInfo.fontSize,s&&(o=parseInt(s.replace("pt",""),10),o=e.Array.indexOf(E,o),o>=0&&(r.selectedFSIndex=o+1)),r.selectedFNIndex=i,n&&t._initializeSpellCheck(),t._bindTextSwitchFresh()}function J(){var t=this,n,r,i=t.getRTEDocNode(),s=t.compArea.one(".compose-quoted-text"),o=i.one(".yahoo_quoted"),u=t.quotedTextBody,a;i.append(t.quotedTextBody),t.quotedTextBody="",m._insertEmptyLineBeforeQuotedText(i),o&&o.setStyle("display","block"),n=f.getVal(t.draft.origin,"yqtdPrefix");if(n)for(r=0;r<n.length;r++)a=t.getRTEDocNode().one("."+n[r]+"yahoo_quoted"),a&&a.setStyle("display","block");s&&s.remove(),e.fire("processedEditorHtml",{processHtml:function(t){var r=e.Node.create("<div>"+t+u+"</div>"),i=m._expandQuotedText(r,n);return i&&i.getHTML()},rteNode:i}),e.fire("recalculateScrollToRepositionSend"),t.resizeRTE()}function K(){var e=this;e.hasRTEFormatter&&e.initializeRTEFormatter(),e.baseNode.one(".attachments-pane").addClass(y)}function Q(t){var n=this,r,s;if(t){n.parent=t,r=d(v._shared_module_compose_fresh_conv.base,n.draft,n.formatters,null,strings,v),t.append(r),n.baseNode=t.one(".compose"),n.get("isQuickReply")||(n.baseNode.addClass("full-compose"),n.baseNode.addClass("content")),n.compArea=n.baseNode.one("div.compose-message").one("div.inner"),n.loadingArea=n.compArea.one("div.msg-loadingpane"),n.footer=n.baseNode.one(".footer-separator");var o=i.getDefaultFontInfo(!n._isRTEActive());n.richFontInfo.fontFamily=o.fontFamily,n.richFontInfo.fontSize=o.fontSize,s=n.baseNode.one("div.cm-plaintext"),s&&s.get("parentNode").removeChild(s),e.UA.gecko&&n.compArea.ancestor("td").setStyle("height","0"),n.header.enableHeader(!1),n._renderWellsFresh(),n.bindUI(),n.header.render(),n.header.bind(),n.composeViewRendered=!0,n.editor.render(n.baseNode);var u=n.baseNode.one(".attachments-well");G(this,u)}}function G(t,n){t.tray=new e.Tray({model:t.draft,view:t,container:n,filesView:n.one(".file-attach"),thumbnailsView:n
.one(".thumbnails-attach")}),t.tray.on("attachmentRemoved",function(){t._setDirty(),t.save()}),t.tray.render()}function Y(){var e=this,t=e.footer.getY();e.footer.setStyles({position:"fixed",top:t+"px"})}function Z(){var t=this,n=e.mail.Tabs,r=function(e){return e.type==="author"&&e.view&&e.view.draft&&e.view.draft.csid&&t.draft.csid&&e.view.draft.csid===t.draft.csid},i;t.isDraft&&NeoConfig.tabs&&NeoConfig.previewPanePref>0&&(i=n.getTab(r),i&&i.isRemovable&&i!==n.getActiveTab()&&i.set("close",1))}function et(){NeoConfig.tabs&&!NeoConfig.hasConvView?(this.resizeRTEDelayTimer&&this.resizeRTEDelayTimer.cancel(),this.resizeRTEDelayTimer=e.later(300,this,this.doResizeRTE)):this.doResizeRTE()}function tt(){var t=this,n,r,i=7,s=0,o,u=0,a,f,h=l.enabled("fullheightcomposeOnThreshold"),p=h?500:300,d=c.value("fullheightcomposeThreshold",953),v=t.baseNode.one("div.attachments-well"),m=0,g;u=v?v.getStyle("height"):0,u=u==="auto"?0:parseInt(u,10),o=e.one("body").get("offsetHeight");if(t.get("close"))return;if(!t.get("isQuickReply")){n=parseInt(t.compArea.getY(),10),r=parseInt(t.compArea.getComputedStyle("paddingBottom"),10),o=e.one("body").get("offsetHeight"),a=o-n-L-r,A?(g=a,m=3,d=0):(g=a-.2*o,g>p&&(g=p));if(l.enabled("fullheightcompose")||h&&o<=d)g=a-i,NeoConfig.isWinApp&&(g-=30),s=20,t.baseNode.one("#to").addClass("fullheight-input"),t.baseNode.one("#cc").addClass("fullheight-input"),t.baseNode.one("#bcc").addClass("fullheight-input");t.compArea.setStyles({maxHeight:a+"px",minHeight:g+"px"}),f=g-u-s-m>0?g-u-s-m:0,t.editor.rteArea.setStyles({minHeight:f+"px"})}else if(!NeoConfig.smartscroll){parseInt(t.baseNode.getStyle("height"),10)>t.maxHeight&&(t.maxHeightFn&&(t.maxHeight=t.maxHeightFn()),t.compArea.setStyles({maxHeight:t.maxHeight-parseInt(t.header.hdr.getStyle("height"),10)-L+"px"}));var y=t.baseNode.get("parentNode").get("offsetTop")-t.containerNode.get("scrollTop")+parseInt(t.baseNode.getStyle("height"),10)+6-t.containerNode.get("offsetHeight");y>0&&t.containerNode.set("scrollTop",t.containerNode.get("scrollTop")+y)}}function nt(){function i(i){var s=i.params,o,u,a,f,l={format:1};if(!l.hasOwnProperty(s.tab))return;if(!t.baseNode)return;s.tooltip=s.tooltip||"";if(s.tab!=="format")return;u=s.name||"Stationery",a='<span class="btn menu" data-app="'+i.appInstance+'">'+'<a class="icon '+u+'" href="#" title="'+s.tooltip+'">'+'<i role="presentation" class="plaintext">'+s.label+"</i></a></span>",f=n(a);try{t.baseNode.one("."+s.tab+"-pane").one(".om-buttons").append(f)}catch(c){}o=e.stamp(f),r.push(f.on("click",function(e){e.preventDefault(),i.handler(o,t)})),r.push(e.on("om:click_btn",function(e){if(!e.app||!e.app.instance||!e.tab)return;i.appInstance===e.app.instance&&i.handler(o,t)}))}var t=this,r=t.handles;e.each(u,i),r.push(e.on("om:compose_add_btn",function(){i(u[u.length-1])}))}function rt(){return l.enabled("autocomposeValentines")&&NeoConfig.mrd&&NeoConfig.mrd.param&&NeoConfig.mrd.param.autocompose}function it(){this.editor.set("isRich",!0),this.rteFormatter._switchEditMode(!0),this.isRichText=!0}function st(){var t=this;if(!f.features.enabled("seasonalPromotion"))return;e.use("mail-ui-onboarding-seasonal-promotion","mail-ui-onboarding",function(e){e.mail.ui.onboarding.seasonalPromotion.init(t)})}function ot(){var t=this,n=t.draft,r,s,o,u,a,c,d,v,m,g,y=function(){e.fire("FullCompose:fullComposeReady",{rte:t.editor,rteActive:t._isRTEActive(),context:t}),e.fire("compose-stat:fullComposeReady"),t.controller.parent.hasClass("quickReply")||t.seasonalPromotion()};t._bindDraft(),t._isOrigin()?(f.perf.startMeasurement("draft_loading"),t.slowOriginReqTimer=setTimeout(function(){t._handleSlowOriginRequest()},x),t.loadingTimer=setTimeout(function(){t._displayLoading()},S),t.editor.hideArea(),i.fetchOrigin(n,t.isDraft,t._getTextMode(),t.stopwatch,function(){var n;Bt(t.quotedTextBody)&&t._expandQuotedReply(),t.set("draftLoaded",!0),t.fire("draftLoaded"),n=f.perf.endMeasurement("draft_loading"),n&&e.fire("stat:feature_latency",{feature_group:"DRAFT_LOADING",value:n}),y()}),t.isDraft?t.hasHardDraft=!0:(u=n.origin,e.Lang.later(90,null,function(){t.neoFire("composeEvent",{action:"darlaEvent",type:"compose_"+u.action})})),r=n.origin.oMsg,r&&r.header?(s=r.header.to,o=r.header.cc,g=r.header.xapparentlyto,a=r.header.from):(s=[],o=[],g=null,a=r&&r.from),t.header.setReplyFrom(s,o,g),a&&t.isDraft&&e.later(10,t,function(){t.header._setFromMenu(a)})):(t.header.setHeader(n),c=n.cc&&n.cc.length>0||n.bcc&&n.bcc.length>0,t._allowEditing(n.body.html,c),!c&&l.enabled("stickyCcBcc",!1)&&(p?(v=h.getSync("attributes.web.composeShowCc",!1),m=h.getSync("attributes.web.composeShowBcc",!1),d=v&&m?!0:!1):d=k.get("neo.pref.compose.showCcBcc")==="1"?!0:!1,t.header._bccSwitch(d,!1,"cc"),t.header._bccSwitch(d,!1,"bcc")),t.dirty=t.controller.isPopulated()?!0:!1,e.later(0,t,Pt,[n.to&&n.to.length>0?"body":"to"]),t.neoFire("composeEvent",{action:"darlaEvent",type:"compose_new"}),y()),t._initOpenMailButtons(),e.fire("load:autosuggest",{rte:t.editor,rteActive:t._isRTEActive(),context:t}),e.fire("read-stat:draftRendered"),!NeoConfig.smartscroll&&t.get("isQuickReply")&&t.compArea.setStyles({minHeight:"150px",maxHeight:t.maxHeight-parseInt(t.header.hdr.getStyle("height"),10)-L-6+"px"}),l.enabled("autoCloseDraftTab")&&t._handleDraftTabAutoClose(),rt()&&(t.temporarySwitchToRichTextMode(),t.rteFormatter.disableEditModeSwitching()),t.resizeRTE()}function ut(){function i(){var t;if(r[e.rteTabIndex]==="#switchtext-plain"||r[e.rteTabIndex]==="#switchtext-rich")return n.one(r[e.rteTabIndex]);if(!e._isRTEActive()&&r[e.rteTabIndex]===".attach-btn-menu a")return e.rteTabIndex=r.length-1,n.one(r[e.rteTabIndex]);do t=n.one(r[++e.rteTabIndex]);while(!t||t.ancestor().hasClass(y)||t.ancestor().getStyle("display")==="none");return t}function s(){var t;if(e.rteTabIndex===0)return n.one(r[e.rteTabIndex]);if(!e._isRTEActive()&&r[e.rteTabIndex]==="#switchtext-plain")return e.rteTabIndex=1,n.one(r[e.rteTabIndex]);do t=n.one(r[--e.rteTabIndex]);while(!t||t.ancestor().hasClass
(y)||t.ancestor().getStyle("display")==="none");return t}function o(t){var n,r,o=e.baseNode.one(".attachments-pane");switch(t.keyCode){case 9:t.shiftKey||(n=e.baseNode.one(".attachments-well"),n&&!n.hasClass(y)?(r=n.one('li.attachmentVisible span.left a[tabIndex="0"]'),r||(r=n.one("li.attachmentVisible span.left a"),r&&r.set("tabIndex",0))):(t.target.blur(),e.setFocus("body"),t.halt()));break;case 13:case 32:t.target!==o?t.target._node.click():t.target.one("input")&&t.target.one("input")._node.click();break;case 37:t.target&&t.target.set("tabIndex",-1),r=s(),r&&r.set("tabIndex",0),r.focus();break;case 39:t.target&&t.target.set("tabIndex",-1),r=i(),r&&r.set("tabIndex",0),r.focus();break;default:}}var e=this,t=e.handles,n=e.baseNode.one("div.rte-well-container"),r=[".attachments-pane","#btn-fontname","#btn-fontsize","span.bold","span.italic","span.underline","#btn-forecolor","#btn-backcolor","#btn-insertunordered","#btn-insertnumbered","#btn-outdent","#btn-indent","span.align-l","span.align-c","span.align-r","#links","#emoticon","span.Stationery","#spellCheck","#btn-spell-langs","#switchtext-plain","#switchtext-rich"];t.push(n.delegate("keydown",o,'div.attachments-pane, span[role="button"]'))}function at(){var e=window.getSelection().getRangeAt(0),t=e.cloneRange(),n=this.getRTEDocNode().getDOMNode(),r=document.createRange();return r.selectNodeContents(n),t.selectNodeContents(n),t.setEnd(e.endContainer,e.endOffset),t.toString&&r.toString&&t.toString().trim()===r.toString().trim()}function ft(t){var n=this,r=t.keyCode,i=(t.ctrlKey||t.metaKey)&&!t.altKey&&!t.shiftKey,s=e.UA.os,o=t.ctrlKey&&(s==="linux"||s==="windows"||s==="win")||t.metaKey&&(s==="macintosh"||s==="mac"),u,a;switch(r){case 27:a=e&&e.one(".btn-close-msg"),a&&a._node.click();break;case 40:if(n._isAtEndOfRTE()){var f=n.baseNode.one(".compose-quoted-text:not(.hidden) .qtd-expansion-text"),l=n.baseNode.one(".attachments-well:not(.hidden)");f?f.focus():l&&l.focus()}break;case 85:o&&t.shiftKey&&!e.UA.ie&&(!e.UA.gecko||e.UA.gecko>1.92)&&(u=n.baseNode.one(".attachments-pane input"),u._node.click(),t.halt());break;case 13:if(o&&!t.altKey){var c={spid:"sent",append:{t1:"cmpsTb",actn:"keybrd",cmpsType:n.get("isQuickReply")?"QR":"fullCmps"},action:"tlbr_send"};return n.lastSendState&&(c.append.ltxt=n.lastSendState),e.fire("mt:click",c),n.send(),t.frameEvent&&t.frameEvent.halt(),t.halt(),!0}if(t.target.get("nodeName")==="A")return t.target.simulate("click"),!0;break;case 65:i&&n._expandQuotedReply();break;case 83:if(i)return n.isAutoSave=!1,n.save(),t.frameEvent&&t.frameEvent.halt(),t.halt(),!0;break;case 88:if((t.ctrlKey||t.metaKey)&&t.shiftKey&&!t.altKey)return t.frameEvent.halt(),NeoConfig.bidi&&(n.editor.invokeCommand("swapdir",null),n.fire("formatter:action",{act:"swapdir",val:null})),!0;break;case 89:if((t.ctrlKey||t.metaKey)&&t.shiftKey&&!t.altKey)return t.halt(),n.allowEdit&&n._cmdTextSwitch(),!0;break;case 219:case 221:e.fire("tabview:handleKeyDown",t);break;default:}return t.frameEvent&&(t.frameEvent.stopPropagation(),t.shiftKey&&r===9),i||a?!0:!1}function lt(e){var t=this,n=t.baseNode.one("div.rte-well-container"),r,i=n.one(".attachments-well");t.rteTabIndex=0,i&&!i.hasClass(y)?(i.all("li.attachmentVisible span.left a").each(function(e){!r&&e.get("tabIndex")===0&&(r=e)}),r||(r=i.one("li.attachmentVisible span.left a"),r&&r.set("tabIndex",0))):(r=n.one(".attachments-pane"),r&&r.set("tabIndex",0)),r&&t.setFocus(r),e.frameEvent.halt()}function ct(t){var n=e.Node.getDOMNode(t);return n!==null?n.tagName.toUpperCase()==="DIV":!1}function ht(){var t=this,n=this.draft.getAccountId(),r=g.getSentFid(n),i={msg:{mid:t.draft.mid},fid:r},s,o,u,a;s=function(t,n){n==="view"?e.fire("openMessage",i):n==="send-another"&&(e.fire("newMessage",{flavor:"autocompose",cbfn:function(){e.fire("util:ymstats",{name:"compose_valentine_autocompose",tags:{source:"sendMore"}})}}),e.fire("mt:click",{action:"autocompose_sendmore"}))},e.use("common-ui-notification-v2",function(e){o=e.common.ui.NotificationV2,u=t.lastNotification,a={type:"info",cbk:s,duration:4e3,speed:"fast"},f.features.enabled("autocomposeValentines")&&t.isValentineAutocompose?(e.use("_shared_module_compose_autocompose_notification",function(e){var t=e.ui.Templates._shared_module_compose_autocompose_notification;o.notify(f.substitute(t.base,0,0,0,strings),{type:"error",cbk:s,duration:1e4,speed:"fast",close:!0})}),e.fire("util:ymstats",{name:"autocompose_sent"}),e.fire("mt:click",{action:"autocompose_send"}),C&&u&&(t.lastNotification=undefined)):k.get("neo.pref.desktopNotification")!=="granted"&&l.enabled("notificationsOnSentOnboarding")&&!f.isCalloutShown("notificationsOnSent")&&window.Notification&&window.Notification.permission!=="denied"?e.use("mail-ui-onboarding-notifications-on-sent",function(e){e.mail.ui.onboarding.notificationsOnSent.init(s),o.clearAll(),t.lastNotification=undefined,u=undefined}):C&&u?(o.update(strings.str_comp_msg_sent,a),t.lastNotification=undefined):o.notify(strings.str_comp_msg_sent,a)})}function pt(){var e=this,t;e.lastSaveType=e.isAutoSave?1:0,e.resetSaveTimer(),e.isAutoSave||(e.hasHardDraft=!0),e.isAutoSave=!1,e.dirty=!1,t=f.dateFormatter(new Date,strings.str_tog_dateformat_rsstime_l10n),t=d(strings.str_comp_saved,0,0,0,{saved_time:t}),e.updateSaveStatusText(t),e.fire("compose:saveSuccess")}function dt(t){var n=this,r,i;n.lastSaveType=-1,n.neoFire("composeEvent",{action:"saveComplete",saveSuccess:!1}),!n.isAutoSave&&!t.notificationDisplayed&&(i=strings.str_error_MessageSaveFailed,e.common.ui.NotificationV2.notify(i,{type:"error",close:!0,speed:"show-medium"})),n.isAutoSave=!1,n._setDirty(),r=strings.str_comp_saveasdraftfail,n.updateSaveStatusText(r),n.fire("compose:saveFail")}function vt(e){var t=this;t.baseNode.one(".save-draft-msg")&&t.baseNode.one(".save-draft-msg").removeClass("hidden").set("innerHTML",e)}function mt(t){var n=this,r=strings.str_tae_unabletosendmsg,i=e.common.ui.NotificationV2;n.showComposeShim(!1),t.notificationDisplayed||(t.code==="EP-4010"?(i.clearAll
(),n.notifySendAbuse()):i.notify(r,{type:"error",close:!0,speed:"show-medium"}))}function gt(){var e=this;e.sendValidationHandlers.handleSpame()}function yt(){var t=this.baseNode.one("#bcc_add_contacts"),n=15e3;e.mail.ui.Onboarding.registerDefaultOnboarding({name:"onboard_bcc_tooltip",node:t,hdText:strings.str_comp_bcc_recipients_added_title,bdText:strings.str_comp_bcc_recipients_added_body,pointer:"bottom-left",offset:[-15,-105]}),e.fire("initCallout:onboard_bcc_tooltip"),setTimeout(function(){e.fire("closeCallout:onboard_bcc_tooltip")},n),e.one("document").once("click",function(){e.mail.ui.Onboarding.closeDefaultOnboarding("onboard_bcc_tooltip")})}function bt(e){var t=this;t.baseNode.one(".composeshim")[e?"removeClass":"addClass"]("hidden"),e?t.baseNode.addClass("sending"):t.baseNode.removeClass("sending"),t.neoFire("composeEvent",{action:"updateTitle",sending:e})}function wt(){var e=this,t=e.draft.attachments,n=e.handles;n.push(t.on("added",function(){e._setDirty(),e.resizeRTE()})),n.push(t.on("deleted",function(){e._setDirty(),setTimeout(function(){e.resizeRTE()},50)})),n.push(t.on("updated",function(t){e.resizeRTE();if(!t.isUploadDone())return;e._setDirty()}))}function Et(e){var t=this;e.reply?t.replyContentChangeAfter(e):e.uiUpdate||(t.draft.body.html?t.editor.setContent(t.draft.body.html,!e.textConvert):t.editor.setContent(t.draft.body.html))}function St(e){var t=this,n=t.draft,r;if(!e.reply)return;t.header.setHeader(n),r=n.subject,t.neoFire("composeEvent",{action:"replyheaderLoad",subject:r})}function xt(e){var t=this,n,r=t.draft;t._setTextMode(e.isRichText),t._setClean(),n=r.cc&&r.cc.length>0||r.bcc&&r.bcc.length>0,t._allowEditing(t.draft.body.html,n),t.header.enableSwitchReplyButton(),t.get("noFocus")||t.setFocus(r.to&&r.to.length>0?"body":"to")}function Tt(){var t=this;t.rtSwitch||(t.rtSwitch=t.baseNode.all("span.switchtext")),t.rtSwitch.each(function(n){t.handles.push(n.on("click",function(n){e.fire("mt:click",{action:"cmps_stchpt",append:{t1:"cmpsTb",ltxt:t._isRTEActive()?"plaintext":"richtext"}}),n.halt(!1),t.allowEdit&&t._cmdTextSwitch()}))})}function Nt(){function n(){e.editor.fire("beforeModeSwitch"),e.draft.setBody(null,e.getContent()),e._setDirty()}function r(t,n){e._setTextMode(!1),e.draft.setBody(null,n),e.draft.notifyBodyChanged({textConvert:!0})}function i(){e._setTextMode(!0)}function s(){n(),e._expandQuotedReply(),e._removeSignatureTweet(),r(e.draft,e.editor.getContentAsPlainText()),e.resizeRTE(),e.setFocus("body"),e.editor.fire("afterModeSwitch")}var e=this,t;e._isRTEActive()?e.editor.hasContent()?(t=!0,e.confirm(strings.str_rte_plaintext,strings.str_comp_conf_plainText,s)):s():(n(),i(e.draft),e.editor.fire("afterModeSwitch")),!t&&e.setFocus("body")}function Ct(){var e=this,t=e.signatureTweetView;t&&t.removeTweet(e.compArea)}function kt(){return!NeoConfig.low_bandwidth&&this._getTextMode()}function Lt(){return this.spellCheckView&&this._isRTEActive()}function At(e){return this.baseNode.one(".cm-"+e+" ul li")}function Ot(){return this.editor.getContent()+this.quotedTextBody}function Mt(){var e=this.editor.getContentNodeClone();return e.append(this.quotedTextBody),e}function _t(){return this.editor.richFontInfo}function Dt(){return this.editor.getRTE()}function Pt(t,n,r){var i=this,s=!0,o,u=i.editor.getRTE();if(typeof t=="string"){o=i.baseNode.one(".compose-header");if(o)switch(t){case"to":case"cc":case"bcc":case"subject":o=i.baseNode.one(".compose-header"),t=o.one(".cm-"+t+"-field");break;case"body":t=u,s=r&&e.UA.os==="macintosh"&&e.UA.chrome>=11?0:i.editor.get("ready")}}s&&(t===u?i.editor.setFocus(n):t&&t.focus()),t&&i._registerFocus(t)}function Ht(e,t){return'<div class="'+t+'">'+e+"</div>"}function Bt(t){return!e.Lang.isString(t)||t.length===0||NeoConfig.hasConvView?!1:t.length<N}function jt(e,t){var n=this;n.header.allowEditing(e,t),n.composeTictacApi.render(n.baseNode.one(".attachments-pane")),n.allowEdit=!0,n.fire("renderComplete")}function Ft(e,t){var n=this,r,i,s,o,u=[],a,l,c="yahoo_quoted";n._clearOriginTimers(),n.header.enableHeader(!0),n.editor.showArea(),n.loadingArea.addClass(y);if(!e){n._setFlagsforAllowEditing(e,t);return}if(!n._isOrigin()){n.editor.setContent(e,!n.isDraft),n._setFlagsforAllowEditing(e,t);return}n.editor.setContent(e,!n.isDraft);if(n.draft.origin.action!=="forward"){if(n.isDraft){r=f.getVal(n.draft.origin,"yqtdPrefix");for(i=0;i<r.length;i++)a="."+r[i]+c,s=n.getRTEDocNode().one(a),s&&(l=Ht(s.getContent(),a),u.push(l),s.remove());n.quotedTextBody=u.join("")}else s=n.getRTEDocNode().one("."+c);s&&n.baseNode.one(".compose-quoted-text")&&n.baseNode.one(".compose-quoted-text").removeClass("hidden"),o=n.getRTEDocNode().one("."+c),o&&(n.quotedTextBody=Ht(o.getContent(),c),o.remove())}n._setFlagsforAllowEditing(e,t)}function It(e,t){var n=null;switch(e){case"fontname":n="userUIPref.composeFontFamily",t+="|1";break;case"fontsize":n="userUIPref.composeFontSize",t=parseInt(t,10),t=E[--t];break;default:}n&&t&&ln(n,t)}function qt(){var t=this,n;t._formatPane||(t._formatPane=t.baseNode.one(".format-pane")),t.spellCheckBtn=t._formatPane.one('[data-action="spellcheck"]'),t.spellCheckMenuBtn=t.spellCheckBtn.next(),n=e.one("#menu-spell-langs"),t.handles.push(t.spellCheckBtn.on("click",function(e){e.preventDefault(),t._isSpellCheckActive()?t.spellCheckView.destroy():t._doSpellCheck(n?n.one(".active").get("text"):null)}),t.spellCheckMenuBtn.on("click",function(e){e.preventDefault(),t._openSpellCheckMenu(e)}),t.on("SpellCheck:destroy",function(){t.spellCheckView=null,t.spellCorrections=null,t.spellCheckBtn.removeClass("active")}))}function Rt(e){var t=this;t.closeSrc="cancelBtn",e&&(t.dirty="ForceClose"),t.canClose()&&t.neoFire("composeEvent",{action:"closeAction"})}function Ut(t){var n=!0,r={},i="",s=this;switch(t){case"send":r.spid="sent",s.lastSendState&&(i=s.lastSendState),s.send();break;case"savedraft":s.blockSave=!0,s._invokeSaveDraft();break;case"cancelcompose":n=!1,s.cancelCompose();break;case"delete":s.doDiscardDraft(!1),s.dirty="ForceClose",s.
neoFire("composeEvent",{action:"closeAction",forceClose:!0})}n&&(r.append={t1:"cmpsTb",cmpsType:s.get("isQuickReply")?"QR":"fullCmps"},r.action="tlbr_"+t,i&&(r.append.ltxt=i),e.fire("mt:click",r))}function zt(e){var t=this,n,r=t.baseNode.one(".attachment-button-attach");e?n=t.draft.after("stateChanged",function(e){if(e&&e.next&&e.next!=="saved")return;n.detach(),t.neoFire("composeEvent",{action:"closeAction",forceClose:!0}),r.fire("compose:close")}):(r.fire("compose:close"),t.neoFire("composeEvent",{action:"closeAction",forceClose:!0}))}function Wt(){}function Xt(){var t=this;if(t._isSpellCheckActive())return;t.spellCheckView===null&&(l.enabled("spellCheck")?(t.spellCorrections=new e.mail.Model.SpellCorrections,t.spellCheckView=new r.ui.SpellCheckView(t,t.draft,t.spellCorrections),t.spellCheckBtn.addClass("active")):t.spellCheckView=!1)}function Vt(t){var n=this;e.use("mail-ui-composeview-spellcheck-v3",function(){n._activateSpellCheck(),n._isSpellCheckActive()&&(n.spellCheckView.doSpellCheck(t),n.setFocus("body"),n.neoFire("composeEvent",{action:"darlaEvent",type:"spell_chk"}))})}function $t(t){var n=this;e.use("mail-ui-composeview-spellcheck-v3",function(){n._activateSpellCheck(),n._isSpellCheckActive()&&n.spellCheckView.showLangMenu(t)})}function Jt(){return this.editor.getRTE().getInstance()}function Kt(){return this.editor.getDoc()}function Qt(e){var t=this,n,i=r.model.DataStore.Messages.getPermMidPart;if(e.flavor!==t.flavor)return!1;if(e&&e.oMsg&&t.getDraftMID())return i(t.getDraftMID())===i(e.oMsg.mid);if(!t._isOrigin())if(!e||!e.oMsg)return!0;return e&&e.oMsg?(n=t.draft.get.origin,e.action===n.action&&e.fid===n.fid&&e.oMsg.mid===n.oMsg.mid&&e.forwardAsAttachment===n.forwardAsAttachment):!1}function Gt(){var e=this,t=e.draft.origin;return t.action&&t.fid&&t.oMsg}function Yt(){var e=this,t;t=e.draft.origin,e._clearOriginTimers(),e._writeLoadingHtml(t.errInfo==="ok"?"pop":"slow")}function Zt(){var e=this;e._writeLoadingHtml("start")}function en(e,t){this.editor.setContent(e,t)}function tn(e){var t=this;t.loadingArea.hasChildNodes()&&t.loadingArea.get("children").remove().destroy(!0),t.loadingArea.appendChild(n(d(w.base,null,t.loadFormatters,e,strings,v)))}function nn(){var e=this;e.slowOriginReqTimer&&clearTimeout(e.slowOriginReqTimer),e.loadingTimer&&clearTimeout(e.loadingTimer)}function rn(e){var t=this,n,r,i=t.baseNode.one(".save-draft-msg");n=function(){return e?strings.str_comp_saving_draft:t.lastSaveType===-1?d(strings.str_comp_saveasdraftfail,0,0,0,{autosave_time:t.lastSave}):t.lastSave?t.lastSaveType===1?d(strings.str_comp_autosave,0,0,0,{autosave_time:t.lastSave}):d(strings.str_comp_saved,0,0,0,{saved_time:t.lastSave}):""},r=n(),i.removeClass("hidden"),i.set("innerHTML",r)}function sn(t){var n=this,r,i;n.allowSend?e.use("common-ui-dialog-helper",function(){n.allowSend=!1,r={hd:t?strings.str_rte_attachments_alert_virus_title:strings.str_comp_dialogtitle_invalidSendAttachments,bd:t?strings.str_rte_attachments_alert_virus:strings.str_comp_dialogbody_invalidSendAttachments,suppressRestoreFocus:!0},i=function(){n.allowSend=!0,n._restoreFocus()},a.ui.DialogHelper.alert(r,{ok:{handler:i},cancel:{handler:i}})}):n._restoreFocus()}function on(e){var t=e||this.getSaveNotification(),n;if(!t)return;n=this.baseNode&&this.baseNode.one(".bottomToolbar"),n&&n.one(".save-draft-msg").setContent(t)}function un(){var e=this;return e.lastSaveType===-1?d(strings.str_comp_saveasdraftfail,0,0,0,{autosave_time:e.lastSave}):e.lastSave&&e.lastSaveType===1?d(strings.str_comp_saved_fresh,0,0,0,{saved_time:e.lastSave}):""}function an(){var t=this,n;return n={bidi:NeoConfig.bidi,isRTL:NeoConfig.isRTL,isRich:t._isRTEActive(),spellCheck:l.enabled("spellCheck"),getDefaultFontInfo:i.getDefaultFontInfo,convertToPlain:e.bind(e.mail.Controller.TextProcessor.convertToPlain,e.mail.Controller.TextProcessor),smartscroll:NeoConfig.smartscroll&&t.get("isQuickReply")},n}function fn(){return this.draft.to.length>0||this.draft.cc.length>0||this.draft.bcc.length>0||this.draft.subject.trim()!==""||this.draft.body.html!==""||this.draft.body.text!==""}function ln(t,n){e.common.persist.UserData.set(t,n),setTimeout(function(){e.common.persist.UserData.saveOne(t)},10)}function cn(e){this.editor.getRTE().fire("cardify",e.cardInfo,e.type)}function hn(e){var t=strings.str_comp_attachment_size_exceeded,n=d(t,{num:e},null,null,strings);a.ui.DialogHelper.alert({hd:strings.str_comp_attachment_size_limit,bd:n,suppressRestoreFocus:!0},{ok:{handler:function(){}}})}function pn(e){var t=this,n,r;if(!l.enabled("richcomposeCloudStorage")){t.showAttachmentSizeDialogForNonCloudUsers(e);return}n=strings.str_comp_large_attachments_cloud_message,r=d(n,{num:e},null,null,strings),a.ui.DialogHelper.confirm({hd:strings.str_comp_large_attachments_from_cloud,bd:r,suppressRestoreFocus:!0},{ok:{handler:function(){t.openComposeAssist()}},cancel:{handler:function(){}}})}function dn(t){var n=strings.str_comp_attachment_size_zero,r=t.map(function(t){return e.Escape.html(t.name)}),i="<strong>"+r.join(", ")+"</strong>",s=d(n,{filenames:i});a.ui.DialogHelper.alert({hd:strings.str_comp_attachment_size_limit,bd:s,suppressRestoreFocus:!0},{ok:{handler:function(){}}})}function vn(){a.ui.DialogHelper.alert({hd:strings.str_comp_attach_error,bd:strings.str_comp_attach_num_files_exceeded,suppressRestoreFocus:!0},{ok:{handler:function(){}},cancel:{handler:function(){}}})}function mn(){var e=this,t,n,r=e.getRichComposeView(),i=function(){e.fire("composeAssist:submitQuery",{query:"",mime:"docs"})},s=r&&!r.isRichComposeShown;s&&(e.fire("showComposeAssist",{clickSource:"attachFromCompose"}),i(),n=e.on("composeAssist:rootMounted",function(){i(),clearTimeout(t),n.detach()}),t=setTimeout(function(){n.detach()},1e4))}function gn(e){this._richComposeView=e}function yn(){return this._richComposeView}var t=e.Lang.trim,n=e.Node.create,r=e.mail,i=r.Controller.ReplyProcessor,s=r.Views.ComposeTictacApi,o=e.mail.rte.fileUtil,u=[],a=e.common,f=a.Utils,l=e.common.Utils.features,c=e.common
.Utils.settings,h=r.controller.v3.settings.userSettings,p=l.enabled("isMetaDataMigrated")||NeoConfig.forceToV3UserSetting,d=f.substitute,v=e.ui.Templates,m=e.mail.Controller.HtmlProcessor,g=r.ui.FolderUtils,y="hidden",b="focus",w=v._shared_module_compose_loading,E=[10,13,16,0,24,32,48],S=2e3,x=7e3,T=500,N=f.settings.value("rplyTxtCollapseTrigger",256e3),C=l.enabled("instantCloseOnSend"),k=e.mail.persist.MetaData,L=67,A=l.enabled("attachMenuInOldToolbar",!1),O=function(t,n,i,o,u){var a=this,f;O.superclass.constructor.call(a,t,n,o,u),a.spellCheckView=null,a.spellCheckLang=null,a.wordsToIgnore=[],a.slowOriginReqTimer=null,a.keepHdrFocus=!1,a.formatShortcutTimer=null,a.mouseFocusEvent=!1,a.composeViewRendered=!1,a.rteTabIndex=0,a.type="fullCompose",a.handles=[],a.lastSendState=null,a.closeSrc="closeBtn",a.containerNode=u.containerNode,a.hasRTEFormatter=!0,a.flavor="compose",a.addAttrs({keydownHandler:{value:null},isQuickReply:{value:!1},noFocus:{value:!1}},u),u.maxHeightFn&&(a.maxHeightFn=u.maxHeightFn,a.maxHeight=a.maxHeightFn()),f=a._getEditorConfig(),f.composeView=a,a.editor=new r.RTEView(f),a.composeTictacApi=new s(a.editor),a.addChild(a.editor),a.loadFormatters={start:function(e,t){return t==="start"?d(w.start,null,null,null,strings):""},slow:function(e,t){return t==="slow"?d(w.slow,null,null,null,strings):""},error:function(e,t){return t==="err"?d(w.error,null,null,null,strings):""},populate:function(e,t){return t==="pop"?d(w.populate,null,null,null,strings):""}},NeoConfig.bidi&&e.use("comms-intl-bidihighlight"),a.neoEvent("composeEvent",{emitFacade:!0,broadcast:1}),this.neoFire("composeEvent",{action:"addChild",subview:this}),this.sendValidationHandlers=new e.mail.Views.SendValidationErrorHandlers(this),a.quotedTextBody=""};e.extend(O,e.mail.Views.MailCompose),O.prototype._bindDraft=function(){var e=this,t=e.draft,n;e.handles||(e.handles=[]),n=e.handles,n.push(t.on("stateChanged",function(t){t.prev==="savingAndSending"||t.prev==="sending"||t.prev==="sent"||t.prev==="captchaing"&&t.next==="unsaved"?t.next==="final"?e.sendSuccess():t.err&&(e.sendFailure(t.err),C&&e.controller.cancelHideCompose()):(t.next==="saved"||t.next==="saving"||t.next==="unsaved"&&t.err)&&e._updateSaveStatus(t.next,t.err),(t.next==="savingAndSending"||t.next==="sending")&&e.showComposeShim(!0),(t.next==="saved"||t.next==="unsaved")&&e.showComposeShim(!1)})),n.push(t.on("bodyChanged",function(t){e.contentChangeAfter(t)})),n.push(t.on("headerChanged",function(t){e.headerChangeAfter(t)})),n.push(t.on("originChanged",function(){var t=f.getVal(e.draft.origin,"errInfo","ok");t!=="ok"&&(e._clearOriginTimers(),t.code!==a.net.Error.abort&&e._writeLoadingHtml("err"))}))},O.prototype._updateSaveStatus=function(e,t){var n=this;e==="saving"?n.draft.isUploadingInlineImages()?n.updateSaveStatusText(strings.str_comp_inline_image_attach_progress):n.updateSaveStatusText(strings.str_comp_saving_draft):e==="saved"&&n.allowEdit?n.saveSuccess():e==="unsaved"&&t&&n.saveFailure(t)},O.prototype=e.mix(O.prototype,{NAME:"FullCompose",render:Q,bindUI:U,_bindWellUIFresh:V,onKeyDown:ft,onFocus:ct,closeCompose:P,hasContent:fn,getContent:Ot,getContentNodeClone:Mt,getFontInfo:_t,getRTE:Dt,getRTEInstance:Jt,getRTEDocNode:Kt,getFirstNode:At,setFocus:Pt,contentChangeAfter:Et,headerChangeAfter:St,replyContentChangeAfter:xt,updateSaveText:rn,postRender:ot,seasonalPromotion:st,matchOrigin:Qt,setContent:en,addCards:cn,showAttachmentSizeDialog:pn,showAttachmentEmptyDialog:dn,showAttachmentCountDialog:vn,showAttachmentSizeDialogForNonCloudUsers:hn,_initOpenMailButtons:nt,_handleDraftTabAutoClose:Z,_addFocusListenersFresh:ut,_handleShiftTabFresh:lt,_handleSendAction:B,handleComposeAction:Ut,_intlBindUIRTE:Wt,_allowEditing:Ft,_isRTEActive:kt,_isAtEndOfRTE:at,_closeAfterWarning:zt,_renderWellsFresh:K,_bindTextSwitchFresh:Tt,_cmdTextSwitch:Nt,_removeSignatureTweet:Ct,_showDropzone:I,_hideDropzone:q,_moveInputFileNode:R,_alertInvalidAttachments:sn,_initializeSpellCheck:qt,_activateSpellCheck:Xt,_isSpellCheckActive:Lt,_doSpellCheck:Vt,_openSpellCheckMenu:$t,_isOrigin:Gt,_handleSlowOriginRequest:Yt,_displayLoading:Zt,_writeLoadingHtml:tn,_clearOriginTimers:nn,_setComposePreference:It,_bindAttachmentsTT:wt,_warnTooManyRecipients:F,send:j,_showSendBtn:X,_expandQuotedReply:J,temporarySwitchToRichTextMode:it,showComposeView:M,hideComposeView:_,getSubjectInfo:D,initializeRTEFormatter:$,getSaveNotification:un,setSaveNotification:on,cancelCompose:Rt,resizeRTE:et,doResizeRTE:tt,fixBottom:Y,savePref:ln,updateUploadForm:z,notifySendAbuse:gt,_getEditorConfig:an,sendSuccess:ht,saveSuccess:pt,saveFailure:dt,sendFailure:mt,updateSaveStatusText:vt,showComposeShim:bt,showGrowthTooltip:yt,setRichComposeView:gn,getRichComposeView:yn,openComposeAssist:mn,_setFlagsforAllowEditing:jt,ondestroy:H},!0),e.namespace("mail.Views").Compose=O},"1.0.0",{requires:["mail-ui-mailcompose-v3","mail-ui-messagepane-utils","attachments-fresh_css","mail-ui-tray","escape","mail-common-utils-features","node","stylesheet","mail-controller-reply-processor","mail-controller-signature-processor","mail-controller-html-processor","common-persist-user-data","mail-models-draft","contacts-api-utils","contacts-api","filter-contacts","plugin","comms-bidi-textentry","comms-editor-autobidi","comms-intl-bidi","editor-bidi","_shared_module_compose_fresh_conv","_shared_module_toolbar_compose_fresh","_shared_module_compose_loading","_shared_module_offscreen_bin_compose","_shared_module_offscreen_bin_compose_menu_spellcheck","_shared_module_offscreen_bin_compose_modal_cancel_compose","_shared_module_rte_well_content_format_fresh","_shared_module_rte_well_content_emoticons_fresh","_shared_module_rte_well_content_fontnamesize_fresh","_shared_module_compose_template_retrieve","_shared_module_rte_well_content_attachments_fresh","_shared_module_rte_well_tabs_compose_fresh","_shared_module_offscreen_bin_notification_notifications","_shared_module_compose_dropzone","common-ui-toolbar-base","common-ui-menu-helper","_shared_module_offscreen_bin_compose_menu_list"
,"_shared_module_offscreen_bin_compose_menu_text_align","_shared_module_offscreen_bin_compose_menu_indent","mail-views-send-validation-error-handlers","mail-ui-composetictacapi","rte-file-utils","mail-ui-signature-tweet-view","common-utils-performance","mail-ui-folder-utils","mail-persist-meta-data","mail-controller-v3-user-settings"]});
YUI.add("mail-core-net-policies-compose-policy",function(B){var A=function(){this.requests={};};B.mix(A.prototype,{enforce:function(E,D,C){B.Object.each(this.requests,function(F,H,G){E.cancel(H);});},add:function(E,D,C){if(!C.upload){this.requests[E]=C;}}});B.namespace("Mail.Core.Net.Policies").ComposePolicy=A;},"1.0.0",{requires:[]});YUI.add("mail-models-serializers-draft-formdata-serializer",function(e){var t=function(e){this.draft=e};e.mix(t.prototype,{data:function(){var t=new FormData;return t.append("jsonString",this.draft.jsonify()),e.Array.each(this.draft.attachments,function(e){if(e.state()==="pending"){if(e.size()===0){e.setState("failed");return}var n=e.getMultiPartName();e.getSourceType()==="file"&&t.append(n,e.file(),e.getFilename()),e.setState("uploading")}}),t},batchData:function(t){var n=new FormData;return n.append("batchJson",this.draft.batchJsonify(t)),e.Array.each(this.draft.attachments,function(e){if(e.state()==="pending"){if(e.size()===0){e.setState("failed");return}var t=e.getMultiPartName();e.getSourceType()==="file"&&n.append(t,e.file(),e.getFilename()),e.setState("uploading")}}),n}}),e.namespace("Mail.Models.Serializers").DraftFormData=t},"1.0.0",{requires:[]});
YUI.add("mail-models-serializers-draft-payloadpart-serializer",function(B){var A=function(C){this.draft=C;};B.mix(A.prototype,{format:function(){var C={partName:"jsonString",contentType:"application/json",payload:this.draft.jsonifyObj()};return[C];}});B.namespace("Mail.Models.Serializers").DraftPayloadPartSerializer=A;},"1.0.0",{requires:["mail-models-draft"]});YUI.add("mail-core-net-helpers-cascade-request-helper",function(D){var C=D.common.Utils.verify,B="/ws/mail/v2.0/jsonrpc";var A={getV2Endpoint:function(E){C(E,"method not supplied to getV2Endpoint");return(B+"?m="+E);},getV2EndpointBatch:function(){return B;},formatV2Payload:function(F,E){C(F&&E,"method and params not supplied to formatV2Payload");return({method:F,params:E});},formatV2GdmParams:function(G,E,F){F=F||"all";C(G&&E,"fid and mid not supplied to formatV2GdmParams");return{fid:G,enableRetry:true,textToHtml:true,urlDetection:true,emailDetection:true,qtAnnotate:{enable:true},emailComposeUrl:"mailto:%e%",truncateAt:100000,charsetHint:"",annotateOption:{annotateText:"inline"},message:this.formatV2GdmMsgParams(E,F)};},formatV2GetCidsParams:function(F,E){return[{fid:F,mids:[E]}];},formatV2GdmMsgParams:function(E,F){return([{blockImages:F,restrictCSS:true,expandCIDReferences:true,enableWarnings:true,mid:E}]);}};D.namespace("Mail.Core.Net.Helpers").CascadeRequestHelper=A;},"1.0.0",{requires:["common-utils"]});YUI.add("mail-controller-conv-adapter",function(e){function y(t){var n=40,r=e.Lang.trim(t.part[0].text);return r=r.substring(0,n),r.replace(/\n/g," ")}var t=e.mail.model.ConvStore.Conversations,n=e.mail.model.DataStore.Messages,r=e.common.Utils,i=r.getVal,s=e.mail.Controller.Folders,o="Draft",u="Sent",a=e.mail.ui.FolderUtils,f=a.SentFolderType,l=r.features,c=l.enabled("instantCloseOnSend"),h=l.enabled("yodaConversationRead"),p=l.enabled("yodaMessageRead"),d=!1,v=function(e){return h?t.getPermCidPart(e):e},m=function(e){return h||p?n.getPermMidPart(e):e},g={_serializeSendMessageInfo:function(e,t,n){var r=t.sourceFolderInfo&&t.sourceFolderInfo.fid||u;return{mid:m(t.mid),cid:v(e),csid:t.csid,fid:r,snippet:t?t.snippet:y(t),sourceFolderInfo:{fid:r},receivedDate:i(t,"header.sentDate")||Math.floor(Date.now()/1e3),flags:i(t,"flags")||{isRead:1},from:t.from,toEmail:i(t,"header.to")||n.to,subject:i(t,"header.subject")||n.subject}},getInReplyTo:function(e){var t="mimeMsgId";return h&&(t="messageIdRfc822"),i(e.origin,"parentMsg")?i(e.origin,"parentMsg."+t):i(e.origin,"oMsg."+t)},_serializeSaveMessageInfo:function(e,t){var n=t.sourceFolderInfo&&t.sourceFolderInfo.fid||o;return{mid:m(t.mid),cid:v(i(e,"origin.oMsg.cid")),csid:t.csid,header:{from:e.from,to:e.to,cc:e.cc,bcc:e.bcc,subject:e.subject,replyto:e.replyto,receivedDate:Math.floor(Date.now()/1e3)},fid:n,flags:{isRead:1},snippet:t.snippet||y(t),sourceFolderInfo:{fid:n},inReplyToRfc822:this.getInReplyTo(e),inReplyTo:this.getInReplyTo(e)}},_send:function(r){var l={draft:r.draft,draftMid:r.draftMid},h=r.draft,p=r.draftMid,d=i(h,"origin.oMsg.cid"),g=r.msgResponse,y=r.midToCidResponse&&r.midToCidResponse[0]&&r.midToCidResponse[0].cid,b=a.getFolderByIndex(h&&h.folder&&h.folder.id),w=b&&b.folderInfo&&b.folderInfo.fid||o,E,S,x,T,N;try{p&&n.remove(w,p,!0,null,{reason:"sent"}),y&&t.getPermCidPart(y)===t.getPermCidPart(d)?(N=this._serializeSendMessageInfo(y,g,h),c?n.set(N.fid,g,"add",!0,function(t){return e.mail.Controller.Messages._process(t,{fid:N.fid,key:N.mid,msg:g}),t}):e.mail.Controller.Messages._preset({fid:N.fid,msgObj:g}),t.msgAdd(v(d),null,N,l,!0)):g&&(g.mid=m(g.mid||g.id),NeoConfig.imapIn?(T=s.get(g.sourceFolderInfo.fid).acctId,E=e.mail.Controller.ImapIn.getFolderByType(f,T),S=E.folderInfo.fid,x=E.folderInfo.name):(S=u,x=u),n.set(S,g,"add",!1,function(t){return t.sourceFolderInfo&&(t.sourceFolderInfo.name=x,t.sourceFolderInfo.fid=S),e.mail.Controller.Messages._process(t,{fid:S}),t}))}catch(C){}},_save:function(e){var r={draft:e.draft,draftMid:m(e.draftMid)},s=e.draft,u=v(i(s,"origin.oMsg.cid")),f=e.msgResponse,l=m(e.draftMid),c=a.getFolderByIndex(s&&s.folder&&s.folder.id),h=c&&c.folderInfo&&c.folderInfo.fid||o,p;NeoConfig.hasConvView&&u?(p=this._serializeSaveMessageInfo(s,f),t.msgAdd(v(u),null,p,r)):f&&(p={mid:m(f.mid||f.id),flags:{}},n.set(h,p,"add")),l&&n.remove(h,l,!0,null,{reason:"savedraft"})},store:function(t){t.method==="send"?this._send(t):t.method==="save"&&this._save(t),(h||p)&&e.use("mail-controller-id-tracker",function(e){d||(e.mail.controller.v3.idTracker.addSource("compose"),d=!0),e.mail.controller.v3.idTracker.trackID(i(t,"msgResponse.mid"),"compose")})}};e.namespace("mail.Controller").convAdapter=g},"1.0.0",{requires:["mail-model-convstore","mail-model-datastore","mail-controller-messages","common-utils","mail-controller-folders","mail-common-utils-features","mail-ui-folder-utils"]});
YUI.add("mail-models-attachment-preprocessor",function(e){function t(t,n){var r=0,i;for(r=0;r<t.length;r++)if(t[r].partId===n.partId)return i=e.clone(t[r]),e.mix(i,n,!0),i;return undefined}function n(e,t){var n,r=t.match(/\<(.+)\>/);return r&&(n=r[1]),!e[t]&&e[n]?(e[t]=e[n],delete e[n],!0):!1}var r=function(){};e.mix(r.prototype,{preProcess:function(r){var i=r.normalizedResponse.attachments,s=r.normalizedResponse.parts,o=r.normalizedResponse.mid,u,a,f,l,c,h=[],p=r.uploads||{},d=r.draft,v=d.attachments,m=d.attachments.map(function(e){return e.contentId()}),g=e.Array.hash(m,v);for(u=0;u<i.length;u++)l=i[u],f=l.contentId,h.push(f),n(p,f),r.saveSuccess&&(n(g,f)&&g[f].setContentId(f),g[f]?g[f].partId()!==l.partId&&(g[f].setData(t(s,l)),g[f].setMid(r.normalizedResponse.mid)):(l.currentSessionAttachment=!0,c=new e.mail.Models.Attachment(o,l),c.setData(t(s,l)),c.setState("saved"),c.setSavedInfo(l),d.addAttachment(c)),d.draftToDelete&&g[f].mid()===d.draftToDelete&&g[f].setMid(r.normalizedResponse.mid));if(r.saveSuccess)for(a in g)h.indexOf(a)<0&&g[a].state()==="saved"&&d.removeAttachment(a);return i}}),e.namespace("Mail.Models.Serializers").AttachmentRespPreprocessor=r},"1.0.0",{requires:["mail-model-attachment"]});
