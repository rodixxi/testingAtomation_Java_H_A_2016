YUI.add("common-net-pulse",function(e){function o(t){var r;t=t||!1;if(!NeoGV.isOnline||t)r=n.Session.createXHR(),r.onload=function(){e.fire(i)},r.ontimeout=r.onerror=function(){(!n.Pulse.ynotify||!n.Pulse.ynotify.showingNotification)&&e.fire(s)},r.open("GET","/neo/pulse?uuid="+NeoConfig.uuid,!0),r.timeout=1e4,r.send()}function u(){n.Pulse.netStatusIntervalId!==0&&(clearInterval(n.Pulse.netStatusIntervalId),n.Pulse.netStatusIntervalId=0)}function a(){u(),n.Pulse.netStatusIntervalId=setInterval(o,1e4)}function f(){}var t=e.common.Utils,n=e.common.net,r=t.substitute,i="net:online",s="net:offline";e.on("net:online",function(){var t={online:!0,userTimeStamp:new Date,isCorp:NeoConfig.isCorpmail?1:0},r;!NeoGV.isOnline&&n.Pulse.ynotify&&(r=n.Pulse.ynotify,r.showingNotification=!1,r._hide()),NeoGV.isOnline=!0,e.fire("SplunkLog","pulse_check",t,"critical"),u()}),e.on("net:offline",function(){var t=e.UA.userAgent,i={menu_start:"<b>",menu_end:"</b>",gt:"&gt;",line_start:'<div class="tae-dialog network-help">',line_end:"</div>"},s={menu_start:"<b>",menu_end:"</b>",list_start:"<ol>",list_end:"</ol>",item_start:"<li>",item_end:"</li>",line_start:"<div>",line_end:"</div>"},o={online:!1,userTimeStamp:new Date,isCorp:NeoConfig.isCorpmail?1:0},u,f;NeoGV.isOnline=!1,e.fire("SplunkLog","pulse_check",o,"critical"),t.indexOf("Win")!==-1&&t.indexOf("NT 5.")!==-1?u=r(strings.str_tae_winxpnetworkresolution,s,null,null,null,null):t.indexOf("Win")!==-1&&t.indexOf("NT 6.0")!==-1?u=r(strings.str_tae_winvistanetworkresolution,i,null,null,null,null):t.indexOf("Win")!==-1?u=r(strings.str_tae_win7networkresolution,i,null,null,null,null):t.indexOf("Mac")!==-1&&(u=r(strings.str_tae_macnetworkresolution,i,null,null,null,null)),f=r(e.ui.Templates._shared_module_offscreen_bin_notification_single_inline_text.base,{nf_text:strings.str_nointernetconn+" "+(u?strings.str_nointernetconn_help:""),inline_text:u?u:""},null,null,null,strings),n.Pulse.ynotify=e.common.ui.NotificationV2.notify(f,{type:"attention",close:!0,customClass:"single-inline"}),n.Pulse.ynotify.showingNotification=!0,a()}),e.on("net:checkNetStatus",function(){t.features.enabled("autoCheckNetwork")&&o(!0)}),f.prototype.checkNetStatus=function(e){return o(e)},e.namespace("common.net").Pulse=new f},"1.0.0",{requires:["node","event-custom","common-utils","common-net-session","mail-common-utils-features","_shared_module_offscreen_bin_notification_single_inline_text","common-ui-notification-v2"]});
