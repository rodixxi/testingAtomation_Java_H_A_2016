YUI.add("tictac-autosuggest",function(a){"use strict";function b(){return a.common.Utils.settings.value("appid")}function c(b,c){return a.Tictac.base.getAssetURL(b,"tictac-autosuggest",c)}function d(b){return a.Tictac.base&&a.Tictac.base.isRTL?b.replace(/\.css$/,"_bidi.css"):b}function e(a){n||(n=new a.Tictac.base.Stats({name:"autosuggest",yamas:!0}))}function f(){var b=a.Tictac.base.getTictacVersion("autosuggest").filter,d=window.NeoConfig?window.NeoConfig.lang:"en-US";a.Tictac.base.defineModuleGroup("autosuggest",{filter:b,modules:{"tictac-autosuggest-rollups":{path:c("js/tictac-autosuggest-rollups_"+d+"-min.js"),requires:["handlebars-base"]},"tictac-autosuggest-strings":{path:c("js/strings/lang_"+d+"-min.js")},"autosuggest-contact-api":{path:c("js/contactapi-min.js")},"autosuggest-highlight-helper":{path:c("js/autosuggesthighlighthelper-min.js")},"autosuggest-response-formatter":{path:c("js/autosuggestresponseformatter-min.js"),requires:["autosuggest-highlight-helper","handlebars-base"]},"autosuggest-api":{path:c("js/autosuggestapi-min.js"),requires:["autosuggest-response-formatter","io-base","querystring-stringify","event-base","querystring-parse","autosuggest-search-performance","autosuggest-api-mail-endpoints","autosuggest-api-state"]},"autosuggest-api-cache":{path:c("js/autosuggestapicache-min.js"),requires:["autosuggest-api","autosuggest-api-cache-object"]},"autosuggest-api-factory":{path:c("js/autosuggestapifactory-min.js"),requires:["autosuggest-api","autosuggest-api-cache"]},"autosuggest-social-footer":{path:c("js/socialfooter-min.js"),requires:["event","tictac-autosuggest-rollups","mail-common-utils-features"]},"autosuggest-compose-utils":{path:c("js/autosuggestcomposeutilities-min.js"),requires:["tictac-autosuggest-rollups"]},"tictac-autosuggest-compose":{path:c("js/autosuggesttictaccompose-min.js"),requires:["node","event","autosuggest-social-footer","autosuggest-main","autosuggest-api","comms-intl-bidi","handlebars-base","common-net-session","autosuggest-compose-utils","autosuggest-api-factory","autosuggest-prefetch-store","autosuggest-api-mail-endpoints"]},"autosuggest-footer-manager":{path:c("js/autosuggestfootermanager-min.js")},"autosuggest-main":{path:c("js/autosuggestmain-min.js"),requires:["node","autocomplete","event","autosuggest-footer-manager","autosuggest-api","autosuggest-css","tictac-autosuggest-rollups"]},"autosuggest-api-mail-endpoints":{path:c("js/autosuggestapimailendpoints-min.js"),requires:["mail-common-utils-features"]},"autosuggest-standalone-loader":{path:c("js/standaloneloader-min.js"),requires:["autosuggest-api","autosuggest-main","autosuggest-standalone-helper","querystring-parse","autosuggest-api-factory"]},"autosuggest-standalone-helper":{path:c("js/autosuggeststandalonehelper-min.js"),requires:["autosuggest-compose-utils"]},"autosuggest-tictac-stats":{path:c("js/autosuggesttictacstats-min.js"),require:["event-base"]},"autosuggest-prefetch-store":{path:c("js/prefetchstore-min.js")}}},"min"===b)}function g(b,c){if(!m){var d=["contains","destructor","detach","fire","generateID","getItemMarkup","handleEscape","hide","isVisible","on","one","hasItemSelected","refresh","render","set","setAlign","setSize"],e={},f=null;a.Array.each(d,function(a){e[a]=!0}),c&&c.contacts&&c.contacts.ui&&c.contacts.ui.ACWidget&&c.contacts.ui.ACWidget.prototype&&(f=c.contacts.ui.ACWidget.prototype),b.ACWidgetInst&&b.ACWidgetInst.get("ac").destructor(),b.ACWidgetInst=m=c.autosuggest.tictac.shim.create(f,d,{canHandleEnter:function(){return!0},get:function(a){return"data"===a?"data":this},handleEnter:function(){}})}}function h(b){var c,d;e(b),g(a,b),a.log("Taking over autosuggest.","debug"),n.stat("info",{intl:NeoConfig.intl,internal:(!!NeoConfig.isInternal).toString()}),f(),l||(l=YUI()),k||l.use("autosuggest-tictac-stats",function(a){k=new a.autosuggest.tictac.Stats(a,n)}),yui.on("autosuggest:standalone:initialize",function(a){window.NeoConfig?j(a):o&&o.isXobnifiedAndAvailable&&a.id&&o.isXobnifiedAndAvailable(function(b){b&&j(a)})}),yui.on("autosuggest:standalone:destroy",function(b){b.id&&b.id in r&&(a.Array.each(r[b.id],function(a){a.detach(),a.destroy()}),delete r[b.id])}),u=t,c=s.length;for(d=0;d<c;d++)i(s[d]);s.length=0}function i(a){var c=a.context,d=c&&c.header,e=c&&c.draft&&c.draft.from&&c.draft.from.email;l.use("tictac-autosuggest-compose",function(c){if(a.rte.baseNode){var f=c.autosuggest.tictac.compose.create(),g={yBaseNode:a.rte.baseNode,shim:m,fromAccount:e||"",apiConfig:{xobniBaseURL:p,getAppid:b},showPerf:1===q.xShowPerf,useCache:1!==q.xDisableCache};f.init(g),d&&d.on("closeChange",function(a){1===a.newVal&&f.destroy()})}})}function j(a){l.use("autosuggest-standalone-loader",function(c){r[a.id]=c.Array.map(a.inputSelectors,function(d){return c.autosuggest.standalone.init(c.one(d),c.mix(a.config,{getAppid:b,xobniBaseURL:p}))})})}var k,l,m,n,o=a.xobniContacts,p=o&&o.Utils.getXobniBaseURL().url,q=a.QueryString.parse(window.location.search.substr(1)),r={},s=[],t="initialized",u="uninitialized";a.namespace("Tictac").autosuggest={loader:function(b){(b||"uninitialized"===u)&&("uninitialized"===u?(u="inprogress",b&&s.push(b),a.use("ac-widget","tictac-autosuggest-shim","isXobnifiedCheck","get","tictac-base-stats",function(a){var b=!1,f=function(){b&&h(a)};a.Get.css(d(c("css/autosuggest.css",!0)),function(c){if(c)return a.log("Error loading CSS: "+c[0].error),e(a),void n.stat("cssFailToLoad",{browser_info:NeoConfig.browser,error:c[0].error});b=!0,f()})})):"inprogress"===u?s.push(b):i(b))}}},"1.0.0",{requires:["tictac-base","querystring-parse","io-base","mail-common-utils-settings","xobni-utilities"]}),YUI.add("tictac-autosuggest-shim",function(a){"use strict";a.namespace("autosuggest.tictac").shim={create:function(b,c,d,e){function f(a,b){return a&&"string"==typeof a&&"__setHandler__"!==a&&"__unsetHandler__"!==a&&!m[a]&&b&&"function"==typeof b}var g,h,i,j,k={},l=d&&"object"==typeof d?d:{},m={};l.__setHandler__=function(a,b){return!!f(a,b)&&(k[a]||(k[a]=[]),k[a].push(b),!0)},l.__unsetHandler__=function(a,b){var c,d,e;if(f(a,b)&&(e=k[a]))for(c=0,d=e.length;c<d;++c)if(e[c]===b)return e.splice(c,1),!0;return!1},g=function(a,b){var c,d,f;if(e&&e(a),k[a]&&k[a].length){for(c=!1,d=0,f=k[a].length;d<f;++d)"function"==typeof k[a][d]&&(c=c||!!k[a][d]());return c}return b};for(h in l)m[h]=!0;for(i in b)l[i]||(j=b[i],"function"==typeof j?l[i]=a.bind(g,this,i,l):"string"!=typeof j&&"number"!=typeof j&&"boolean"!=typeof j||(l[i]=b[l]));return a.Array.each(c,function(b){l[b]||(l[b]=a.bind(g,this,b,l))}),l}}},"1.0.0");