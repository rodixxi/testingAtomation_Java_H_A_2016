var wrappedFn = function () {
(function(){function n(e,t){var n=NeoConfig,r=n&&n.stat&&n.statThrottlePct,i=n&&n.statEndpoint||"/stats/ymstat",s=n&&n.statTimeout||3e3,o=[],u;XMLHttpRequest&&r&&(u=new XMLHttpRequest,u.open("POST",i),u.setRequestHeader("Content-Type","text/plain"),u.timeout=s,o.push("type="+t,"browser="+(n.browser&&n.browser.split("_")[0])||"unknown","mp="+!n.hasAds,"env="+n.mailEnv,"colo="+n.colo,"yid="+n.loginId),u.send(e+"~blocks~counter~1~"+o.join(",")))}function r(e,t,n,r){var i=[],s;XMLHttpRequest&&(s=new XMLHttpRequest,s.open("POST","/neo/splunkLogger?wssid="+NeoConfig.wssid),s.setRequestHeader("Content-Type","application/json"),s.timeout=3e3,i.push({timestamp:Date.now(),key:e,browser:NeoConfig.browser,bucket:NeoConfig.expBucketId,build:NeoConfig.buildNumber,env:NeoConfig.mailEnv,remoteIP:NeoConfig.remoteIp,uuid:NeoConfig.uuid,yid:NeoConfig.loginId,d:{type:t,message:n,exceptionMessage:r.name+":"+r.message,stack:r&&r.stack?r.stack.split("\n"):""}}),s.send(JSON.stringify(i)))}function i(e,t,i){window.console&&console.log&&console.log(e),window.globals&&typeof globals.report=="function"?globals.report(e,t,1,1,1,i):(n("jsexception","YUI_BEFORE_LOAD"),NeoConfig.SplunkLog_sample&&r("debug_jsexception","YUI_BEFORE_LOAD",e,i))}var e=function(t){function c(e,t,n){var o;typeof t=="string"&&(t=[t]);for(o=0;o<t.length;o++)t[o].search(/combo(.php)?\?/)>0&&(s=1);if(s){r===1&&++i>6&&(i=2);switch(i){case 2:for(o=0;o<t.length;o++)t[o]=t[o].replace(/combo(.php)?\?/,"nocombo?");break;case 3:n.timeOut=20;case 4:setTimeout(function(){n.onFailure.call(n.context,{win:window,data:n})},n.timeout/2);return;case 5:setTimeout(function(){n.onTimeout.call(n.context,{win:window,data:n})},n.timeOut);return;case 6:n.timeout=10}}return e.call(this,t,n)}try{var n,r,i,s,o=0,u=t.Get.script,a=window.location.search.substring(1).split("&"),f={all:1,404:2,fastfailure:3,failure:4,timeout:5,fasttimeout:6};e=0;for(;o<a.length;o++)n=a[o].split("="),n[0]==="modfailure"&&n.length===2&&(i=r=f[n[1].toLowerCase()]);r&&(t.Get.script=function(e,t){return c.call(this,u,e,t)})}catch(l){}},t=YUI.use;YUI.use=YUI.prototype.use=function(){var n,r=this,s=0,o=r.Env,u=o._used,a=o._attached,f=Array.prototype.slice.call(arguments,0),l=f.pop(),c=!0,h=null,p,d;e&&e(r),typeof l!="function"&&(f.push(l),l=0);try{while(n=f[s++])if(!u[n]||!a[n])return p=new Promise(function(e,n){h=n,d=function(t){f.pop(),e(t)},f.push(d),c=!1,t.apply(r,f)}),l&&p.then(function(){try{l.call(r,r,{success:!0})}catch(e){i("Exception in use "+f.join(",")+" callback: "+e.toString(),"YUI_CB",e)}}),p}catch(v){typeof h=="function"&&h(r),i("Exception in use "+n+" with args "+f.join(",")+": "+v.toString(),"YUI_USE",v)}if(l)try{p=Promise.resolve(r),l.call(r,r,{success:!0})}catch(v){p=Promise.reject(r),i("Exception in use "+f.join(",")+" callback: "+v.toString(),"YUI_CB",v)}return p||(p=Promise.resolve(r)),p}})();


YUI.add("comms-log4js",function(e){function i(e,t){var n=[],i=0,s=0,o={};return{useAppender:function(t,n){var i=o[t];if(!i){if(i=r[t])n=i(this,n,e);i=o[t]=n,i.refresh&&i.refresh()}return i},log:function(e){var r,u=n[s++]={msg:e,id:++i};this.noDate||(u.ts=new Date),s>=t&&(s=0);for(r in o)o[r].notify(u)},getEntries:function(){return n=n.concat(n.splice(0,s)),s=n.length,s>=t&&(s=0),n}}}function s(t,n){function r(t){try{if(e.common.Utils.features.enabled("autoCheckNetwork")&&!NeoGV.isOnline)return;var r=t.msg,s=new XMLHttpRequest;s.open("POST",i),n.jsonReq&&s.setRequestHeader("Content-type","application/json"),s.send(r)}catch(o){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-comms-shared-src-log4js-log4js:1",o,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-comms-shared-src-log4js-log4js:1")}}n=n||{};var i=n.url||"/neo/logger?wssid="+NeoConfig.wssid,s=n.include,o=n.exclude,u=n.maxCount||5,a=n.jsonReq||!1;return s=s&&s.split(",")||[],o=o&&o.split(",")||[],{notify:function(e){function c(e){for(;l<e.length;l++){t=e[l];if(t==="*"||f.indexOf(t)!==-1)return 1}}var t,n,i,a=s.length,f=e.msg,l=0;n=c(s),i=c(o),u&&(n||!a&&!i)&&r(e)}}}var t=e.namespace("comms"),n={},r={ajax:s};t.log4js={getLogger:function(e,t,r,s){e=e||"[default]",t=t||1e3;var o=n[e];return o||(o=n[e]=i(e,t)),r&&o.useAppender(r,s),o},register:function(e,t){r[e]=t}}},"1.0",{required:["common-utils"]});


YUI.add("launch-utils",function(e){var t=e.log,n=e.comms.log4js.getLogger,r=n("ylogLogger",1e3),i=e.namespace("common.Utils");e.log=YUI.prototype.log=function(e){r.log(e),t.apply(this,arguments)},i.traceMsg=function(t,n){i.startConsole(n),r.log(t)},i.startConsole=function(t){t&&e.use("comms-log4js-appenders-console",function(){r.useAppender("console").show()})},i.netError=function(e){NeoConfig.log_error_yapache&&n("netLogger",1,"ajax").log(e)}},"1.0",{requires:["comms-log4js"]});


YUI.add("mail-modules",function(e){e.use(function(e){function a(){var t,n,r,i;if(NeoConfig.convMods)for(var s in NeoConfig.convMods){r=s.split("$"),t=NeoConfig.convMods[s],n=e.comps[r[1]];if(n&&t)if(r[0]=="PATH")n.path=t;else if(r[0]=="REQ"){i=t.split("$");if(i[0]==="")n.requires.push(i[1]);else for(var o=0;o<n.requires.length;o++)if(n["requires"][o]==i[0]){n.requires[o]=i[1];break}}}}function y(){d++>2&&d<7&&p++,f=(NeoConfig.yloaderTimeout||7500)*p,NeoConfig.low_bandwidth&&(f=f*2+2)}function b(){var e,t,n,r,i,s,o,u=NeoConfig.retryOriginPerc,a=0,p=[],d=window,g=d.globals||{};return d.globals=g,e=g.failures={},u||u===0||(u=101),o=Math.random()*100<u,t=function(t,u,d,g){function k(){L("edge"),y();try{u&&u.apply(this,arguments)}catch(e){}A(0,1)}function L(e){l="",c=0}function A(e,t){if(s&&t==2){i=s+1e4-(new Date).getTime(),i>0&&(n=n||setTimeout(A,i));if(n)return}else n&&t==1&&clearTimeout(n),n=0;setTimeout(function(){s=(new Date).getTime(),(r=p.shift())&&r.Y.use.apply(r.Y,r.a)},0)}function O(e){u&&u.errorFn?g.push(u):g.push(k),p.push({Y:t,a:g}),A(0,e)}function M(){var e,n,r=0;while(e=g[r++])if(!S[e]){b=T[e];if(!b)(function(e){t.use("common-utils-error",function(t){t.common.Utils.error.report("No Module Info: "+e,"YUI_MODULE_INFO_MISSING",1,1,1)})})(e),YUI.add(e);else{if(b.type=="js"){if(!b.noRegister)return;n=b,YUI.add(e)}n=n||b}}b=n}function _(e,n){var r,i,s,o,u=e.fullpath,a=e.name,l=f/4;if(!u){if(i=N[e.group]){if(!(r=i.origin)){(r=i.root)&&r.indexOf("nq/")==0&&(r="storm/"+r.substring(3)),r.indexOf("f=/n/")==0&&(r="storm/"+r.substring(5));if(r.length<3){n(2);return}}}else r="yui3/build/";u=location.protocol+"//"+location.host+"/"+r+e.path}t.UA.webkit&&(u+="?.rand="+(new Date).getTime()),s={autopurge:!0,timeout:l,onSuccess:function(){!o&&S[a]?(o=1,L("origin"),n(1)):this.onFailure()},onFailure:function(){o||(o=1,n(2))}},s.onTimeout=s.onFailure,t.Get.script(u,s)}var b,w,E=t.Env,S=YUI.Env.mods,x=E._loader,T=x.moduleInfo,N=x.groups,C=t.clone(E._missed);if(Array.isArray(C)){if(t.common.Utils.features.enabled("debugException",!1))debugger;t.use("common-utils-error",function(e){C.forEach(function(t){e.common.Utils.error.report("Missing Module: "+t,"YUI_MODULE_MISSING",1,1,1)})})}k.errorFn=1,g=t.clone(g),M(g);if(b&&b.type=="js"&&!b.noRegister){e[b.name]=e[b.name]||0,e[b.name]++,l||(l=b.name,h++),c++,m==v?f<61e3&&(f*=2):b=0,m=v,w={timeout:f,maxURLLength:m},t._config(w);if(b){o?_(b,O):O(2);return}}O(a++<5?1:2)},t}e.mix(e.namespace("comps"),{"ac-widget":{path:"contacts/autocomplete/acWidget_5_1881.js",requires:["overlay","node-event-simulate","comms-ui-autocomplete-plugin","comms-ui-autocomplete","contacts-api-utils","contacts-api","filter-contacts","common-utils","comms-intl-bidihighlight"]},"boss-ult":{path:"mail/ui/boss/boss-ult_2_2607.js",requires:["common-utils-rapid-clickmap","common-utils-rapid-viewmap"]},"calendar-ui-addEvent-controller":{path:"calendar/ui/addEvent/addEventController_54_10489.js",requires:["event-base","yui-log","attribute","calendar-ui-addEvent-utils","calendar-ui-addEvent-view","calendar-ui-addEvent-model","mail-controller-compose-text"]},"calendar-ui-addEvent-listener":{path:"calendar/ui/addEvent/addEventListener_54_10489.js",requires:["yui-log","event-base","calendar-ui-addEvent-controller"]},"calendar-ui-addEvent-model":{path:"calendar/ui/addEvent/addEventModel_54_10489.js",requires:["yui-log","attribute","calendar-ui-addEvent-utils"]},"calendar-ui-addEvent-utils":{path:"calendar/ui/addEvent/addEventUtils_54_10489.js",requires:["common-net-sessionmgr","common-utils"]},"calendar-ui-addEvent-view":{path:"calendar/ui/addEvent/addEventView_5_1308.js",requires:["common-utils","_shared_module_calendar_dialog_add_event_mail_rollup","modal-calendar_css","modal_css","comms-ui-dialog-base"]},"calendar-ui-calendarview":{path:"calendar/ui/calendarview_54_10489.js",requires:["mail-ui-basewidget","node-event-simulate","querystring-stringify-simple","comms-crossframe","mail-common-utils-features"]},comet:{path:"common/net/cometd-yui3_2_1831.js",requires:["base","io","json","async-queue","cookie","jsonp","jsonp-url","common-utils-jsonparse"]},"common-net-crossframe":{path:"common/net/crossframe_54_10489.js",requires:["common-utils"]},"common-net-diag":{path:"common/net/diag_2_1676.js",requires:["common-net-session","common-utils"]},"common-net-error":{path:"common/net/error_2_1308.js",requires:["common-net-error-base","common-net-errorevent","common-net-sessionmgr","common-ui-dialog-helper","json-stringify","common-persist-user-data","launch-utils","common-utils","mail-common-utils-features","common-ui-notification-v2","_shared_module_offscreen_bin_notification_single_inline_text","io-base"]},"common-net-error-base":{path:"common/net/error-base_54_10489.js",requires:["common-utils","common-user-session"]},"common-net-errorevent":{path:"common/net/errorevent_54_10489.js"},"common-net-pulse":{path:"common/net/pulse_2_1749.js",requires:["node","event-custom","common-utils","common-net-session","mail-common-utils-features","_shared_module_offscreen_bin_notification_single_inline_text","common-ui-notification-v2"]},"common-net-session":{path:"common/net/session_2_1773.js",requires:["node","event-custom","common-utils","mail-model-datastore","mail-common-utils-features","mail-common-utils-settings"]},"common-net-sessionmgr":{path:"common/net/sessionmgr_2_1888.js",requires:["event-custom-base","common-net-session","common-net-error-base","json-parse","ymma-stats","mail-common-utils-features","mail-common-utils-settings","common-utils-jsonparse"]},"common-net-ydod":{path:"common/net/ydod_2_1438.js",requires:["ymma-stats","mail-core-net-transport","mail-core-net-helpers-v3-request-helper","mail-common-utils-settings"]},"common-persist-cookie-data":{path:"common/persist/cookieData_2_1676.js",requires:["cookie","attribute","common-persist-neo-data"]},"common-persist-neo-data":{path:"common/persist/neoData_54_10489.js",requires:["attribute"]},"common-persist-user-data":{path:"common/persist/userData_2_2909.js"
,requires:["attribute","mail-net-transport","json","common-utils","mail-common-utils-settings","mail-controller-v3-user-settings"]},"common-ui-anchored-header":{path:"common/ui/listview/anchored-header_2_2370.js"},"common-ui-contentwidget":{path:"common/ui/contentwidget/contentwidget_2_1966.js",requires:["event-key","common-utils","mail-common-utils-features"]},"common-ui-conv-listview":{path:"common/ui/listview/conv-listview_2_2977.js",requires:["base-base","node","event-focus","common-utils","mail-common-utils-features","common-ui-anchored-header","common-ui-timechunk","common-ui-conv-listview-ext","mail-persist-meta-data"]},"common-ui-conv-listview-ext":{path:"common/ui/listview/conv-listview-ext_2_2471.js",requires:["common-ui-conv-listview","common-ui-notification","mail-common-utils-features","mail-common-utils-settings","common-utils","mail-model-datastore"]},"common-ui-dd":{path:"common/ui/dd/dd_5_3542.js",requires:["node","common-utils"]},"common-ui-diagpanel":{path:"common/ui/contentwidget/diagpanel_54_10489.js",requires:["common-utils"]},"common-ui-dialog-helper":{path:"common/ui/dialoghelper/dialoghelper_2_862.js",requires:["common-utils","modal_css","comms-ui-dialog-base","_shared_module_offscreen_bin_modal","_shared_module_offscreen_bin_modal_btn_ok"]},"common-ui-listview":{path:"common/ui/listview/listview_2_2977.js",requires:["base-base","node","event-focus","common-utils","mail-common-utils-features","common-ui-anchored-header","common-ui-timechunk","mail-persist-meta-data"]},"common-ui-listview-ext":{path:"common/ui/listview/listview-ext_2_2406.js",requires:["common-ui-listview","mail-common-utils-features","common-utils"]},"common-ui-lozengeDD":{path:"common/ui/lozenge/lozenge-DD_54_10489.js",requires:["common-ui-dd","common-utils"]},"common-ui-menu-helper":{path:"common/ui/menuhelper/menuhelper_2_1687.js",requires:["common-utils","comms-ui-menu-base","_shared_module_offscreen_bin_menus_loading"]},"common-ui-navtabs":{path:"common/ui/tabview/navtabs_2_1670.js",requires:["common-ui-tabs-base","common-utils","common-net-session","minty_module_tabs_navtabs_removable","mail-common-utils-features"]},"common-ui-notification":{path:"common/ui/notifications/notification_54_10489.js",requires:["common-utils"]},"common-ui-notification-v2":{path:"common/ui/notifications/notification-v2_2_2486.js",requires:["common-utils","common-ui-dialog-helper","overlay","event-outside","event-mouseenter","mail-common-utils-features"]},"common-ui-tabs-base":{path:"common/ui/tabview/tabview_2_700.js",requires:["mail-ui-basewidget","minty_module_tabs_tab_removable","comms-ui-nodefocus-base","common-utils","mail-ui-common-string-utils","ymma-stats","mail-ui-folder-utils"]},"common-ui-tabs-overflow":{path:"common/ui/tabview/taboverflow_2_383.js",requires:["common-ui-menu-helper","_shared_module_offscreen_bin_inbox","mail-common-utils-features"]},"common-ui-tabs-tray":{path:"common/ui/tabview/tray_54_10489.js",requires:["common-ui-tabs-base"]},"common-ui-timechunk":{path:"common/ui/listview/timechunk_5_2083.js"},"common-ui-toolbar-base":{path:"common/ui/toolbar/toolbar_5_3685.js",requires:["attribute","event-custom-base","common-utils","comms-ui-nodefocus-base","ymma-stats","common-ui-tabs-base","mail-common-utils-features"]},"common-user-session":{path:"common/user/session_54_10489.js",requires:["common-persist-cookie-data","common-utils"]},"common-utils":{path:"common/utils/utils_2_2915.js",requires:["querystring-parse-simple","querystring-stringify-simple","launch-utils","common-utils-jsonparse","mail-common-utils-features","mail-common-utils-settings","oop"]},"common-utils-apihook":{path:"common/utils/apihook_2_1440.js",requires:["common-utils"]},"common-utils-error":{path:"common/utils/error_2_1879.js",requires:["mail-common-utils-features","mail-common-utils-settings","common-ui-tabs-base","comms-utils-stack-tracer","ymma-stats","mail-ui-recorder"]},"common-utils-jsonparse":{path:"common/utils/jsonparse_2_1534.js"},"common-utils-net-queue":{path:"common/utils/net-queue_2_415.js",requires:["io-base","mail-common-utils-settings","mail-common-utils-features"]},"common-utils-onboarding":{path:"common/utils/onboarding-stat-utils_2_1611.js",requires:["common-utils","contacts-api","contacts-api-utils","mail-ui-folder-utils"]},"common-utils-page-visibility":{path:"common/utils/pagevisibility_2_1193.js",requires:["common-utils"]},"common-utils-performance":{path:"common/utils/performance_5_3681.js"},"common-utils-pinkbox":{path:"common/utils/pinkbox_2_1795.js",requires:["common-utils","minty_module_pinkbox"]},"common-utils-rapid":{path:"common/utils/rapid_2_2753.js",requires:["common-utils","common-utils-rapid-viewmap","common-utils-rapid-clickmap","mail-common-utils-features","common-ui-tabs-base"]},"common-utils-rapid-clickmap":{path:"common/utils/rapid-clickmap_2_2661.js"},"common-utils-rapid-doc":{path:"common/utils/rapid-doc_2_2804.js",requires:["common-utils-rapid-clickmap","common-utils-rapid-viewmap","search-ult","boss-ult","live-nation-ult","hovercard-ult","s2s-ult","snow-ult","onboarding-ult","newsfeed-ult","mail-ui-keytaskpanel-ult","mail-ui-unsubscribe-ult","mail-common-connected-accounts-ult","folder-menu-ult","composeassist-ult","recentwebsearches-ult","mail-ui-onboarding-imap-in-ult","mail-ui-mailoptions-ult"]},"common-utils-rapid-viewmap":{path:"common/utils/rapid-viewmap_2_2036.js",requires:["common-utils-rapid-clickmap"]},"common-utils-stats":{path:"common/utils/stats_5_2662.js"},"comms-aop-tracer":{path:"comms/shared/src/aop/aspects/tracer_54_10489.js",requires:["comms-log4js","comms-log4js-appenders-traceconsole"]},"comms-aop-weaver":{path:"comms/shared/src/aop/weaver_54_10489.js"},"comms-bidi-textentry":{path:"comms/shared/src/bidi-textentry/js/bidi-textentry_54_10489.js",requires:["plugin","event-valuechange","comms-intl-bidi","comms-node-setdir"]},"comms-crossframe":{path:"comms/shared/src/crossframe/crossframe_54_10489.js",requires:["json","crossframe"]},"comms-editor-autobidi":{
path:"comms/shared/src/editor-autobidi/js/editor-autobidi_54_10489.js",requires:["editor-base","comms-intl-bidi"]},"comms-intl-bidi":{path:"comms/shared/src/intl-bidi/js/intl-bidi_54_10489.js"},"comms-intl-bidihighlight":{path:"comms/shared/src/intl-bidihighlight/js/intl-bidihighlight_54_10489.js"},"comms-log4js":{path:"comms/shared/src/log4js/log4js_2_2538.js"},"comms-log4js-appenders-console":{path:"comms/shared/src/log4js/console_54_10489.js",requires:["comms-log4js"]},"comms-log4js-appenders-traceconsole":{path:"comms/shared/src/log4js/traceconsole_54_10489.js",requires:["comms-log4js"]},"comms-lozenge":{path:"comms/shared/src/lozenge/js/lozenge_54_10489.js",requires:["node","widget","substitute","comms-utils"]},"comms-lozenge-address":{path:"comms/shared/src/lozenge-address/js/lozenge-address_54_10489.js",requires:["base-build","comms-lozenge"]},"comms-lozenge-edit":{path:"comms/shared/src/lozenge-edit/js/lozenge-edit_54_10489.js",requires:["base-build","comms-lozenge"]},"comms-node-setdir":{path:"comms/shared/src/node-setdir/js/node-setdir_54_10489.js",requires:["classnamemanager","node-base","node-style"]},"comms-ui-autocomplete":{path:"comms/shared/src/autocomplete/js/autocomplete-widget_54_10489.js",requires:["overlay","comms-ui-autocomplete-plugin","node-event-simulate"]},"comms-ui-autocomplete-plugin":{path:"comms/shared/src/autocomplete/js/autocomplete-plugin_54_10489.js",requires:["node","plugin","event-valuechange","event-key"]},"comms-ui-clipboard-plugin":{path:"comms/shared/src/clipboard/js/clipboard-plugin_2_848.js",requires:["node","plugin","substitute"]},"comms-ui-dialog-base":{path:"comms/shared/src/ui/dialog/js/dialog_5_2315.js",requires:["node","overlay"]},"comms-ui-editable-overlay-plugin":{path:"comms/shared/src/editable/js/editable-overlay-plugin_54_10489.js",requires:["comms-ui-editable-plugin","comms-utils"]},"comms-ui-editable-plugin":{path:"comms/shared/src/editable/js/editable-plugin_54_10489.js",requires:["node","plugin"]},"comms-ui-envelope":{path:"comms/shared/src/envelope/envelope_54_10489.js",requires:["env-indicator_css"]},"comms-ui-feedback-widget":{path:"comms/shared/src/feedback/js/feedback-widget_5_1003.js",requires:["node","widget","widget-position","widget-position-constrain","widget-stack"]},"comms-ui-lozenge":{path:"comms/shared/src/lozengeOld/js/hLozenge_2_2603.js",requires:["comms-ui-lozenge_css","common-utils","comms-utils","node"]},"comms-ui-menu-base":{path:"comms/shared/src/ui/menu/js/menu_2_2572.js",requires:["common-utils"]},"comms-ui-model":{path:"comms/shared/src/ui/model/js/model_54_10489.js",requires:["json"]},"comms-ui-nodefocus":{path:"comms/shared/src/ui/nodefocus/js/nodefocus_54_10489.js",requires:["plugin","node","event-key"]},"comms-ui-nodefocus-base":{path:"comms/shared/src/ui/nodefocus/js/base_54_10489.js",requires:["plugin","node","event-key"]},"comms-ui-store-javascript":{path:"comms/shared/src/ui/model/js/stores/javascript-store_54_10489.js",requires:["comms-ui-model","json"]},"comms-ui-tooltips-widget":{path:"comms/shared/src/tooltips/js/tooltips-widget_54_10489.js",requires:["node","common-utils","widget","widget-position","widget-position-constrain","widget-stack","event-mouseenter"]},"comms-utils":{path:"comms/shared/src/utils/js/utils_5_2136.js"},"comms-utils-stack-tracer":{path:"comms/shared/src/utils/js/stack-tracer_2_1374.js"},"composeassist-ult":{path:"mail/ui/composeassist/composeassist-ult_2_2068.js",requires:["common-utils-rapid-clickmap","common-utils-rapid-viewmap"]},"contacts-api":{path:"comms/shared/src/contacts-api/api_2_773.js",requires:["contacts-api-adapter","contacts-api-config","contacts-api-cache","contacts-api-utils"]},"contacts-api-adapter":{path:"comms/shared/src/contacts-api/api-adapter_2_1379.js",requires:["contacts-api-io","contacts-api-cache","contacts-api-urigenerator","contacts-api-config","json","common-utils"]},"contacts-api-cache":{path:"comms/shared/src/contacts-api/api-cache_2_1858.js",requires:["contacts-api-config","common-utils-stats"]},"contacts-api-config":{path:"comms/shared/src/contacts-api/api-config_2_2041.js",requires:["attribute","mail-common-utils-features","mail-common-utils-settings"]},"contacts-api-io":{path:"comms/shared/src/contacts-api/io_2_1638.js",requires:["contacts-api-urigenerator","common-utils-jsonparse","json"]},"contacts-api-urigenerator":{path:"comms/shared/src/contacts-api/urigenerator_2_2839.js",requires:["contacts-api-config","contacts-api-utils","mail-common-utils-settings","common-net-session","mail-common-utils-features"]},"contacts-api-utils":{path:"comms/shared/src/contacts-api/api-utils_2_773.js",requires:["contacts-api-cache","common-utils-stats"]},"contacts-ui-addcontact-add":{path:"comms/shared/src/addContact/js/addcontactdialogadd_54_10489.js",requires:["node-event-simulate","common-utils","_shared_module_offscreen_bin_contacts_modal_kiosk_add_modal_kiosk_addcontact"]},"contacts-ui-addcontact-confirm":{path:"comms/shared/src/addContact/js/addcontactconfirm_54_10489.js",requires:["common-utils","_shared_module_offscreen_bin_contacts_modal_kiosk_add_fragments_modal_kiosk_addcontactconfirm_bd","_shared_module_offscreen_bin_contacts_modal_kiosk_add_fragments_modal_kiosk_addcontactconfirm_ft","_shared_module_offscreen_bin_contacts_modal_kiosk_add_fragments_modal_kiosk_addcontactconfirm_hd","_shared_module_contact_card_confirm","_shared_module_contact_fragments_dl_email","_shared_module_contact_fragments_dl_yim","_shared_module_contact_fragments_dl_mobile","_shared_module_contact_fragments_photo","mod-contact-card_css"]},"contacts-ui-contactsevents":{path:"contacts/ui/contactseventstranslator/contactsEvents_54_10489.js"},"contacts-ui-contactseventstranslator":{path:"contacts/ui/contactseventstranslator/contactsEventsTranslator_2_2644.js",requires:["contacts-ui-contactsevents","contacts-ui-contactsview","mail-common-utils-features"]},"contacts-ui-contactsview":{path:"contacts/ui/contactsview/contactsview_2_2488.js",requires:["mail-ui-basewidget","mail-common-utils-features"
,"mail-persist-meta-data","node-event-simulate"]},"contacts-ui-hovercard-addedit":{path:"contacts/ui/hovercard/hovercard-addedit_5_2557.js",requires:["node-base","node-event-delegate","attribute-base","event-base","comms-utils","contacts-api-utils","contacts-api","xobni-contacts-search-api","_shared_module_offscreen_bin_contacts_modal_contact_edit","_shared_module_offscreen_bin_contacts_modal_contact_add","_shared_module_offscreen_bin_contacts_modal_contact_fragments_ep_smtp","_shared_module_offscreen_bin_contacts_modal_contact_fragments_ep_tel","_shared_module_offscreen_bin_contacts_modal_contact_fragments_ep_other","_shared_module_offscreen_bin_contacts_modal_contact_fragments_menu_email_types","_shared_module_offscreen_bin_contacts_modal_contact_fragments_menu_phone_types","common-ui-menu-helper","common-ui-dialog-helper"]},"contacts-ui-hovercard-datastore":{path:"contacts/ui/hovercard/hovercard-datastore_2_1179.js",requires:["cache-base","xobni-utilities","xobni-contacts-search-api","mail-common-utils-settings"]},"contacts-ui-hovercard-plugin":{path:"contacts/ui/hovercard/hovercard-plugin_2_2913.js",requires:["node","widget","widget-position","widget-position-constrain","widget-stack","event-mouseenter","common-utils","comms-utils","contacts-ui-hovercard-datastore","mail-common-connected-accounts","hovercard-ult","isXobnifiedCheck","xobni-contacts-search-api","mail-common-utils-settings","mail-common-utils-features","_shared_module_offscreen_bin_contacts_hovercard","_shared_module_offscreen_bin_contacts_hovercard_mini","hovercard_css"]},"coupons-ult":{path:"mail/ui/expiringcoupons/coupons-ult_2_2605.js",requires:["common-utils-rapid-clickmap","common-utils-rapid-viewmap"]},crossframe:{path:"comms/shared/src/crossframe/crossframe-base_2_1819.js"},"darla-utils":{path:"mail/ui/darla/utils_5_1922.js"},"datasource-sync":{path:"comms/shared/src/autocomplete/demo/federated-autocomplete-providers_54_10489.js",requires:["array-extras"]},"federated-autocomplete":{path:"comms/shared/src/autocomplete/js/federated-autocomplete_54_10489.js",requires:["autocomplete","mail-persist-meta-data","common-utils"]},"federated-autocomplete-acwidget-shim":{path:"comms/shared/src/autocomplete/js/federated-autocomplete-widgetshim_54_10489.js",requires:["federated-autocomplete"]},"filter-contacts":{path:"contacts/autocomplete/filtercontacts_2_773.js",requires:["contacts-api-utils","contacts-api","common-utils"]},"folder-menu-ult":{path:"mail/ui/foldersview/folder-menu-ult_5_1670.js",requires:["common-utils-rapid-clickmap"]},"gallery-event-pasted":{path:"mail/ui/common/galleryEventPasted_54_10489.js",requires:["event-synthetic"]},"hovercard-ult":{path:"contacts/ui/hovercard/hovercard-ult_2_248.js",requires:["common-utils-rapid-clickmap","common-utils-rapid-viewmap"]},"info-collector":{path:"mail/debug/info-collector_54_10489.js",requires:["io"]},"input-mask":{path:"mail/ui/common/inputMask_2_1292.js",requires:["event-valuechange","event-base-ie","gallery-event-pasted","event-focus","event-base"]},isXobnifiedCheck:{path:"comms/shared/src/xobniContacts/isXobnifiedCheck_2_1653.js",requires:["io-base","common-utils","xobni-utilities","ymma-stats","mail-persist-meta-data"]},"launch-utils":{path:"common/launch/utils_54_10489.js",requires:["comms-log4js"]},"live-nation-ult":{path:"mail/ui/ads/live-nation-ult_54_10489.js",requires:["common-utils-rapid-clickmap","common-utils-rapid-viewmap"]},"mail-api-attribute-selector":{path:"mail/api/attributeSelector_2_2667.js",requires:["oop","mail-api-base-selector"]},"mail-api-attribute-updater":{path:"mail/api/attributeUpdater_2_2667.js",requires:["mail-api-attribute-selector","mail-api-validator","array-extras"]},"mail-api-base-entity":{path:"mail/api/baseEntity_2_2623.js",requires:["mail-api-validator","mail-api-batch"]},"mail-api-base-selector":{path:"mail/api/baseSelector_2_2239.js"},"mail-api-base-updater":{path:"mail/api/baseUpdater_2_2239.js"},"mail-api-batch":{path:"mail/api/batch_2_2239.js",requires:["mail-api-validator"]},"mail-api-batch-id-helper":{path:"mail/api/batchIdHelper_2_1434.js",requires:["mail-api-validator"]},"mail-api-decos-selector":{path:"mail/api/decosSelector_2_2718.js",requires:["oop","mail-api-base-selector"]},"mail-api-decos-updater":{path:"mail/api/decosUpdater_2_2670.js",requires:["mail-api-decos-selector","array-extras"]},"mail-api-display-selector":{path:"mail/api/displaySelector_2_2720.js",requires:["oop","mail-api-validator","mail-api-base-selector","array-extras"]},"mail-api-folder-selector":{path:"mail/api/folderSelector_2_1434.js",requires:["oop","mail-api-validator","mail-api-base-selector","array-extras"]},"mail-api-folderv2-selector":{path:"mail/api/folderV2Selector_2_2211.js",requires:["oop","mail-api-base-selector"]},"mail-api-message-selector":{path:"mail/api/messageSelector_2_2971.js",requires:["oop","mail-api-validator","mail-api-base-selector","array-extras"]},"mail-api-message-updater":{path:"mail/api/messageUpdater_2_2977.js",requires:["mail-api-message-selector","mail-api-validator","mail-api-utility","mail-controller-imapin","mail-ui-folder-utils"]},"mail-api-migration-customviews":{path:"mail/api/migration/custom-views-migration_2_2713.js",requires:["mail-api-message-selector","mail-api-yoda","common-utils-jsonparse","mail-persist-meta-data","mail-api-utility","mail-api-savedsearch-selector","mail-api-savedsearch-updater"]},"mail-api-savedsearch-selector":{path:"mail/api/savedSearchSelector_2_2239.js",requires:["oop","mail-api-validator","mail-api-base-selector"]},"mail-api-savedsearch-updater":{path:"mail/api/savedSearchUpdater_2_2239.js",requires:["mail-api-base-updater","mail-api-savedsearch-selector","mail-api-validator","mail-api-utility"]},"mail-api-utility":{path:"mail/api/utility_2_2760.js"},"mail-api-validator":{path:"mail/api/validator_2_2239.js"},"mail-api-yoda":{path:"mail/api/yoda_2_2760.js",requires:["mail-api-validator","mail-api-yoda-response","mail-api-yoda-logger","mail-api-batch-id-helper","mail-api-yoda-io","mail-api-batch"
,"mail-api-base-entity"]},"mail-api-yoda-io":{path:"mail/api/yodaIO_2_2864.js",requires:["io","common-net-sessionmgr","querystring-stringify-simple","mail-common-utils-settings"]},"mail-api-yoda-logger":{path:"mail/api/yodaLogger_2_2796.js",requires:["common-utils","mail-api-utility","common-utils-jsonparse"]},"mail-api-yoda-response":{path:"mail/api/yodaResponse_2_2696.js",requires:["mail-api-utility","mail-api-base-selector","common-utils-jsonparse"]},"mail-captcha-data-controller":{path:"compose_v3/captcha/data/controller_54_10489.js",requires:["common-utils","captcha_css","comms-ui-dialog-base","common-ui-dialog-helper","mail-captcha-data-view","attribute","oop"]},"mail-captcha-data-view":{path:"compose_v3/captcha/data/view_54_10489.js",requires:["common-ui-dialog-helper","attribute","common-utils","captcha_css","_shared_module_send_confirm_captcha","_shared_module_send_confirm_captcha_blocked"]},"mail-captcha-turnkey-iframe":{path:"compose_v3/captcha/turnkey/Iframe_54_10489.js",requires:["node","common-utils"]},"mail-captcha-turnkey-parser":{path:"compose_v3/captcha/turnkey/Parser_54_10489.js",requires:["json-parse","common-utils"]},"mail-captcha-turnkey-view":{path:"compose_v3/captcha/turnkey/View_54_10489.js",requires:["common-ui-dialog-helper","mail-captcha-turnkey-iframe","oop","node"]},"mail-common-cachewarmer":{path:"mail/common/cachewarmer_2_2554.js",requires:["async-queue","loader","common-net-session","mail-controller-messages","mail-common-utils-features"]},"mail-common-connected-accounts":{path:"mail/common/connected-accounts_2_1308.js",requires:["io-base","node-base","ymma-stats","xobni-utilities","common-net-session","mail-model-datastore","xobni-utilities","isXobnifiedCheck","xobni-contacts-search-api","common-ui-dialog-helper","mail-common-connected-accounts-ult","_shared_module_offscreen_bin_modal_connected_accounts","_shared_module_offscreen_bin_notification_refresh_dialog"]},"mail-common-connected-accounts-ult":{path:"mail/common/connected-accounts-ult_5_1050.js",requires:["common-utils-rapid-clickmap"]},"mail-common-corpmail":{path:"mail/common/corpmail_2_1078.js"},"mail-common-downloader-v1":{path:"mail/common/downloader_v1_54_10489.js",requires:["common-utils","mail-controller-messages","_shared_module_offscreen_bin_modal_attach_download_rollup","common-ui-dialog-helper","comms-ui-dialog-base"]},"mail-common-downloader-v2":{path:"mail/common/downloader_v2_54_10489.js",requires:["common-utils","mail-controller-messages","common-ui-dialog-helper","comms-ui-dialog-base","datatype"]},"mail-common-hidef-profiles":{path:"mail/common/hidef_profiles_54_10489.js",requires:["common-net-session"]},"mail-common-inline-edit":{path:"mail/common/edit-control_54_10489.js"},"mail-common-lowbandwidth":{path:"mail/common/lowbandwidth_54_10489.js",requires:["node"]},"mail-common-newscookie":{path:"mail/common/newscookie_2_1676.js",requires:["node","cookie"]},"mail-common-pixiedust":{path:"mail/common/pixiedust_54_10489.js"},"mail-common-precache-ranking":{path:"mail/common/precache-ranking_54_10489.js",requires:["mail-ui-messagelist-base"]},"mail-common-precache-thread":{path:"mail/common/precache-thread_2_1938.js",requires:["mail-ui-convlist-base"]},"mail-common-precache-unread":{path:"mail/common/precache-unread_54_10489.js",requires:["mail-ui-messagelist-base"]},"mail-common-token-refresh":{path:"mail/common/token-refresh_5_3212.js",requires:["node","event","mail-common-connected-accounts"]},"mail-common-tracker":{path:"mail/common/tracker_2_359.js",requires:["mail-common-utils-features"]},"mail-common-utils-callbacks":{path:"common/utils/callbacks_54_10489.js"},"mail-common-utils-deferred":{path:"common/utils/deferred_54_10489.js",requires:["mail-common-utils-callbacks","array-extras"]},"mail-common-utils-featureflipper":{path:"common/utils/featureflipper_5_3321.js"},"mail-common-utils-features":{path:"common/utils/features_5_3321.js",requires:["mail-common-utils-featureflipper"]},"mail-common-utils-settings":{path:"common/utils/settings_5_3321.js",requires:["mail-common-utils-featureflipper"]},"mail-common-yml":{path:"mail/common/yml_54_10489.js"},"mail-compose-syncer":{path:"compose_v3/controllers/Syncer_2_2347.js",requires:["common-utils","mail-common-utils-features"]},"mail-controller-alertstore":{path:"mail/controller/alertstore_2_1154.js",requires:["mail-core-net-policies-basic","mail-core-net-transport","mail-core-net-helpers-v3-request-helper","mail-model-datastore","common-utils","mail-controller-imapin"]},"mail-controller-base":{path:"mail/controller/base_2_1054.js",requires:["mail-net-transport","common-net-error-base","common-utils","common-utils-apihook","mail-common-utils-features"]},"mail-controller-cloud-linkutil":{path:"compose_v3/controllers/CloudLinkHelper_2_1670.js",requires:["tictac-lib","common-ui-notification-v2","_shared_module_offscreen_bin_modal_cloud_filepermissions","common-ui-dialog-helper","mail-persist-meta-data","common-utils"]},"mail-controller-compose":{path:"mail/controller/composectrl_2_2685.js",requires:["mail-controller-base","mail-model-compose","mail-model-send","common-persist-user-data","mail-persist-meta-data","_shared_module_compose_reply"]},"mail-controller-compose-text":{path:"mail/controller/composetext_54_10489.js",requires:["common-persist-user-data","mail-controller-compose"]},"mail-controller-compose-v3":{path:"compose_v3/controllers/ComposeController_2_2830.js",requires:["mail-ui-fullcompose-v3","mail-models-validators-send","mail-model-datastore","mail-models-draft","mail-model-attachment","mail-services-compose","mail-services-plugins","mail-services-response-serializer","mail-compose-syncer","mail-controller-reply-processor","mail-controller-html-processor","mail-controller-text-processor","mail-controller-signature-processor","mail-controller-spell-processor","mail-ui-mailcompose-header-form-list-helper","mail-controller-composecontent-helper","mail-controller-inlineimage-processor","mail-common-utils-features","rte-file-utils"
,"mail-ui-folder-utils","mail-controller-v3-user-settings"]},"mail-controller-composecontent-helper":{path:"compose_v3/controllers/composeContentHelper_2_1670.js",requires:["mail-model-attachment","mail-controller-cloud-linkutil"]},"mail-controller-contact-processor":{path:"compose_v3/controllers/ContactProcessor_2_1379.js",requires:["mail-models-draft","comms-utils","common-persist-user-data","contacts-api-utils","common-net-sessionmgr","contacts-api","contacts-api-config"]},"mail-controller-conv-adapter":{path:"compose_v3/controllers/convAdapter_2_2329.js",requires:["mail-model-convstore","mail-model-datastore","mail-controller-messages","common-utils","mail-controller-folders","mail-common-utils-features","mail-ui-folder-utils"]},"mail-controller-conversations":{path:"mail/controller/conversation_2_1676.js",requires:["launch-utils","mail-controller-parkqueue","mail-controller-base","mail-controller-folders","common-persist-user-data","mail-net-transport","mail-model-convstore","mail-model-datastore","mail-ui-folder-utils","mail-common-utils-features","mail-common-utils-settings"]},"mail-controller-conversations-ops":{path:"mail/controller/conversationsops_2_1094.js",requires:["mail-controller-base","mail-model-convstore","json-stringify","array-extras","mail-ui-folder-utils","mail-common-utils-settings"]},"mail-controller-conversations-ops-drafts":{path:"mail/controller/conversationsops-draft_2_362.js",requires:["mail-core-net-policies-conv-write-policy","mail-core-net-transport","mail-model-datastore","mail-model-convstore","mail-core-net-helpers-batch-request-helper","mail-core-net-helpers-cascade-request-helper"]},"mail-controller-filters-v3":{path:"mail/controller/filters_v3_2_2781.js",requires:["mail-core-net-policies-list-filters-policy","mail-core-net-transport","mail-core-net-helpers-v3-request-helper","mail-ui-messagesview-quickfilter","mail-common-utils-features","mail-common-utils-settings"]},"mail-controller-folders":{path:"mail/controller/folders_2_1296.js",requires:["mail-common-utils-features","mail-model-datastore","mail-controller-base","common-persist-user-data","mail-common-utils-settings","mail-ui-folder-utils"]},"mail-controller-folders-v3":{path:"mail/controller/folders_v3_2_2838.js",requires:["mail-core-net-policies-list-folders-policy","mail-core-net-transport","mail-model-datastore","mail-controller-base","mail-controller-imapin","common-persist-user-data","mail-common-utils-settings","common-persist-user-data","mail-core-net-helpers-batch-request-helper","mail-core-net-helpers-v3-request-helper","escape","mail-ui-folder-utils","mail-common-utils-features","cookie","mail-api-utility"]},"mail-controller-html-processor":{path:"compose_v3/controllers/HtmlProcessor_2_209.js",requires:["_shared_module_compose_reply"]},"mail-controller-id-tracker":{path:"mail/controller/v3/idTracker_2_2329.js",requires:["mail-api-utility"]},"mail-controller-imapin":{path:"mail/controller/imap-in_2_2552.js",requires:["mail-model-datastore","mail-ui-folder-utils","mail-common-utils-settings","cookie"]},"mail-controller-inlineimage-processor":{path:"compose_v3/controllers/InlineImageProcessor_2_1022.js",requires:["mail-common-utils-features"]},"mail-controller-messages":{path:"mail/controller/messages_2_1676.js",requires:["launch-utils","ymma-stats","mail-controller-parkqueue","mail-controller-base","mail-controller-folders","common-persist-user-data","mail-ui-folder-utils","mail-common-utils-settings"]},"mail-controller-messages-ops":{path:"mail/controller/messagesops_2_1094.js",requires:["mail-controller-base","mail-model-datastore","json-stringify","mail-ui-folder-utils","mail-common-utils-settings"]},"mail-controller-mrd":{path:"mail/controller/mrd_2_2432.js",requires:["common-utils","mail-ui-shortcuts"]},"mail-controller-parkqueue":{path:"mail/controller/parkqueue_54_10489.js"},"mail-controller-persist":{path:"mail/controller/persistController_2_1563.js",requires:["common-utils","common-ui-tabs-base","mail-ui-foldersview-base","mail-persist-meta-data","common-ui-notification-v2","mail-common-utils-features","mail-ui-folder-state"]},"mail-controller-processbody":{path:"mail/controller/processbody_2_2492.js",requires:["common-utils","mail-ui-folder-utils","common-utils-stats"]},"mail-controller-reply-processor":{path:"compose_v3/controllers/ReplyProcessor_2_2685.js",requires:["mail-models-draft","comms-utils","mail-model-attachment","mail-controller-messages","mail-controller-text-processor","common-persist-user-data","mail-persist-meta-data","mail-models-serializers-draft-gdm-unserializer","_shared_module_compose_reply","mail-controller-signature-processor","mail-common-utils-features","mail-ui-mailcompose-header-form-list-helper"]},"mail-controller-sendconfirm":{path:"mail/controller/sendconfirm_2_1676.js",requires:["mail-controller-base","mail-model-send","mail-model-datastore","contacts-api-utils","contacts-api","mail-controller-messages-ops","common-utils-stats","mail-ui-folder-utils"]},"mail-controller-signature-processor":{path:"compose_v3/controllers/SignatureProcessor_2_2643.js",requires:["mail-controller-text-processor","common-persist-user-data","common-utils","mail-model-datastore","mail-persist-meta-data","mail-model-datastore","mail-common-utils-features"]},"mail-controller-spell-processor":{path:"compose_v3/controllers/SpellProcessor_54_10489.js",requires:["mail-model-spellcorrections","common-net-sessionmgr","common-persist-user-data","json-parse"]},"mail-controller-spellcheck":{path:"mail/controller/spellcheck_54_10489.js",requires:["mail-controller-base","mail-model-compose","common-net-sessionmgr","common-persist-user-data","json-parse"]},"mail-controller-text-processor":{path:"compose_v3/controllers/TextProcessor_54_10489.js",requires:["common-utils","node"]},"mail-controller-tictacs":{path:"mail/controller/tictacs_54_10489.js"},"mail-controller-v3":{path:"mail/controller/v3/controllerV3_2_2979.js",requires:["mail-model-datastore","mail-model-convstore","mail-model-liststore"
,"mail-api-yoda","mail-api-attribute-selector","mail-api-folderv2-selector","mail-api-message-selector","mail-api-display-selector","mail-api-message-updater","mail-controller-v3-helper","mail-api-decos-selector","mail-api-decos-updater","mail-controller-v3-converter","mail-api-folder-selector","mail-controller-folders","mail-controller-imapin","mail-ui-folder-utils","mail-api-utility","mail-common-utils-settings","mail-common-utils-features"]},"mail-controller-v3-converter":{path:"mail/controller/v3/converter_2_2962.js",requires:["mail-model-datastore","mail-model-convstore","mail-api-utility"]},"mail-controller-v3-helper":{path:"mail/controller/v3/helper_2_2667.js",requires:["mail-model-datastore","mail-model-convstore","mail-controller-imapin","mail-ui-folder-utils","common-persist-user-data","array-extras","mail-api-utility","mail-errormap","mail-error","mail-controller-id-tracker","mail-common-utils-settings"]},"mail-controller-v3-hoverprefetch":{path:"mail/controller/v3/hoverprefetch_2_2386.js",requires:["common-utils"]},"mail-controller-v3-user-settings":{path:"mail/controller/v3/user-settings_2_2909.js",requires:["mail-api-utility","common-utils","array-extras","mail-common-utils-settings","mail-controller-v3-user-settings-savedsearches-adapter","mail-controller-v3-user-settings-attribute-adapter","mail-controller-v3-user-settings-accounts-adapter"]},"mail-controller-v3-user-settings-accounts-adapter":{path:"mail/controller/v3/user-settings-accounts-adapter_2_2757.js"},"mail-controller-v3-user-settings-attribute-adapter":{path:"mail/controller/v3/user-settings-attribute-adapter_2_2864.js",requires:["mail-api-utility"]},"mail-controller-v3-user-settings-savedsearches-adapter":{path:"mail/controller/v3/user-settings-savedsearches-adapter_2_2704.js",requires:["mail-api-utility"]},"mail-core-feature":{path:"mail/core/feature_54_10489.js",requires:["mail-common-utils-features"]},"mail-core-net-helpers-batch-request-helper":{path:"compose_v3/core/net/helpers/BatchRequestHelper_2_2704.js"},"mail-core-net-helpers-cascade-request-helper":{path:"compose_v3/core/net/helpers/CascadeRequestHelper_54_10489.js",requires:["common-utils"]},"mail-core-net-helpers-multipart-request-wrapper":{path:"compose_v3/core/net/helpers/MultipartRequestWrapper_2_1676.js"},"mail-core-net-helpers-v3-request-helper":{path:"compose_v3/core/net/helpers/V3RequestHelper_2_2044.js",requires:["mail-common-utils-settings","common-net-session"]},"mail-core-net-policies-basic":{path:"compose_v3/core/net/policies/BasicPolicy_2_336.js"},"mail-core-net-policies-compose-policy":{path:"compose_v3/core/net/policies/ComposePolicy_54_10489.js"},"mail-core-net-policies-conv-write-policy":{path:"compose_v3/core/net/policies/ConvWritePolicy_54_10489.js"},"mail-core-net-policies-list-filters-policy":{path:"compose_v3/core/net/policies/ListFiltersPolicy_54_10587.js"},"mail-core-net-policies-list-folders-policy":{path:"compose_v3/core/net/policies/ListFoldersPolicy_54_10489.js"},"mail-core-net-request":{path:"compose_v3/core/net/Request_2_2473.js",requires:["io","json","common-utils","common-net-error","common-net-session","common-user-session","mail-error-v3","mail-core-net-helpers-multipart-request-wrapper","mail-common-utils-features"]},"mail-core-net-transport":{path:"compose_v3/core/net/Transport_2_2765.js",requires:["mail-core-net-request","common-utils"]},"mail-debug":{path:"mail/debug/debug_2_320.js",requires:["node-base","comms-log4js","comms-log4js-appenders-console","info-collector","common-net-diag","_shared_module_offscreen_bin_menus_debug"]},"mail-error":{path:"mail/controller/error_2_1534.js",requires:["common-net-error","mail-common-utils-features","mail-common-utils-settings","mail-errormap","ymma-stats","json-stringify","escape","_shared_module_offscreen_bin_modal_launch_error_rollup","common-ui-notification-v2","common-utils-jsonparse"]},"mail-error-v3":{path:"mail/controller/error_v3_2_2473.js",requires:["mail-error","common-net-error","mail-common-utils-settings","mail-errormap","ymma-stats","json-stringify","_shared_module_offscreen_bin_modal_launch_error_rollup"]},"mail-errormap":{path:"mail/controller/errormap_2_2909.js",requires:["common-utils","mail-common-utils-features","json-stringify","common-net-error","_shared_module_offscreen_bin_notification_tae_text","mail-common-utils-settings"]},"mail-model-attachment":{path:"compose_v3/models/Attachment_2_1022.js",requires:["common-utils","event-custom"]},"mail-model-compose":{path:"mail/model/composemodel_2_1676.js",requires:["base","common-persist-user-data"]},"mail-model-convstore":{path:"mail/model/convstore_2_2643.js",requires:["common-utils","mail-ui-folder-utils","mail-common-utils-features"]},"mail-model-couponstore":{path:"mail/model/couponstore_2_2486.js",requires:["common-utils","mail-persist-meta-data","mail-common-utils-settings"]},"mail-model-datastore":{path:"mail/model/datastore_2_2979.js",requires:["common-utils","json-stringify","event-custom","mail-ui-folder-utils"]},"mail-model-liststore":{path:"mail/model/liststore_2_1839.js",requires:["common-utils","mail-ui-folder-utils"]},"mail-model-send":{path:"mail/model/sendmodel_54_10489.js",requires:["base"]},"mail-model-spellcorrections":{path:"compose_v3/models/SpellCorrections_54_10489.js",requires:["event-custom","oop"]},"mail-model-tripod-photo":{path:"compose_v3/models/TripodPhoto_5_3495.js",requires:["common-utils","event-custom"]},"mail-model-unsubstore":{path:"mail/model/unsubstore_2_2772.js",requires:["common-utils","mail-common-utils-settings"]},"mail-models-attachment-preprocessor":{path:"compose_v3/models/serializers/AttachmentResponsePreProcessor_2_2538.js",requires:["mail-model-attachment"]},"mail-models-draft":{path:"compose_v3/models/Draft_2_2347.js",requires:["common-utils","event-custom","json","oop","mail-common-utils-features","mail-ui-folder-utils"]},"mail-models-serializers-draft-formdata-serializer":{path:"compose_v3/models/serializers/DraftFormData_2_155.js"},"mail-models-serializers-draft-gdm-unserializer"
:{path:"compose_v3/models/serializers/DraftGdmUnserializer_2_1803.js",requires:["mail-model-attachment"]},"mail-models-serializers-draft-messageV3-unserializer":{path:"compose_v3/models/serializers/DraftMessageV3Unserializer_5_1425.js",requires:["common-utils"]},"mail-models-serializers-draft-payloadpart-serializer":{path:"compose_v3/models/serializers/DraftPayloadPartSerializer_54_10489.js",requires:["mail-models-draft"]},"mail-models-serializers-draft-ref-att-serializer":{path:"compose_v3/models/serializers/DraftRefAttSerializer_54_10489.js",requires:["mail-models-draft"]},"mail-models-validators-send":{path:"compose_v3/models/validators/SendValidator_2_1981.js",requires:["comms-utils","common-utils"]},"mail-net-diag":{path:"mail/net/diag_2_1418.js",requires:["common-net-diag","json-stringify","json-parse","common-utils-jsonparse"]},"mail-net-queue":{path:"mail/net/queue_2_507.js",requires:["mail-net-transport"]},"mail-net-transport":{path:"mail/net/transport_2_1935.js",requires:["ymma-stats","common-net-sessionmgr","json-stringify","common-persist-neo-data","mail-common-utils-settings"]},"mail-persist-meta-data":{path:"mail/persist/metaData_2_2830.js",requires:["attribute","mail-net-transport","mail-common-utils-features","mail-controller-v3-user-settings","mail-common-utils-settings"]},"mail-persist-user-preferences":{path:"mail/persist/userPreferences_54_10489.js",requires:["attribute","mail-net-transport","json"]},"mail-platform":{path:"mail/core/platform_54_10489.js",requires:["mail-core-feature"]},"mail-rte-autocomposemenu":{path:"compose_v3/rte/autocompose-menu_2_1670.js",requires:["_shared_module_compose_autocompose_menu","comms-utils","mail-ui-onboarding"]},"mail-rte-caret-plugin":{path:"compose_v3/rte/rte-caret-plugin_5_2652.js",requires:["mail-common-utils-features"]},"mail-rte-enhancr-card":{path:"compose_v3/rte/linkEnhancr/enhancr-card_2_2281.js",requires:["mail-rte-enhancr-config","mail-ui-enhancr-utils","common-utils","json","comms-intl-bidi"]},"mail-rte-enhancr-config":{path:"compose_v3/rte/linkEnhancr/enhancr-config_2_2281.js",requires:["common-utils","mail-ui-enhancr-utils","_shared_module_rte_well_content_enhancr_card_mini","_shared_module_rte_well_content_enhancr_card_cover","_shared_module_rte_well_content_enhancr_card_medium","_shared_module_rte_well_content_enhancr_card_medium_no_image","_shared_module_rte_well_content_enhancr_card_append","_shared_module_rte_well_content_enhancr_card_loading","_shared_module_rte_well_content_enhancr_link_previews"]},"mail-rte-enhancr-controller":{path:"compose_v3/rte/linkEnhancr/enhancr-controller_2_1123.js",requires:["mail-rte-enhancr-card","mail-rte-enhancr-config","mail-ui-enhancr-utils","mail-services-hlfs","common-utils","array-extras","json"]},"mail-rte-enhancr-plugin":{path:"compose_v3/rte/linkEnhancr/rte-enhancr-plugin_2_1905.js",requires:["mail-common-utils-features","mail-ui-enhancr-utils"]},"mail-rte-inline-image-plugin":{path:"compose_v3/rte/rte-inline-image-plugin_2_2572.js",requires:["node","rte-file-utils","rte-inline-image","event-custom","comms-utils","mail-common-utils-features","mail-common-utils-settings","_shared_module_rte_well_content_inline_image_ctrl_overlay","_shared_module_rte_well_content_inline_image_markup","_shared_module_rte_well_content_inline_image_saved","mail-ui-enhancr-utils"]},"mail-rte-scroll-utils":{path:"mail/ui/mailcompose/rte/rte-scroll-utils_2_1761.js"},"mail-services-attach-io":{path:"compose_v3/services/AttachmentIO_2_1676.js",requires:["io","json-parse","json-stringify"]},"mail-services-calservice":{path:"compose_v3/services/CalService_54_10489.js",requires:["common-net-sessionmgr","mail-core-net-transport","mail-controller-reply-processor","common-utils","mail-core-net-policies-compose-policy","_shared_module_compose_calendarReply","mail-core-net-helpers-batch-request-helper","mail-models-serializers-draft-ref-att-serializer","mail-model-attachment"]},"mail-services-compose":{path:"compose_v3/services/Compose_2_2704.js",requires:["common-utils","json","json-parse","mail-core-net-policies-compose-policy","mail-core-net-transport","mail-models-serializers-draft-formdata-serializer","mail-models-serializers-draft-payloadpart-serializer","mail-core-net-helpers-batch-request-helper","mail-core-net-helpers-cascade-request-helper","mail-controller-conv-adapter","mail-models-serializers-draft-gdm-unserializer","mail-models-attachment-preprocessor","mail-controller-v3-converter","mail-models-serializers-draft-messageV3-unserializer","mail-controller-messages-ops","mail-services-response-serializer"]},"mail-services-flickrsdk":{path:"compose_v3/services/flickrsdk_5_3496.js"},"mail-services-hlfs":{path:"compose_v3/services/HLFS_2_303.js",requires:["common-net-sessionmgr","common-utils","json","io"]},"mail-services-message-service":{path:"mail/services/message-service_2_1563.js",requires:["mail-controller-messages"]},"mail-services-plugins":{path:"compose_v3/services/Plugins_54_10489.js",requires:["event-custom"]},"mail-services-response-serializer":{path:"compose_v3/services/ResponseSerializer_2_2256.js",requires:["common-utils","json","json-parse"]},"mail-services-tripod":{path:"compose_v3/services/TripodUploader_5_3496.js",requires:["mail-services-flickrsdk"]},"mail-services-v3":{path:"mail/services/v3_2_1676.js",requires:["io","mail-common-utils-settings"]},"mail-track":{path:"common/utils/track_2_2738.js",requires:["common-utils","mail-ui-folder-utils"]},"mail-ui-accounts":{path:"mail/ui/accounts/accounts_2_2643.js",requires:["common-utils","common-persist-user-data"]},"mail-ui-actions-marker":{path:"mail/ui/actions/marker_54_10489.js",requires:["comms-aop-tracer"]},"mail-ui-ad-feedback-dialog":{path:"mail/ui/darla/adFeedbackDialog_54_10489.js",requires:["mail-persist-meta-data","common-utils","comms-ui-dialog-base","_shared_module_offscreen_bin_modal_ad_feedback_rollup","modal_css"]},"mail-ui-ad-sponsored-feedback-dialog":{path:"mail/ui/moneyball/mbFeedback_54_10489.js",requires:["mail-persist-meta-data"
,"common-utils","comms-ui-dialog-base","modal_css","_shared_module_offscreen_bin_modal_mbFeedback"]},"mail-ui-ad-toolbar":{path:"mail/ui/ads/toolbar_5_1137.js",requires:["common-ui-toolbar-base"]},"mail-ui-ad-upsell-dialog":{path:"mail/ui/darla/adUpsellDialog_2_2986.js",requires:["mail-persist-meta-data","common-utils","comms-ui-dialog-base","_shared_module_offscreen_bin_modal_upsell_rollup","modal_css"]},"mail-ui-add-account":{path:"mail/ui/imap-in/add-account_2_2078.js",requires:["io","json","common-ui-notification-v2","minty_module_rough_seas_upsell_nf","common-utils","common-net-session","ymma-stats"]},"mail-ui-adfree-mail-dialog":{path:"mail/ui/darla/adFreeMailDialog_5_3710.js",requires:["common-utils","comms-ui-dialog-base","_shared_module_offscreen_bin_modal_adfree_rollup","_shared_module_offscreen_bin_modal_btn_remove_ads_bucket_rollup","_shared_module_offscreen_bin_modal_btn_manage_service_bucket_rollup","modal_css"]},"mail-ui-adfree-pricing":{path:"mail/ui/onboarding/adFreePricing_2_2380.js",requires:["mail-ui-onboarding","minty_module_offscreen_bin_callout_adfree","adfree_onboarding_css"]},"mail-ui-adfree-renewal":{path:"mail/ui/onboarding/adFreeRenewal_2_2523.js",requires:["mail-ui-onboarding"]},"mail-ui-ads-emptyfolder-video":{path:"mail/ui/ads/emptyfolder-video_2_2775.js",requires:["common-utils","escape","yui-throttle","mail-persist-meta-data","mail-ui-folder-utils","mail-ui-workspace-base","minty_module_video_emptyfolder_vd_rollup","mail-ui-video-channelVideoService","mail-common-utils-features","common-utils-page-visibility","common-ui-tabs-base","mail-ui-darla","emptyfolder-video_css"]},"mail-ui-ads-jtcService":{path:"mail/ui/ads/jtcService_2_2040.js",requires:["array-extras","json-parse","common-net-sessionmgr","common-utils"]},"mail-ui-ads-live-nation":{path:"mail/ui/ads/live-nation_5_1788.js",requires:["common-utils","common-net-sessionmgr","json-parse","escape","_shared_module_ad_live_nation","mail-common-utils-features","common-ui-tabs-base","live-nation_css","live-nation-ult"]},"mail-ui-ads-mobilizer":{path:"mail/ui/ads/mobilizer_2_2228.js",requires:["input-mask","jsonp","common-utils","querystring-stringify-simple","minty_module_ads_mobilizer","minty_module_ads_mobilizerpane","mail-persist-meta-data"]},"mail-ui-alert-ssa-account":{path:"mail/ui/onboarding/ssa-account-alert_2_2588.js",requires:["common-utils","mail-ui-onboarding","compromised-account-onboarding_css"]},"mail-ui-attachment-filetype":{path:"mail/ui/attachments/filetype_54_10489.js"},"mail-ui-authorview-v3":{path:"compose_v3/views/authorview-v3_2_1905.js",requires:["mail-controller-base","mail-controller-reply-processor","_shared_module_compose_title","mail-common-utils-features","mail-controller-compose-v3","mail-ui-folder-utils"]},"mail-ui-backbutton":{path:"mail/ui/workspace/backbutton_54_10529.js"},"mail-ui-basewidget":{path:"mail/ui/basewidget/basewidget_54_10489.js",requires:["common-ui-contentwidget"]},"mail-ui-boss":{path:"mail/ui/boss/boss_2_1676.js",requires:["event-hover","mail-common-utils-features","boss-ult"]},"mail-ui-boss-multitask":{path:"mail/ui/boss/multitask_2_1482.js",requires:["mail-ui-boss","minty_module_boss_preview_overlay","common-persist-cookie-data","escape","boss-multitask_css","mail-common-utils-features"]},"mail-ui-boss-screensaver":{path:"mail/ui/boss/screensaver_2_1676.js",requires:["mail-ui-boss","boss-extras_css"]},"mail-ui-boss-screensaver-console":{path:"mail/ui/boss/screensaver-console_54_10489.js",requires:["mail-ui-boss-themes","mail-ui-boss-screensaver"]},"mail-ui-boss-screensaver-halloween":{path:"mail/ui/boss/screensaver-halloween_54_10489.js",requires:["mail-ui-boss-screensaver-photos"]},"mail-ui-boss-screensaver-photos":{path:"mail/ui/boss/screensaver-photos_54_10489.js",requires:["overlay","mail-ui-boss-themes","mail-ui-boss-screensaver"]},"mail-ui-boss-themes":{path:"mail/ui/boss/themes_5_3147.js",requires:["overlay","minty_module_boss_themes_strip","mail-ui-themes-cfg","boss-themes_css","mail-ui-smarttop-theme-info"]},"mail-ui-breakingnews":{path:"mail/ui/breakingnews/breakingnews_2_2671.js",requires:["common-net-sessionmgr","mail-persist-meta-data"]},"mail-ui-button-ctxt":{path:"mail/ui/buttonctxt/buttonctxt_5_3103.js",requires:["common-ui-toolbar-base","mail-common-utils-features"]},"mail-ui-captcha-controller":{path:"mail/ui/captcha/controller_54_10489.js",requires:["common-utils","captcha_css","comms-ui-dialog-base","common-ui-dialog-helper","mail-ui-captcha-view"]},"mail-ui-captcha-view":{path:"mail/ui/captcha/view_54_10489.js",requires:["captcha_css","_shared_module_send_confirm_captcha","_shared_module_send_confirm_captcha_blocked"]},"mail-ui-carouselads-read":{path:"mail/ui/ads/carouselAdsRead_2_1783.js",requires:["mail-ui-nativeads-read"]},"mail-ui-chrome-dss-ext":{path:"mail/ui/ads/chromedssext_54_10489.js",requires:["mail-persist-meta-data","common-utils","minty_module_ads_chrome_dss_ext"]},"mail-ui-common-string-utils":{path:"mail/ui/common/stringUtils_5_2399.js",requires:["common-utils","mail-ui-folder-utils"]},"mail-ui-composetictacapi":{path:"compose_v3/views/ComposeTictacApi_2_2956.js",requires:["event-custom","common-ui-menu-helper","mail-services-plugins","mail-controller-reply-processor","mail-common-utils-features","mail-ui-onboarding-richcompose"]},"mail-ui-composeview-compose-loader":{path:"mail/ui/composeview/compose-loader_2_700.js",requires:["mail-platform","common-utils","common-utils-stats","mail-services-message-service","mail-common-utils-features"]},"mail-ui-composeview-spellcheck-v3":{path:"compose_v3/views/compose-spellcheck-v3_2_2685.js",requires:["node","plugin","mail-controller-spell-processor","mail-models-draft","mail-model-spellcorrections","comms-ui-menu-base","common-ui-menu-helper","_shared_module_offscreen_bin_compose_menu_spell_langs"]},"mail-ui-confirmation-dialog":{path:"mail/ui/confirmation/confirmation-dialog_2_2804.js",requires:["common-utils","minty_module_confirmation_dialog"]},"mail-ui-contentmatch-controller"
:{path:"mail/ui/contentmatch/Controller_54_10489.js",requires:["mail-ui-searchads-cap","array-extras","mail-ui-contentmatch-model","mail-ui-contentmatch-text-ads-view"]},"mail-ui-contentmatch-d2s":{path:"mail/ui/contentmatch/d2s/d2s_54_10489.js",requires:["mail-ui-messagekeywords"]},"mail-ui-contentmatch-model":{path:"mail/ui/contentmatch/Model_54_10489.js",requires:["io","datatype-xml","mail-services-v3"]},"mail-ui-contentmatch-text-ads-view":{path:"mail/ui/contentmatch/textAdsView_54_10489.js",requires:["common-utils","minty_module_shell_ad_searchads"]},"mail-ui-conv-maillist-model":{path:"mail/ui/maillist/conv/conv-maillistmodel_2_1773.js",requires:["common-ui-conv-listview"]},"mail-ui-conv-maillist-view":{path:"mail/ui/maillist/conv/conv-maillistview_5_2857.js",requires:["common-ui-conv-listview","common-utils"]},"mail-ui-convevents":{path:"mail/ui/mailview/conv/convevents_2_2570.js",requires:["mail-controller-conversations","contacts-api-utils","mail-controller-conversations-ops","mail-model-convstore","mail-ui-mailevents","mail-common-utils-features","mail-ui-folder-utils"]},"mail-ui-convlist-base":{path:"mail/ui/maillist/conv/convlist_2_2701.js",requires:["mail-ui-maillist","mail-ui-common-string-utils","mail-ui-conv-maillist-model","mail-ui-conv-maillist-view","mail-controller-conversations","mail-controller-imapin","mail-common-utils-features","mail-persist-meta-data","mail-ui-listview-controls","common-utils","mail-ui-folder-utils"]},"mail-ui-convpane-base":{path:"mail/ui/mailpane/conv/convpane_2_1976.js",requires:["_shared_module_thread_thread_pane","common-utils","mail-model-datastore","mail-controller-messages","mail-controller-conversations","mail-ui-mailpane-base","mail-persist-meta-data","common-utils-stats","mail-ui-messagepane-utils","mail-model-convstore","mail-ui-folder-utils"]},"mail-ui-convpane-bind":{path:"mail/ui/mailpane/conv/bind_54_10489.js"},"mail-ui-convpane-error":{path:"mail/ui/mailpane/conv/error_5_2396.js",requires:["common-utils","_shared_module_thread_thread_display_rollup","mail-ui-pane-utils","mail-ui-folder-utils"]},"mail-ui-convpane-next-prev":{path:"mail/ui/mailpane/conv/convnextprevious_2_2057.js",requires:["mail-ui-common-string-utils","mail-ui-convpane-base","mail-ui-mailpane-next-prev","mail-model-convstore","mail-controller-conversations","common-utils","common-utils-stats","mail-ui-folder-utils"]},"mail-ui-convpane-read":{path:"mail/ui/mailpane/conv/convpaneread_2_2861.js",requires:["_shared_module_thread_thread_display_rollup","common-persist-user-data","common-ui-tabs-base","common-utils-stats","contacts-api","contacts-api-utils","mail-persist-meta-data","mail-platform","mail-ui-convpane-base","mail-ui-convpane-bind","mail-ui-mailpane-read","mail-ui-messagepane-utils","mail-ui-messagepane-warnings","mod-conversation-history_css","mail-common-utils-features","mail-common-utils-settings","mail-ui-pane-utils","common-utils","mail-ui-folder-utils","mail-ui-deeplink-manager"]},"mail-ui-convs-confirm-dialog":{path:"mail/ui/maillist/tutorial/convsConfirmDialog_54_10489.js",requires:["mail-persist-meta-data","common-utils","comms-ui-dialog-base","minty_module_conversations_modal_convs_confirm_rollup","modal_css"]},"mail-ui-convview-base":{path:"mail/ui/mailview/conv/convview_2_2701.js",requires:["common-ui-contentwidget","common-ui-toolbar-base","mail-ui-mailview-base","mail-ui-convlist-base","mail-ui-convpane-base","minty_module_toolbar_inbox_default_thread_rollup","dom-screen","mail-ui-common-string-utils","mail-common-utils-features","mail-common-utils-settings","common-utils","mail-ui-folder-utils"]},"mail-ui-coupons-tracking-option":{path:"mail/ui/expiringcoupons/trackingOptions_2_2605.js",requires:["mail-common-utils-features","common-utils","mail-model-couponstore","common-ui-notification-v2"]},"mail-ui-darla":{path:"mail/ui/darla/neodarla_2_2775.js",requires:["node-base","darla-base","common-utils","common-persist-cookie-data","mail-common-utils-features","mail-common-utils-settings","mail-track","minty_module_ads_spritz_leave_behind"]},"mail-ui-deeplink-manager":{path:"mail/ui/mailpanedeeplink/deeplinkmanager_2_2031.js"},"mail-ui-desktop-notifications":{path:"mail/ui/desktopnotifications/desktopnotifications_2_2025.js",requires:["node","mail-persist-meta-data","common-utils"]},"mail-ui-desktop-notifications-mail":{path:"mail/ui/desktopnotifications/mail-desktopnotifications_2_2830.js",requires:["mail-ui-desktop-notifications","cookie","comms-utils","common-utils","xobni-utilities","mail-ui-folder-utils","ymma-stats","mail-persist-meta-data","mail-controller-v3-user-settings"]},"mail-ui-dmsearch-controller":{path:"mail/ui/dmsearch/dmsearchController_2_1723.js",requires:["event-base","mail-ui-dmsearch-view","mail-ui-sponsoredsearch-model","mail-ui-dmsearch-model","mail-common-utils-features"]},"mail-ui-dmsearch-model":{path:"mail/ui/dmsearch/dmsearchModel_2_1723.js",requires:["common-net-sessionmgr","mail-common-utils-settings"]},"mail-ui-dmsearch-view":{path:"mail/ui/dmsearch/dmsearchView_2_1723.js",requires:["node-base","node-event-delegate","attribute-base","event-base","minty_module_list_view_ad_search","minty_module_list_view_ad_skysearch","minty_module_list_view_ad_mas_search","minty_module_shell_ad_searchads","minty_module_list_view_ad_buckets_serp_ratings","mail-common-utils-features"]},"mail-ui-enhancr":{path:"mail/ui/enhancr/enhancr_2_1239.js",requires:["transition","mail-ui-enhancr-utils","mail-persist-meta-data","mail-ui-share-menu"]},"mail-ui-enhancr-utils":{path:"mail/ui/enhancr/utils_2_1676.js",requires:["json","mail-common-utils-settings","mail-common-utils-features","mail-persist-meta-data","common-utils"]},"mail-ui-expiring-coupons":{path:"mail/ui/expiringcoupons/expiring-coupons_2_2706.js",requires:["mail-common-utils-features","common-utils","mail-model-couponstore","minty_module_expiring_coupons","minty_module_expiring_coupon_item"]},"mail-ui-factory-base":{path:"mail/ui/factory/factory_54_10489.js"},"mail-ui-favicon-notify"
:{path:"mail/ui/desktopnotifications/favicon-notify_2_1574.js",requires:["common-utils","mail-common-utils-features","mail-ui-foldersview-base","mail-ui-folder-utils"]},"mail-ui-flow-recorder":{path:"mail/debug/flow-recorder_5_1913.js",requires:["mail-ui-recorder","common-utils-rapid","mail-common-utils-features","mail-common-utils-settings"]},"mail-ui-folder-menu":{path:"mail/ui/foldersview/folder-menu_5_2481.js",requires:["_shared_module_offscreen_bin_menus_folder_menu","common-utils","mail-ui-folder-utils","folder-menu_css","node-event-simulate","mail-controller-folders","folder-menu-ult"]},"mail-ui-folder-state":{path:"mail/ui/foldersview/folder-state_5_2529.js",requires:["mail-controller-imapin"]},"mail-ui-folder-utils":{path:"mail/ui/foldersview/folder-utils_2_906.js",requires:["common-utils","mail-common-utils-features","mail-model-datastore"]},"mail-ui-folderevents":{path:"mail/ui/foldersview/folderevents_2_1620.js",requires:["common-utils","mail-controller-folders","common-ui-dialog-helper","comms-bidi-textentry","mail-common-utils-features","mail-common-utils-settings","mail-model-datastore","mail-ui-folder-utils","mail-controller-folders"]},"mail-ui-foldersview-base":{path:"mail/ui/foldersview/foldersview_2_3008.js",requires:["io-base","yui-throttle","common-utils","mail-controller-folders","attribute","node","mail-persist-meta-data","common-persist-user-data","mail-ui-accounts","common-ui-tabs-base","mail-common-utils-features","node-event-simulate","node-focusmanager","mail-model-datastore","mail-ui-folder-utils"]},"mail-ui-foldersview-bind":{path:"mail/ui/foldersview/bind_2_2701.js",requires:["mail-controller-folders","mail-persist-meta-data","mail-ui-folder-utils","mail-common-utils-features"]},"mail-ui-fullcompose-v3":{path:"compose_v3/views/composeview-v3_2_2958.js",requires:["mail-ui-mailcompose-v3","mail-ui-messagepane-utils","attachments-fresh_css","mail-ui-tray","escape","mail-common-utils-features","node","stylesheet","mail-controller-reply-processor","mail-controller-signature-processor","mail-controller-html-processor","common-persist-user-data","mail-models-draft","contacts-api-utils","contacts-api","filter-contacts","plugin","comms-bidi-textentry","comms-editor-autobidi","comms-intl-bidi","editor-bidi","_shared_module_compose_fresh_conv","_shared_module_toolbar_compose_fresh","_shared_module_compose_loading","_shared_module_offscreen_bin_compose","_shared_module_offscreen_bin_compose_menu_spellcheck","_shared_module_offscreen_bin_compose_modal_cancel_compose","_shared_module_rte_well_content_format_fresh","_shared_module_rte_well_content_emoticons_fresh","_shared_module_rte_well_content_fontnamesize_fresh","_shared_module_compose_template_retrieve","_shared_module_rte_well_content_attachments_fresh","_shared_module_rte_well_tabs_compose_fresh","_shared_module_offscreen_bin_notification_notifications","_shared_module_compose_dropzone","common-ui-toolbar-base","common-ui-menu-helper","_shared_module_offscreen_bin_compose_menu_list","_shared_module_offscreen_bin_compose_menu_text_align","_shared_module_offscreen_bin_compose_menu_indent","mail-views-send-validation-error-handlers","mail-ui-composetictacapi","rte-file-utils","mail-ui-signature-tweet-view","common-utils-performance","mail-ui-folder-utils","mail-persist-meta-data","mail-controller-v3-user-settings"]},"mail-ui-geminivideo-ads":{path:"mail/ui/ads/geminiVideoAds_2_2979.js",requires:["common-utils","mail-ui-nativeads-read","mail-ui-vd-controller","mail-track"]},"mail-ui-greylist":{path:"mail/ui/greylist/greylist_5_982.js",requires:["ymma-stats"]},"mail-ui-header":{path:"mail/ui/header/header_2_2841.js",requires:["node","mail-ui-header-base","mail-ui-header-utils","common-utils","common-persist-user-data"]},"mail-ui-header-base":{path:"mail/ui/header/header_base_54_10489.js"},"mail-ui-header-roughseas":{path:"mail/ui/header/header-roughseas_54_10489.js",requires:["common-utils"]},"mail-ui-header-utils":{path:"mail/ui/header/headerUtils_2_2986.js",requires:["common-utils","common-persist-user-data","mail-common-utils-settings","common-utils-performance"]},"mail-ui-heartbeat":{path:"mail/ui/heartbeat/heartbeat_2_1653.js",requires:["ymma-stats","mail-common-utils-features"]},"mail-ui-imap-in":{path:"mail/ui/imap-in/imap-in_2_2639.js",requires:["common-utils","mail-controller-imapin","mail-ui-foldersview-base","mail-model-datastore","mail-ui-folder-utils","mail-common-utils-features","mail-ui-onboarding","mail-persist-meta-data","mail-common-utils-settings","common-ui-notification-v2","_shared_module_imap_in_send_only","_shared_module_imap_in_alter"]},"mail-ui-inboxmenu-base":{path:"mail/ui/inboxmenu/inboxmenu_2_2316.js",requires:["common-utils","mail-ui-folder-utils","mail-ui-foldersview-base","mail-common-utils-features","mail-controller-imapin"]},"mail-ui-inhelp":{path:"mail/ui/inhelp/in-product-help_2_1837.js",requires:["yhelp-bootstrap"]},"mail-ui-keytaskpanel-configmap":{path:"mail/ui/keytaskpanel/configMap_2_2830.js",requires:["common-utils","mail-ui-keytaskpanel-panelview","mail-ui-keytaskpanel-ult"]},"mail-ui-keytaskpanel-panelview":{path:"mail/ui/keytaskpanel/panelview_2_2830.js",requires:["common-utils","mail-persist-meta-data","mail-ui-keytaskpanel-ult","mail-ui-keytaskpanel-configmap","tictac-onboarding","minty_module_key_task_panel"]},"mail-ui-keytaskpanel-ult":{path:"mail/ui/keytaskpanel/panelUlt_2_2410.js",requires:["common-utils-rapid-clickmap","common-utils-rapid-viewmap"]},"mail-ui-light-document-preview-fullscreenslideshow":{path:"mail/ui/lightdocpreview/fullscreen_slideshow_5_3515.js",requires:["_shared_module_fullscreen_slideshow","comms-utils"]},"mail-ui-light-document-preview-helper":{path:"mail/ui/lightdocpreview/attachment_helpers_2_2785.js",requires:["common-utils","mail-common-utils-features"]},"mail-ui-lightdocpreview-constants":{path:"mail/ui/lightdocpreview/lightdocpreview_constants_5_3334.js"},"mail-ui-lightdocpreview-controller":{path:"mail/ui/lightdocpreview/lightdocpreview_controller_5_3334.js"
,requires:["event-base","mail-ui-lightdocpreview-constants","mail-ui-light-document-preview-helper","mail-ui-lightdocpreview-document-iterator","mail-ui-light-document-preview-fullscreenslideshow"]},"mail-ui-lightdocpreview-document-iterator":{path:"mail/ui/lightdocpreview/document_iterator_5_3334.js",requires:["mail-ui-lightdocpreview-constants","mail-ui-light-document-preview-helper"]},"mail-ui-list-item-editor":{path:"mail/ui/actions/list-item-editor_2_1494.js",requires:["common-utils","comms-bidi-textentry","mail-common-utils-features","mail-ui-folder-utils","_shared_module_offscreen_bin_renamer","_shared_module_offscreen_bin_searcher","_shared_module_offscreen_bin_tooltip_validation","list-item-editor_css","escape","overlay"]},"mail-ui-listview-controls":{path:"mail/ui/maillist/base/listview-controls_2_1075.js",requires:["mail-ui-folder-utils"]},"mail-ui-location-model":{path:"mail/ui/location/locationModel_2_1091.js",requires:["io","common-net-sessionmgr","common-utils","event-base"]},"mail-ui-log":{path:"mail/debug/maillog_2_627.js",requires:["ymma-stats","comms-log4js","common-utils","mail-common-utils-features"]},"mail-ui-log-events":{path:"mail/debug/maillog-events_2_2538.js",requires:["mail-ui-log","common-utils-net-queue","mail-common-utils-features"]},"mail-ui-mail-helper":{path:"mail/ui/mailhelper_2_2995.js",requires:["common-utils","mail-ui-folder-utils"]},"mail-ui-mailcompose-base-header-v3":{path:"compose_v3/views/ComposeHeader-v3_2_2132.js",requires:["comms-ui-lozenge","ac-widget","_shared_module_offscreen_bin_compose","mail-controller-reply-processor","_shared_module_offscreen_bin_notification_notifications","mail-controller-compose-text","contacts-api","_shared_module_compose_message_header_fresh","mail-models-validators-send","mail-ui-basewidget","mail-common-utils-features","mail-ui-mailcompose-header-form-list-helper","mail-model-datastore","mail-common-utils-settings","mail-ui-pane-utils"]},"mail-ui-mailcompose-header-form-list-helper":{path:"compose_v3/controllers/FromListHelper_2_2925.js",requires:["comms-utils","mail-controller-imapin","common-persist-user-data","mail-common-utils-features","mail-persist-meta-data","mail-ui-folder-utils","mail-model-datastore"]},"mail-ui-mailcompose-templates":{path:"compose_v3/views/composeTemplates_2_2650.js",requires:["common-ui-dialog-helper","mail-common-utils-features","mail-common-utils-settings","mail-controller-compose-text","_shared_module_offscreen_bin_save_templates","_shared_module_offscreen_bin_change_template","_shared_module_compose_template_retrieve","common-ui-dialog-helper","compose-template-dialog_css","mail-ui-onboarding"]},"mail-ui-mailcompose-v3":{path:"compose_v3/views/mailcompose-v3_2_2603.js",requires:["autocomplete_css","common-persist-user-data","mail-persist-meta-data","mail-controller-messages","mail-model-datastore","mail-controller-reply-processor","_shared_module_compose_message_header_fresh","mail-ui-mailcompose-base-header-v3","comms-utils","mail-ui-basewidget","editor-inline","mail-services-message-service","mail-error-v3","mail-common-utils-features","mail-common-utils-settings","mail-ui-folder-utils"]},"mail-ui-mailevents":{path:"mail/ui/mailview/base/mailevents_2_2806.js",requires:["mail-controller-messages","mail-controller-messages-ops","common-utils","common-ui-tabs-base","mail-model-datastore","comms-utils","_shared_module_offscreen_bin_notification_notifications","common-ui-notification","querystring-parse","mail-common-utils-features","mail-ui-unsubscribe","mail-ui-folder-utils","mail-common-utils-settings","mail-persist-meta-data","mail-core-net-helpers-v3-request-helper"]},"mail-ui-maillist":{path:"mail/ui/maillist/base/maillist_2_2775.js",requires:["common-ui-contentwidget","mail-controller-folders","common-persist-user-data","mail-ui-accounts","mail-model-datastore","io","event-valuechange","mail-common-utils-features","mail-ui-folder-utils","mail-model-liststore"]},"mail-ui-maillist-listview":{path:"mail/ui/maillist/base/maillist-listview_54_10489.js",requires:["plugin","mail-ui-messagelist-base"]},"mail-ui-maillist-model":{path:"mail/ui/maillist/base/maillistmodel_2_2097.js",requires:["common-ui-listview"]},"mail-ui-maillist-view":{path:"mail/ui/maillist/base/maillistview_5_1752.js",requires:["common-ui-listview","common-utils"]},"mail-ui-mailmarkup-base":{path:"mail/ui/mailview/base/markup_54_10489.js",requires:["node"]},"mail-ui-mailoptions-ult":{path:"mail/ui/mailoptions/mailoptions-ult_2_1716.js",requires:["common-utils-rapid-clickmap"]},"mail-ui-mailpane-base":{path:"mail/ui/mailpane/base/mailpane_2_2753.js",requires:["common-utils","mail-model-datastore","mail-controller-messages","mail-ui-basewidget","mail-persist-meta-data","common-utils-stats","mail-ui-messagepane-utils"]},"mail-ui-mailpane-next-prev":{path:"mail/ui/mailpane/base/mailnextprevious_54_10489.js",requires:["mail-ui-common-string-utils","common-utils","common-utils-stats"]},"mail-ui-mailpane-read":{path:"mail/ui/mailpane/base/mailread_2_2738.js",requires:["mail-ui-common-string-utils","common-utils","common-utils-stats","mail-controller-base"]},"mail-ui-mailuibind-base":{path:"mail/ui/mailview/base/uibind_54_10489.js",requires:["node"]},"mail-ui-mailview-base":{path:"mail/ui/mailview/base/mailview_2_2728.js",requires:["mail-ui-basewidget","common-persist-user-data","mail-ui-messagepane-utils","mail-model-datastore","common-utils","mail-common-utils-features","mail-ui-pane-utils","mail-ui-folder-utils","mail-core-net-helpers-v3-request-helper","mail-persist-meta-data"]},"mail-ui-maintenancenotification":{path:"mail/ui/maintenancenotification/maintenancenotification_5_2093.js",requires:["common-ui-notification"]},"mail-ui-mb-controller":{path:"mail/ui/moneyball/mbController_2_2977.js",requires:["mail-ui-mb-list-view","mail-ui-mb-search-list-view","mail-ui-mb-list-img-view","mail-common-utils-features","mail-ui-mb-list-native-view"]},"mail-ui-mb-feedback-view":{path:"mail/ui/moneyball/mbFeedbackView_2_2982.js",
requires:["node","mail-ui-mb-view","common-utils","mail-common-utils-settings"]},"mail-ui-mb-list-img-view":{path:"mail/ui/moneyball/mbListImgView_2_2982.js",requires:["mail-ui-mb-list-view","mail-common-utils-features","minty_module_list_view_ad_buckets_mb_list_img","_shared_module_offscreen_bin_modal_subscriptionad"]},"mail-ui-mb-list-native-view":{path:"mail/ui/moneyball/mbListNativeView_2_2995.js",requires:["mail-ui-mb-list-view","minty_module_list_view_ad_mb_native","minty_module_ads_native_ad_forward","minty_module_list_view_ad_buckets_mb_right_rail_save_ad","minty_module_list_view_ad_mb_native_sponsored_img","minty_module_list_view_ad_mb_native_sponsored_video","minty_module_list_view_ad_mb_native_sponsored_leadsgen","minty_module_list_view_ad_mb_native_sponsored_carousel","minty_module_offscreen_bin_native_ad_callout","minty_module_offscreen_bin_native_ad_star","mail-ui-onboarding","mail-common-utils-features","mail-common-utils-settings","_shared_module_offscreen_bin_notification_native_ad_star","mail-ui-mail-helper","common-ui-tabs-base","common-net-sessionmgr","mail-ui-nativeads-read","mail-ui-carouselads-read","mail-ui-geminivideo-ads","_shared_module_offscreen_bin_modal_subscriptionad"]},"mail-ui-mb-list-view":{path:"mail/ui/moneyball/mbListView_2_2592.js",requires:["mail-ui-mb-view","minty_module_list_view_ad_mb","minty_module_list_view_ad_mb_native","minty_module_list_view_ad_mb_native_vert_prev","minty_module_list_view_ad_mb_native_img_link","mail-common-utils-features"]},"mail-ui-mb-model":{path:"mail/ui/moneyball/mbModel_2_2977.js",requires:["common-net-sessionmgr","common-utils","event-base","mail-common-utils-features","mail-common-utils-settings","common-utils-jsonparse"]},"mail-ui-mb-msg-read-view":{path:"mail/ui/moneyball/mbMsgReadView_54_10489.js",requires:["mail-ui-mb-view","minty_module_moneyball_msg_read_img"]},"mail-ui-mb-rec-view":{path:"mail/ui/moneyball/mbRecView_54_10489.js",requires:["event-resize","mail-ui-mb-view","minty_module_list_view_ad_mbrec"]},"mail-ui-mb-right-rail-carousel-view":{path:"mail/ui/moneyball/mbRightRailCarouselView_2_1611.js",requires:["array-extras","common-utils","mail-ui-mb-right-rail-view","minty_module_moneyball_right_rail","minty_module_moneyball_right_rail_carousel","minty_module_list_view_ad_buckets_mb_right_rail_save_ad"]},"mail-ui-mb-right-rail-view":{path:"mail/ui/moneyball/mbRightRailView_54_10489.js",requires:["array-extras","common-utils","event-resize","mail-ui-mb-view","minty_module_moneyball_right_rail"]},"mail-ui-mb-search-list-view":{path:"mail/ui/moneyball/mbSearchListView_54_10489.js",requires:["mail-ui-mb-view","minty_module_list_view_ad_mb"]},"mail-ui-mb-view":{path:"mail/ui/moneyball/mbView_2_2977.js",requires:["node","mail-ui-mb-model","common-utils","node-event-delegate"]},"mail-ui-message-encodings":{path:"mail/ui/messagesview/message-encodings_2_1503.js",requires:["common-utils"]},"mail-ui-message-timedalertdialog":{path:"mail/ui/messagesview/message-timedalertdialogs_54_10489.js",requires:["mail-modules","mail-templates","common-utils","common-ui-dialog-helper"]},"mail-ui-messagecategories":{path:"mail/ui/messagecategories/messagecategories_54_10489.js",requires:["array-extras","mail-ui-messagecategories-vespa"]},"mail-ui-messagecategories-vespa":{path:"mail/ui/messagecategories/vespa_5_2689.js",requires:["array-extras","json-parse","common-net-sessionmgr"]},"mail-ui-messageevents":{path:"mail/ui/mailview/message/messageevents_2_2570.js",requires:["mail-controller-messages","mail-controller-messages-ops","mail-model-datastore","mail-ui-mailevents","mail-common-utils-features","mail-ui-folder-utils"]},"mail-ui-messagekeywords":{path:"mail/ui/messagekeywords/messagekeywords_54_10489.js",requires:["mail-ui-searchads-cap","array-extras"]},"mail-ui-messagelist-base":{path:"mail/ui/maillist/message/messagelist_2_2701.js",requires:["mail-ui-maillist","mail-ui-maillist-model","mail-ui-maillist-view","mail-controller-messages","mail-controller-imapin","mail-common-utils-features","mail-ui-listview-controls","mail-ui-maillist-listview","mail-ui-pane-utils"]},"mail-ui-messagepane-base":{path:"mail/ui/mailpane/message/messagepane_2_2477.js",requires:["common-utils","mail-model-datastore","mail-controller-messages","mail-ui-mailpane-base","mail-persist-meta-data","common-utils-stats","mail-ui-messagepane-utils","mail-ui-folder-utils"]},"mail-ui-messagepane-bind":{path:"mail/ui/mailpane/message/bind_2_2701.js"},"mail-ui-messagepane-error":{path:"mail/ui/mailpane/message/error_2_711.js",requires:["common-utils","_shared_module_message_display_fresh_rollup","mail-ui-folder-utils"]},"mail-ui-messagepane-next-prev":{path:"mail/ui/mailpane/message/nextprevious_2_2855.js",requires:["mail-ui-common-string-utils","mail-ui-messagepane-base","mail-ui-mailpane-next-prev","mail-model-datastore","mail-controller-messages","common-utils","common-utils-stats","mail-ui-folder-utils"]},"mail-ui-messagepane-read":{path:"mail/ui/mailpane/message/messagepaneread_2_2667.js",requires:["common-persist-user-data","mail-persist-meta-data","mail-ui-messagepane-warnings","mail-ui-mailpane-read","mail-ui-pane-utils","contacts-api","contacts-api-utils","common-utils-stats","mail-ui-messagepane-utils","mod-conversation-history_css","mail-ui-attachment-filetype","common-ui-tabs-base","mail-common-utils-settings","ymma-stats","mail-ui-deeplink-manager"]},"mail-ui-messagepane-utils":{path:"mail/ui/messagepane/utils_2_2154.js",requires:["common-utils-stats","mail-ui-messagepane-utils-shared","mail-ui-folder-utils"]},"mail-ui-messagepane-utils-shared":{path:"mail/ui/messagepane/shared_2_1816.js"},"mail-ui-messagepane-warnings":{path:"mail/ui/messagepane/warnings_2_660.js",requires:["common-utils"]},"mail-ui-messagesview-base":{path:"mail/ui/mailview/message/messagesview_2_2701.js",requires:["common-ui-contentwidget","common-ui-toolbar-base","mail-ui-mailview-base","mail-ui-messagelist-base","mail-ui-messagepane-base","dom-screen","mail-ui-common-string-utils"
,"mail-common-utils-features","_shared_module_message_pane_fresh","common-utils","mail-ui-folder-utils"]},"mail-ui-messagesview-dd":{path:"mail/ui/messagesview/messagesview-dd_5_2403.js",requires:["mail-model-datastore","common-utils","node-base","common-ui-dd","_shared_module_offscreen_bin_drag_drop","mail-ui-folder-utils"]},"mail-ui-messagesview-quickfilter":{path:"mail/ui/messagesview/quickfilter_2_2804.js",requires:["common-utils","common-persist-user-data","mail-controller-folders","_shared_module_offscreen_bin_modal_quick_filters","common-ui-dialog-helper","mail-controller-messages-ops","common-net-session","mail-model-datastore","mail-common-utils-features","mail-common-utils-settings","mail-ui-folder-utils"]},"mail-ui-messagesview-resize":{path:"mail/ui/messagesview/messagesview-resize_54_10489.js",requires:["common-persist-cookie-data","stylesheet","node","common-ui-dd","common-persist-user-data","mail-common-utils-features"]},"mail-ui-messagesview-vertical":{path:"mail/ui/messagesview/vertical_5_2396.js",requires:["mail-ui-messagesview-resize"]},"mail-ui-messenger":{path:"mail/ui/messenger/messenger_54_10489.js",requires:["common-utils","swfdetect"]},"mail-ui-nativeads-read":{path:"mail/ui/ads/nativeAdsRead_2_2862.js",requires:["mail-ui-basewidget","_shared_module_ads_display","common-ui-toolbar-base","common-persist-user-data","mail-ui-ad-toolbar","minty_module_toolbar_fragments_native_ad_group_rollup","mail-ui-onboarding"]},"mail-ui-navkeys":{path:"mail/ui/navkeys/navkeys_2_2129.js",requires:["mail-controller-folders","event-custom-complex","mail-common-utils-features"]},"mail-ui-newsfeed-controller":{path:"mail/ui/newsfeed/newsFeedController_5_2523.js",requires:["common-utils","event-base","mail-ui-newsfeed-view","mail-ui-weather-view","mail-ui-weather-controller","io","minty_module_newsfeed_filterbar_weather"]},"mail-ui-newsfeed-model":{path:"mail/ui/newsfeed/newsFeedModel_2_1676.js",requires:["common-net-sessionmgr","common-utils","event-base","mail-ui-newsfeed-slingstone"]},"mail-ui-newsfeed-slingstone":{path:"mail/ui/newsfeed/slingstone_2_2405.js",requires:["array-extras","json-parse","common-net-sessionmgr","common-utils"]},"mail-ui-newsfeed-view":{path:"mail/ui/newsfeed/newsFeedView_2_2321.js",requires:["mail-ui-newsfeed-model","common-utils","common-ui-tabs-base","mail-ui-mb-model","minty_module_newsfeed_listview","minty_module_newsfeed_filterbar","minty_module_moneyball_newsfeed_mb","minty_module_newsfeed_storyview","mail-ui-basewidget","mail-ui-trending-controller","datatype-date","minty_module_list_view_ad_buckets_newsfeed_save_ad","newsfeed-ult","mail-common-utils-features","mail-ui-mail-helper","mail-common-utils-settings"]},"mail-ui-norrin-upsell-takeover":{path:"mail/ui/onboarding/norrin-upsell-takeover_2_2621.js",requires:["common-utils","mail-ui-onboarding","norrin-upsell-takeover_css","minty_module_offscreen_bin_norrin_upsell_takeover"]},"mail-ui-onboarding":{path:"mail/ui/onboarding/onboarding_2_2621.js",requires:["common-utils","json-parse","node-event-simulate","onboarding_css"]},"mail-ui-onboarding-archive":{path:"mail/ui/onboarding/mail-archive-onboarding_2_533.js",requires:["mail-ui-onboarding"]},"mail-ui-onboarding-calloutlist-model":{path:"mail/ui/onboarding/calloutlist-model_2_1071.js",requires:["common-utils"]},"mail-ui-onboarding-compromised-account":{path:"mail/ui/onboarding/compromised-account_2_245.js",requires:["common-utils","mail-ui-onboarding","compromised-account-onboarding_css"]},"mail-ui-onboarding-configmap":{path:"mail/ui/onboarding/configMap_2_3008.js",requires:["common-utils","mail-common-utils-settings"]},"mail-ui-onboarding-coupons-feedback":{path:"mail/ui/expiringcoupons/callout-feedback_2_2706.js",requires:["mail-ui-onboarding"]},"mail-ui-onboarding-coupons-list":{path:"mail/ui/expiringcoupons/callout-list_2_2380.js",requires:["mail-ui-onboarding"]},"mail-ui-onboarding-coupons-restore":{path:"mail/ui/expiringcoupons/callout-restore_2_2341.js",requires:["mail-ui-onboarding"]},"mail-ui-onboarding-coupons-tracking":{path:"mail/ui/expiringcoupons/callout-tracking_2_2402.js",requires:["mail-ui-onboarding"]},"mail-ui-onboarding-desktop-notification":{path:"mail/ui/onboarding/mail-desktop-notification-onboarding_2_2492.js",requires:["common-utils","mail-ui-desktop-notifications","mail-ui-onboarding","mail-desktop-notification-onboarding_css","minty_module_offscreen_bin_notification_screen_overlay"]},"mail-ui-onboarding-dispatcher":{path:"mail/ui/onboarding/dispatcher_2_2552.js",requires:["common-ui-tabs-base","mail-common-utils-features","mail-common-utils-settings","mail-ui-onboarding","mail-ui-onboarding-configmap","mail-ui-onboarding-calloutlist-model","mail-persist-meta-data","mail-ui-foldersview-base","mail-ui-folder-utils"]},"mail-ui-onboarding-enhancr":{path:"mail/ui/onboarding/enhancr_2_981.js",requires:["common-utils","mail-persist-meta-data","mail-ui-onboarding","mail-ui-onboarding-spotlight","mail-ui-enhancr-utils","_shared_module_compose_autocompose_enhancr_onboard"]},"mail-ui-onboarding-holiday-themes":{path:"mail/ui/onboarding/holiday-themes_54_10489.js",requires:["common-utils","mail-ui-onboarding","minty_module_offscreen_bin_holiday_themes_callout"]},"mail-ui-onboarding-imap-in":{path:"mail/ui/onboarding/imap-in_2_2723.js",requires:["common-utils","mail-ui-onboarding","imap-in-onboarding_css","mail-common-utils-features","mail-common-utils-settings","mail-ui-onboarding-imap-in-ult","common-net-sessionmgr","querystring-stringify-simple"]},"mail-ui-onboarding-imap-in-ult":{path:"mail/ui/onboarding/imap-in-ult_2_2723.js",requires:["common-utils-rapid-clickmap","common-utils-rapid-viewmap"]},"mail-ui-onboarding-imap-in-upsell":{path:"mail/ui/onboarding/imap-in-upsell_2_1182.js",requires:["common-utils","mail-ui-onboarding","mail-common-utils-settings","mail-persist-meta-data","mail-ui-imap-in"]},"mail-ui-onboarding-mobile-upsell-generic":{path:"mail/ui/onboarding/mobile-upsell-generic_2_2830.js",requires:["common-utils","mail-ui-onboarding"
,"minty_module_mobile_upsell_generic","mobile-upsell_css"]},"mail-ui-onboarding-mobile-upsell-task-panel":{path:"mail/ui/onboarding/mobile-upsell-task-panel_2_2830.js",requires:["common-utils","minty_module_mobile_upsell_task_panel","mail-ui-onboarding","mail-ui-onboarding-mobilizer","mobile-upsell_css"]},"mail-ui-onboarding-mobilizer":{path:"mail/ui/onboarding/mobilizer_2_2135.js",requires:["common-utils","minty_module_offscreen_bin_mobilizer","input-mask","mobilizer_css","querystring-stringify-simple","jsonp"]},"mail-ui-onboarding-new-tab-ext":{path:"mail/ui/onboarding/new-tab-ext-onboarding_2_1091.js",requires:["common-utils","mail-ui-onboarding"]},"mail-ui-onboarding-notification-error-task-panel":{path:"mail/ui/onboarding/notification-error-task-panel_2_2588.js",requires:["common-utils","mail-ui-onboarding"]},"mail-ui-onboarding-notifications-on-sent":{path:"mail/ui/onboarding/notifications-on-sent_2_2830.js",requires:["common-utils","mail-ui-onboarding","mail-ui-onboarding-desktop-notification","mail-ui-desktop-notifications","notif-on-send_css","mail-persist-meta-data","mail-controller-v3-user-settings"]},"mail-ui-onboarding-pensive":{path:"mail/ui/onboarding/pensive_2_2818.js",requires:["tictac-lib","common-utils","mail-ui-onboarding"]},"mail-ui-onboarding-popin-to-imap":{path:"mail/ui/onboarding/popin-to-imap-upsell_2_2832.js",requires:["common-utils","mail-ui-onboarding","mail-model-datastore","mail-common-utils-settings"]},"mail-ui-onboarding-restart":{path:"mail/ui/onboarding/restart_2_1982.js",requires:["common-utils","contacts-api","contacts-api-utils","mail-ui-folder-utils"]},"mail-ui-onboarding-rhythm":{path:"mail/ui/onboarding/rhythm_2_2588.js",requires:["jsonp","io-base","common-utils","common-utils-jsonparse","mail-common-utils-settings","common-ui-dialog-helper","mail-ui-onboarding","minty_module_rhythm_callout","_shared_module_offscreen_bin_modal_rhythm_confirm","rhythm-onboarding_css"]},"mail-ui-onboarding-richcompose":{path:"mail/ui/onboarding/richCompose_2_2748.js",requires:["common-utils","mail-ui-onboarding","minty_module_offscreen_bin_cloud_toolbar_callout","minty_module_offscreen_bin_compose_toolbar_callout","mail-ui-workspace-ext","rich-compose-onboarding_css","mail-ui-onboarding-dispatcher"]},"mail-ui-onboarding-seasonal-promotion":{path:"mail/ui/onboarding/seasonal-promotion_2_2958.js",requires:["mail-ui-onboarding","minty_module_offscreen_bin_seasonal_promotion","seasonal-promotion_css","common-utils"]},"mail-ui-onboarding-spotlight":{path:"mail/ui/onboarding/spotlight_2_1676.js",requires:["mail-ui-onboarding","spotlight_css","mail-common-utils-features"]},"mail-ui-onboarding-wider-mail-ext":{path:"mail/ui/onboarding/wider-mail-ext-onboarding_2_2978.js",requires:["common-utils","mail-ui-onboarding"]},"mail-ui-onboarding-windows-app":{path:"mail/ui/onboarding/windowsApp_5_3698.js",requires:["common-utils","mail-common-utils-settings","mail-ui-onboarding","_shared_module_offscreen_bin_modal_windows_app","windows-app-onboarding_css"]},"mail-ui-onboarding-windows-app-eol":{path:"mail/ui/onboarding/windowsAppEol_2_2889.js",requires:["common-utils","mail-ui-onboarding","windows-app-onboarding_css"]},"mail-ui-pane-utils":{path:"mail/ui/mailpane/base/paneutils_2_2667.js",requires:["mail-controller-messages","common-utils","mail-persist-meta-data","mail-common-utils-features"]},"mail-ui-pane-utils-linkEnhancr":{path:"mail/ui/mailpane/base/readLinkEnhancr_2_1676.js",requires:["overlay","common-utils","common-utils-stats","mail-ui-pane-utils","_shared_module_offscreen_bin_readlinkenhancr","mail-common-utils-features","hover-link-enhancr_css","mail-rte-enhancr-controller","mail-ui-enhancr-utils"]},"mail-ui-pane-utils-s2s":{path:"mail/ui/mailpane/base/s2s_2_22.js",requires:["overlay","common-utils","common-utils-stats","mail-ui-pane-utils","_shared_module_offscreen_bin_s2s","mail-common-utils-features","s2s-ult"]},"mail-ui-player":{path:"mail/debug/player_54_10605.js",requires:["mail-ui-recorder","minty_module_ui_player_controls","minty_module_ui_player_click_record","ui-player_css","common-utils","common-utils-rapid","common-utils-rapid-doc"]},"mail-ui-print":{path:"mail/ui/print/print_2_1503.js",requires:["mail-controller-messages","_shared_module_offscreen_bin_print_print_rollup"]},"mail-ui-proxyevents":{path:"mail/ui/mailview/conv/proxyevents_2_1853.js",requires:["mail-ui-mailevents","mail-ui-messageevents","mail-ui-convevents"]},"mail-ui-recorder":{path:"mail/debug/recorder_2_1528.js",requires:["ymma-stats","common-utils","mail-common-utils-features"]},"mail-ui-richcompose-view":{path:"compose_v3/views/richcompose_view_2_2748.js",requires:["mail-persist-meta-data","composeassist-ult","common-utils","mail-common-utils-features"]},"mail-ui-rr-backfill-controller":{path:"mail/ui/ads/rr-backfill-controller_2_1770.js",requires:["mail-ui-darla"]},"mail-ui-rte-formatter-v3":{path:"compose_v3/rte/rte-formatter-v3_2_2603.js",requires:["mail-persist-meta-data"]},"mail-ui-rte-linkeditor-v3":{path:"compose_v3/rte/rte-linkeditor-v3_5_3350.js",requires:["plugin","common-ui-dialog-helper","_shared_module_compose_link_editor","escape"]},"mail-ui-rte-smartscroll":{path:"mail/ui/mailcompose/rte/rte-smartscroll_2_2572.js",requires:["editor-base","mail-common-utils-features","mail-rte-scroll-utils"]},"mail-ui-rteview-v3":{path:"compose_v3/rte/rteview-v3_2_1831.js",requires:["attribute-base","event-base","node-base","node-event-delegate","common-utils","mail-ui-basewidget","mail-ui-rte-linkeditor-v3","mail-ui-rte-smartscroll","mail-ui-ym-rte"]},"mail-ui-searchads-cap":{path:"mail/ui/searchads/cap_54_10489.js",requires:["json-parse","mail-services-v3"]},"mail-ui-searchbar":{path:"mail/ui/msearch/searchbar_2_1820.js",requires:["common-utils","node-pluginhost"]},"mail-ui-searchmyworld":{path:"mail/ui/predictivesearch/searchmyworld_2_1676.js",requires:["json-parse","mail-services-v3","predictive-search_css","mail-common-utils-settings","mail-common-utils-features"]},"mail-ui-searchmyworld-srp"
:{path:"mail/ui/predictivesearch/searchmyworld-srp_5_812.js",requires:["mail-ui-searchmyworld"]},"mail-ui-sendconfirmview-base-conv":{path:"mail/ui/sendconfirm/sendconfirm-base-conv_5_2191.js",requires:["_shared_module_offscreen_bin_notification_notifications","_shared_module_send_confirm_captcha_blocked","_shared_module_send_confirm_rollup","common-ui-notification","common-utils","comms-lozenge-address","comms-ui-lozenge","mail-controller-sendconfirm","mail-platform","mail-ui-searchbar","minty_module_toolbar_inbox_sent_msg_rollup","mail-common-utils-features"]},"mail-ui-share-menu":{path:"mail/ui/share-menu/share-menu_2_2554.js",requires:["common-utils","common-ui-menu-helper","_shared_module_share_menu"]},"mail-ui-shortcuts":{path:"mail/ui/shortcuts/shortcuts_2_2761.js",requires:["common-utils","mail-ui-messagepane-utils"]},"mail-ui-shortcuts-dialog":{path:"mail/ui/shortcuts/shortcutsdialog_2_2603.js",requires:["common-utils","comms-ui-dialog-base","_shared_module_offscreen_bin_modal_shortcuts_rollup","modal_css","mail-common-utils-features"]},"mail-ui-sidekick-controller":{path:"mail/ui/sidekick/sidekickController_2_1091.js",requires:["event-base","mail-ui-sidekick-model","mail-ui-sidekick-view","common-utils"]},"mail-ui-sidekick-model":{path:"mail/ui/sidekick/sidekickModel_5_1339.js",requires:["event-base","common-net-sessionmgr","json-parse","common-utils"]},"mail-ui-sidekick-view":{path:"mail/ui/sidekick/sidekickView_5_3088.js",requires:["event-base","common-utils","mail-ui-darla"]},"mail-ui-signature-tweet-view":{path:"compose_v3/views/signaturetweet_view_5_3612.js",requires:["io-base","common-utils","_shared_module_compose_signature_tweet","mail-persist-meta-data","mail-common-connected-accounts"]},"mail-ui-smarttop-container":{path:"mail/ui/smarttop/smarttop-container_5_2457.js",requires:["node","event","event-mousewheel","event-delegate","mail-common-utils-features","mail-ui-smarttop-theme-info"]},"mail-ui-smarttop-theme-info":{path:"mail/ui/smarttop/smarttop-themeinfo_5_2690.js"},"mail-ui-snowflakes":{path:"mail/ui/boss/snowflakes_2_1676.js",requires:["mail-common-utils-features","mail-common-utils-settings","mail-persist-meta-data","snow-ult"]},"mail-ui-sponsoredsearch-model":{path:"mail/ui/sponsoredsearch/sponsoredSearchModel_2_1940.js",requires:["common-net-sessionmgr","mail-common-utils-settings"]},"mail-ui-themes":{path:"mail/ui/themes/themes_2_1599.js",requires:["common-utils","comms-ui-dialog-base","_shared_module_offscreen_bin_modal_colors_rollup","json-parse","modal_css","options-pages_css","mail-ui-themes-cfg","mail-ui-smarttop-theme-info"]},"mail-ui-themes-cfg":{path:"mail/ui/themes/themes-cfg_2_2432.js",requires:["common-utils","mail-common-utils-features"]},"mail-ui-tos-disclosure":{path:"mail/ui/tos/disclosure_2_1676.js",requires:["ymma-stats","cookie"]},"mail-ui-tray":{path:"compose_v3/views/tray_2_2650.js",requires:["node","comms-utils","event-custom","common-ui-menu-helper","mail-services-plugins","_shared_module_compose_attach_item","_shared_module_compose_thumbnail_item","_shared_module_compose_thumbnail_preview_item","mail-services-attach-io","mail-common-utils-features"]},"mail-ui-trending-controller":{path:"mail/ui/trending/trendingController_2_2486.js",requires:["event-base","mail-ui-trending-utils","mail-ui-trending-view","mail-ui-trendingnow-view","mail-ui-trending-model"]},"mail-ui-trending-model":{path:"mail/ui/trending/trendingModel_5_2411.js",requires:["event-base","common-net-sessionmgr","json-parse","common-utils"]},"mail-ui-trending-utils":{path:"mail/ui/trending/trendingUtils_2_2486.js",requires:["mail-common-utils-settings","mail-common-utils-features","common-utils"]},"mail-ui-trending-view":{path:"mail/ui/trending/trendingView_2_2486.js",requires:["minty_module_trending_gifts","mail-ui-trending-utils","event-base","mail-common-utils-settings","array-extras","common-utils"]},"mail-ui-trendingnow-view":{path:"mail/ui/trending/trendingNowView_2_1770.js",requires:["minty_module_trending_trending","mail-ui-trending-utils","common-utils"]},"mail-ui-unsub-api":{path:"mail/ui/unsubscribe/unsub-api_2_2822.js",requires:["mail-ui-messagesview-quickfilter","mail-ui-shortcuts","mail-util-headless-compose","mail-model-unsubstore","mail-ui-unsubscribe-dialog"]},"mail-ui-unsubscribe":{path:"mail/ui/actions/unsubscribe_2_2781.js",requires:["comms-ui-dialog-base","_shared_module_offscreen_bin_modal_unsubscribe","_shared_module_offscreen_bin_notification_header_body","common-ui-notification","mail-common-utils-features","mail-common-utils-settings"]},"mail-ui-unsubscribe-dialog":{path:"mail/ui/unsubscribe/unsubscribe-dialog_2_2970.js",requires:["common-utils","unsubscribe-dialog_css","mail-model-unsubstore","comms-ui-dialog-base","common-ui-notification","mail-ui-unsub-api","mail-ui-confirmation-dialog","mail-ui-unsubscribe-error-dialog","_shared_module_offscreen_bin_modal_unsubscribe_link_item","_shared_module_offscreen_bin_modal_unsubscribe_dialog_rollup","mail-ui-unsubscribe-ult","mail-controller-v3-user-settings"]},"mail-ui-unsubscribe-error-dialog":{path:"mail/ui/unsubscribe/unsubscribe-error-dialog_2_2814.js",requires:["common-utils","unsubscribe-error-dialog_css","minty_module_unsubscribe_error_dialog_rollup"]},"mail-ui-unsubscribe-ult":{path:"mail/ui/unsubscribe/unsubscribe-ult_2_2804.js",requires:["common-utils-rapid-clickmap","common-utils-rapid-viewmap"]},"mail-ui-vd-controller":{path:"mail/ui/video/vdcontroller_5_2713.js",requires:["mail-ui-vd-factory","common-utils","mail-common-utils-features"]},"mail-ui-vd-dataservice":{path:"mail/ui/video/vddataservice_5_2713.js",requires:["common-utils","event-base"]},"mail-ui-vd-dataservice-channel":{path:"mail/ui/video/vddataservicechannel_2_1046.js",requires:["mail-ui-vd-dataservice","mail-ui-vd-model-uuid"]},"mail-ui-vd-dataservice-id":{path:"mail/ui/video/vddataserviceid_2_2979.js",requires:["mail-ui-vd-dataservice","mail-ui-vd-model-uuid"]},"mail-ui-vd-dataservice-newsfeed":{path:"mail/ui/video/vddataservicenewsfeed_5_2713.js"
,requires:["mail-ui-vd-dataservice","mail-ui-vd-model-uuid"]},"mail-ui-vd-factory":{path:"mail/ui/video/vdfactory_2_236.js",requires:["common-utils","mail-common-utils-features"]},"mail-ui-vd-model":{path:"mail/ui/video/vdmodel_5_2713.js",requires:["common-utils","event-base"]},"mail-ui-vd-model-uuid":{path:"mail/ui/video/vdmodeluuid_5_2713.js",requires:["mail-ui-vd-model"]},"mail-ui-vd-view":{path:"mail/ui/video/vdview_2_2862.js",requires:["mail-ui-vd-controller","common-utils","event-base","node"]},"mail-ui-vd-view-folder":{path:"mail/ui/video/vdviewfolder_2_1046.js",requires:["mail-ui-vd-view","common-utils","minty_module_video_emptyfolder_vd_rollup"]},"mail-ui-vd-view-nativead":{path:"mail/ui/video/vdviewnativead_2_2862.js",requires:["mail-ui-vd-view","common-utils","minty_module_video_nativead_vd"]},"mail-ui-vd-view-newsfeed":{path:"mail/ui/video/vdviewnewsfeed_5_2713.js",requires:["mail-ui-vd-view","common-utils","minty_module_video_newsfeed_vd"]},"mail-ui-vd-view-spotlight":{path:"mail/ui/video/vdviewspotlight_2_236.js",requires:["mail-ui-vd-view","common-utils","minty_module_video_spotlight_vd"]},"mail-ui-video-channelVideoService":{path:"mail/ui/video/channelVideoService_2_2009.js",requires:["array-extras","json-parse","common-net-sessionmgr","common-utils"]},"mail-ui-weather-controller":{path:"mail/ui/weather/weatherController_5_2523.js",requires:["common-utils","mail-ui-weather-model","mail-ui-weather-view","mail-ui-location-model"]},"mail-ui-weather-model":{path:"mail/ui/weather/weatherModel_2_1091.js",requires:["io","common-net-sessionmgr","common-utils","event-base"]},"mail-ui-weather-view":{path:"mail/ui/weather/weatherView_5_2523.js",requires:["common-utils","mail-ui-weather-model","common-persist-user-data"]},"mail-ui-windows-helper":{path:"mail/ui/windows/helper_2_2917.js",requires:["json-stringify","common-utils","common-ui-dialog-helper","mail-social-icons-sprites_css","windows-app-onboarding_css","_shared_module_offscreen_bin_modal_win10_post_eol","event"]},"mail-ui-workspace-base":{path:"mail/ui/workspace/workspace_2_2956.js",requires:["mail-platform","event-resize","mail-controller-tictacs","mail-modules","mail-templates","mail-ui-foldersview-base","common-ui-tabs-base","common-ui-toolbar-base","mail-ui-searchbar","common-utils-stats","mail-persist-meta-data","mail-ui-common-string-utils","mail-common-tracker","ymma-stats","mail-ui-navkeys","mail-common-utils-features","mail-ui-folder-utils","mail-controller-v3-user-settings"]},"mail-ui-workspace-ext":{path:"mail/ui/workspace/workspace-ext_2_1148.js",requires:["mail-ui-workspace-base"]},"mail-ui-workspace-fresh":{path:"mail/ui/workspace/workspace-fresh_5_2315.js",requires:["mail-ui-workspace-base","widget-anim"]},"mail-ui-workspace-horizontal-slider":{path:"mail/ui/workspace/workspacehslider_54_10489.js",requires:["node-base","common-persist-cookie-data","common-ui-dd"]},"mail-ui-workspace-postload":{path:"mail/ui/workspace/workspace-postload_2_3008.js",requires:["mail-ui-workspace-base","mail-common-utils-features","mail-persist-meta-data","mail-ui-folder-utils","mail-api-utility","common-net-sessionmgr","common-utils-onboarding"]},"mail-ui-workspace-postload-coupons":{path:"mail/ui/expiringcoupons/coupons-api_2_2576.js",requires:["mail-model-couponstore","mail-persist-meta-data","coupons-ult"]},"mail-ui-workspace-rum":{path:"mail/ui/workspace/rum_2_2676.js",requires:["event","mail-common-utils-features","common-utils","common-utils-performance"]},"mail-ui-workspace-rum-cpu":{path:"mail/ui/workspace/rum-cpu-log_2_1369.js",requires:["common-utils","mail-ui-darla"]},"mail-ui-workspace-stats":{path:"mail/ui/workspace/workspace-stats_54_10549.js",requires:["mail-ui-workspace-base"]},"mail-ui-ym-rte":{path:"compose_v3/rte/YMRTEYUI_2_2447.js",requires:["mail-rte-enhancr-plugin","mail-rte-caret-plugin","mail-rte-inline-image-plugin","event-custom","mail-common-utils-features","mail-common-utils-settings","_shared_module_rte_well_content_inline_image_drop_zone","comms-utils"]},"mail-util-headless-compose":{path:"compose_v3/util/headlessCompose_2_2814.js",requires:["common-utils","comms-utils","mail-ui-folder-utils","mail-ui-authorview-v3","mail-ui-mailcompose-header-form-list-helper","mail-ui-rteview-v3","mail-ui-confirmation-dialog"]},"mail-views-send-validation-error-handlers":{path:"compose_v3/views/SendValidationErrorHandlers_2_1198.js",requires:["common-utils","node","mail-captcha-turnkey-view","mail-controller-reply-processor","mail-models-serializers-draft-gdm-unserializer"]},"newsfeed-ult":{path:"mail/ui/newsfeed/newsFeedUlt_2_2321.js",requires:["common-utils-rapid-clickmap","common-utils-rapid-viewmap"]},"newsstream-ui-newsstreamview":{path:"newsstream/ui/newsstreamview_54_10489.js",requires:["mail-ui-basewidget"]},"notepad-ui-notepadview":{path:"notepad/ui/notepadview_54_10489.js",requires:["mail-ui-basewidget","node-event-simulate","querystring-stringify-simple"]},"onboarding-ult":{path:"mail/ui/onboarding/onboarding-ult_2_2654.js",requires:["common-utils-rapid-clickmap","common-utils-rapid-viewmap"]},"premium-video-ad-ult":{path:"mail/ui/ads/premium-video-ad-ult_2_2513.js",requires:["common-utils-rapid-clickmap"]},"profile-api":{path:"comms/shared/src/profile-api/js/api_54_10489.js",requires:["profile-api-config"]},"profile-api-config":{path:"comms/shared/src/profile-api/js/api-config_54_10489.js",requires:["attribute"]},"recentwebsearches-ult":{path:"mail/ui/recentwebsearches/recentwebsearches-ult_5_2453.js",requires:["common-utils-rapid-clickmap"]},"rte-file-utils":{path:"compose_v3/rte/rte-file-utils_5_2322.js"},"rte-inline-image":{path:"compose_v3/rte/rte-inline-image_2_155.js",requires:["common-utils","escape","event-custom"]},"s2s-ult":{path:"mail/ui/mailpane/base/s2s-ult_54_10489.js",requires:["common-utils-rapid-clickmap"]},"search-ult":{path:"mail/ui/msearch/search-ult_2_1439.js",requires:["common-utils-rapid-clickmap","common-utils-rapid-viewmap"]},"snow-ult":{path:"mail/ui/boss/snow-ult_54_10489.js",
requires:["common-utils-rapid-clickmap"]},"template-renderer":{path:"comms/shared/src/utils/js/template-renderer_54_10489.js"},tracer:{path:"mail/debug/tracer_54_10489.js",requires:["comms-aop-weaver","comms-aop-tracer","mail-ui-actions-marker"]},"xobni-contacts-search-api":{path:"comms/shared/src/xobniContacts/xobni-contacts-search-api_2_2692.js",requires:["io-base","querystring-stringify-simple","json","ymma-stats","xobni-utilities","common-utils-jsonparse","common-net-session"]},"xobni-utilities":{path:"comms/shared/src/xobniContacts/xobniUtils_2_2827.js",requires:["querystring-stringify","common-utils","common-net-session","mail-common-utils-settings"]},"ymma-stats":{path:"comms/shared/src/ymmastats/js/src/ymmastats_2_2526.js",requires:["mail-common-utils-settings","mail-common-utils-features","common-utils-net-queue"]}});var t={postlaunch:["mail-ui-add-account","mail-controller-folders-v3","mail-ui-heartbeat","mail-ui-unsubscribe-dialog","mail-ui-unsubscribe-error-dialog","mail-ui-confirmation-dialog","mail-ui-onboarding-coupons-restore","mail-ui-onboarding-coupons-list","mail-ui-onboarding-coupons-tracking","mail-ui-onboarding-windows-app","mail-ui-onboarding-windows-app-eol","mail-ui-norrin-upsell-takeover","mail-ui-keytaskpanel-configmap","mail-ui-windows-helper","mail-ui-nativeads-read","mail-ui-carouselads-read","mail-ui-geminivideo-ads","mail-ui-ad-toolbar","mail-controller-conversations-ops-drafts","mail-ui-imap-in","common-utils-error","mail-common-cachewarmer","mail-captcha-data-view","mail-captcha-data-controller","mail-error","mail-ui-coupons-tracking-option","mail-error-v3","mail-errormap","mail-ui-inboxmenu-base","mail-ui-folderevents","mail-ui-messenger","mail-ui-print","mail-ui-themes","mail-ui-onboarding","mail-ui-shortcuts-dialog","mail-ui-ad-upsell-dialog","mail-ui-adfree-mail-dialog","mail-ui-ad-feedback-dialog","mail-ui-ad-sponsored-feedback-dialog","mail-ui-darla","mail-ui-workspace-rum-cpu","mail-ui-convs-confirm-dialog","common-ui-menu-helper","mail-ui-searchmyworld","common-ui-tabs-overflow","mail-ui-workspace-ext","mail-ui-foldersview-bind","mail-ui-messagesview-quickfilter","mail-controller-filters-v3","mail-ui-messagekeywords","mail-ui-messagecategories","mail-ui-messagecategories-vespa","calendar-ui-calendarview","notepad-ui-notepadview","federated-autocomplete","federated-autocomplete-acwidget-shim","filter-contacts","_shared_module_offscreen_bin_menus_spam","mail-ui-proxyevents","mail-ui-mb-controller","mail-ui-mb-view","mail-ui-mb-list-view","mail-ui-mb-list-img-view","mail-ui-mb-list-native-view","mail-ui-mb-rec-view","mail-ui-mb-right-rail-view","mail-ui-mb-right-rail-carousel-view","mail-ui-mb-search-list-view","mail-ui-mb-msg-read-view","mail-ui-mb-model","mail-ui-mb-feedback-view","mail-ui-adfree-pricing","mail-ui-adfree-renewal","gallery-event-pasted","input-mask","mail-ui-ads-mobilizer","mail-ui-composeview-compose-loader","mail-services-message-service","mail-ui-contentmatch-d2s","mail-ui-boss-multitask","mail-ui-boss-themes","mail-ui-boss-screensaver-console","mail-ui-boss-screensaver-halloween","mail-ui-boss-screensaver-photos","mail-ui-desktop-notifications","mail-ui-rr-backfill-controller","comet","mail-ui-ads-live-nation","mail-ui-ads-emptyfolder-video","mail-ui-video-channelVideoService","mail-ui-vd-view-folder","mail-ui-vd-view-nativead","mail-ui-pane-utils-s2s","mail-ui-pane-utils-linkEnhancr","mail-ui-chrome-dss-ext","mail-ui-onboarding-holiday-themes","mail-ui-list-item-editor","mail-ui-folder-menu","mail-common-connected-accounts","mail-common-connected-accounts-ult","mail-ui-unsubscribe","mail-ui-maintenancenotification","mail-ui-desktop-notifications-mail","mail-ui-onboarding-dispatcher","mail-ui-onboarding-desktop-notification","mail-ui-onboarding-wider-mail-ext","mail-ui-onboarding-new-tab-ext","mail-ui-onboarding-imap-in","mail-ui-onboarding-imap-in-upsell","mail-ui-onboarding-popin-to-imap","mail-ui-onboarding-archive","mail-ui-onboarding-spotlight","mail-ui-alert-ssa-account","mail-ui-onboarding-compromised-account","mail-ui-onboarding-mobilizer","mail-ui-onboarding-enhancr","mail-ui-onboarding-notifications-on-sent","mail-ui-sidekick-controller","mail-ui-sidekick-view","mail-common-token-refresh","mail-ui-light-document-preview-fullscreenslideshow","mail-ui-lightdocpreview-controller","mail-ui-boss","mail-ui-boss-screensaver","mail-controller-persist","mail-ui-onboarding-mobile-upsell-generic","mail-ui-onboarding-notification-error-task-panel","mail-ui-onboarding-mobile-upsell-task-panel","mail-ui-enhancr","mail-ui-enhancr-utils","mail-controller-alertstore","mail-ui-onboarding-pensive","mail-ui-favicon-notify","mail-ui-keytaskpanel-panelview","common-net-ydod","mail-controller-v3","mail-controller-v3-helper","mail-ui-trendingnow-view","mail-ui-trending-controller","mail-ui-onboarding-rhythm","mail-ui-onboarding-richcompose","mail-ui-mailcompose-templates","mail-api-migration-customviews","mail-ui-onboarding-coupons-feedback","mail-ui-unsub-api","mail-ui-shortcuts","mail-controller-mrd","mail-util-headless-compose","mail-core-net-transport","mail-core-net-request","mail-controller-messages-ops","comms-utils","mail-ui-authorview-v3","mail-controller-reply-processor","mail-models-draft","mail-controller-signature-processor","mail-ui-mailcompose-header-form-list-helper","mail-controller-compose-v3","mail-ui-fullcompose-v3","mail-ui-mailcompose-v3","mail-ui-mailcompose-base-header-v3","comms-ui-lozenge","ac-widget","mail-controller-compose-text","mail-controller-compose","mail-model-compose","mail-models-validators-send","mail-ui-tray","mail-controller-html-processor","mail-views-send-validation-error-handlers","mail-captcha-turnkey-view","mail-ui-composetictacapi","mail-ui-signature-tweet-view","xobni-utilities","isXobnifiedCheck","xobni-contacts-search-api","mail-services-compose","mail-models-serializers-draft-payloadpart-serializer","mail-controller-conv-adapter","mail-controller-v3-converter","mail-controller-spell-processor"
,"mail-controller-composecontent-helper","mail-controller-cloud-linkutil","mail-ui-rteview-v3","mail-ui-rte-linkeditor-v3","mail-ui-ym-rte","mail-rte-enhancr-plugin","mail-rte-inline-image-plugin","mail-model-couponstore","mail-ui-themes-cfg","mail-ui-mailevents","mail-ui-messageevents","mail-ui-convevents","mail-controller-conversations-ops","mail-ui-mail-helper","mail-rte-enhancr-controller","mail-rte-enhancr-card","mail-rte-enhancr-config","mail-services-hlfs","mail-ui-sidekick-model","mail-ui-folder-state","mail-ui-share-menu","mail-api-yoda","mail-api-yoda-io","mail-api-message-updater","mail-ui-trending-model"],calendar:["calendar-ui-addEvent-utils","calendar-ui-addEvent-listener","calendar-ui-addEvent-controller","calendar-ui-addEvent-model","calendar-ui-addEvent-view","mail-controller-compose-text","mail-controller-compose","mail-model-compose"],compose:["mail-common-downloader-v1","mail-common-downloader-v2","mail-controller-compose","mail-controller-compose-text","mail-controller-reply-processor","mail-ui-signature-tweet-view","mail-controller-contact-processor","mail-views-send-validation-error-handlers","mail-models-validators-send","mail-controller-spellcheck","mail-controller-spell-processor","mail-controller-signature-processor","mail-controller-composecontent-helper","mail-controller-cloud-linkutil","mail-ui-authorview-v3","mail-ui-fullcompose-v3","mail-ui-mailcompose-base-header-v3","mail-ui-mailcompose-v3","mail-controller-compose-v3","mail-captcha-turnkey-view","mail-ui-composeview-spellcheck-v3","mail-ui-messageevents","mail-ui-convevents","mail-ui-mailevents","mail-ui-messagepane-error","mail-ui-messagepane-read","mail-ui-messagepane-warnings","mail-ui-messagepane-next-prev","mail-ui-convpane-next-prev","mail-ui-messagepane-bind","mail-ui-message-encodings","mail-ui-sendconfirmview-base-conv","mail-ui-convpane-read","mail-ui-captcha-controller","mail-ui-captcha-view","mail-ui-rteview-v3","mail-ui-rte-formatter-v3","mail-ui-rte-linkeditor-v3","mail-rte-autocomposemenu","mail-ui-tray","mail-ui-composetictacapi","mail-services-compose","mail-services-calservice","mail-core-net-transport","mail-core-net-request","mail-ui-mailcompose-header-form-list-helper","mail-rte-inline-image-plugin","mail-rte-caret-plugin","mail-rte-enhancr-plugin","mail-rte-enhancr-card","mail-rte-enhancr-config","mail-rte-enhancr-controller","mail-ui-ym-rte","mail-ui-workspace-postload-coupons","mail-ui-onboarding-seasonal-promotion","mail-model-compose","mail-models-draft","comms-utils","mail-common-connected-accounts","xobni-utilities","isXobnifiedCheck","xobni-contacts-search-api","comms-ui-lozenge","ac-widget","filter-contacts","mail-services-message-service","mail-error-v3","mail-error","mail-errormap","common-ui-menu-helper","mail-controller-html-processor","mail-ui-onboarding-richcompose","mail-ui-onboarding","mail-ui-workspace-ext","mail-ui-onboarding-dispatcher","mail-models-serializers-draft-payloadpart-serializer","mail-controller-conv-adapter","mail-controller-v3-converter","mail-controller-messages-ops","mail-ui-unsubscribe","mail-controller-conversations-ops","mail-ui-mailpane-read","mail-ui-mailpane-next-prev","comms-lozenge-address","comms-lozenge","mail-controller-sendconfirm","mail-ui-enhancr-utils","mail-models-serializers-draft-ref-att-serializer","mail-services-hlfs","mail-model-couponstore"],contacts:["contacts-ui-addcontact-add","contacts-ui-addcontact-confirm","contacts-ui-hovercard-plugin","contacts-ui-hovercard-datastore","contacts-ui-hovercard-addedit","contacts-ui-contactsview","contacts-ui-contactseventstranslator","comms-utils","xobni-utilities","xobni-contacts-search-api","mail-common-connected-accounts","isXobnifiedCheck","common-ui-menu-helper"],search:["mail-ui-searchmyworld-srp","mail-ui-dmsearch-controller","mail-ui-dmsearch-model","mail-ui-contentmatch-model","mail-ui-contentmatch-controller","mail-ui-contentmatch-text-ads-view","mail-ui-sponsoredsearch-model","mail-ui-dmsearch-view","mail-ui-searchmyworld"],newsfeed:["mail-ui-newsfeed-slingstone","mail-ui-newsfeed-controller","mail-ui-newsfeed-model","mail-ui-newsfeed-view","mail-ui-weather-view","mail-ui-weather-controller","mail-ui-mb-model","mail-ui-trending-controller","mail-ui-trendingnow-view","mail-ui-trending-model","mail-ui-mail-helper","mail-ui-weather-model","mail-ui-location-model"],subcompose:["ac-widget","comms-lozenge","comms-ui-lozenge","comms-utils","comms-lozenge-address","comms-lozenge-edit","comms-ui-editable-overlay-plugin","mail-model-send","mail-controller-compose","mail-controller-sendconfirm","filter-contacts","mail-model-compose","mail-controller-messages-ops"]},n={postlaunch_strings:{path:"intl/js/postlaunch/lang_"+NeoConfig.lang+"_2_3008"+".js"},calendar_strings:{path:"intl/js/calendar/lang_"+NeoConfig.lang+"_2_2768"+".js",requires:["postlaunch_strings"]},compose_strings:{path:"intl/js/compose/lang_"+NeoConfig.lang+"_2_2962"+".js",requires:["postlaunch_strings"]},contacts_strings:{path:"intl/js/contacts/lang_"+NeoConfig.lang+"_2_2868"+".js",requires:["postlaunch_strings"]},search_strings:{path:"intl/js/search/lang_"+NeoConfig.lang+"_2_2768"+".js",requires:["postlaunch_strings"]},newsfeed_strings:{path:"intl/js/newsfeed/lang_"+NeoConfig.lang+"_2_2768"+".js",requires:["postlaunch_strings"]},subcompose_strings:{path:"intl/js/subcompose/lang_"+NeoConfig.lang+"_2_2761"+".js",requires:["postlaunch_strings"]}};e.mix(e.comps,n);for(var r in t){var i=t[r];for(var s=0;s<i.length;s++){var o=i[s],u=e.comps[o];u&&(u.requires||(u.requires=[]),u.requires.push(r+"_strings"))}}a();var f,l="",c=0,h=0,p=1,d=0,v=NeoConfig.reducedUrlLength||255,m=NeoConfig.urlLength||2e3,g={mail:{name:"mail",comboBase:YUI_config.groups.mailMods.comboBase,root:YUI_config.groups.mailMods.root,base:YUI_config.groups.mailMods.base,combine:!0,modules:e.comps,origin:NeoConfig.originPath}};y(),delete e.Env._loader.rollups,e._config({requireRegistration:!0,loadErrorFn:b(),timeout:f,maxURLLength:m,groups:g})})},"1.0.0");


YUI.add("mail-templates",function(e){var t={mailTmpl:{name:"mailTmpl",comboBase:YUI_config.groups.mailMods.comboBase,root:YUI_config.groups.mailMods.root+"templates/js/",base:YUI_config.groups.mailMods.base+"templates/js/",combine:!0,modules:{_shared_module_ad_live_nation:{path:"_shared/module/ad/live-nation_54_10489.js"},_shared_module_ads_display:{path:"_shared/module/ads-display_2_1193.js"},_shared_module_ca_openhide:{path:"_shared/module/ca-openhide_2_2572.js"},_shared_module_calendar_dialog_add_event_mail_rollup:{path:"_shared/module/calendar/dialog/add-event-mail_rollup_54_10489.js"},_shared_module_calendar_menu_times:{path:"_shared/module/calendar/menu/times_54_10489.js"},_shared_module_compose_attach_item:{path:"_shared/module/compose/attach-item_5_2209.js"},_shared_module_compose_autocompose_enhancr_onboard:{path:"_shared/module/compose/autocompose-enhancr-onboard_2_981.js"},_shared_module_compose_autocompose_menu:{path:"_shared/module/compose/autocompose-menu_2_475.js"},_shared_module_compose_autocompose_notification:{path:"_shared/module/compose/autocompose-notification_2_475.js"},_shared_module_compose_calendarReply:{path:"_shared/module/compose/calendarReply_54_10489.js"},_shared_module_compose_dropzone:{path:"_shared/module/compose/dropzone_54_10489.js"},_shared_module_compose_dummy_rollup:{path:"_shared/module/compose-dummy_rollup_2_2603.js"},_shared_module_compose_fresh:{path:"_shared/module/compose-fresh_54_10489.js",requires:["_shared_module_compose_message_header_fresh","_shared_module_rte_well_fresh","_shared_module_compose_message_body"]},_shared_module_compose_fresh_conv:{path:"_shared/module/compose-fresh-conv_2_2572.js",requires:["_shared_module_compose_message_header_fresh","_shared_module_compose_message_body","_shared_module_rte_well_fresh_conv"]},_shared_module_compose_link_editor:{path:"_shared/module/compose/link-editor_54_10489.js"},_shared_module_compose_loading:{path:"_shared/module/compose/loading_54_10489.js"},_shared_module_compose_message_body:{path:"_shared/module/compose/message-body_2_1811.js",requires:["_shared_module_message_loading_error","_shared_module_rte_well_content_attachments_well_fresh"]},_shared_module_compose_message_header_fresh:{path:"_shared/module/compose/message-header-fresh_2_2543.js",requires:["_shared_module_compose_quick_reply_card_actions"]},_shared_module_compose_quick_reply_card_actions:{path:"_shared/module/compose/quick-reply-card-actions_54_10489.js"},_shared_module_compose_reply:{path:"_shared/module/compose/reply_2_534.js"},_shared_module_compose_signature_tweet:{path:"_shared/module/compose/signature-tweet_5_2988.js"},_shared_module_compose_template_retrieve:{path:"_shared/module/compose/template-retrieve_2_2572.js"},_shared_module_compose_thumbnail_item:{path:"_shared/module/compose/thumbnail-item_5_2239.js"},_shared_module_compose_thumbnail_preview_item:{path:"_shared/module/compose/thumbnail-preview-item_5_3210.js"},_shared_module_compose_title:{path:"_shared/module/compose/title_54_10489.js"},_shared_module_contact_card_confirm:{path:"_shared/module/contact/card-confirm_54_10489.js",requires:["_shared_module_contact_fragments_photo","_shared_module_contact_fragments_activity","_shared_module_contact_fragments_name","_shared_module_contact_fragments_info"]},_shared_module_contact_fragments_activity:{path:"_shared/module/contact/fragments/activity_54_10489.js"},_shared_module_contact_fragments_dl_email:{path:"_shared/module/contact/fragments/dl/email_54_10489.js"},_shared_module_contact_fragments_dl_mobile:{path:"_shared/module/contact/fragments/dl/mobile_54_10489.js"},_shared_module_contact_fragments_dl_yim:{path:"_shared/module/contact/fragments/dl/yim_54_10489.js"},_shared_module_contact_fragments_info:{path:"_shared/module/contact/fragments/info_54_10489.js",requires:["_shared_module_contact_fragments_dl_email","_shared_module_contact_fragments_dl_yim","_shared_module_contact_fragments_dl_mobile"]},_shared_module_contact_fragments_name:{path:"_shared/module/contact/fragments/name_54_10489.js"},_shared_module_contact_fragments_photo:{path:"_shared/module/contact/fragments/photo_54_10489.js"},_shared_module_feedback:{path:"_shared/module/feedback_54_10489.js"},_shared_module_folder_empty_rollup:{path:"_shared/module/folder-empty_rollup_54_10489.js"},_shared_module_folder_list_mailbox_list:{path:"_shared/module/folder-list/mailbox-list_5_1921.js"},_shared_module_fullscreen_slideshow:{path:"_shared/module/fullscreen_slideshow_5_3334.js"},_shared_module_imap_in_alter:{path:"_shared/module/imap-in-alter_2_1026.js"},_shared_module_imap_in_send_only:{path:"_shared/module/imap-in-send-only_2_1026.js"},_shared_module_message_display_fresh_rollup:{path:"_shared/module/message-display-fresh_rollup_2_325.js"},_shared_module_message_list_refresh_rollup:{path:"_shared/module/message-list-refresh_rollup_2_2492.js"},_shared_module_message_list_thread_expansion_error:{path:"_shared/module/message-list/thread_expansion_error_54_10489.js"},_shared_module_message_list_threaded_rollup:{path:"_shared/module/message-list-threaded_rollup_2_2492.js"},_shared_module_message_loading_error:{path:"_shared/module/message/loading-error_54_10489.js"},_shared_module_message_norton_logo:{path:"_shared/module/message/norton-logo_54_10489.js"},_shared_module_message_pane_fresh:{path:"_shared/module/message-pane-fresh_2_2388.js",requires:["_shared_module_message_prompt","_shared_module_message_display_fresh_rollup"]},_shared_module_message_prompt:{path:"_shared/module/message/prompt_54_10489.js"},_shared_module_offscreen_bin_change_template:{path:"_shared/module/offscreen-bin/change-template_2_2132.js",requires:["_shared_module_offscreen_bin_modal_close_icon","_shared_module_offscreen_bin_modal_btn_cancel"]},_shared_module_offscreen_bin_compose:{path:"_shared/module/offscreen-bin/compose_54_10489.js"},_shared_module_offscreen_bin_compose_menu_color_picker:{path:"_shared/module/offscreen-bin/compose/menu-color-picker_54_10489.js"},_shared_module_offscreen_bin_compose_menu_indent
:{path:"_shared/module/offscreen-bin/compose/menu-indent_54_10489.js"},_shared_module_offscreen_bin_compose_menu_list:{path:"_shared/module/offscreen-bin/compose/menu-list_54_10489.js"},_shared_module_offscreen_bin_compose_menu_spell_langs:{path:"_shared/module/offscreen-bin/compose/menu-spell-langs_54_10489.js"},_shared_module_offscreen_bin_compose_menu_spellcheck:{path:"_shared/module/offscreen-bin/compose/menu-spellcheck_54_10489.js"},_shared_module_offscreen_bin_compose_menu_text_align:{path:"_shared/module/offscreen-bin/compose/menu-text-align_54_10489.js"},_shared_module_offscreen_bin_compose_modal_cancel_compose:{path:"_shared/module/offscreen-bin/compose/modal-cancel-compose_54_10489.js",requires:["_shared_module_offscreen_bin_modal_close_icon"]},_shared_module_offscreen_bin_contacts_hovercard:{path:"_shared/module/offscreen-bin/contacts/hovercard_2_2413.js"},_shared_module_offscreen_bin_contacts_hovercard_mini:{path:"_shared/module/offscreen-bin/contacts/hovercard-mini_5_2929.js"},_shared_module_offscreen_bin_contacts_modal_contact_add:{path:"_shared/module/offscreen-bin/contacts/modal-contact/add_54_10677.js",requires:["_shared_module_offscreen_bin_modal_close_icon","_shared_module_offscreen_bin_contacts_modal_contact_fragments_ep_smtp","_shared_module_offscreen_bin_contacts_modal_contact_fragments_ep_tel","_shared_module_offscreen_bin_contacts_modal_contact_fragments_ep_other","_shared_module_offscreen_bin_modal_btn_cancel"]},_shared_module_offscreen_bin_contacts_modal_contact_edit:{path:"_shared/module/offscreen-bin/contacts/modal-contact/edit_5_2929.js",requires:["_shared_module_offscreen_bin_modal_close_icon","_shared_module_offscreen_bin_contacts_modal_contact_fragments_ep_smtp","_shared_module_offscreen_bin_contacts_modal_contact_fragments_ep_tel","_shared_module_offscreen_bin_contacts_modal_contact_fragments_ep_other","_shared_module_offscreen_bin_modal_btn_cancel"]},_shared_module_offscreen_bin_contacts_modal_contact_fragments_ep_other:{path:"_shared/module/offscreen-bin/contacts/modal-contact/fragments/ep-other_54_10677.js"},_shared_module_offscreen_bin_contacts_modal_contact_fragments_ep_smtp:{path:"_shared/module/offscreen-bin/contacts/modal-contact/fragments/ep-smtp_54_10828.js"},_shared_module_offscreen_bin_contacts_modal_contact_fragments_ep_tel:{path:"_shared/module/offscreen-bin/contacts/modal-contact/fragments/ep-tel_54_10677.js"},_shared_module_offscreen_bin_contacts_modal_contact_fragments_menu_email_types:{path:"_shared/module/offscreen-bin/contacts/modal-contact/fragments/menu-email-types_54_10489.js"},_shared_module_offscreen_bin_contacts_modal_contact_fragments_menu_phone_types:{path:"_shared/module/offscreen-bin/contacts/modal-contact/fragments/menu-phone-types_54_10489.js"},_shared_module_offscreen_bin_contacts_modal_kiosk_add_fragments_modal_kiosk_addcontact_bd:{path:"_shared/module/offscreen-bin/contacts/modal-kiosk-add/fragments/modal-kiosk-addcontact-bd_54_10489.js",requires:["minty_module_contacts_edit_error","minty_module_contacts_edit_name","minty_module_contacts_edit_basics_emails","minty_module_contacts_edit_basics_ims","minty_module_contacts_edit_basics_phones"]},_shared_module_offscreen_bin_contacts_modal_kiosk_add_fragments_modal_kiosk_addcontact_ft:{path:"_shared/module/offscreen-bin/contacts/modal-kiosk-add/fragments/modal-kiosk-addcontact-ft_54_10489.js",requires:["_shared_module_offscreen_bin_modal_btn_cancel"]},_shared_module_offscreen_bin_contacts_modal_kiosk_add_fragments_modal_kiosk_addcontact_hd:{path:"_shared/module/offscreen-bin/contacts/modal-kiosk-add/fragments/modal-kiosk-addcontact-hd_54_10489.js",requires:["_shared_module_offscreen_bin_modal_close_icon"]},_shared_module_offscreen_bin_contacts_modal_kiosk_add_fragments_modal_kiosk_addcontactconfirm_bd:{path:"_shared/module/offscreen-bin/contacts/modal-kiosk-add/fragments/modal-kiosk-addcontactconfirm-bd_54_10489.js",requires:["_shared_module_contact_card_confirm"]},_shared_module_offscreen_bin_contacts_modal_kiosk_add_fragments_modal_kiosk_addcontactconfirm_ft:{path:"_shared/module/offscreen-bin/contacts/modal-kiosk-add/fragments/modal-kiosk-addcontactconfirm-ft_54_10489.js",requires:["_shared_module_offscreen_bin_modal_btn_done"]},_shared_module_offscreen_bin_contacts_modal_kiosk_add_fragments_modal_kiosk_addcontactconfirm_hd:{path:"_shared/module/offscreen-bin/contacts/modal-kiosk-add/fragments/modal-kiosk-addcontactconfirm-hd_54_10489.js",requires:["_shared_module_offscreen_bin_modal_close_icon"]},_shared_module_offscreen_bin_contacts_modal_kiosk_add_modal_kiosk_addcontact:{path:"_shared/module/offscreen-bin/contacts/modal-kiosk-add/modal-kiosk-addcontact_54_10489.js",requires:["_shared_module_offscreen_bin_contacts_modal_kiosk_add_fragments_modal_kiosk_addcontact_hd","_shared_module_offscreen_bin_contacts_modal_kiosk_add_fragments_modal_kiosk_addcontact_bd","_shared_module_offscreen_bin_contacts_modal_kiosk_add_fragments_modal_kiosk_addcontact_ft"]},_shared_module_offscreen_bin_drag_drop:{path:"_shared/module/offscreen-bin/drag-drop_54_10489.js"},_shared_module_offscreen_bin_inbox:{path:"_shared/module/offscreen-bin/inbox_2_1620.js",requires:["_shared_module_offscreen_bin_menus_actions_fresh","_shared_module_offscreen_bin_menus_view","_shared_module_offscreen_bin_modal_attach_download","_shared_module_offscreen_bin_menus_tab_overflow","_shared_module_offscreen_bin_modal_set_encodings","_shared_module_offscreen_bin_menus_bubble_actions","_shared_module_offscreen_bin_menus_message_list_sortby","_shared_module_offscreen_bin_menus_message_list_cbox_select","_shared_module_offscreen_bin_menus_message_list_count"]},_shared_module_offscreen_bin_menus_actions_fresh:{path:"_shared/module/offscreen-bin/menus/actions-fresh_5_3103.js"},_shared_module_offscreen_bin_menus_bubble_actions:{path:"_shared/module/offscreen-bin/menus/bubble-actions_5_3103.js"},_shared_module_offscreen_bin_menus_debug:{path:"_shared/module/offscreen-bin/menus/debug_5_3198.js"},_shared_module_offscreen_bin_menus_emptyfolder_video_channels
:{path:"_shared/module/offscreen-bin/menus/emptyfolder-video-channels_2_1046.js"},_shared_module_offscreen_bin_menus_external_links:{path:"_shared/module/offscreen-bin/menus/external-links_54_10489.js"},_shared_module_offscreen_bin_menus_folder_menu:{path:"_shared/module/offscreen-bin/menus/folder-menu_5_3103.js"},_shared_module_offscreen_bin_menus_loading:{path:"_shared/module/offscreen-bin/menus/loading_54_10489.js"},_shared_module_offscreen_bin_menus_message_list_cbox_select:{path:"_shared/module/offscreen-bin/menus/message-list-cbox-select_54_10489.js"},_shared_module_offscreen_bin_menus_message_list_count:{path:"_shared/module/offscreen-bin/menus/message-list-count_54_10489.js"},_shared_module_offscreen_bin_menus_message_list_sortby:{path:"_shared/module/offscreen-bin/menus/message-list-sortby_54_10489.js"},_shared_module_offscreen_bin_menus_moneyball_ad_feedback:{path:"_shared/module/offscreen-bin/menus/moneyball-ad-feedback_5_2499.js"},_shared_module_offscreen_bin_menus_mts_external_links:{path:"_shared/module/offscreen-bin/menus/mts-external-links_54_10489.js"},_shared_module_offscreen_bin_menus_options_fresh:{path:"_shared/module/offscreen-bin/menus/options-fresh_2_2986.js"},_shared_module_offscreen_bin_menus_predictive_search_close_menu:{path:"_shared/module/offscreen-bin/menus/predictive-search-close-menu_5_2704.js"},_shared_module_offscreen_bin_menus_reply_modes:{path:"_shared/module/offscreen-bin/menus/reply-modes_54_10489.js"},_shared_module_offscreen_bin_menus_sbc_external_links:{path:"_shared/module/offscreen-bin/menus/sbc-external-links_54_10489.js"},_shared_module_offscreen_bin_menus_spam:{path:"_shared/module/offscreen-bin/menus/spam_5_2453.js"},_shared_module_offscreen_bin_menus_tab_overflow:{path:"_shared/module/offscreen-bin/menus/tab-overflow_54_10489.js"},_shared_module_offscreen_bin_menus_view:{path:"_shared/module/offscreen-bin/menus/view_2_2316.js"},_shared_module_offscreen_bin_modal:{path:"_shared/module/offscreen-bin/modal_54_10489.js",requires:["_shared_module_offscreen_bin_modal_close_icon"]},_shared_module_offscreen_bin_modal_ad_feedback_rollup:{path:"_shared/module/offscreen-bin/modal-ad-feedback_rollup_54_10489.js"},_shared_module_offscreen_bin_modal_adfree_rollup:{path:"_shared/module/offscreen-bin/modal-adfree_rollup_54_10489.js"},_shared_module_offscreen_bin_modal_attach_download:{path:"_shared/module/offscreen-bin/modal-attach-download_54_10489.js",requires:["_shared_module_offscreen_bin_modal_close_icon","_shared_module_message_norton_logo","_shared_module_offscreen_bin_modal_btn_cancel"]},_shared_module_offscreen_bin_modal_attach_download_rollup:{path:"_shared/module/offscreen-bin/modal-attach-download_rollup_54_10489.js"},_shared_module_offscreen_bin_modal_autocompose:{path:"_shared/module/offscreen-bin/modal-autocompose_54_10489.js"},_shared_module_offscreen_bin_modal_btn_cancel:{path:"_shared/module/offscreen-bin/modal-btn-cancel_54_10489.js"},_shared_module_offscreen_bin_modal_btn_continue:{path:"_shared/module/offscreen-bin/modal-btn-continue_54_10489.js"},_shared_module_offscreen_bin_modal_btn_done:{path:"_shared/module/offscreen-bin/modal-btn-done_54_10489.js"},_shared_module_offscreen_bin_modal_btn_generic:{path:"_shared/module/offscreen-bin/modal-btn-generic_54_10489.js"},_shared_module_offscreen_bin_modal_btn_manage_service_bucket_rollup:{path:"_shared/module/offscreen-bin/modal-btn-manage-service-bucket_rollup_54_10489.js"},_shared_module_offscreen_bin_modal_btn_ok:{path:"_shared/module/offscreen-bin/modal-btn-ok_54_10489.js"},_shared_module_offscreen_bin_modal_btn_remove_ads_bucket_rollup:{path:"_shared/module/offscreen-bin/modal-btn-remove-ads-bucket_rollup_54_10489.js"},_shared_module_offscreen_bin_modal_btn_save:{path:"_shared/module/offscreen-bin/modal-btn-save_54_10489.js"},_shared_module_offscreen_bin_modal_btns_done_cancel:{path:"_shared/module/offscreen-bin/modal-btns-done-cancel_54_10489.js",requires:["_shared_module_offscreen_bin_modal_btn_done","_shared_module_offscreen_bin_modal_btn_cancel"]},_shared_module_offscreen_bin_modal_btns_ok_cancel:{path:"_shared/module/offscreen-bin/modal-btns-ok-cancel_54_10489.js",requires:["_shared_module_offscreen_bin_modal_btn_ok","_shared_module_offscreen_bin_modal_btn_cancel"]},_shared_module_offscreen_bin_modal_close_icon:{path:"_shared/module/offscreen-bin/modal-close-icon_54_10489.js"},_shared_module_offscreen_bin_modal_cloud_filepermissions:{path:"_shared/module/offscreen-bin/modal-cloud-filepermissions_2_1670.js",requires:["_shared_module_offscreen_bin_modal_close_icon"]},_shared_module_offscreen_bin_modal_colors_rollup:{path:"_shared/module/offscreen-bin/modal-colors_rollup_54_10489.js"},_shared_module_offscreen_bin_modal_connected_accounts:{path:"_shared/module/offscreen-bin/modal-connected-accounts_5_2779.js",requires:["_shared_module_offscreen_bin_modal_close_icon","_shared_module_offscreen_bin_modal_btn_ok"]},_shared_module_offscreen_bin_modal_launch_error_rollup:{path:"_shared/module/offscreen-bin/modal-launch-error_rollup_54_10489.js"},_shared_module_offscreen_bin_modal_link_cancel:{path:"_shared/module/offscreen-bin/modal-link-cancel_2_862.js"},_shared_module_offscreen_bin_modal_mbFeedback:{path:"_shared/module/offscreen-bin/modal-mbFeedback_54_10489.js",requires:["_shared_module_offscreen_bin_modal_close_icon","_shared_module_offscreen_bin_modal_btn_ok","_shared_module_offscreen_bin_modal_btn_cancel"]},_shared_module_offscreen_bin_modal_onboard_imap_in:{path:"_shared/module/offscreen-bin/modal-onboard-imap-in_5_3217.js"},_shared_module_offscreen_bin_modal_quick_filters:{path:"_shared/module/offscreen-bin/modal-quick-filters_54_10489.js",requires:["_shared_module_offscreen_bin_modal_close_icon","_shared_module_offscreen_bin_modal_btn_save","_shared_module_offscreen_bin_modal_btn_cancel"]},_shared_module_offscreen_bin_modal_rhythm_confirm:{path:"_shared/module/offscreen-bin/modal-rhythm-confirm_2_2554.js",requires:["_shared_module_offscreen_bin_modal_close_icon"]},_shared_module_offscreen_bin_modal_set_encodings
:{path:"_shared/module/offscreen-bin/modal-set-encodings_54_10489.js",requires:["_shared_module_offscreen_bin_modal_close_icon","_shared_module_offscreen_bin_modal_btns_done_cancel"]},_shared_module_offscreen_bin_modal_shortcuts_rollup:{path:"_shared/module/offscreen-bin/modal-shortcuts_rollup_2_2603.js"},_shared_module_offscreen_bin_modal_subscriptionad:{path:"_shared/module/offscreen-bin/modal-subscriptionad_5_3692.js"},_shared_module_offscreen_bin_modal_unsubscribe:{path:"_shared/module/offscreen-bin/modal-unsubscribe_2_2494.js"},_shared_module_offscreen_bin_modal_unsubscribe_dialog_rollup:{path:"_shared/module/offscreen-bin/modal-unsubscribe-dialog_rollup_2_2906.js"},_shared_module_offscreen_bin_modal_unsubscribe_link_item:{path:"_shared/module/offscreen-bin/modal-unsubscribe-link-item_2_2804.js"},_shared_module_offscreen_bin_modal_upsell_rollup:{path:"_shared/module/offscreen-bin/modal-upsell_rollup_2_2986.js"},_shared_module_offscreen_bin_modal_win10_post_eol:{path:"_shared/module/offscreen-bin/modal-win10-post-eol_2_2917.js"},_shared_module_offscreen_bin_modal_windows_app:{path:"_shared/module/offscreen-bin/modal-windows-app_5_3516.js"},_shared_module_offscreen_bin_notification_header_body:{path:"_shared/module/offscreen-bin/notification/header-body_2_2572.js"},_shared_module_offscreen_bin_notification_native_ad_star:{path:"_shared/module/offscreen-bin/notification/native-ad-star_54_10752.js"},_shared_module_offscreen_bin_notification_notifications:{path:"_shared/module/offscreen-bin/notification/notifications_54_10489.js"},_shared_module_offscreen_bin_notification_refresh_dialog:{path:"_shared/module/offscreen-bin/notification/refresh-dialog_5_3334.js"},_shared_module_offscreen_bin_notification_single_inline_text:{path:"_shared/module/offscreen-bin/notification/single-inline-text_54_10489.js"},_shared_module_offscreen_bin_notification_tae_text:{path:"_shared/module/offscreen-bin/notification/tae-text_5_2253.js"},_shared_module_offscreen_bin_print_print_rollup:{path:"_shared/module/offscreen-bin/print/print_rollup_5_3349.js"},_shared_module_offscreen_bin_readlinkenhancr:{path:"_shared/module/offscreen-bin/readlinkenhancr_5_3692.js"},_shared_module_offscreen_bin_renamer:{path:"_shared/module/offscreen-bin/renamer_2_59.js"},_shared_module_offscreen_bin_s2s:{path:"_shared/module/offscreen-bin/s2s_54_10489.js"},_shared_module_offscreen_bin_save_templates:{path:"_shared/module/offscreen-bin/save-templates_2_2171.js",requires:["_shared_module_offscreen_bin_modal_close_icon","_shared_module_offscreen_bin_modal_btn_save","_shared_module_offscreen_bin_modal_btn_cancel"]},_shared_module_offscreen_bin_searcher:{path:"_shared/module/offscreen-bin/searcher_5_3082.js"},_shared_module_offscreen_bin_shell_navigation_newfolder_body_rollup:{path:"_shared/module/offscreen-bin/shell-navigation/newfolder/body_rollup_54_10489.js"},_shared_module_offscreen_bin_shell_navigation_newfolder_header_rollup:{path:"_shared/module/offscreen-bin/shell-navigation/newfolder/header_rollup_54_10489.js"},_shared_module_offscreen_bin_sleek_progress_bar:{path:"_shared/module/offscreen-bin/sleek-progress-bar_2_862.js"},_shared_module_offscreen_bin_tooltip_validation:{path:"_shared/module/offscreen-bin/tooltip-validation_5_3116.js"},_shared_module_rte_well_content_attach_item:{path:"_shared/module/rte-well/content/attach-item_54_10489.js"},_shared_module_rte_well_content_attachments:{path:"_shared/module/rte-well/content/attachments_54_10489.js",requires:["_shared_module_rte_well_content_attach_item","_shared_module_rte_well_content_file_count"]},_shared_module_rte_well_content_attachments_fresh:{path:"_shared/module/rte-well/content/attachments-fresh_2_2594.js"},_shared_module_rte_well_content_attachments_well_fresh:{path:"_shared/module/rte-well/content/attachments-well-fresh_5_2209.js",requires:["_shared_module_rte_well_content_attach_item"]},_shared_module_rte_well_content_emoticons:{path:"_shared/module/rte-well/content/emoticons_54_10489.js"},_shared_module_rte_well_content_emoticons_fresh:{path:"_shared/module/rte-well/content/emoticons-fresh_2_1599.js"},_shared_module_rte_well_content_enhancr_card_append:{path:"_shared/module/rte-well/content/enhancr-card-append_2_2281.js"},_shared_module_rte_well_content_enhancr_card_cover:{path:"_shared/module/rte-well/content/enhancr-card-cover_2_2281.js"},_shared_module_rte_well_content_enhancr_card_loading:{path:"_shared/module/rte-well/content/enhancr-card-loading_2_209.js"},_shared_module_rte_well_content_enhancr_card_medium:{path:"_shared/module/rte-well/content/enhancr-card-medium_2_2281.js"},_shared_module_rte_well_content_enhancr_card_medium_no_image:{path:"_shared/module/rte-well/content/enhancr-card-medium-no-image_2_2281.js"},_shared_module_rte_well_content_enhancr_card_mini:{path:"_shared/module/rte-well/content/enhancr-card-mini_2_2281.js"},_shared_module_rte_well_content_enhancr_link_previews:{path:"_shared/module/rte-well/content/enhancr-link-previews_2_1157.js"},_shared_module_rte_well_content_file_count:{path:"_shared/module/rte-well/content/file-count_54_10489.js",requires:["_shared_module_message_norton_logo"]},_shared_module_rte_well_content_fontnamesize_fresh:{path:"_shared/module/rte-well/content/fontnamesize-fresh_54_10489.js"},_shared_module_rte_well_content_format_fresh:{path:"_shared/module/rte-well/content/format-fresh_2_2594.js"},_shared_module_rte_well_content_inline_image_ctrl_overlay:{path:"_shared/module/rte-well/content/inline-image-ctrl-overlay_2_799.js"},_shared_module_rte_well_content_inline_image_drop_zone:{path:"_shared/module/rte-well/content/inline-image-drop-zone_54_10489.js"},_shared_module_rte_well_content_inline_image_markup:{path:"_shared/module/rte-well/content/inline-image-markup_54_10489.js"},_shared_module_rte_well_content_inline_image_saved:{path:"_shared/module/rte-well/content/inline-image-saved_54_10489.js"},_shared_module_rte_well_fresh:{path:"_shared/module/rte-well-fresh_2_2572.js",requires:["_shared_module_rte_well_content_attachments_fresh"
,"_shared_module_rte_well_content_format_fresh"]},_shared_module_rte_well_fresh_conv:{path:"_shared/module/rte-well-fresh-conv_2_2603.js",requires:["_shared_module_rte_well_content_attachments_fresh","_shared_module_rte_well_content_format_fresh","_shared_module_ca_openhide"]},_shared_module_rte_well_tabs_compose:{path:"_shared/module/rte-well/tabs/compose_54_10489.js"},_shared_module_rte_well_tabs_compose_fresh:{path:"_shared/module/rte-well/tabs/compose-fresh_54_10489.js"},_shared_module_send_confirm_captcha:{path:"_shared/module/send-confirm/captcha_54_10489.js",requires:["_shared_module_offscreen_bin_modal_btn_continue","_shared_module_offscreen_bin_modal_btn_cancel"]},_shared_module_send_confirm_captcha_blocked:{path:"_shared/module/send-confirm/captcha-blocked_54_10489.js"},_shared_module_send_confirm_rollup:{path:"_shared/module/send-confirm_rollup_54_10489.js"},_shared_module_share_menu:{path:"_shared/module/share-menu_2_558.js"},_shared_module_smarttop_smarttop:{path:"_shared/module/smarttop/smarttop_5_2457.js"},_shared_module_thread_thread_display_rollup:{path:"_shared/module/thread/thread-display_rollup_2_2603.js"},_shared_module_thread_thread_pane:{path:"_shared/module/thread/thread-pane_2_2388.js",requires:["_shared_module_message_prompt","_shared_module_thread_thread_display_rollup"]},_shared_module_toolbar_compose:{path:"_shared/module/toolbar/compose_54_10489.js"},_shared_module_toolbar_compose_fresh:{path:"_shared/module/toolbar/compose-fresh_54_10489.js"},minty_module_ads_chrome_dss_ext:{path:"minty/module/ads/chrome_dss_ext_54_10489.js"},minty_module_ads_mobilizer:{path:"minty/module/ads/mobilizer_54_10489.js"},minty_module_ads_mobilizerpane:{path:"minty/module/ads/mobilizerpane_54_10489.js"},minty_module_ads_native_ad_forward:{path:"minty/module/ads/native-ad-forward_5_1137.js"},minty_module_ads_spritz_leave_behind:{path:"minty/module/ads/spritz-leave-behind_5_2169.js"},minty_module_boss_preview_overlay:{path:"minty/module/boss/preview-overlay_54_10489.js"},minty_module_boss_themes_strip:{path:"minty/module/boss/themes-strip_54_10489.js"},minty_module_confirmation_dialog:{path:"minty/module/confirmation-dialog_2_2804.js"},minty_module_contacts_edit_basics_emails:{path:"minty/module/contacts/edit/basics/emails_54_10489.js",requires:["minty_module_contacts_edit_select_lists_emails"]},minty_module_contacts_edit_basics_ims:{path:"minty/module/contacts/edit/basics/ims_54_10489.js",requires:["minty_module_contacts_edit_select_lists_ims"]},minty_module_contacts_edit_basics_phones:{path:"minty/module/contacts/edit/basics/phones_54_10489.js",requires:["minty_module_contacts_edit_select_lists_phones"]},minty_module_contacts_edit_error:{path:"minty/module/contacts/edit/error_54_10489.js"},minty_module_contacts_edit_name:{path:"minty/module/contacts/edit/name_54_10489.js"},minty_module_contacts_edit_select_lists_emails:{path:"minty/module/contacts/edit/select-lists/emails_54_10489.js"},minty_module_contacts_edit_select_lists_ims:{path:"minty/module/contacts/edit/select-lists/ims_54_10489.js"},minty_module_contacts_edit_select_lists_phones:{path:"minty/module/contacts/edit/select-lists/phones_54_10489.js"},minty_module_conversations_modal_convs_confirm_rollup:{path:"minty/module/conversations/modal-convs-confirm_rollup_54_10489.js"},minty_module_expiring_coupon_item:{path:"minty/module/expiring-coupon-item_2_2448.js"},minty_module_expiring_coupons:{path:"minty/module/expiring-coupons_2_2443.js"},minty_module_imapin_post_mobile_upsell:{path:"minty/module/imapin-post-mobile-upsell_2_2152.js"},minty_module_key_task_panel:{path:"minty/module/key-task/panel_2_2492.js"},minty_module_list_view_ad_buckets_mb_list_img:{path:"minty/module/list-view-ad/buckets/mb-list-img_2_985.js"},minty_module_list_view_ad_buckets_mb_right_rail_save_ad:{path:"minty/module/list-view-ad/buckets/mb_right_rail_save_ad_5_1673.js"},minty_module_list_view_ad_buckets_newsfeed_save_ad:{path:"minty/module/list-view-ad/buckets/newsfeed_save_ad_5_1595.js"},minty_module_list_view_ad_buckets_serp_ratings:{path:"minty/module/list-view-ad/buckets/serp_ratings_5_2428.js"},minty_module_list_view_ad_mas_search:{path:"minty/module/list-view-ad/mas-search_54_10489.js"},minty_module_list_view_ad_mb:{path:"minty/module/list-view-ad/mb_5_1618.js"},minty_module_list_view_ad_mb_native:{path:"minty/module/list-view-ad/mb-native_2_1147.js"},minty_module_list_view_ad_mb_native_feedback:{path:"minty/module/list-view-ad/mb-native-feedback_2_2982.js"},minty_module_list_view_ad_mb_native_img_link:{path:"minty/module/list-view-ad/mb-native-img-link_2_2972.js"},minty_module_list_view_ad_mb_native_sponsored_carousel:{path:"minty/module/list-view-ad/mb-native-sponsored-carousel_2_1783.js"},minty_module_list_view_ad_mb_native_sponsored_img:{path:"minty/module/list-view-ad/mb-native-sponsored-img_2_2009.js"},minty_module_list_view_ad_mb_native_sponsored_leadsgen:{path:"minty/module/list-view-ad/mb-native-sponsored-leadsgen_2_1193.js"},minty_module_list_view_ad_mb_native_sponsored_video:{path:"minty/module/list-view-ad/mb-native-sponsored-video_2_2887.js"},minty_module_list_view_ad_mb_native_vert_prev:{path:"minty/module/list-view-ad/mb-native-vert-prev_2_2628.js"},minty_module_list_view_ad_mbrec:{path:"minty/module/list-view-ad/mbrec_5_2365.js"},minty_module_list_view_ad_search:{path:"minty/module/list-view-ad/search_54_10489.js"},minty_module_list_view_ad_skysearch:{path:"minty/module/list-view-ad/skysearch_54_10489.js"},minty_module_mobile_upsell_generic:{path:"minty/module/mobile-upsell-generic_2_2594.js"},minty_module_mobile_upsell_task_panel:{path:"minty/module/mobile-upsell-task-panel_2_1579.js"},minty_module_moneyball_msg_read_img:{path:"minty/module/moneyball/msg-read-img_5_1618.js"},minty_module_moneyball_newsfeed_mb:{path:"minty/module/moneyball/newsfeed-mb_5_1618.js"},minty_module_moneyball_right_rail:{path:"minty/module/moneyball/right-rail_5_1618.js"},minty_module_moneyball_right_rail_carousel:{path:"minty/module/moneyball/right-rail-carousel_54_10489.js"
},minty_module_newsfeed_filterbar:{path:"minty/module/newsfeed/filterbar_2_2321.js"},minty_module_newsfeed_filterbar_weather:{path:"minty/module/newsfeed/filterbar-weather_5_2523.js"},minty_module_newsfeed_listview:{path:"minty/module/newsfeed/listview_5_2611.js"},minty_module_newsfeed_loaderror:{path:"minty/module/newsfeed/loaderror_5_1477.js"},minty_module_newsfeed_storyview:{path:"minty/module/newsfeed/storyview_5_1005.js"},minty_module_offscreen_bin_callout_adfree:{path:"minty/module/offscreen-bin/callout-adfree_2_2086.js"},minty_module_offscreen_bin_callout_default:{path:"minty/module/offscreen-bin/callout-default_2_1080.js"},minty_module_offscreen_bin_cloud_toolbar_callout:{path:"minty/module/offscreen-bin/cloud-toolbar-callout_2_1837.js"},minty_module_offscreen_bin_compose_toolbar_callout:{path:"minty/module/offscreen-bin/compose-toolbar-callout_2_2552.js"},minty_module_offscreen_bin_holiday_themes_callout:{path:"minty/module/offscreen-bin/holiday-themes-callout_54_10489.js"},minty_module_offscreen_bin_mobilizer:{path:"minty/module/offscreen-bin/mobilizer_2_651.js"},minty_module_offscreen_bin_multitask_callout_rollup:{path:"minty/module/offscreen-bin/multitask-callout_rollup_54_10489.js"},minty_module_offscreen_bin_native_ad_callout:{path:"minty/module/offscreen-bin/native-ad-callout_5_1554.js"},minty_module_offscreen_bin_native_ad_star:{path:"minty/module/offscreen-bin/native-ad-star_5_1137.js"},minty_module_offscreen_bin_norrin_upsell_takeover:{path:"minty/module/offscreen-bin/norrin-upsell-takeover_2_2607.js"},minty_module_offscreen_bin_notification_screen_overlay:{path:"minty/module/offscreen-bin/notification-screen-overlay_2_1799.js"},minty_module_offscreen_bin_peoplesearch_callout_rollup:{path:"minty/module/offscreen-bin/peoplesearch-callout_rollup_54_10489.js"},minty_module_offscreen_bin_seasonal_promotion:{path:"minty/module/offscreen-bin/seasonal-promotion_2_2958.js"},minty_module_pinkbox:{path:"minty/module/pinkbox_2_1795.js"},minty_module_rhythm_callout:{path:"minty/module/rhythm-callout_2_2554.js"},minty_module_rough_seas_upsell_nf:{path:"minty/module/rough-seas/upsell-nf_2_1966.js"},minty_module_shell_ad_searchads:{path:"minty/module/shell-ad/searchads_54_10489.js"},minty_module_shell_navigation_pane_account_item:{path:"minty/module/shell-navigation/pane/account-item_2_2639.js"},minty_module_shell_navigation_pane_account_menu:{path:"minty/module/shell-navigation/pane/account-menu_2_521.js"},minty_module_shell_navigation_pane_inbox_copyright:{path:"minty/module/shell-navigation/pane/inbox-copyright_2_2607.js",requires:["minty_module_shell_navigation_pane_launch_screen"]},minty_module_shell_navigation_pane_inbox_sticky_refresh:{path:"minty/module/shell-navigation/pane/inbox-sticky-refresh_2_342.js",requires:["_shared_module_folder_list_mailbox_list"]},minty_module_shell_navigation_pane_launch_screen:{path:"minty/module/shell-navigation/pane/launch-screen_2_2607.js"},minty_module_tabs_navtabs_removable:{path:"minty/module/tabs/navtabs-removable_54_10489.js"},minty_module_tabs_tab_removable:{path:"minty/module/tabs/tab-removable_54_10489.js"},minty_module_toggle_button:{path:"minty/module/toggle-button_2_2486.js"},minty_module_toggle_button_v2:{path:"minty/module/toggle-button-v2_2_2486.js"},minty_module_toolbar_fragments_native_ad_group_rollup:{path:"minty/module/toolbar/fragments/native_ad_group_rollup_2_1193.js"},minty_module_toolbar_fragments_reply_group:{path:"minty/module/toolbar/fragments/reply_group_54_10489.js"},minty_module_toolbar_fragments_reply_group_conv:{path:"minty/module/toolbar/fragments/reply_group_conv_54_10586.js"},minty_module_toolbar_inbox:{path:"minty/module/toolbar/inbox_54_10489.js"},minty_module_toolbar_inbox_archive_fresh_rollup:{path:"minty/module/toolbar/inbox/archive-fresh_rollup_2_441.js"},minty_module_toolbar_inbox_archive_thread_rollup:{path:"minty/module/toolbar/inbox/archive-thread_rollup_2_1075.js"},minty_module_toolbar_inbox_conversation_fresh_rollup:{path:"minty/module/toolbar/inbox/conversation-fresh_rollup_2_159.js"},minty_module_toolbar_inbox_conversation_thread_rollup:{path:"minty/module/toolbar/inbox/conversation-thread_rollup_2_159.js"},minty_module_toolbar_inbox_default_fresh_rollup:{path:"minty/module/toolbar/inbox/default-fresh_rollup_2_159.js"},minty_module_toolbar_inbox_default_rollup:{path:"minty/module/toolbar/inbox/default_rollup_2_159.js"},minty_module_toolbar_inbox_default_thread_rollup:{path:"minty/module/toolbar/inbox/default-thread_rollup_2_1075.js"},minty_module_toolbar_inbox_drafts_fresh_rollup:{path:"minty/module/toolbar/inbox/drafts-fresh_rollup_2_159.js"},minty_module_toolbar_inbox_drafts_thread_rollup:{path:"minty/module/toolbar/inbox/drafts-thread_rollup_2_1075.js"},minty_module_toolbar_inbox_message_fresh:{path:"minty/module/toolbar/inbox/message-fresh_2_441.js",requires:["minty_module_toolbar_fragments_reply_group"]},minty_module_toolbar_inbox_message_thread:{path:"minty/module/toolbar/inbox/message-thread_2_1075.js",requires:["minty_module_toolbar_fragments_reply_group_conv"]},minty_module_toolbar_inbox_search_fresh_rollup:{path:"minty/module/toolbar/inbox/search-fresh_rollup_2_159.js"},minty_module_toolbar_inbox_search_thread_rollup:{path:"minty/module/toolbar/inbox/search-thread_rollup_2_159.js"},minty_module_toolbar_inbox_sent_fresh_rollup:{path:"minty/module/toolbar/inbox/sent-fresh_rollup_2_159.js"},minty_module_toolbar_inbox_sent_msg_rollup:{path:"minty/module/toolbar/inbox/sent-msg_rollup_2_159.js"},minty_module_toolbar_inbox_sent_thread_rollup:{path:"minty/module/toolbar/inbox/sent-thread_rollup_2_1075.js"},minty_module_toolbar_inbox_spam_fresh_rollup:{path:"minty/module/toolbar/inbox/spam-fresh_rollup_2_159.js"},minty_module_toolbar_inbox_spam_thread_rollup:{path:"minty/module/toolbar/inbox/spam-thread_rollup_2_1075.js"},minty_module_trending_gifts:{path:"minty/module/trending/gifts_5_3618.js"},minty_module_trending_trending:{path:"minty/module/trending/trending_2_1544.js"},minty_module_ui_player_click_record
:{path:"minty/module/ui-player/click-record_54_10606.js"},minty_module_ui_player_controls:{path:"minty/module/ui-player/controls_54_10543.js"},minty_module_unsubscribe_error_dialog_rollup:{path:"minty/module/unsubscribe-error-dialog_rollup_2_2804.js"},minty_module_video_emptyfolder_vd_rollup:{path:"minty/module/video/emptyfolder-vd_rollup_2_1193.js"},minty_module_video_nativead_vd:{path:"minty/module/video/nativead-vd_2_2862.js"},minty_module_video_newsfeed_vd:{path:"minty/module/video/newsfeed-vd_5_2713.js"},minty_module_video_spotlight_vd:{path:"minty/module/video/spotlight-vd_2_722.js"}}}};e.Env._loader?e.Env._loader._config({groups:t}):e._config({groups:t})},"1.0.0");


YUI.add("common-net-diag",function(e){e.namespace("common.net"),e.common.net.Diag=function(){function c(){return Date.now()}function h(t){function n(){var e,n;(e=i[t])&&!e.end&&(n=c()-e.start,n>u&&(e.stale=!0,a(["Session stale : ",t,":",e.key,"stale for",n," ms"].join(" ")),b("stalecheck")))}e.later(u,null,n)}function p(e,t){s[e]||(s[e]=[]),s[e].push(t)}function d(){var e,t=arguments[0],n=s["net:"+t],r="",i="",o,u=[];for(e=1;e<arguments.length;e++)u.push(arguments[e]);for(e=0;n&&e<n.length;e++)if(o=n[e].apply(null,u))r+=o.log&&o.log+";"||"",i+=o.dbgui&&o.dbgui+";"||"";return{log:r,dbgui:i}}function v(e,t,n){var r=e.id,s=d("start",e,t,n),o=t.method||(t.service||"")+e.request.url.match(/\/[^\/]*\?+/),u=s.log,f=s.dbgui||"";i[r]={id:r,key:o,desc:[f],start:e.start||c(),args:t&&t.args},b("start"),h(r),a(["net [start] id:",r,o,"desc:",f,u].join(" "))}function m(e,t){var n=i[e.id],r=d("complete",e,t),s=r.dbgui,o="",u=r.log||"";n&&(n.end=e.end||c(),s.length&&n.desc.push(s)),b("complete"),a(["net [complete] id:",n.id,n.key,"time :",o,u].join(" "))}function g(e,t,n){var r=i[e.id];r&&(r.end=e.end||c(),r.aborted=!0,r.timedout=n,b("abort"),a(["net [aborted] id: "+e.id,"timeout: ",n,r?r.end-r.start:-1,d("abort",e,t,n).log].join(" ")))}function y(e,t){var n=t.status,s=e.id,o=d("end",e,t),u=i[s],f=o.dbgui,l=o.log;u&&(f.length&&u.desc.push(f),b("done"),n!==r.abort&&r!==r.xhr&&a(["net [done] id:"+s,"total: "+(u.end?u.end-u.start:-1),"msecs http: "+t.status,l].join(" ")))}function b(){if(o){var e='<span style="color:red">Open sessions : </span>',t,n,r,s=[],u=[],a=[],c;for(n in i)c=i[n],c.done=c.end||c.abort,c.done?u.push(n):a.push(n);while(u.length&&u.length+a.length>10)delete i[u[0]],u.shift();for(n in i)c=i[n],r=c.stale&&'<span style="color:red">'+(c.end?c.aborted?c.timedout?"TIMEDOUT":"ABORTED":"DONE":"STALE")+"</span>"||!c.end&&"OPEN",t=["<br/>","[",c.id,"]",'<span style="color:blue">'+c.key+"</span>",r||"",c.desc.join("<br/>"),c.end?["<br/>client :",f,c.end-c.start,l,"ms"].join(" "):""].join(" "),s.push(t);s.reverse(),o.setBody(e+a.length+s.join(""))}}function w(){if(o)return;e.use("common-ui-diagpanel",function(){o=new e.common.ui.DiagPanel({},function(){o=null}),b("panelopen")})}var t=e.common,n=t.Utils,r=t.net.Status,i={},s={},o,u=NeoConfig.chkStaleReq||3e4,a=n.traceMsg,f='<span style="font-weight:bold">',l="</span>";e.on("net:start",v),e.on("net:complete",m),e.on("net:abort",g),e.on("net:end",y);var E={addLogger:p,showSessions:w};return E}()},"1.0.0",{requires:["common-net-session","common-utils"]});


YUI.add("common-net-session",function e(t){function N(e){try{t.fire.apply(t,e)}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-net-session:1",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-net-session:1"),t.use("common-utils-error",function(){r.error.report("netsession error",n,1,1,1)})}}function C(){return Date.now()}function k(){try{return a?new f:new ActiveXObject("Microsoft.XMLHTTP")}catch(e){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-net-session:2",e,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-net-session:2")}return}function L(e){e._timeoutid&&(u.clearTimeout(e._timeoutid),e._timeoutid=l)}function A(e){try{var t=e._conn;t&&a&&delete t.onreadystatechange}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-net-session:3",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-net-session:3")}e._conn=l}function O(e,t,n){var r,i=e.match(/\?([\w\W])*/);return i=i&&i[0]?i[0].length>1?"&":"":"?",r=M(t,n),[e,r.length?i:"",r].join("")}function M(e,t){var r,i,s,o,u,a,f=[],l=_(e,t);for(r in e){a=l[r],u=a?encodeURIComponent(r):r,i=e[r];if(n.isArray(i))for(s=0,o=i.length;s<o;s++)f.push([u,a?encodeURIComponent(i[s]):i[s]].join("="));else f.push([u,a?encodeURIComponent(e[r]):e[r]].join("="))}return f.join("&")}function _(e,t){var r={},i;if(n.isObject(t))return t;if(t!==!1)for(i in e)r[i]=1;return r}function D(e){if(n.isString(e)){var t=this.responseHeaders,r=e.toLowerCase(),i;for(i in t)if(i.toLowerCase()===r)return t[i]}return l}function P(e){function n(e,t){var n=t;try{n=a[e]}catch(r){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-net-session:4",r,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-net-session:4")}return n}var r,i={},s=0,o,u,a=e._conn,f=a.status===1223,l,c,h,p,d,v;try{r={status:f?204:a.status,statusText:f?"No Content":n("statusText",""),callback:e._callback,request:e.request,responseHeaders:"",allHeadersText:"",getResponseHeader:D,responseText:n("responseText"),responseXML:n("responseXML"),id:e.id},l=a.getAllResponseHeaders(),v=l.split("\n"),o=v.length;if(r.status===340||r.status===342){switch(r.status){case 340:h=/"code":"(.*?)","message/g,p=h.exec(r.responseText),d=p&&p.length>1&&p[1]||"Unknown",r.status=500;break;case 342:r.status=502}t.fire("util:ymstats",{name:"http_status_map",tags:{httpStatus:a.status,code:d?d:"Unknown",browser:NeoConfig.browser},include:{farm:!0}})}while(o--)c=v[s++],u=c.indexOf(":"),u!==-1&&(i[c.substring(0,u)]=c.substring(u+2));e.end&&e.start&&(r.curlTime=e.end-e.start),r.responseHeaders=i,r.allHeadersText=l}catch(m){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-net-session:5",m,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-net-session:5")}return r}function H(e,t,n){var r,i=e._conn,o,u="unknown",a=n&&n.name===d&&n.code,f=-1;try{t?(o=t.timeout?s.timeout:s.abort,u="abort"):(i&&(f=i.readyState),f<=3?(o=a,u="readyState."+f):r=P(e))}catch(c){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-net-session:6",c,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-net-session:6")}return r||(r={status:o||s.xhr,statusText:u,responseText:n&&n.message||l,callback:e._callback,request:e.request,getResponseHeader:D,id:e.id}),r}function B(e){r.assert(e._conn.readyState),e._conn.readyState===4&&(L(e),e.end=C(),N([m,e,e._callback]),F(e))}function j(e,t,n){function r(){N([y,e,t]),A(e),t=l,T--,T||N([b,1])}var i=e._callback||{},s=n?i.success:i.failure;s?s.call(i.scope,e,t,r):r()}function F(e,n){var r=0,i,s,o=e._conn;try{r=o&&o.status||0}catch(u){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-net-session:7",u,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-net-session:7"),t.fire("MailLog",{m:"Connection status unavailable"})}s=!n&&(r>=200&&r<300||r===1223),i=s?P(e):H(e,n),j(e,i,s)}function I(){var t,n;e.reqSeq++,t=e.reqSeq.toString(16),n=4-t.length;while(n--)t="0"+t;return NeoConfig.uuid?NeoConfig.uuid.replace("SEQN",t):""}t.namespace("common.net");var n=t.Lang,r=t.common.Utils,i=t.common.net,s=i.Status={},o=0,u=t.config.win||window,a=typeof XMLHttpRequest!="undefined",f=t.config&&t.config.net?t.config.net.XMLHttpRequest:window.XMLHttpRequest,l,c="GET",h,p=[],d="net:exc",v="net:start",m="net:complete",g="net:abort",y="net:end",b="net:idle",w="net:online",E="net:offline",S=35e3,x=r.features.enabled("autoCheckNetwork"),T=0;e.reqSeq||(e.reqSeq=0),t.mix(t.Node.DOM_EVENTS,{online:!0,offline:!0}),typeof NeoGV.isOnline=="undefined"&&(NeoGV.isOnline=!0,t.on("online",function(){t.fire(w)}),t.on("offline",function(){x?i.Pulse.checkNetStatus(!0):t.fire(E)})),i.Session=function(e,t,n,r,i,s){var u=this,a;n=n?n.toUpperCase():c,a=n===c,u.request={url:e,urlparams:a?r||{}:{},post:a?l:r,mthd:n,enc:_(r,i),headers:{}},u._callback=t,!s&&s!==0?u.id=o:u.id=s,++o};var q=i.Session;q.formatQueryParams=M,q.genReqID=I,q.suspendRequests=function(e){h=e},q.resumeRequests=function(){h=l;while(p.length)p[0].send(),p.splice(0,1)},q.isIdle=function(){return T===0},q.createXHR=function(){return k()},q.prototype={_callback:{},_conn:l,tries:0,_timeoutid:l,start:0,end:0,addUrlParam:function(e,t,n){var r=this.request,i=r.urlparams;i[e]=t,n!==!1&&(r.enc[e]=1)},send:function(){var e=this,i=t.common.net.Session,o=e.request,a=e._callback||{},f=o.mthd,c=o.url,m,g,y,w,E;if(h){p.push(e);return}e.abort();try{e.tries++,o.rand=o.urlparams.r||(new Date).getTime(),o.urlparams.ymreqid=i.genReqID(),NeoConfig.expBucketId!=="0"&&(o.urlparams.ymbucketid=encodeURIComponent(NeoConfig.expBucketId)),c=O(c,o.urlparams,o.enc);if(c.length>=2048)throw E=new Error("URL size over:"+
c),E.name=d,E.code=s.maxsize,E;e._conn=k(),m=e._conn,g=o.post,o.postdata=g=n.isFunction(g)?g():g,m.open(f,c,!0),e.applyHeaders(),m.onreadystatechange=function(){e._conn&&B(e)},y=a.timeout,y&&(e._timeoutid=u.setTimeout(function(){e.abort(!0)},y)),e.end=0,e.start=C(),N([v,e,a,c]),m.send(g||""),T||N([b,0]),T++}catch(S){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-net-session:8",S,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-net-session:8"),t.fire("SplunkLog","debug_networkerror",{request:e.request||{},exceptionName:S.name,exceptionMessage:S.message},r.settings.value("SplunkLogLevel","sample")),w=H(e,l,S),u.setTimeout(function(){j(e,w)},0)}},setHeader:function(e,t){this.request.headers[e]=t},getHeaders:function(){var e=[],t,n=this.request.headers;for(t in n)e.push([t,n[t]].join("="));return e.join(";")},applyHeaders:function(){var e,n=this,i=n._conn,s=n.request.headers;if(i){r.assert(!r.isEmpty(s));for(e in s)i.setRequestHeader(e,s[e]);t.config&&t.config.net&&i.setRequestHeader("Cookie",t.config.net.cookie)}},abort:function(e){var t,n=this._conn;n&&(t=this,n.readyState!==0&&n.readyState!==4&&(L(t),A(t),n.abort(),N([g,t,t._callback,e]),F(t,{timeout:e})))}},t.mix(s,{timeout:-1,xhr:-2,maxsize:-3,abort:-4})},"1.0.0",{requires:["node","event-custom","common-utils","mail-model-datastore","mail-common-utils-features","mail-common-utils-settings"]});


YUI.add("common-net-sessionmgr",function(e){var t=e.common.net;t.SessionMgr=function(){function b(e,t,n,r,i){var s;return e&&(s={code:e,message:t,detail:n,host:i,subcode:r}),s}function w(t){var n=t.responseText||"";n=n.replace(/<!--?(.*)?-->[\r\n]*$/,"");if(e.Lang.trim(n)===""){E(n,t);return}t.body=e.common.Utils.json.tryParse(n,function(e,n){E(e,t,n.name+":"+n.message)})}function E(t,n,r){var i,o,u=!1,a=/^\s*<!doctype\s*[^>]*?>\s*/i,f=/\n/g,l=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;e.Lang.trim(t)===""?o="Empty JSON body":t.match(a)?(o="!DOCTYPE is presented at the beginning of json response",S(n,a),u=!0):t.match(l)?(o="Script is presented in json response",S(n,l),u=!0):t.match(f)?(o="New line char present in the response",S(n,f),u=!0):o="Unknown JSON parse error",u||(i=s.parse,n.fault=b(i,(r||"")+" Response parse failed.",{respTxt:t})),r&&e.fire("SplunkLog","debug_validateJSONError",{request:n.request||n.requestBatch||"",response:n.responseText||n.responseTextBatch||"",errorType:o,exceptionMessage:r},v.value("SplunkLogLevel","sample"))}function S(e,t){e.responseText=e.responseText.replace(t,""),w(e)}function x(e,t){var n=P.validate[e];n?n(t):t.body=t.responseXML||t.responseText}function T(t,n){var o=0,u=n.callback,a,f,l,c;t.multipart&&(n=u.parseMultiPartResponse(n)),a=s.getErrType(t,n);if(a){if(a===s.conn||a===s.unavailable)o=2,g&&(o=1);f=a===s.abort||a===s.timeout||a===s.login||a.indexOf(s.send)===0,n.fault={code:a}}else x(u.responseType,n);u.formatter&&u.formatter(t,n);if(m&&t.request&&t.request.postdata&&n.fault&&n.fault.code){try{l=i.parse(t.request.postdata)}catch(h){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-net-sessionmgr:1",h,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-net-sessionmgr:1"),c={errorMsg:"retryAPIOnError= "+h.message},e.fire("SplunkLog","debug_formatter_jsonparse",c,v.value("SplunkLogLevel","sample"))}l&&N(l.method,n.fault.code)===!0&&(g&&n.fault.code===s.timeout&&(f=0),o=y,t.retryLogData={API:l.method,code:n.fault.code,httpStatus:n.status,attempt:t.tries,succeeded:!1,suppressStat:u&&u.suppressStat||!1},e.fire("SplunkLog","debug_api_on_error_retry",t.retryLogData,"critical"))}u.retries=f?0:r.isNumber(u.retries)?u.retries:o}function N(e,t){var n=v.value("retryAPIErrMap"),r,i,s,o;if(typeof n!="object"||!e||!t)return!1;for(r in n){if(r!==e)continue;i=n[r],o=i&&i.length;if(o>0)for(s=0;s<o;s++)if(i[s]===t)return!0}return!1}function C(t){var n=t.allHeadersText||"",r=e.Lang.trim(t.responseText),i;if(n.indexOf("Content-Type: text/html")>-1||(/^<html/i.test(r)||/^<!doctype html/i.test(r))&&(/<\/html>[\s]*$/i.test(r)||/<\/html>[\s]*[\r\n]*<!--?(.*)?-->[\r\n]*$/i.test(r)))return/<\/html>[\s]*$/i.test(r)?i="External":/<\/html>[\s]*[\r\n]*<!--?(.*)?-->[\r\n]*$/i.test(r)?i="Internal":i="Unknown",i}function k(e){e.fault=b(s.unknown)}function L(e){function t(){var e=this;e.success=e.failure=O,e.scope=P}return t.prototype=e,t.prototype.constructor=t,new t}function A(e){return e.constructor.prototype}function O(n,r,i){function g(){(v=c&&c.failure)&&v.call(p,o,h,n),i(),_()}var o=r,u=r.status,a=r.callback,c,h,p,d,v;try{T(n,o);if(o.fault&&n.tries<=a.retries)return o.fault.code===s.conn&&e.fire("util:ymstats",{name:"httpconnerror",tags:{browser:NeoConfig.browser,status:u,tries:n.tries,url:o.request.url}}),e.later(this._retryTimeout(n.tries),null,function(){n.send()}),!0;u!==200&&!o.fault&&k(o),c=o.callback=A(a),c&&(h=c.args,p=c.scope),o.fault?u===t.Status.abort?g():(e.fire(l,n,o),s._handle(n,o,g)):(e.fire(f,o),d=c&&c.success,d&&(d.call(p,o,h,n),i(),_()),m&&n.retryLogData&&(n.retryLogData.succeeded=!0,n.retryLogData.attempt=n.tries,n.retryLogData.suppressStat=d&&d.suppressStat||!1,e.fire("SplunkLog","debug_api_on_error_retry",n.retryLogData,"critical")))}catch(y){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-net-sessionmgr:2",y,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-net-sessionmgr:2")}}function M(e){a.push(e)}function _(){if(!u&&a.length){var e=a.shift();e&&e.send?e.send():_()}}function D(e,t){var n=t.data||"",i,s={},o,u=null,a;return t=t||{},i=t.on||{},n=t.data||"",o=t.method||"GET",s.service=t.service,s.serviceCredType=t.serviceCredType,s.scope=t.context,s.timeout=t.timeout,s.args=t.args,s.suppressWssid=t.suppressWssid,i.success&&(s.success=function(e,t){i.success(0,e,t)}),i.failure&&(s.failure=function(e,t){i.failure(0,e,t)}),s.responseType=t.responseType||"json",s.suppressCodes=t.suppressCodes||["*"],a=r.isUndefined(t.sync)?!0:!t.sync,P.request(e,n,s,o,u,a)}var n=t.Session,r=e.Lang,i=e.JSON,s=t.Error,o=NeoConfig.wssid,u,a=[],f="net:success",l="net:failure",c="net:suspended",h="net:resumed",p=e.common.Utils,d=p.features,v=p.settings,m=d.enabled("retryAPIOnError"),g=d.enabled("retryOnTimeoutConnErr"),y=v.value("wsReadRetryCount"),P={request:function(e,n,r,i,s,f,l){var c,h,p,d;r=r||{},r.args||(r.args={}),p=L(r),c=new t.Session(e,p,i,n,s),c.multipart=l,c.setHeader("Content-Type","application/"+(p.responseType||"json")),o&&!r.suppressWssid&&c.addUrlParam("wssid",o,!1);if(r.urlParams)for(d in r.urlParams)r.urlParams.hasOwnProperty(d)&&c.addUrlParam(d,r.urlParams[d]);return c.callbackData=r.args,f?u||a.length?M(c):c.send():(h=c.send,c.send=function(){var e=this;e.send=h,u||a.length?M(e):h.apply(e)}),c},requestProxy:D,formatQueryParams:function(e,t){return n.formatQueryParams(e,t)},getWssid:function(){return o},setWssid:function(e){o=e;for(var t=0,n=a.length;t<n;t++)a[t].addUrlParam("wssid",o,!1)},makeFaultObject:b,validate:{json:w},isHtml:C,suspend:function(t){u=t,e.fire(c,t)},resume:function(){u=0,_(),e.fire(h)},queue:M,_qsize:function(){return a.length},_qclear:function(){a=[]},pingTest:function(){},_retryTimeout:function(e){return Math.pow(e,2)*1e3}};return P}()},"1.0.0",{requires:["event-custom-base","common-net-session","common-net-error-base","json-parse","ymma-stats","mail-common-utils-features"
,"mail-common-utils-settings","common-utils-jsonparse"]});


YUI.add("common-net-error-base",function(e){function a(e){for(var t=0;t<o.length;t++)if(e===o[t])return!0}function f(e,t){t=t&&t.replace(/<br\/>/g,"\n").replace(/<p\/>/g,"\n"),t&&window.alert(t),e&&e()}e.namespace("common.net");var t=e.common,n=t.net,r=t.Utils,i="HTTPError.",s=n.Error=n.Error||{},o=[502,900,12002,12152,12007,12029,12030,12031,13030,0],u=s.handler=[];e.mix(s,{base:i,conn:i+"conn",ydod:i+"999",abort:"abort",timeout:"timeout",unknown:"unknown",login:"login",loginfail:"loginfail",parse:"parse",send:"xhrsend",wssid:"invalidwssid",unavailable:i+"503",isHttp:function(e){return/^HTTPError/.test(e)},isConn:function(e){return e==="HTTPError.conn"},isUnexpected:function(e,t){return!a(e)&&s.isHttp(t)&&e!==2&&e!==999&&e!==302},getErrType:function(e,r){var o=r.status,u=n.Status,f,l;return o!==200&&o!==500&&(o===u.xhr||o===u.maxsize?f=s.send+"."+r.statusText:o===u.abort?f=s.abort:o===u.timeout?f=s.timeout:(e.tries===1&&(l=(o===0||o===302)&&!t.UserSession.same()),f=l?s.login:a(o)?s.conn:i+o,r.status=l?401:o===0?13030:o)),f},_fireHandlers:function(){arguments[arguments.length-1]()},_handle:function(){var t=arguments;e.use("common-net-error",function(){s._fireHandlers.apply(s,t)})},onError:function(t,n){var i;return r.assert(t),n?(i=e.Array.indexOf(u,t))!==-1&&u.splice(i,1):(u.push(t),i=1),i>=0},show:f,showAlert:f})},"1.0.0",{requires:["common-utils","common-user-session"]});


YUI.add("common-net-error",function(e){function x(t,n,r,i,o){i=i||{},e.mix(i,{hd:r||c(strings.str_error_title,null,null,null,strings),bd:o?n:'<div class="dlg-error">'+n+"</div>"}),n?(s.assert(p),p?p.alert(i,{ok:{handler:t}}):f.showAlert(t,n,r,i)):t&&t()}function T(t,n,r,i,o){o=o||{},e.mix(o,{hd:i||c(strings.str_error_title,null,null,null,strings),bd:'<div class="dlg-error">'+r+"</div>"}),r?(s.assert(p),p?p.confirm(o,{ok:{handler:t},cancel:{handler:n}}):f.showAlert(t,r,i,o)):t&&t()}function N(n,i,s){function p(t){var n=t&&t.callback;if(t.id===a||n&&!n.suppressWssid)delete y[a],e.unsubscribe(o)}if(S)return u.queue(n),!0;var o,a=n.id,l,c=y[a]||0,h=i.fault;try{c===0&&(o=e.on("net:success",p)),y[a]=++c;if(c===t){h.code=f.wssid,h.message=["wssid net :",u.getWssid(),"resp :",s].join(" "),C({msg:strings.str_error_wstoken,stat:"BadWssid"});return}if(c>=t)return!0;s&&(l=r.getState(),l.newuser?A():(F(s),n.addUrlParam("wssid",s,!1),n.send()))}catch(d){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-net-error:1",d,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-net-error:1")}return!!s}function C(t){var n=t||{},r,i=n.url||d;e.later(0,null,function(){i?window.location=i:window.location.reload()}),r=document.body;while(r.children.length)r.removeChild(r.children[0])}function k(e){var t,n=e.request;if(n.mthd==="GET")return t=u.request(n.url,u.formatQueryParams(n.urlparams,n.enc),e.callback,"POST",n.enc),t.send(),!0;return}function L(e){var t,n="us",r=e&&['"',strings.str_cfg_url_arc_help+"?token=",e,"&.intl=",n,"&property=abuse_ops",'"'].join("");t=["<p class=userMessage >",strings.str_error_ydod_error,".<br/>",r?strings.str_error_ydod_token_link.replace("{linkURL}",r):"","</p>"].join(""),x(null,t,strings.str_error_ydod_title)}function A(){C({msg:c(strings.str_error_reload_user_change,{username:h.get("userSendPref.loggedInAlias")},null,null,strings),stat:"UserChange"})}function O(){S&&S.destroy(),E=S=null,r.getState().newuser?e.later(0,null,A):(r.update(),g?C({url:g,stat:"HostCorrection"}):e.fire("net:reloginSuccessful")),e.fire("util:ymstats",{name:"relogin_callback",include:{farm:!0}})}function M(t,n){var r=n&&n._callback&&n._callback.service||"default",i="/neo/vc?service="+r;w<5?(e.io(i,{on:{success:function(){e.common.ui.NotificationV2.notify(strings.str_error_ydod_title,{type:"attention",close:!0,customClass:"single-inline",closeOnExternalClick:!0})},failure:function(){_(t,n)},complete:function(t,i){e.fire("util:ymstats",{name:"relogin_verification",tags:{status:i.status,service:r,url:n&&n.request&&n.request.url}})}},timeout:3e3}),w++):_(t,n)}function _(t,n){var r=c(strings.str_error_title,null,null,null,strings),i=['<div class="dlg-error">',t||strings.str_error_relogin,o.enabled("showDumpCookieUrl")?"<br/>"+c(strings.str_error_relogin_corpmail,null,null,null,strings):"","</div>"].join(""),s=v+d.replace(/[^\/]+([?#]+|$)/,"relogin?"),u={hd:r,bd:i,suppressActive:!0,maskId:"opaque-overlay",noScroll:!0,hideClose:!0,disableEsc:!0},a=function(){if(NeoConfig.isWinApp){I("relogin");return}E&&E.close(),E=window.open(s,"_blank",NeoConfig.loginParams||"height=650,width=850,resizable,scrollbars=yes")};p&&p.alert(u,{ok:{handler:a,stopDestroy:!0,text:strings.str_error_signin}},function(t){S=t,window.reloginCallback=O,e.fire("net:reloginAttempted",{request:n})})}function D(e){var t=e&&e.request;u.suspend("relogin"),b=t&&t.id||-1,t&&u.queue(t)}function P(e){var t=e&&e.request;t&&u.queue(t)}function H(){u.resume()}function B(){return!!S}function j(){return M(),!0}function F(e){NeoConfig.wssid=e,u.setWssid(e)}function I(t){e.use("mail-ui-windows-helper",function(e){e.mail.ui.windows.helper.appNotify(t)})}function q(t,n,r){NeoConfig.isWinApp&&I("logout");if(S)return e.fire("net:reloginAlreadyActive",{request:t}),!0;var i=n||{};return t&&t.id===b?(s.assert(0,"cyclic login"),r&&r.fault&&(r.fault.code=f.loginfail),s.netError("net:ReloginCyclic_"+[e.JSON.stringify(t.request),r.responseText,t.id,b].join(" : ")),!1):(g=i.url,s.assert(p),R(t,r),M(i.msg,t),!0)}function R(t,n){var r=t&&t._callback&&t._callback.service,i=t&&t.request&&t.request.url,s={id:t&&t.id,request:t||{},response:n||{},reason:"unknown",service:r};/\/ws\/v3\//.test(i)?s.reason="v3":/\/ws\/mail\/v2\.0\//.test(i)?s.reason="v2":/\/mailsearch\/v2\//.test(i)&&(s.reason="mailsearch"),e.fire("SplunkLog","debug_relogin",s,"critical"),e.fire("util:ymstats",{name:"relogin_start",tags:{code:n&n.body&&n.body.code,reason:s.reason,status:n.status,service:r},include:{farm:!0}})}function U(e,t,n){var r=t.responseHeaders,i=t.responseText||strings.str_error_Connect;e===302&&r&&r.Location?window.open(r.Location):n||z(e,t,{message:i})}function z(t,n,r){function a(e,t){var n,r={success:function(e){t(e.responseText)},failure:function(){t(s.escapeHtml(e))},suppressCodes:["*"],timeout:1e4},i="content="+encodeURIComponent(e)+"&restrictOff=true";n=u.request("yiv",i,r,"POST"),n.setHeader("Content-length",i.length),n.setHeader("Connection","close"),n.send()}function l(t){var u,a=f.isConn(p),l=r&&r.title&&c(r.title,null,null,null,strings)||c(strings["str_error_"+(a?"UnexpectedTitle":"MailErrorTitle")],n),d=h||strings["str_error_"+(a?"Connect":"MailUnexpectedResponse")],v=o.enabled("NotificationsV2"),m,g,y,b,w;a&&v?s.features.enabled("autoCheckNetwork")?i.Pulse.checkNetStatus(!0):(m=e.UA.userAgent,g={menu_start:"<b>",menu_end:"</b>",gt:">",line_start:'<div class="tae-dialog network-help">',line_end:"</div>"},y={menu_start:"<b>",menu_end:"</b>",list_start:"<ol>",list_end:"</ol>",item_start:"<li>",item_end:"</li>",line_start:"<div>",line_end:"</div>"},m.indexOf("Win")!==-1&&m.indexOf("NT 5.")!==-1?w=c(strings.str_tae_winxpnetworkresolution,y,null,null,null,null):m.indexOf("Win")!==-1&&m.indexOf("NT 6.0")!==-1?w=c(strings.str_tae_winvistanetworkresolution,g,null,null,null,null):m.indexOf("Win")!==-1?w=c(strings.str_tae_win7networkresolution,g,null,null,null,null):m.indexOf("Mac")!==-1&&(w=c(strings.str_tae_macnetworkresolution
,g,null,null,null,null)),b=c(e.ui.Templates._shared_module_offscreen_bin_notification_single_inline_text.base,{nf_text:strings.str_nointernetconn+" "+(w?strings.str_nointernetconn_help:""),inline_text:w?w:""},null,null,null,strings),e.common.ui.NotificationV2.notify(b,{type:"attention",close:!0,customClass:"single-inline",closeOnExternalClick:!0})):(u=[c(d,null,null,null,strings)],t&&u.push("<div>"+t+"</div>"),u=u.join(""),x(null,u,l,u.length>1e3&&{modal_classes:"lg",focusedNode:".default"},!0))}var h=r&&r.message,p=n.fault.code;f.isUnexpected(t,p)&&u.isHtml(n)?a(n.responseText,l):l()}function W(e){var t=e.match(/[\&\?(amp;)>]wssid=([^<\&}\"]+)/i)||e.match(/^wssid=([^<\&}\"]+)/i)||e.match(/<WSSID>([\w\W]+)<\/WSSID>/i)||e.match(/"wssid":"(.*?)"/i);return t&&t[1]}function X(e,t,n){var r,i;for(r=0;t&&r<t.length;r++){i=t[r];if(i==="*"||n(i))return!1}for(r=0;e&&r<e.length;r++){i=e[r];if(i==="*"||n(i))return!0}}function V(e){var t=m;return e&&e.serviceCredType&&(t=m?e.serviceCredType!=="loose":e.serviceCredType==="strict"),t}function $(t,n,r,i,o,u){var l=i.callback||{},c,h,p,d,v=i.fault,m=v&&v.code,g=f.isConn(m),y=l.suppressNotification||X(l.suppressCodes,l.exceptCodes,function(e){return n===e});switch(n){case 402:c=N(r,i,o);break;case 401:h=V(l),h&&(c=q(r,o,i),u=!1);break;case 310:c=C(o);break;case 429:case 999:y||L(o);break;case a.maxsize:c=k(i);break;case 404:case a.abort:break;case 302:case 13030:s.features.enabled("autoCheckNetwork")&&g&&e.common.net.Pulse.checkNetStatus(!0),U(n,i,y);break;case a.xhr:p=!0;default:s.features.enabled("autoCheckNetwork")&&m==="timeout"&&n===-1&&e.common.net.Pulse.checkNetStatus(!0),y||z(n,i,o)}u&&!c&&(d=g?"E_HTTPConnect":p?"E_XHR":"E_HTTP"),t.done(c)}function J(e,t,n,r,i,s){var o=r||n.status,u=i||(o===402?W(n.responseText):o===999?null:n);$(e,o,t,n,u,s)}var t=3,n=e.common,r=n.UserSession,i=n.net,s=n.Utils,o=s.features,u=i.SessionMgr,a=i.Status,f=i.Error,l=f.handler,c=s.substitute,h=n.persist.UserData,p=n.ui&&n.ui.DialogHelper,d=document.location.href,v=c(strings.str_cfg_url_yahoo_relogin,null,null,null,strings),m=!0,g,y={},b,w=0,E,S=null;NeoConfig.isCorpmail&&(v=v.replace(/\?/,"?.partner=ycorp&")),f._fireHandlers=function(){var e,t,n,r=new i.ErrorEvent(arguments,J,f),s=[r];for(e=0,t=arguments.length-1;e<t;e++)s.push(arguments[e]);for(e=0;e<l.length;e++)if(r.isdone()||(n=l[e].apply(this,s)))break;!r.isdone()&&n!==r.asyncval&&r.callDefault(null,null,1)},e.on("net:reloginAttempted",D),e.on("net:reloginAlreadyActive",P),e.on("net:reloginSuccessful",H),e.mix(f,{relogin:q,simpleRelogin:j,isReloginActive:B,setWssid:F,reloadUserChange:A,show:x,showConfirm:T,suppress:X,logRelogin:R,_handle:function(){f._fireHandlers.apply(f,arguments)},_parseWssid:W},!0)},"1.0.0",{requires:["common-net-error-base","common-net-errorevent","common-net-sessionmgr","common-ui-dialog-helper","json-stringify","common-persist-user-data","launch-utils","common-utils","mail-common-utils-features","common-ui-notification-v2","_shared_module_offscreen_bin_notification_single_inline_text","io-base"]});


YUI.add("common-net-errorevent",function(e){e.namespace("common.net");var t=e.common.net,n=function(e,t,n){var r=this;r.args=e,r._def=function(e){t?t.apply(n,e):r.done()}};n.prototype={async:function(t){var n=this;return n.timer||(n.timer=e.later(NeoConfig.timerErrEv||1e4,null,function(){n.isdone()||(t?t():n.callDefault(null,null,1))})),-1},asyncval:-1,callDefault:function(e,t,n){var r,i,s,o=this;if(!o._h){s=o.args,i=[o];for(r=0;r<s.length-1;r++)i.push(s[r]);i.push(e),i.push(t),i.push(!!n),o._def(i)}},isdone:function(){return this._h},done:function(e){var t,n=this;n.timer&&n.timer.cancel(),n._h||(n._h=!0,n.retry=e,e||(t=n.args,t[t.length-1]()))}},t.ErrorEvent=n},"1.0.0",{requires:[]});


YUI.add("common-persist-neo-data",function(e){function n(e){var t={cookieDomain:{writeOnce:!0},cookiePath:{writeOnce:!0},cookieID:{writeOnce:!0},servername:{writeOnce:!0},farm:{writeOnce:!0},wssid:{writeOnce:!0},neoguid:{writeOnce:!0},hasAds:{writeOnce:!0},om:{writeOnce:!0},global_url_base:{writeOnce:!0},extraURLArgs:{writeOnce:!0},mailnetQueue:{writeOnce:!0}};this.addAttrs(t,e)}var t=e.namespace("common.persist");e.augment(n,e.Attribute),t.NeoData=new n(window.NeoConfig)},"1.0.0",{requires:["attribute"]});


YUI.add("common-persist-cookie-data",function(e){function i(e){return e=e||r,t.Cookies[e]?t.Cookies[e]:(t.Cookies[e]=new o(e),t.Cookies[e])}function s(i){i=i||r,e.Cookie.remove(i,{domain:n.get("cookieDomain"),path:n.get("cookiePath")}),t.Cookies[i]&&delete t.Cookies[i]}function o(t){this.name=t;if(e.Cookie.get(this.name)===null)this.name!=="T"&&this.name!=="Y"&&e.Cookie.set(this.name,"",this.getCookieArgs());else{var r=n.get("cookiePath");r&&r.length>2&&r[r.length-1]==="/"&&(r=r.slice(0,r.length-1),e.Cookie.remove(t,{domain:n.get("cookieDomain"),path:r}))}}var t=e.namespace("common.persist"),n=t.NeoData;t.Cookies=[];var r="YM.NEO_"+n.get("cookieID");o.prototype.getCookieArgs=function(){return{expires:new Date(Date.now()+7776e6),domain:n.get("cookieDomain"),path:n.get("cookiePath")}},o.prototype.set=function(t,n){return e.Cookie.setSub(this.name,t,n,this.getCookieArgs())},o.prototype.get=function(t){return e.Cookie.getSub(this.name,t,this.getCookieArgs())},o.prototype.remove=function(t){return e.Cookie.removeSub(this.name,t)},e.augment(o,e.Attribute),t.getCookie=i,t.removeCookie=s},"1.0.0",{requires:["cookie","attribute","common-persist-neo-data"]});


YUI.add("common-persist-user-data",function(e){function u(){o.prototype._get=e.common.persist.UserData._get=e.Attribute.prototype.get,o.prototype.get=e.common.persist.UserData.get=function(e){var n;if(r)try{n=t.getSync("userData."+e)}catch(i){return typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-persist-userData:1",i,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-persist-userData:1"),s["userData."+e]}else n=this._get(e);return n},o.prototype._set=e.common.persist.UserData._set=e.Attribute.prototype.set,o.prototype.set=e.common.persist.UserData.set=function(e,n){var i;r?i=t.set("userData."+e,n):i=this._set(e)},o.prototype.load=function(){},o.prototype.saveRequest=function(){},t.occurEvent("userDataInit")}e.namespace("common.persist");var t=e.mail.controller.v3.settings.userSettings,n=e.common.Utils,r=n.features.enabled("isUserDataMigrated")||NeoConfig.forceToV3UserSetting,i=n.getVal,s={},o;o=function(n){var o=this;this.attributeConfig={userFeaturePref:{},userUIPref:{},userSpamPref:{},userVacationPref:{},userSendPref:{},userPopPref:{},externalAccounts:{},disposableAddresses:{},aliases:{},otherYahooMboxes:{},blockedAddresses:{},switches:{},parentalControls:{},filters:{},loaded:{value:!1}},this.addAttrs(this.attributeConfig,n),n?this.set("loaded",!0):this.load();if(r&&!t.hasEventOccured("userDataInit")){var a=t.getMigrationKeys("userData","launch"),f=t.getMigrationKeys("userData","postLaunch"),l;s=t.getDefaultValueMap("userData"),a.forEach(function(e){t.ingest(e,o.get(e.split(".").slice(1).join(".")))}),l=i(NeoConfig,"accounts.primaryAccount.0.email"),t.ingest("userData.userSendPref.loggedInAlias",l||NeoConfig.loginId),t.get(f).then(u)}r&&t.hasEventOccured("userDataInit")&&setTimeout(u,0)},o.prototype.load=function(t){var n=this;e.mail.net.Transport.request("GetUserData",{bidiDetection:NeoConfig.bidi},{success:function(r){var i;r=r.body.result.data;for(i in r)n.set(i,r[i]);n.set("loaded",!0),t&&e.fire("uData:change",r)},failure:function(){}},!0)},o.prototype.update=function(t){e.mail.ui.Workspace&&e.mail.ui.Workspace.moUpdate(t)},o.prototype.saveOne=function(e){var t,n,r=e.split("."),i=r.length-1,s={},o=this.get(e);n=s;for(t=0;t<i;t++)n[r[t]]={},n=n[r[t]];n[r[t]]=o,this.saveRequest(s)},o.prototype.save=function(){var e={},t,n,r=["userFeaturePref","userUIPref","userSpamPref","userVacationPref","userSendPref","userPopPref","blockedAddresses","switches","aliases"];for(n in r)t=r[n],t==="aliases"?e.alias=this.get("aliases.alias"):t==="userPopPref"?this.get(t+".popSetupEligible")&&(e[t]=this.get(t)):e[t]=this.get(t);this.saveRequest(e)},o.prototype.saveRequest=function(t){var r="passive";if(NeoGV.isYdod){n.settings.value("ydodActiveAPI",[]).indexOf("SetUserData")>-1&&(r="active"),e.fire("util:ymstats",{name:"ydodBlock",tags:{api:"SetUserData",mode:r},include:{farm:!0}});if(r==="active")return}e.mail.net.Transport.request("SetUserData",{setdata:t},{success:function(){},failure:function(){}},!0)},o.prototype.knownAddresses=NeoConfig&&NeoConfig.accounts&&NeoConfig.accounts.ALL.reduce(function(e,t){return t.email&&(e[t.email]=1),e},{})||{},o.prototype.isUsersEmailAddress=function(e){if(!NeoConfig.accounts||!NeoConfig.accounts.ALL)return;return NeoConfig.accounts.ALL.map(function(e){return e.email}).indexOf(e)>=0?1:undefined},e.augment(o,e.Attribute);if(NeoConfig.userDataObj){var a=NeoConfig.userDataObj.userSendPref,f=NeoConfig.userDataObj.externalAccounts,l=n.unescapeHtml,c,h,p;a&&(a.defaultFromName=l(a.defaultFromName));if(f){c=f.extAccount;if(c){p=c.length;for(h=0;h<p;h++)c[h].fromName=l(c[h].fromName),c[h].username=l(c[h].username)}}}e.common.persist.UserData=new o(NeoConfig.userDataObj)},"1.0.0",{requires:["attribute","mail-net-transport","json","common-utils","mail-common-utils-settings","mail-controller-v3-user-settings"]});


YUI.add("common-ui-tabs-base",function(e){var t=e.Node.one,n=e.Node.create,r=e.Lang,i=!1,s=!1,o={convpane:".t-mail",messagepane:".t-mail",author:".t-draft",search:".t-search"},u=e.common.Utils.ymmastats,a=e.one("#nav"),f=e.mail.ui.FolderUtils,l=function(){function F(t){e.fire("util:ymstats",{name:"nav",tags:{view:t}})}function I(){function n(t){if(window.history&&!e.UA.ie){var n=window.location.search&&window.location.search.substr(1)||"",r=n!==""?e.QueryString.parse(n):{},i=window.location.hash;t=="inbox"&&r.action?delete r.action:r.action=t,window.history.pushState({},"",window.location.pathname+"?"+e.QueryString.stringify(r)+window.location.hash)}}b=t(c),w=t(h),E=t(d),b.plug(e.comms.ui.NodeFocusBase,{descendants:"a",keys:{next:"39",previous:"37"}});if(!NeoConfig.multitask)return;b.delegate("click",function(t){var n=t.currentTarget.one("a").get("id"),r=q(n);if(!r)return;l.tabClicked=!0;if(t.target.hasClass("close-tab")){r.set("close",1);return}e.fire("tab:click",r),r.get("active")!==1&&(e.fire("util:ymstats",{name:"tabSwitchRecent"}),l.holdNavSwitch=1,l.hideOnLeave=1,g.detachTabHandlers(),G(r,null,!0),r._bindConvPaneListener())},".t-el"),t(p).on("mouseleave",function(){var t;l.hideOnLeave?(l.holdNavSwitch===1&&l.switchLaterNav&&(e.fire("navigation:switch",{type:l.switchLaterNav}),l.switchLaterNav=null),et(ut()),l.hideOnLeave=0):l.tabClicked&&(t=ut(),t.widget&&"search"===t.widgetType&&e.fire("navigation:switch",{type:"searchNav"})),l.tabClicked=!1,l.holdNavSwitch=0}),e.on("pagemodeChange",function(e){pt(e)}),e.on("tabview:handleKeyDown",ct),e.on("key",ct,document,"down:"+O,l),e.on("keyup",lt,document,l),e.on("tab:addRef",function(e){var t,n,r,i;t=l.refTabCheck(e.data),g.detachTabHandlers(),t&&(i=!!(t&&t.cfg&&t.cfg.widget),i&&(r=t.cfg.widget.rawAttr,r.fid=e.data.fid),t.set("close",1),i&&(e.widget=new t.cfg.widget.constructor(r))),t=l.addTab(e,K(e)),n=b.one(".t-el.active"),n&&n.removeClass(v),t.elTab.addClass(v)}),e.on("tab:removeRef",function(e){var t;t=l.refTabCheck(e.data),t&&t.set("close",1)}),e.on("nav:inbox",function(){G(q("tabinbox"),0,0,0,1),e.fire("mt:click",{action:"inbox_leftnav"}),n("inbox"),F("inbox")}),e.on("nav:contacts",function(){G(q("tabcontacts"),0,0,0,1),e.fire("mt:click",{action:"contacts_leftnav"}),n("contacts"),F("contacts")}),e.on("nav:calendar",function(){if(N.features.enabled("gCal")){e.one(".nav-item-calendar a").blur(),window.open(N.settings.value("corpcal_destination"),"_corpcal");return}G(q("tabcalendar"),0,0,0,1),e.fire("mt:click",{action:"calendar_leftnav"}),n("calendar"),F("calendar")}),e.on("nav:notepad",function(){G(q("tabnotepad"),0,0,0,1),e.fire("mt:click",{action:"notepad_leftnav"}),n("notepad"),F("notepad")}),e.on("nav:messenger",function(){e.fire("mt:click",{action:"msngr_nav"}),F("messenger")}),e.on("nav:newsfeed",function(){G(q("tabnewsfeed"),0,0,0,1),n("newsfeed"),F("newsfeed")})}function q(e){var t,n=S.length;for(t=0;t<n;t++)if(S[t].get("id")===e)return S[t];return null}function R(){var t=S.length,n,r,i=M;for(r=1;r<t;r++)S[r].isRemovable&&S[r].time<i&&(n=S[r],i=S[r].time);n&&(n.set("close",1),e.fire("util:ymstats",{name:"tabAutoClose",tags:{tabsEnabled:NeoConfig.tabs?1:0}}))}function U(){var e=0;w&&(e=w.all(".nav-tab-li.hidden").size());while(S.length-e>=_)R()}function z(e,t){S.push(t),x[e]||(x[e]={}),t.set("collection",e),x[e][t.get("id")]=t}function W(e,t){var n=x[e];if(n){var r=t.get("id");if(n[r])return delete n[r],!0}return!1}function X(e,t,n){var r=x[e],i;if(r){i=t.get("id");if(r[i])return r[i].invisible=!n,!0}return!1}function V(t,n){var r;U(),t.tab&&(t.tab.addTabEl(),t.tab.set("title",t.p_label)),n.p_label=t.p_label,n.s_label=t.s_label,n.s_labelDir=t.s_labelDir,r=ut(),n.prevTabId=r?r.get("id"):-1,n.srcTabType=r?r.widgetType:"",t.widget&&t.widget!==n.get("widget")&&n.set("widget",t.widget);var i=t&&t.widget&&t.widget.widgetType||"content_widget";return z(i,n),b.fire("refresh"),e.fire("tab:add",n),n.fire("tab:add",{cfg:t,tab:n}),n}function $(e){return x[e]?x[e]:[]}function J(e){var t=this,n=t.getActiveTab(),r=n&&n.widget,i=r&&r.type,s=e&&e.fid||r&&r.fid,o,u;if(i==="messagepane")o="msgRdTb";else if(i==="convpane")o="thrdRdTb";else if(i==="author")o="cmpsTb";else if(i==="search")o="srchTb";else if(f.isInboxFid(s))o="inbxTb";else if(f.isDraftFid(s))o="drftTb";else if(f.isSentFid(s))o="sntTb";else if(f.isSpamFid(s))o="spmTb";else if(f.isTrashFid(s))o="trshTb";else if(s==="%40C%40Chats")o="chtTb";else if(s==="%40S%40Search")o="srchTb";else{u=n&&n.elContent.getAttribute("data-tid");switch(u){case"tabcontacts":o="cntctsTb";break;case"tabnotepad":o="ntpdTb";break;case"tabcalendar":o="clndrTb";break;case"tabnewsfeed":o="newsTb";break;default:o="fldrTb"}}return o}function K(e){return g&&g.detachTabHandlers(),new j(e)}function Q(t){var n,r,i,s,o="mail";switch(t.widgetType){case"search":n="searchNav";break;case"author":n="none"}n||(s=t.widget&&t.widget.fid,s&&(r=e.one("#storm-listnav").one('> li[data-fid="'+s+'"]'),r&&(n="none")));if(!n){i=t.elContent.getAttribute("data-tid");switch(i){case"tabcontacts":case"tabnotepad":case"tabcalendar":case"tabnewsfeed":n=o=i.replace("tab","")}}n||(n="none"),e.fire("navigation:switch",{type:n}),a&&(a.all(".nav-item").removeClass("active"),a.one(".nav-item-"+o).addClass("active"))}function G(t,n,r,s,o,u){t&&t.get("id")==="tabcalendar"&&(t.darlaType||(t.darlaType="calendartab"));if(y&&y===t){y.get("active")||y.set("active",1),i=!1,e.fire("tab:reactivated",t.widget);return}if(y&&i&&y!==t){y.get("active")||(i=!1);return}if(!y||t.get("active")){y=t,y.get("active")||y.set("active",1),i=!1;return}y._evt["switchToTab-deactivateOldTab"]&&(e.detach(y._evt["switchToTab-deactivateOldTab"]),delete y._evt["switchToTab-deactivateOldTab"]),y._evt["switchToTab-deactivateOldTab"]=y.after("activeChange",function(s){e.detach(y._evt["switchToTab-deactivateOldTab"]),delete y._evt["switchToTab-deactivateOldTab"];if(s.newVal)return;t._evt["switchToTab-activateNewTab"]&&(e.detach(t._evt["switchToTab-activateNewTab"]),delete t._evt["switchToTab-activateNewTab"
]),t._evt["switchToTab-activateNewTab"]=t.after("activeChange",function(){e.detach(t._evt["switchToTab-activateNewTab"]),delete t._evt["switchToTab-activateNewTab"],i=!1,n&&n(t)}),e.fire("tabDeactivated",t),r||et(t),t.set("active",1)}),s&&t._bindConvPaneListener(),y.get("active")?(i=!0,tt(),y.set("active",0),NeoConfig.backButtonFull&&!u&&y.cfg.p_label!=="Folders"&&e.fire("initPage",{id:t.cfg.label})):i=!1,(!ft()||m.getAttribute("data-open")!=="multitask"||o)&&Q(t),e.fire("tab:resize"),e.fire("list-stat:tabDone",t.widget),NeoConfig.showNewsFeedOb&&!N.features.enabled("newsFeedOb3")&&this.tabs.length>4&&this.getActiveTabIndex()===0&&(e.fire("showNewsFeedOnboarding"),NeoConfig.showNewsFeedOb=0)}function Z(t){var n,r,i,s=!1,o,u,a;y.prevTabId&&(o=q(y.prevTabId),o&&o.widgetType==="search"&&(s=!0,u=o)),i=S.length;if(t==="all"){a=e.one("#btn-back-to-search"),!u&&a&&a.hide();for(n=i-1;n>=0;n--)r=S[n],r.get("removable")&&r!==y&&(s&&r.get("id")!==u.get("id")||!s)&&r.set("close",1)}else for(n=i-1;n>=0;n--)r=S[n],r.get("removable")&&r!==y&&r.widgetType!=="convpane"&&r.widgetType!=="messagepane"&&r.set("close",1)}function et(e){if(NeoConfig.tabs)return;var t,n,r;NeoConfig.multitask&&(t=e.elTab,n=t.ancestor(".t-s-group"),n&&n.prepend(t),r=b.one(".t-el.active"),r&&r.removeClass(v),t.addClass(v),g=e,e.time=++M)}function tt(){y._evt["switchToTab-activeHaltedOldTab"]&&(e.detach(y._evt["switchToTab-activeHaltedOldTab"]),delete y._evt["switchToTab-activeHaltedOldTab"]),y._evt["switchToTab-activeHaltedOldTab"]=y.once("activeHalted",function(){e.detach(y._evt["switchToTab-activeHaltedOldTab"]),delete y._evt["switchToTab-activeHaltedOldTab"],i=!1})}function nt(t,n){var r=0,i,s,o=t.get("id"),a,f,c=t.prevTabId;u.stat((t.widgetType?t.widgetType:"")+"_tab_close");while(S.length>r){i=S[r++],a=i.get("id");if(o===a){W(i.get("collection"),i),l.tabs=S=S.slice(0,r-1).concat(S.slice(r)),e.fire("tab:remove",a),r--;continue}a===c&&(f=i)}if(!f){s=S.length-1;while(s>0){if(!S[s]||!S[s].noDefault)break;s--}f=S[s]||S[0]}n.SwitchTab&&(y=null,e.fire("tabDeactivated",f),G(f,function(){b.fire("refresh")})),i=ut(),i&&(!ft()||m.getAttribute("data-open")!=="multitask")&&Q(i)}function rt(t,n){var r=0,i=t.get("id"),s=t.prevTabId,o=n.show,u,a,f,l;while(S.length>=r){u=S[r++],f=u.get("id");if(i===f){X(u.get("collection"),u,o),e.fire("tab:updateNavTab",f,o),o&&(l=u),r--;break}!o&&f===s&&(l=u)}if(!o&&!l){a=S.length-1;while(a>0){if(!S[a]||!S[a].noDefault)break;a--}l=S[a]||S[0]}n&&n.SwitchTab&&(o&&e.fire("tabActivated",l),G(l),l.set("active",1)),u=ut(),u&&(!ft()||m.getAttribute("data-open")!=="multitask")&&Q(u)}function it(e){var t,n=S.length;while(n--){t=S[n].widget||{};if(e(t,S[n]))return S[n]}}function st(e,t){var n=S,r=n.length,i=t?-1:r,s=t?r-1:0,o=t?-1:1,u;for(u=s;u!==i;u+=o)if(e(n[u]))return n[u]}function ot(e){return!e||!e.widget||!e.widget.get||e.widget.get("canDeactivate")}function ut(){return y}function at(){var e,t;for(t=S.length;t--;){e=S[t];if(e&&e.get("active"))return t}return-1}function ft(){return NeoConfig.tabs||!NeoConfig.multitask?!1:!0}function lt(t){var n=t.keyCode;(n===91||n===93)&&D>-1&&(et(ut()),ft()&&m.getAttribute("data-open")==="multitask"&&e.fire("navigation:switch",{type:"none"})),l.holdNavSwitch===1&&l.switchLaterNav&&(e.fire("navigation:switch",{type:l.switchLaterNav}),l.switchLaterNav=null),l.holdNavSwitch=0,D=-1}function ct(t){function u(e,t,n){return e?t===0?n-1:t-1:t===n-1?0:t+1}function a(t){var n=ut(),r=n.elTab,i=NeoConfig.tabs,s=i?n.get("id"):r.get("id"),o,a,f,c,h=i?w.all(".nav-tab-li"):b.all(".t-el"),p,d=!1;if(h.size()===0)return;i?(c=t?"next":"previous",h.pop()):c=t?"previous":"next",h.each(function(e,t){i?e.hasClass("hidden")||(p=e.one("[data-tid]"),p&&p.getAttribute("data-tid")===s&&(o=t)):e.get("id")===s&&(o=t)}),e.Lang.isUndefined(o)?f=0:f=u(t,o,h.size());if(i){while(!d)a=h.item(f),a.hasClass("hidden")?f=u(t,f,h.size()):d=!0;a=q(a.one(".nav-tab").getAttribute("data-tid"))}else a=h.item(f),a=q(a.one("a").get("id"));a&&(l.holdNavSwitch=1,G(a,null,!0)),D=f}var n=t.keyCode,r=t.metaKey,i=t.ctrlKey,s=t.target,o=s.get("tagName");if(o==="INPUT"||o==="SELECT"||o==="TEXTAREA"||s.get("isContentEditable"))return;switch(n){case 219:!r&&!i&&!t.shiftKey&&!t.altKey&&(t.preventDefault(),ft()&&e.fire("navigation:switch",{type:"multitask"}),a(!0));break;case 221:!r&&!i&&!t.shiftKey&&!t.altKey&&(t.preventDefault(),ft()&&e.fire("navigation:switch",{type:"multitask"}),a(!1))}}function ht(){I()}function pt(){var e=ut();e&&dt(e)}function dt(t){vt(t.hideToolbar);if(t.widgetType==="search"||t.widgetType==="messagepane"||t.widgetType==="convpane")e.fire("mbEvent:hide");else if(t.widgetType==="convlist"||t.widgetType==="messagelist")e.fire("mbEvent:rotate"),e.fire("rotateD2S")}function vt(e){e?m.addClass("notoolbar"):m.removeClass("notoolbar")}function mt(e){var t=st(function(t){if(t.data&&e[e.tabKey]===t.data[t.data.tabKey])return!0});return t}function gt(e){e.widget&&e.widget.set("close",1),e=null}var l=this,c="div.tabs ul",h="#tabs",p="#multitask .listnav-container",d="#shellinner",v="active",m=t("body"),g,y,b,w,E,S=[],x={},T=e.ui.Templates.minty_module_tabs_tab_removable.base,N=e.common.Utils,C=N.substitute,k=N.escapeHtml,L=N.unescapeHtml,A=N.removeHtml,O=[219,221],M=0,_=16,D=-1,P=e.mail.ui.common.StringUtils,H=N.features,B=H.enabled("instantCloseOnSend"),j=function(t){function _(e,t){if(!e.inDoc())return;t?e.removeClass("offscreen"):e.addClass("offscreen")}function D(t){var n=t.newVal,r,s;if(n){if(!i.widget&&u.init){t.halt(!0),u.init(i,function(){var e;if(i.widget){w.siblings().each(function(t,n){n>0&&t.getStyle("visibility")==="visible"&&(e=!0)});if(e)return;i.widget.render(w),i.set("widget",i.widget),i.set("active",1)}});return}NeoConfig.multitask||e.later(0,null,function(){var e=t.currentTarget.widgetType;e==="convpane"||e==="messagepane"?Z("all"):Z("non-msg")}),i.isRemovable&&i.set("removable",!0),y=i,i===S[0]&&0&&i.widget&&i.widget.msgPane&&i.widget.msgPane.message&&(r={},r.cid=e.mail.model.ConvStore.Conversations.getPermCidPart
(i.widget.msgPane.message.cid),r.fid=i.widget.msgPane.message.fid,s=mt(r),s&&s._bindConvPaneListener()),d.addClass(v),m.setAttrs({"aria-selected":!0,tabIndex:0});try{M.set("aria-labelledby",m.get("id"))}catch(o){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-ui-tabview-tabview:1",o,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-ui-tabview-tabview:1")}dt(i),e.fire("tabChange",i.widget),e.fire("tab:active",y.get("id"))}else{e.fire("tabBlur",{widget:i.widget}),this.detachTabHandlers(),NeoConfig.vertPane&&w.get("id")==="inboxcontainer"&&w.setStyle("display","none"),w.setStyle("visibility","hidden");if(NeoConfig.multitask&&NeoConfig.vertPane){if(w.inDoc()){if(w.getStyle("visibility")!=="hidden")return;_(w,!1)}}else _(w,!1);d.removeClass(v),m.setAttrs({"aria-selected":!1,tabIndex:-1})}}function H(e){e.newVal===1&&(nt(i,{SwitchTab:i===y}),d.hide(),w.hide())}function F(t){var n,r,s,o=i.widget?i.widget.scrolling||[]:[],u=o.length;for(s=0;s<u;s++)n=o[s],r=w.test(n)?w:w.one(n),r&&(r=e.Node.getDOMNode(r),t?x[n]>0&&(r.scrollTop=x[n]):x[n]=r.scrollTop)}function I(e){var t=d.one("a#"+o+" b")||d.one("a.uc b")||d.one("a#"+o)||d.one("a.uc"),n=d.one("a#"+o)||d.one("a.uc"),s,u,f,l,c,h,p,v,m,g=k(e);t&&r.trim(t.get("text"))!==r.trim(e)&&(e.indexOf("::")>=0?(s=e.split("::"),t.setContent(s[0]),e=s[0]+" <i>("+s[1]+")</i>"):(l=i.widget&&i.widget.msgPane,NeoConfig.hasConv?(c=l&&l.message&&l.message.msgs,h=c&&c.length>=1?c[0]:null):h=l&&l.message,p=h&&h.header,v=p&&p.from&&p.from.name,v=v?v:h&&h.from&&h.from.name,v=k(v),m=d.one("a[data-action='navigate']"),v?m&&m.setHTML(v+"<br>"+g):t.setHTML(g)),f=L(A(e)),u=v?v+" - "+f:f,n.setAttribute("title",u),i.elContent.setAttribute("data-title",f),i.elContent.setAttribute("aria-label",f)),a=e,i.NAME=a+" Tab"}function q(e){var t=d.one("a#"+o)||d.one("a.uc");t&&t.setAttribute("dir",e)}var i=this,o=e.guid(),u=t||{},a=u.p_label||"",l=u.s_label||"",c=u.url||"#",h=u.content||"",p=u.widget,d=u.yTabEl||n(C(T,{tab_url:c,tab_id:o,tab_title:a+" - "+l,p_label:a!==""?a+"<br/>":"",s_label:l},null,null,strings)),m=d.one("a"),w=u.yTabContentEl||n('<div class="tab-content offscreen" style="visibility: hidden">'+h+"</div>"),x={},O,M=e.one('#main[role="tabpanel"]');u.yTabEl&&(o=u.yTabEl.one("a").get("id")),w&&u.inactive&&(w.setStyle("visibility","hidden"),_(w,!1),w.removeClass("hidden")),w.setAttribute("data-tid",o),p?(p.hasMsgList&&l?w.setAttribute("data-title",f.getSystemFolderName(l,l)):w.setAttribute("data-title",l),p.render(w)):w.setAttribute("data-title",P.getTabName(o)),this.cfg=u,this.elTab=d,this.reuse=u.reuse,this.isRemovable=u.isRemovable,this.widget=p,this.elContent=w,this.noDefault=u.noDefault?!0:!1,this.allowFullpage=!u.forcePane,this.hideToolbar=u.noToolbar,this.userClose=!1,this.data=u.data,this.widgetType=p&&p.type||u.widgetType,B&&(this.invisible=u.invisible||!1),i.addTabEl(),g=this,a&&(this.NAME=a+" Tab"),u.yTabContentEl||E.appendChild(w),m.setAttrs({tabIndex:-1,"aria-selected":!1}),j.superclass.constructor.call(i),window.location.href.indexOf("mytray")>=0&&!s&&(s=!0,e.use("common-ui-tabs-tray",function(){e.mail.ui.Tray.init(i)})),i.after("closeChange",function(t){var n=t.newVal,r=i.get("reuse"),s,o;n?(NeoConfig.multitask&&(s=i._getParentTabGroup(d),o=i._getParentTabSGroup(d)),r?(d.addClass("hidden"),w.addClass("hidden")):(N.remove(w),N.remove(d),i._evt["switchToTab-activeHaltedOldTab"]&&(e.detach(i._evt["switchToTab-activeHaltedOldTab"]),delete i._evt["switchToTab-activeHaltedOldTab"]),i.detachDarla(),i.detachAll()),NeoConfig.multitask&&i._hideTabGroupIfEmpty(s,o),nt(i,{SwitchTab:i===y}),NeoConfig.multitask&&!b.all(".t-el").size()&&b.one(".empty-tabs").removeClass("hidden")):r&&(d.removeClass("hidden"),w.removeClass("hidden"))},i),i.on("activeChange",D),i.after("activeChange",function(t){var n,r,i,s,o,u=function(e){return!e||!e.get("offsetWidth")||!e.get("offsetHeight")},a=function(){var e,t=ut();t&&t.widgetType==="search"&&(e=r.one(".list-view-item.selected input")||r.one(".list-view-item input"),e&&!u(e)&&e.focus())};if(t.newVal){NeoConfig.vertPane&&w.get("id")==="inboxcontainer"&&w.setStyle("display","block"),w.setStyle("visibility","visible"),_(w,!0);if(w.get("id")==="inboxcontainer")n=w.one("#msg-list"),N.isControlActive()||n&&n.focus();else if(r=w.one("#msg-list.result"))i=document.activeElement&&e.Node(document.activeElement),i&&NeoConfig.searchField&&i._node===NeoConfig.searchField._node?i.once("blur",function(){a()}):a()}}),i.on("unloadingChange",H),i.on("titleChange",function(t){t.prevVal!==t.newVal&&(I(t.newVal),e.fire("tab:title",i.get("id"),t.newVal))}),i.on("directionChange",function(e){e.oldVal!==e.newVal&&q(e.newVal)}),i.on("closeHalted",function(){i!==y&&G(i)}),i.after("closeHalted",function(){e.use("common-ui-dialog-helper",function(e){setTimeout(function(){var t={hd:strings.str_modal_tabdeactivate_title,bd:strings.str_modal_tabdeactivate_body},n=function(){i.set("forceClose",1),i.set("reuse",0),i.set("close",1)};e.common.ui.DialogHelper.confirm(t,{ok:{handler:n},cancel:{}})},0)})}),i.before("widgetChange",function(t){var n=t.newVal,r=t.prevVal,s={},o=!1,u=function(){var t;e.detach(i.widget._evt["widgetChange-Active"]),o?(t=n.get("rootNode"),t&&t.removeClass("hidden")):(t=i.widget.get("rootNode"),t&&t.addClass("hidden")),i.widget=null,i.once("widgetChange",function(){r.set("skipEvents.active-1",!0),n.set("active",1),o||n.render(i.elContent)}),i.detachDarla(),i.set("widget",n)};i.widget&&i.widget!==n?(t.halt(!0),i.iterateChildren(function(e){e===n&&(o=!0)}),o||i.set("children",i.get("children").concat([n])),i.widget._evt["widgetChange-Active"]&&e.detach(i._evt["widgetChange-Active"]),i.widget._evt["widgetChange-Active"]=i.widget.after("activeChange",u),s=n.get("skipEvents"),delete s["active-1"],n.set("skipEvents",s),i.widget.get("active")?i.widget.set("active",0):u()):(i.widget=n,i.widget.tab=i,i.get("children").length||i.set("children",[n]))},i),B&&i.after("viewableChange",function(
e){var t={SwitchTab:!0};e.newVal?t.show=!0:t.show=!1,rt(this,t)}),e.mix(i,{widget:p}),i.addAttrs({id:{value:o},title:{},direction:{setter:q},widget:{setter:function(){i.attachDarla()}},children:{value:[i.widget]},removable:{value:!1},hideToolbar:{getter:function(){return i.hideToolbar},setter:function(t){i.hideToolbar=t,vt(t),e.fire("mbEvent:"+(t?"hide":"rotate"))}}})};e.extend(j,e.mail.ui.BaseWidget),e.mix(j.prototype,{NAME:"Tab",addTabEl:function(){var e=this,t,n=e.widgetType;!e.invisible&&!e.cfg.yTabEl&&n&&(e._hideElTab(),t=e._getTabGroup(n),e._appendElTabToDom(t),e._showMultitaskTutorial(n),NeoConfig.multitask&&b.one(".empty-tabs").addClass("hidden"),n==="convpane"&&e._bindConvPaneListener(),e._showElTab())},_bindConvPaneListener:function(){var t=this;t.draftCount=0,NeoConfig.multitaskDraft&&(t.draftCardRemovedHandler=e.on("draftCardRemoved",function(){t.isDraftTab&&t._moveDraftTabToEmailTab()}),t.draftCardAddedHandler=e.on("draftCardAdded",function(){t.isDraftTab||t._moveEmailTabToDraftTab()}))},_moveEmailTabToDraftTab:function(){var e=this,t,n;e.elTab&&(t=e._getParentTabGroup(e.elTab),n=e._getParentTabSGroup(e.elTab),e._hideElTab(),b.one(o.convpane).removeChild(e.elTab),e.isDraftTab=!0,e._hideTabGroupIfEmpty(t,n),e._appendElTabToDom(e._getTabGroup("author")),e._showElTab())},_moveDraftTabToEmailTab:function(){var e=this,t,n;t=e._getParentTabGroup(e.elTab),n=e._getParentTabSGroup(e.elTab),e._hideElTab(),b.one(o.author).removeChild(e.elTab),e.isDraftTab=!1,e._hideTabGroupIfEmpty(t,n),e._appendElTabToDom(e._getTabGroup("convpane")),e._showElTab()},_getTabGroup:function(e){return o[e]&&b.one(o[e])},_getParentTabGroup:function(e){return e.ancestor(".t-group")},_getParentTabSGroup:function(e){return e.ancestor(".t-s-group")},_hideTabGroupIfEmpty:function(e,t){t&&t.get("children").size()===0&&e.addClass("hidden")},detachTabHandlers:function(){var e=this;NeoConfig.multitaskDraft&&(e.draftCardRemovedHandler&&e.draftCardRemovedHandler.detach(),e.draftCardAddedHandler&&e.draftCardAddedHandler.detach(),e.draftCardRemovedHandler=null,e.draftCardAddedHandler=null)},_appendElTabToDom:function(e){var t=this;e?(e.prepend(t.elTab),e.ancestor(".t-group").removeClass("hidden"),t.time=M++):b.prepend(t.elTab)},_showMultitaskTutorial:function(t){},_showElTab:function(){var e=this;setTimeout(function(){e.elTab&&e.elTab._node&&e.elTab.setStyle&&e.elTab.setStyle("visibility","visible")},10)},_hideElTab:function(){var e=this;e.elTab&&e.elTab._node&&e.elTab.setStyle&&e.elTab.setStyle("visibility","hidden")},attachDarla:function(){var t=this;!t.darlaEvent&&t.widget&&(t.darlaEvent=t.widget.on("darlaEvent",function(n){n.beaconOnly=!t.widget.get("active"),e.fire("darlaEvent",n),e.fire("mt:view",n)}))},_cleanSearchAd:function(){var t=e.one("#sponsoredAd"),n=e.one("#theAd");t&&t.remove(!0);if(n.hasClass("withSponsoredAd")){n.removeClass("withSponsoredAd");var r=m.hasClass("wide-right-rail")?"#sb_rel_tgtWSKY":"#sb_rel_tgtSKY",i=e.one(r);i&&i.show()}},detachDarla:function(){var e=this;e.darlaEvent&&e.darlaEvent.detach(),e.darlaEvent=null},updateTabData:function(e){this.data=e}}),e.augment(l,e.Attribute),e.mix(l,{render:ht,createTab:K,addTab:V,switchToTab:G,removeTab:nt,setPageMode:pt,showToolbar:vt,tabs:S,getTab:it,iterateTabs:st,getActiveTab:ut,getActiveTabIndex:at,getActiveTabContext:J,canDeactivateTab:ot,refTabCheck:mt,destroyTabWidget:gt,getTabById:q,autoCloseTabs:U,getByType:$})};e.namespace("mail"),e.mail.Tabs=new l},"1.0.0",{requires:["mail-ui-basewidget","minty_module_tabs_tab_removable","comms-ui-nodefocus-base","common-utils","mail-ui-common-string-utils","ymma-stats","mail-ui-folder-utils"]});


YUI.add("common-ui-toolbar-base",function(e){function o(t){function l(){u.all(".btn a").each(function(e){e.setAttribute("role","button")}),u.all(".menu a").each(function(e){e.setAttribute("aria-haspopup","true")}),u.all(".btn a i").each(function(e){e.setAttribute("role","presentation")})}function c(){return!u&&a&&(u=e.Node.create(e.common.Utils.substitute(a,0,0,0,strings)),n.root=u,n.set("content",u),l()),o||h(),u||"&nbsp;"}function h(){if(u){n._evts.push(e.on("toolbar:ui-automation",p)),n._evts.push(u.delegate("mousedown",function(e){e.preventDefault()},".btn a"));var t=function(t){e.common.Utils.isProcessDefaultEnabled(t)||t.preventDefault();if(!i){var n=e.common.Utils.getDataAction(t),r=n.action,s=n.node,o=t.currentTarget;d(r,s,o,t),i=setTimeout(function(){i=0},300)}},r=function(t){var n=t.keyCode,r,i,s=t.target,o=function(e){return e.hasClass("btn")&&!e.hasClass("hidden")&&e.getStyle("display")!=="none"};if(n===13||n===32){if(t.currentTarget.hasClass("cbox")){e.use("node-event-simulate",function(){t.currentTarget.one("input").simulate("click")});return}}else n===37||n===39?(i=t.keyCode===37,s.hasClass("btn")&&(r=i?s.previous(o):s.next(o)),r&&(s.setAttribute("tabindex",-1),r.setAttribute("tabindex",0),r.focus())):n===9&&e.later(0,null,function(){var e=u.all("> .btn:not(.hidden)"),t=e.size(),n,r;u.all(".btn").setAttribute("tabindex",-1),u.one(".btn").setAttribute("tabindex",0);for(n=0;n<t;n++){r=e.item(n);if(r.getStyle("display")!=="none"){r.setAttribute("tabindex",0);break}}})};n._evts.push(u.delegate("click",t,".btn, input")),n._evts.push(u.delegate("keydown",r,".btn, input")),n._evts.push(e.one("#Compose").on("click",t)),n._evts.push(n.on("activeChange",function(t){t.newVal&&e.fire("toolbar:refresh")})),o=1}}function p(t,r,i){var s;u.get("parentNode")&&n.get("active")&&t==="menu"&&(s=u.one("#btn-"+r),s&&(s.menu?s.menu.show&&(u._node?n.buttonEnabled({root:u,node:s,action:t})&&(n.setNodeButtonMenu({node:s}),s.menu.show({context:i})):e.fire("MailLog",{m:"root._node is not defined"},1,"ToolbarError")):d(t,s,undefined,undefined,i)))}function d(t,i,o,a,l){var c=t,h=i.get("id"),p={},d,v=0;if(t){t==="menu"&&f&&n.buttonEnabled({root:u,node:i,action:t})?(s.stat("toolbar","type=>"+e.mail.Tabs.getActiveTab().widgetType+",action=>"+h),i.menu||e.use("common-ui-menu-helper",function(e){var t=e.common.ui.MenuHelper;t.createLoadingMenu(i),f.template.call(this,h,function(){m(i,l)})}),h==="btn-actions"&&e.fire("darlaEvent",{action:"action_menu"}),c+=h):n.buttonEnabled({root:u,node:i,action:t})&&(s.stat("toolbar","type=>"+e.mail.Tabs.getActiveTab().widgetType+",action=>"+t),n.fire("itemSelected",{dataAction:t,item:o,rawEvent:a}),t==="selectAll-message"&&r.features.enabled("mbListNativeView")&&e.fire("nativeAd:select"));if(t==="menu"&&h!=="btn-new"){d=o&&o.ancestor(".list-view-footer"),e.mail.Tabs.getActiveTab().get("widget").type==="messagepane"&&(p.append={sec:d?"msgReadTlbrBtm":"msgReadTlbr"},v=1),p.action="tlbr_"+c,d&&(p.action+="_btm"),e.fire("mt:click",p);switch(p.action){case"tlbr_menubtn-spam":case"tlbr_menubtn-spam_btm":p.action=p.action.replace("tlbr_menubtn-spam","spam_menu"),v&&(p.action+="_msg_read"),e.fire("mt:view",p)}}}}function v(t){var n=e.mail.Tabs.getActiveTab().get("widget"),r="";n&&n.msgPane&&n.msgPane.message&&(r=n.msgPane.message,NeoConfig.hasConvView?(r.totalUnread?t.removeClass("read"):t.addClass("read"),r.totalFlagged?t.addClass("flagged"):t.removeClass("flagged")):(r.flags.isRead?t.addClass("read"):t.removeClass("read"),r.flags.isFlagged?t.addClass("flagged"):t.removeClass("flagged")))}function m(t,r){e.use("common-ui-menu-helper",function(e){var i=t.get("id").replace("btn-","menu-"),s=e.one("#"+i),o=e.common.ui.MenuHelper,a=e.mail.Tabs.getActiveTab().get("widget"),l="",c={menu:s,button_enabled:function(){return n.buttonEnabled({root:u,node:t})},keys:function(e){f.keys.call(this,s,e)},enterAccel:function(e){f.enterAccel.call(this,e)}};i==="menu-actions"&&!s.hasClass("list-checked")&&(c.setVisibleCbk=function(){v(s)}),i==="menu-move"&&(c.fixedMenuGroup={menu:"menu-move-folder",height:275}),o.create(t,c,function(){var r;s.on("menuSelected",function(e){n.fire("itemSelected",{dataAction:e.dataAction,item:e.item})}),s.on("menu:state",function(e){e.state==="show"&&n.buttonEnabled({root:u,node:t})?(n.setNodeButtonMenu({node:t}),t.addClass("pressed")):t.removeClass("pressed")}),t.addClass("pressed"),r=n.on("activeChange",function(n){n.newVal||(t.menu&&t.menu.hide(),t.unplug(e.Plugin.Menu),r.detach())}),n.setNodeButtonMenu({node:t})}),i==="menu-move"&&NeoConfig.imapIn&&e.use("mail-ui-folder-menu",function(e){var n=e.one("#menu-move-folder");e.mail.ui.FolderMenu.enhanceMenu({menu:t.menu,root:n.ancestor(),groups:[n,n.next()],childSelector:"li",displayNameSelector:"a span",rapidPrefix:"tlbr_mv_msg_mnu",initialContext:r}),s.on("menu:state",function(r){r.state==="show"&&e.mail.ui.FolderMenu.enhanceMenu({menu:t.menu,root:n.ancestor(),groups:[n,n.next()],childSelector:"li",displayNameSelector:"a span",rapidPrefix:"tlbr_mv_msg_mnu",initialContext:r.context})})})})}function g(t){if(t){for(var i in n._evts)e.detach(n._evts[i]);r.remove(n.get("content")),n.detachAll()}}var n=this,o=0,u,a,f;t=t||{},u=t.root,a=t.template,f=t.menu,n.root=u,n.addAttrs({content:{value:u,getter:c},close:{setter:g},active:{}}),n._evts=[],u&&(h(),l())}function u(){return!0}e.Node.DOM_EVENTS.beforedeactivate=1;var t=strings["str_msg-view_btn_hidepreview"],n=strings["str_msg-view_btn_showpreview"],r=e.common.Utils,i,s=r.ymmastats;e.augment(o,e.Attribute),e.mix(o.prototype,{buttonEnabled:u,setNodeButtonMenu:u}),e.namespace("mail.ui").Toolbar=o;var a=function(){var t=e.one("#toolbar");t&&(t.plug(e.comms.ui.NodeFocusBase,{descendants:"button.btn",keys:{next:"39",previous:"37"}}),e.on("toolbar:refresh",function(){t.fire("refresh")}))};e.mail.ui.ToolbarContainer=new a},"1.0.0",{requires:["attribute","event-custom-base","common-utils","comms-ui-nodefocus-base","ymma-stats","common-ui-tabs-base","mail-common-utils-features"]});


YUI.add("common-ui-contentwidget",function(e){var t=0,n=e.common.Utils.features.enabled("instantCloseOnSend"),r=function(){},i={input:1,textarea:1,select:1},s={checkbox:1,button:1,radio:1,submit:1},o=null,u=function(e){if(e&&e.hasAttribute)try{e.hasAttribute("tabIndex")||e.setAttribute("tabIndex","0")}catch(t){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-ui-contentwidget-contentwidget:1",t,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-ui-contentwidget-contentwidget:1")}return e},a=function(e,t,n){var r=e?e.split(","):[],i=r?r.length:0,s,o={},u,a;for(s=0;s<i;s++)u=r[s].split("+"),a=u[1],u=u[0],o[u]=1,a?n.push(r[s]):t.push(u),u>=48&&u<=57&&t.push(parseInt(u,10)+48);o[46]&&t.push("8")},f=function(t){var r=this,i=["closeChange","reuseChange","activeChange","forceCloseChange","forceDeactivateChange"];this.NAME||(this.NAME="ContentWidget"),r.accelKeyHandle=[],r.accelLocalKeyHandle=[],e.augment(r,e.Attribute),r.addAttrs({active:{setter:r._active},reuse:{value:0},close:{setter:r._close},viewable:{value:!0},skipEvents:{value:{}},contentToolbar:{setter:r._setContentToolbar},parentNode:{},rootNode:{setter:r._setRoot},focus:{setter:r._setFocus},dirty:{getter:r._getDirty},children:{setter:r._setChildren,value:[]},focusNode:{setter:u},forceClose:{value:0},canClose:{value:1,getter:r._canClose,setter:function(e){this._canCloseFlag=e}},forceDeactivate:{value:0},canDeactivate:{value:1,getter:r._getCanDeactivate,setter:function(e){this._canDeactivateFlag=e}},title:{},direction:{},navToolbar:{},navKeys:{},charCodes:{},composeWidgets:{value:null,getter:r.getComposeWidgets},localCharCodes:{},handleKeysLocally:{}},t||{},!0),r._evt={},r.before("closeChange",function(t){var n=t.newVal,i=r.get("active")||0;if(t.newVal&&!r.get("forceClose")&&!r.get("canClose")){t.target.elTab?setTimeout(function(){r.fire("closeHalted"),t.halt(!0)},0):(r.fire("closeHalted"),t.halt(!0));return}i===n&&!r.get("reuse")&&(t.halt(!0),r._evt.deactivateB4Close&&e.detach(r._evt.deactivateB4Close),r._evt.deactivateB4Close=r.after("activeChange",function(){r.set("close",n)}),r.set("active",!n))}),n&&i.push("viewableChange"),r.on(i,function(t){var n=t.attrName,i=t.newVal,s=t.type,o=0,u=r.get("children").length,a,f;if(r.get(n)===i){t.halt(!0);return}if(n==="active"&&!i&&!r.get("forceDeactivate")&&!r.get("canDeactivate")){r._evt.deactivateB4Close&&e.detach(r._evt.deactivateB4Close),r.fire("activeHalted"),t.halt(!0);return}a=function(){o===u&&r.get(n+"Flag")&&(f?(r._evtAfterAction&&e.detach(r._evtAfterAction),r._evtAfterAction=r.after(s,function(){r.set(n+"Flag",0)}),r.set(n,i)):r.set(n+"Flag",0))},r.set(n+"Flag",1),r.iterateChildren(function(t){var r=t.get("skipEvents."+n+"-"+(i&&1));t.get(n)!==i&&!r?(t._myActionEvt&&e.detach(t._myActionEvt),t._myActionEvt=t.after(s,function(){o++,a()}),t.set(n,i)):o++},r);if(r.get(n+"Flag")&&u&&u!==o){f=1,t.halt(!0);return}}),r.after("closeChange",function(t){var n=function(e){if(!e.detachAll)return;e.detachAll(),e.ondestroy()};t.newVal&&!r.get("reuse")&&setTimeout(function(){try{r.iterateChildren(n),r.parentCW||n(r)}catch(t){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-ui-contentwidget-contentwidget:2",t,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-ui-contentwidget-contentwidget:2"),e.error("An error occurred in the clean up phase of this contentWidget",t)}},500)}),r.after("activeChange",function(e){if(e.newVal){var t=r.get("contentToolbar");r.set("contentToolbar",t?t:""),t=r.get("navToolbar"),t&&r.set("navToolbar",t)}})},l=function(n){var r=this.NAME,i=!1;t--,e.Lang.isString(n)&&n.length>1&&(r=n);try{var s=this;for(var o in s)s.hasOwnProperty(o)&&(s[o]instanceof e.Node,s[o]=null);o=null,s=null,i=!0}catch(u){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-ui-contentwidget-contentwidget:3",u,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-ui-contentwidget-contentwidget:3")}return r=null,i};e.mix(f.prototype,{keyHandle:null,localKeyHandle:null,accelKeyHandle:null,accelLocalKeyHandle:null,bound:null,ondestroy:function(){l.apply(this,arguments)},iterateChildren:function(e){if(typeof this.get!="function")return;var t=this,n,r=t.get("children"),i=r.length,s;for(s=0;s<i;s++)n=r[s],n instanceof f&&e.call(t,n,s)},addChild:function(e){var t=this,n=!1;if(!e||!(e instanceof f))return;t.iterateChildren(function(t){t===e&&(n=!0)}),n||t.set("children",t.get("children").concat([e]))},removeChild:function(e){var t=this,n=function(n){var r=[];n.newVal&&(t.iterateChildren(function(t){if(t===e){t.parentCW=null;return}r.push(t)}),t.set("children",r))};e.get("close")?n({newVal:1}):(e.once("closeChange",n),e.set("close",1))},_active:function(e){var t=this,n=t.get("contentToolbar");e?(t.isContained||(o=t),t.get("active")||setTimeout(function(){t.get("active")&&(window.bktest2,t._bindToKeys())},0)):(t.isContained||(o=null),t.isContained||t._blur(),t._detach()),n&&n.set("active",e)},_setFocus:function(e){var t=this;e?t._focus(e):this._blur(e)},_focus:function(){var t,n=this,r=n.get("focusNode"),i;e.UA.gecko>=2&&(i=document.activeElement)&&i.blur();if(r){try{t=n.onFocus(r)}catch(s){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-ui-contentwidget-contentwidget:4",s,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-ui-contentwidget-contentwidget:4"),t=!1}if(!t)try{r&&r.focus()}catch(s){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-ui-contentwidget-contentwidget:5",s,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-ui-contentwidget-contentwidget:5")}}},_blur:function(){var e=this,t=e.get("focusNode");if(t&&t._node&&t.blur)try{t.blur()}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-ui-contentwidget-contentwidget:6"
,n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-ui-contentwidget-contentwidget:6")}},_close:function(e){e===1&&this._detach()},_handleKeyDown:function(t){var n=!1,r=t.target;if(!e.common.Utils.isYuiNode(r,!0))return n;try{var o=t.keyCode,u=r?r.get("tagName").toLowerCase():"",a=r?r.get("type")||"":"",f;a=a.toLowerCase(),f=u in i&&!(a in s),f||(e.UA.os==="macintosh"&&o===8&&(t.charCode=46,t.keyCode=46),o>=96&&o<=105&&(t.charCode=o-48,t.keyCode=o-48),n=this.onKeyDown(t))}catch(l){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-ui-contentwidget-contentwidget:7",l,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-ui-contentwidget-contentwidget:7"),n=!1}return n?(t.halt(),!1):n},_setRoot:function(e){var t=this;e&&(t.get("focusNode")?u(e):t.set("focusNode",e),t.get("active")&&t._bindToKeys(e))},_bindToKeys:function(t){var n,r,i=this,s=i.get("charCodes"),o=i.get("localCharCodes"),u=i.get("handleKeysLocally"),f=[],l=[],c;t=t||i.get("rootNode");if(i.bound)return;if(s&&(!u||t)){c=u?t||document:document,a(s,f,l),f.length&&(i.keyHandle=e.on("key",i._handleKeyDown,c,"down:"+f.join(","),i),i.bound=1),r=l?l.length:0;for(n=0;n<r;n++)i.accelKeyHandle.push(e.on("key",i._handleKeyDown,c,"down:"+l[n],i)),i.bound=1}if(o&&t){f=[],l=[],a(o,f,l),f.length&&(i.localKeyHandle=e.on("key",i._handleKeyDown,t,"down:"+f.join(","),i),i.bound=1),r=l?l.length:0;for(n=0;n<r;n++)i.accelLocalKeyHandle.push(e.on("key",i._handleKeyDown,t,"down:"+l[n],i)),i.bound=1}},_nest:function(e){var t=this,r=["activeChange","closeChange"];e.isContained=1,n&&r.push("viewableChange"),e.after(r,function(n){var r=n.attrName,i=n.newVal,s=0,o=t.get("children").length;t.iterateChildren(function(n){var u=e.get("skipEvents."+r+"-"+(i&&1));(e===n||n.get(r)===i||u)&&s++,s===o&&t.get(r+"Flag")!==1&&t.set(r,i)})},t),e.on(["titleChange","focusNodeChange","dirtyChange","directionChange","navKeysChange"],function(e){e.oldVal!==e.newVal&&t.set(e.attrName,e.newVal)},t)},_setContentToolbar:function(e){var t=this.get("contentToolbar");return t!==e&&(t&&t.set("active",0),e&&e.set("active",1)),e},_setChildren:function(e){var t=0,n=e?e.length:0,r,i=[],s=this;for(t;t<n;t++)r=e[t],r&&r instanceof f&&(r.parentCW!==s&&(r.parentCW=s,s._nest(r)),i.push(r));return i},_detach:function(){var e=this,t=e.accelKeyHandle.length;e.keyHandle&&e.keyHandle.detach(),e.localKeyHandle&&e.localKeyHandle.detach();for(var n=0;n<t;n++)e.accelKeyHandle[n].detach();e.accelKeyHandle=[],t=e.accelLocalKeyHandle.length;for(n=0;n<t;n++)e.accelLocalKeyHandle[n].detach();e.accelLocalKeyHandle=[],e.bound=0,t=null},_getDirty:function(){var e=this,t=!1;return e.iterateChildren(function(e){if(e.get("isDirty")){t=!0;return}}),t||e.isDirty&&e.isDirty()},_getCanDeactivate:function(){var e=this,t=e.get("children"),n=!1;return e._canDeactivateFlag===-1||e._canDeactivateFlag===2?e._canDeactivateFlag>0:(e.iterateChildren(function(e){if(!e.get("canDeactivate")){n=!0;return}}),t.length?!n:e._canDeactivateFlag)},_canClose:function(){var e=this,t=e.get("children"),n=!1;return e._canCloseFlag===-1||e._canCloseFlag===2?e._canCloseFlag>0:(e.iterateChildren(function(e){if(!e.get("canClose")){n=!0;return}}),t.length?!n:e._canCloseFlag)},render:r,onKeyDown:r,onFocus:r,getComposeWidgets:r,isDirty:function(){return!1}}),e.namespace("common.ui").ContentWidget=f},"1.0.0",{requires:["event-key","common-utils","mail-common-utils-features"]});


YUI.add("common-ui-notification",function(e){function r(e){var t=this;e=e||{},t.dir=e.dir||"top",t.sticky=e.sticky||!1,t.closeButton=e.closeButton||!1,t.height=e.height||"50px",t.type=e.type||"slide",t.className=e.className||"",t.parent=e.parent||"body",t.parentType=e.parentType||"class",t.create()}function i(){var t=this,n;t.type==="slide"?n=t.dir+":-"+t.height:t.type==="fade"&&(n="opacity:0"),t.container=e.Node.create('<div tabindex="0" role="alert" aria-labelledby="notification" id = "notification" class="'+t.className+'" style="'+n+'"></div>'),t.parentType==="id"?e.one("#"+t.parent).appendChild(t.container):e.one(t.parent).appendChild(t.container),t.bindUI()}function s(){var n=this;n.container.delegate("click",function(e){var r=t.getDataAction(e),i=r&&r.action;e.preventDefault(),i&&(i==="close"?n.hide():n.fire("clickEvent",{action:i}))},"a"),n.sticky&&e.once("click",function(){n.hide()})}function o(t,n){var r=this;if(!t)return;n=n||3e3,r.container.set("innerHTML",t),e.Lang.later(0,r,function(){this.show(n)})}function u(t){var n=this;n.type==="slide"?n.container.setStyle(n.dir,0):n.type==="fade"&&(n.container.setStyle("opacity",100),n.container.focus()),n.sticky||e.Lang.later(t,n,function(){this.hide()})}function a(){var t=this,r,i;t.type==="slide"?(r=t.dir,i="-"+t.height):t.type==="fade"&&(r="opacity",i=0),t.container&&t.container._node&&(t.container.setStyle(r,i),e.Lang.later(n,t,function(){this.destroy()}))}function f(){var e=this;e.container.remove(!0)}function l(){}var t=e.common.Utils,n=3e3;r.prototype={create:i,notify:o,show:u,hide:a,getMsg:l,destroy:f,bindUI:s},e.namespace("common.ui"),e.augment(r,e.EventTarget),e.common.ui.Notification=r},"1.0.0",{requires:["common-utils"]});


YUI.add("comms-ui-nodefocus-base",function(e){function t(){t.superclass.constructor.apply(this,arguments)}e.extend(t,e.Plugin.Base,{initializer:function(t){function n(n){i.detach(),s.detach(),e.use("comms-ui-nodefocus",function(){u.unplug(a.NodeFocusBase),u.plug(a.NodeFocus,t),u.nodeFocus.onKeyDown(n)})}var r=this,i,s,o,u=r.get("host"),a=e.comms.ui,f=a.NodeFocus;f?u.plug(f,t):(o=[t.keys.next,t.keys.previous],i=e.on("key",n,u,"down:"+o.join(","),r),s=e.on("nodeFocus:load",n,r))}}),t.NAME="NodeFocusBase",t.NS="nodeFocusBase",e.on("keydown",function(t){t.keyCode===9&&e.fire("nodeFocus:load",t)}),e.namespace("comms.ui").NodeFocusBase=t},"1.0.0",{requires:["plugin","node","event-key"]});


YUI.add("minty_module_tabs_tab_removable",function(e){e.namespace("ui.Templates"),e.ui.Templates.minty_module_tabs_tab_removable={base:'<li role="presentation" class="removable t-el"> <a data-action="navigate" href="{{tab_url}}" role="tab" id="{{tab_id}}" title="{{tab_title}}" class = "bold"> {{p_label}} <b>{{s_label}}</b> </a> <button class="icon icon-small-close close-tab" data-action="close-tab" title="{{str_close}}"></button></li>'}},"1.0.0");


YUI.add("mail-ui-accounts",function(e){function i(){var i,s,o,u,a,f,l,c,h,p=strings.str_cfg_tog_accnt_user_color||NeoConfig.userColorIndicParam,d=t.extAccountColors,v=d.length,m=e.Lang.trim(r.get("userSendPref.defaultFromName"))||r.get("userSendPref.defaultFromAddress"),g=r.get("externalAccounts.extAccount"),y=g?g.length:0;c={Inbox:{id:"Inbox",color:"ypurple",name:m,pretty_name:m,check_mbox:n(strings.str_nav_left_checkmail_account_attr,{mailbox_pretty_name:m})}};for(i=0,s=0;i<y;++i)o=g[i],h=null,p&&(l=o.colorIndicator,t.colorIndicatorsStr[l]?h=t.colorIndicatorsStr[l]:(l=o.colorIndicator?o.colorIndicator:"",l>0&&(h=t.colorIndicators[l]))),a=o.server?e.Lang.trim(o.server):null,f=o.username&&a?o.username+"@"+a:null,f&&(u="data-mboxid"+s,m=e.Lang.trim(o.accountName)||o.address,c[u]={id:u,color:h||d[s%v],name:o.address,pretty_name:m,check_mbox:n(strings.str_nav_left_checkmail_account_attr,{mailbox_pretty_name:m}),server_addr:f},h&&(c[u].user_color=h),++s);return s===0&&(c=null),c}function s(){var e,n,s,o,u,a,f=strings.str_cfg_tog_accnt_user_color||NeoConfig.userColorIndicParam,l={},c=i(),h=r.get("aliases.alias")||[],p=r.get("disposableAddresses.deaName")||[];if(strings.str_cfg_tog_msgListColorIndic||t.showExtAccountsParam>1){if(c)for(e in c)s=c[e],o=s.server_addr,a=f?s.user_color:s.color,o&&a&&(l[o]=s.color);if(f){h=h.concat(p),n=h.length;for(e=0;e<n;++e)s=h[e],u=s.colorIndicator?s.colorIndicator-0:0,u>0&&(l[s.address]=t.colorIndicators[u])}}return l}var t=NeoConfig,n=e.common.Utils.substitute,r=e.common.persist.UserData;e.namespace("mail.ui"),e.mail.ui.Accounts={buildExtAccountList:i,buildAccountList:s}},"1.0.0",{requires:["common-utils","common-persist-user-data"]});


YUI.add("mail-ui-foldersview-base",function(e){var t=e.Node.one,n=e.Node.all,r=NeoConfig,i=e.common.Utils,s=e.mail.ui.FolderUtils,o=i.substitute,u=i.getNormalizedMessageCount,a=strings.str_nav_left_checking_mail,f=strings.str_nav_inbox,l=r.mailboxes,c="knownAddress|externalAccountsChange",h=e.common.persist.UserData,p="mail-ui-foldersview-bind",d={totalFolderUnreadCount:0},v={accounts:{}},m={},g=i.log,y=i.features.enabled("archive"),b=i.escapeHtml,w;e.Node.DOM_EVENTS.beforedeactivate=1;var E=function(){function ot(e){return z?t('li[data-vfid="'+e+'"]'):Q.one('li[data-fid="'+e+'"]')}function ut(){var t={fid:{value:{fid:"",name:"",checkMail:!1,mailboxId:"",extraParams:null,smartFolder:!1,forceRefresh:!1},setter:function(t){var n,r,s,o,u=t.fid,a=t.checkMail,f=t.mailboxId,c=t.forceRefresh,h,p,d=!1,v,m=!1;z=t.smartFolder,(u===R&&u===I["in"]&&!z||a)&&J===null&&(Nt(f),h=f,f&&f!==""&&f!=="Inbox"&&(h=l&&l[f]?l[f].name:""),v=e.common.persist.UserData.get("externalAccounts.extAccount"),v&&h===""?(e.fire("MailLog",{m:"User forced a checkmail"}),J=W.refresh({forced:!0},{success:function(){Ct(),e.later(0,null,function(){W.refresh({accountId:h},{},"checkmail")})},failure:Ct,timeout:3e4,suppressCodes:NeoConfig.farm==="f9323"?[]:["*"]},"checkmail")):(e.fire("MailLog",{m:"User forced a checkmail"}),J=W.refresh({accountId:h,forced:!0},{success:Ct,failure:Ct,timeout:3e4,suppressCodes:NeoConfig.farm==="f9323"?[]:["*"]},"checkmail")));if(u!==R||z||c){d=z&&!c,d&&(z=!1),n=ot(R)||ot("Inbox"),d&&(z=!0),m=z&&c,m&&(z=!1),o=ot(u);if(!NeoConfig.backButtonFull&&NeoConfig.backButton&&typeof window.history.pushState=="function")try{(!window.history.state||window.history.state.id!==1)&&u!=="Inbox"&&window.history.pushState({id:"1"},document.title,window.location.pathname+window.location.search),u==="Inbox"?window.history.state&&window.history.go(-1):window.history.replaceState({id:"1"},document.title,"#mail")}catch(g){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-foldersview-foldersview:1",g,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-foldersview-foldersview:1"),e.fire("SplunkLog","debug_ie_history",{backButton:NeoConfig.backButton,backButtonFull:NeoConfig.backButtonFull,newFId:u},"sample")}return n&&(r=n.one("a"),r&&(n.removeClass(H),r.setAttrs({tabIndex:-1,"aria-selected":!1}))),o&&((p=o.ancestor("ul").one(D))&&p&&p.set("tabIndex",-1),s=o.one("a"),s&&(o.addClass(H),s.setAttrs({tabIndex:0,"aria-selected":!0})),t.isTrashBtn||i.isControlActive()||o.one("a").focus()),bt(),R=u,t}},lazyAdd:!0},isCheckingMail:{value:!1},active:{value:!1}};P.addAttrs(t)}function at(t,n){return function(r){n||r.preventDefault(),e.use(p,function(e){try{e.mail.FoldersView[t](r)}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-foldersview-foldersview:2",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-foldersview-foldersview:2"),e.use("common-utils-error",function(){i.error.report("Exception when trying to call '"+t+"':"+n.toString(),1,1,1,n)})}})}}function ft(){return it}function lt(t){var n,r,i,s,o;it=0;for(n=0;n<nt.length;n++)r=nt[n].toLowerCase(),i=e.Node(rt._nodes[n]),o=decodeURIComponent(i.getAttribute("data-fid").replace(/%5c/g,"/")),s=r.indexOf(t),s>=0&&(i.addClass(k),i.one(N).setAttribute("title",o),it++);it===0&&e.one(".no-results").addClass(k)}function ct(){var e;st?e=Q.all(N):G.one("li")&&(e=G.all(N)),e&&(nt=e.get("textContent"),e.size()>0&&(rt=e.get("parentNode").get("parentNode")))}function ht(){var n=t(".searcher"),r;n&&(r=n.get("value"),e.all("."+k).removeClass(k),r.length>0?(G.addClass(C),lt(r.toLowerCase())):G.removeClass(C))}function pt(){st=Z.hasClass(L)}function dt(t,n){var r={fid:n,start:0,count:2*NeoConfig.pageSize,groupBy:null,sortKey:"date",sortOrder:NeoConfig.sortOrder||"down"};NeoConfig.yodaReadEnabled&&NeoConfig.loadYodaController.then(function(){e.mail.controller.v3.api.hoverPrefetch({type:NeoConfig.hasConvView?"convlist":"msglist",options:r})})}function vt(e){var t=e.currentTarget.ancestor("li",!0),n;if(!t.hasClass("sysfolder")&&!t.hasClass("folder"))return;n=t.getAttribute("data-fid"),n&&P.hoverPrefetch.onItemMouseOver(n,n,dt)}function mt(){function M(t){var n;m.get("scrollTop")!==0?s.addClass("scrolled"):s.removeClass("scrolled"),t&&t.type==="scroll"&&(n={action:"left_rail_scroll"},w?w.statAfterIdle("leftRailScroll",null,n):e.use("mail-ui-workspace-stats",function(e){w=e.mail.ui.Workspace,w.statAfterIdle("leftRailScroll",null,n)}))}function D(t,n){var r,i=n.target.ancestor(".nav-lnk",!0);i&&(r=i.ancestor("#nav").all(".nav-lnk"),r.set("aria-selected",!1),r.set("tabIndex",-1),i.setAttrs({"aria-selected":!0,tabIndex:0}));switch(t){case"mail":e.fire("nav:inbox");break;case"contacts":e.fire("nav:contacts");break;case"calendar":e.fire("nav:calendar");break;case"notepad":e.fire("nav:notepad");break;case"messenger":e.fire("nav:messenger");break;case"boss":e.fire("nav:boss",n);break;case"newsfeed":e.fire("nav:newsfeed")}e.common.net.Pulse.checkNetStatus(!0)}var s=t("#shellnavigation"),u=t("#main"),a=t("#Folders .btn-folders"),f,l=t("li#unread"),h=e.mail.persist.MetaData,p=n(".listnav-subfolder .listnav-back"),d=t(S),v=t(x),m=t(".listnav-outter"),g=t("#nav"),y=s.all(".papa-folder"),b=NeoConfig.onboarding,T,k="add-mailbox-li",L=NeoConfig.accounts&&NeoConfig.accounts.imapInAccounts,A,O;pt(),s.delegate("keydown",at("upDownNavigation",!0),_),g.delegate("click",function(e){var t=e.currentTarget.getAttribute("data-nav");D(t,e),e.preventDefault()},".nav-item"),g.delegate("keydown",function(e){var t=e.target,n=t.ancestor(".nav-item"),r,i,s;switch(e.keyCode){case 13:D(n.getAttribute("data-nav"),e),e.halt();return;case 37:r=n.previous(),r||(s=n.get("parentNode").all(".nav-item"),r=s.item(s.size()-1));break;case 39:r=n.next()||g.one(".nav-item")}r&&(t.set("tabIndex",-1),i=r.one(".nav-lnk"),i.set("tabIndex",0),i.focus(),e.halt())},".nav-lnk"),m.on("scroll",M),e
.on("windowresize",M),s.delegate("mousedown",function(e){!this.hasClass("selected")&&e.button===1&&!e.ctrlKey&&e.preventDefault()},"h2 span[role=button], h2 .btn input"),K?Q.delegate("contextmenu",at("contextClickV3"),"li"):Q.delegate("contextmenu",at("contextClick"),"li.sysfolder"),Q.delegate("click",at("checkMailClick"),".check-mail"),Q.delegate("keydown",at("foldersKeyDown",!0),"li"),Q.delegate("click",at("emptyFolderOnClick"),"li.sysfolder a span.btn"),i.features.enabled("showAddMailbox")&&Q.one("."+k)&&(T=function(t){e.fire("util:ymstats",{name:t,tags:{theme:NeoConfig.theme.id},include:{bucket:!0}}),e.fire("mt:click",{action:t})},e.once("imapin:accountAdded",function(){Q.one("."+k).hide(),T("add_mailbox_link_imap")}),T("add_mailbox_link_shown"),Q.delegate("click",function(t){if(t.target.hasClass("icon-small-close")){Q.one("."+k).hide(),h.set("neo.pref.onboard.addMailBox",1),T("add_mailbox_link_close");return}T("add_mailbox_link_success"),e.fire("openOptions",{view:"accounts",subView:{sid:"providerList"},origin:"addMailboxFolderNav"})},"."+k)),Q.delegate("click",function(t){!t.currentTarget.hasClass("btn-mobilizer")&&!t.currentTarget.hasClass("t-learn-more")&&t.preventDefault(),t.smartFolder=z;var n=t.currentTarget.ancestor("li",!0),r=n.ancestor(".open"),i=t.target,s=(i||t.currentTarget).getAttribute("data-action"),o=n.get("id"),u,a,f;if(s==="folder-empty-spam"||s==="folder-empty-trash"||n.hasClass(k)){t.halt();return}if(K&&s==="folder-search"){yt({dataAction:"folder-search",target:t.currentTarget},null),e.fire("mt:click",{action:"fldr_srch_open"});return}if(s==="folder-new"){yt({dataAction:"folder-new",target:t.currentTarget},null),e.fire("mt:click",{action:"fldr_add"});return}if(s==="imap-add")return;t.currentTarget=n;if(o==="uservoice_feedback"){UserVoice&&UserVoice.showPopupWidget&&UserVoice.showPopupWidget();return}if(o==="mobilizer")return;n.hasClass("sysfolder")&&(e.fire("navigation:switch",{type:"none"}),n.getAttribute("data-fdepth")?at("usrFoldersClick")(t):at("sysFoldersClick")(t)),u=n,a=n.hasClass("nav-open");if(n.hasClass("openable")){if(o==="smartviews")return;g&&n.toggleClass("nav-open");if(!a)f=n.get("id"),e.fire("navigation:switch",{type:f}),n.hasClass("folders")&&(n.one("a").setAttribute("aria-selected",!0),e.fire("mt:click",{action:"custom_expand"}),n.one("a").set("title",strings.str_nav_left_folders_expanded_attr)),f==="multitask"&&(e.fire("mt:click",{action:"recentTabs_expand"}),e.fire("util:ymstats",{name:"leftNavRecentShow"}));else{var l=e.mail.Tabs.getActiveTab(),c=l.label;f=n.get("id"),c==="Calendar"||c==="Contacts"||c==="Notepad"?e.fire("navigation:switch",{type:c.toLowerCase()}):e.fire("navigation:switch",{type:f}),n.hasClass("folders")&&(n.one("a").setAttribute("aria-selected",!1),e.fire("mt:click",{action:"custom_collapse"}),n.one("a").set("title",strings.str_nav_left_folders_collapsed_attr))}u=null}u&&(Q.all(".sysfolder, .folder, .btn-apps").removeClass("selected"),n.addClass("selected"),r&&r.addClass("selected"))},"li > a, li > button"),i.features.enabled("fetchMessageListOnHover")&&e.use(["event-mouseenter","mail-controller-v3-hoverprefetch"],function(e){P.hoverPrefetch=new e.mail.controller.v3.HoverPrefetch({type:"list"}),Q.delegate("mouseover",function(t){e.later(0,P,vt,[t])},"li > a"),G.delegate("mouseover",function(t){e.later(0,P,vt,[t])},"li > a"),Q.on("mouseleave",function(t){e.later(0,P,P.hoverPrefetch.clearMouseOverEvent,[!0])})}),e.use("event-mouseenter",function(e){Q.delegate("hover",function(t){var n=t.currentTarget.ancestor("li.openable",!0),r=u.hasClass("dragging-message");n&&r&&e.fire("navigation:switch",{type:n.get("id")})},function(t){var n=t.currentTarget.ancestor("li.openable",!0),r=u.hasClass("dragging-message");n&&r&&e.fire("navigation:switch",{type:"none"})},"li.openable")}),G.delegate("click",function(e){var t=e.currentTarget.ancestor("li.open");t&&t.addClass("selected")},"li > a"),e.on(["openCalendar","openContacts","openNotepad"],function(t){t&&!t.mrd&&e.fire("navigation:switch",{type:t})}),e.on("Nav:ComposeClosed",function(){e.one("#Compose").removeClass("selected")}),e.on(["editMessage","newMessage"],function(){Q.all(".sysfolder, .folder").removeClass("selected"),e.one("#Compose").addClass("selected")}),l&&l.on("click",function(t){e.fire("search:fireSearch",{keyword:"is:unread"}),t.preventDefault()}),f=h.after("neoChanged",function(){var e=!0,n=t(E+"-nav");h.get("neo.pref.folderState")?n.replaceClass("collapsed","expanded"):(n.replaceClass("expanded","collapsed"),e=!1),n.one(".label").set("aria-expanded",e),h.detach(f)});var H=e.one(".listnav-folder");G.delegate("click",function(t){var n=t.target,r,s,u;if(n.hasClass("listnav-folder-open")){var a=t.currentTarget.next(),f=t.currentTarget.ancestor(".listnav-folder"),l=f.get("offsetWidth"),c=parseInt(H.getComputedStyle(NeoConfig.isRTL?"left":"right"),10),h='<span class="icon arrow-left"></span>',p;a&&a.hasClass("listnav-folder")&&(p=t.currentTarget.one("a").getHTML(),a.one(".listnav-back").setHTML(p+h),f.all(".listnav-subfolder").addClass("hidden"),a.removeClass("hidden"),H.setStyle(NeoConfig.isRTL?"left":"right",c+l+"px"),a.ancestor(".listnav-container").set("scrollTop","0"))}else n.hasClass("listnav-folder-toggle")?(n.hasClass("icon-chevron-right")?n.replaceClass("icon-chevron-right","icon-chevron-down"):n.replaceClass("icon-chevron-down","icon-chevron-right"),r=n.ancestor("li.folder"),s=r&&r.one(N),u=o(n.hasClass("icon-chevron-right")?strings.str_nav_left_subfolders_collapsed_attr:strings.str_nav_left_subfolders_expanded_attr,{name:i.escapeHtml(s&&s.getHTML())}),n.set("title",u),n.set("aria-label",u),t.currentTarget.next().toggleClass("hidden"),e.fire("persist:folders")):!n.hasClass("searcher-icon-close")&&!n.hasClass("renamer")&&(t.fid=R,t.smartFolder=z,at("usrFoldersClick")(t));t.preventDefault()},"li"),p.on("click",function(e){var t=e.currentTarget.ancestor(".listnav-folder"),n=t.get("offsetWidth"),r=parseInt(H.getComputedStyle("right"),10);H.setStyle("right",r-n+"px")}),K&&G.
delegate("dblclick",function(e){!G.hasClass(C)&&!e.target.hasClass("editor")&&(e.stopPropagation(),yt({dataAction:"folder-rename",target:e.currentTarget,actionSource:"activeFolder"}))},"li"),K||G.on("contextmenu",at("usrFoldersContextClick")),a&&a.on("click",at("updateFolderPref",!0)),d&&(d.all("a").each(function(e){e.set("href","#")}),d.delegate("click",function(t){t.preventDefault();var n=t.currentTarget;n.hasClass("emails-contacts")&&e.fire("openRUEFCInbox"),z=!0},"li"),d.on("contextmenu",function(){})),v&&v.on("click",function(e){var t=e.currentTarget,n;t&&(n=t.get("parentNode"))!==null&&(n.hasClass("expanded")?(n.removeClass("expanded"),n.addClass("collapsed")):n.hasClass("collapsed")&&(n.removeClass("collapsed"),n.addClass("expanded")))}),e.common.persist.UserData.after(c,function(){(strings.str_cfg_tog_renderExternalAccounts||r.showExtAccountsParam)&&e.mail.FoldersView.renderMailboxes()}),Q.all("li.sysfolder a").each(function(e){e.set("href","#")}),e.on("key",function(e){n(".check-mail").each(function(){(this.contains(e.currentTarget)||this.compareTo(e.currentTarget))&&e.stopPropagation()})},s,"",P),e.on("foldersview:resetFocus",function(e){var t=ot(e);(t=t.one("a"))!==null&&t.focus()}),y.each(function(e){var t=e.one(N),n=o(strings.str_nav_left_subfolders_collapsed_attr,{name:i.escapeHtml(t&&t.getHTML())});e.one(".listnav-folder-toggle").set("title",n),e.one(".listnav-folder-toggle").set("aria-label",n)}),P.on("fidChange",function(t){e.fire("ui:currentFolder",t.newVal),e.fire("mailview:relcalculateToolbarPositions",{besidePreviewActive:NeoConfig.previewPanePref===1})}),K&&i.features.enabled("imapInOnboarding")&&i.features.enabled("imapInGA")&&(!i.isLaunchOnboardingShown()&&b.imapInOverview?e.use("mail-ui-onboarding-imap-in",function(e){e.mail.ui.onboarding.ImapIn.init()}):e.once(["initCallout:imapInPreV3","initCallout:imapInPostV4"],function(t){e.use("mail-ui-onboarding-imap-in",function(e){e.mail.ui.onboarding.ImapIn.init(t)})}))}function gt(){var t=n("li.inbox-sub");t&&t.remove(),l=e.mail.ui.Accounts.buildExtAccountList(),l&&Neo.drawMailboxes(l)}function yt(t,n){var r=e.mail.ui.ContextButton,i;if(r&&n){i=ot(n);if(!r.folderActionEnabled(t.dataAction,i))return}e.use("mail-ui-folderevents",function(e){e.mail.ui.FolderEvents.handle(t,n||R)})}function bt(){var e=t(T),n=t(E),r;!e.one(D)&&(r=e.one(A))&&r.set("tabIndex",0),!n.one(D)&&(r=n.one(A))&&r.set("tabIndex",0)}function wt(){var n=t(E),r=t("doc").get("activeElement"),i=-1;if(Q.contains(r)||n.contains(r))i=e.all(_).indexOf(r);return i}function Et(t){var n=e.all(_),r=n.item(t),i;r||(i=t+1,i>n.size()&&(i=t-1),r=n.item(i)),r&&(r.set("tabIndex",0),r.focus())}function St(){var t=e.one("#msg-list");i.isControlActive()||t.focus()}function xt(){var e=t(E+"-btn");mt(),bt(),e&&e.set("aria-expanded",t(E+"-nav").hasClass("expanded")),St()}function Tt(t){var n="Inbox",r=strings[q[n]],i,o,u;NeoConfig.imapIn&&(o=e.mail.Controller.ImapIn,u=o.getCurrentAccountId(),n=o.getFolderByType(s.InboxFolderType,u).folderInfo.fid),i=e.mail.ui.Workspace.getFolderContent().widget.msgList,i._listview.scrollToTop(),e.fire("checkmail:before"),P.set("isCheckingMail",!0),z?P.set("fid",{fid:n,name:r,checkMail:!0,mailboxId:t,smartFolder:z,forceRefresh:!0}):P.set("fid",{fid:n,name:r,checkMail:!0,mailboxId:t})}function Nt(t){var n;!t||t===""||!l?(Q.all("#Inbox i + span, li.inbox-sub i + span").setContent(a),Q.all("li .check-mail").addClass("loading"),Q.all("li.sysfolder .check-mail").addClass("loading")):l&&(n=Q.one('li.inbox-sub i[data-mboxid="'+t+'"]'),n&&n.setContent(a),n=Q.one('li.inbox-sub input[data-mboxid="'+t+'"]'),n&&n.addClass("loading")),e.fire("checkmail:clicked"),e.fire("MailLog",{m:"checkMail: "+t+" is "+a}),!NeoConfig.backButtonFull&&NeoConfig.backButton&&typeof window.history.pushState=="function"&&window.history.state&&window.history.go(-1)}function Ct(){var t,n,r,i;Q.one(".in .icon-text").setContent(f),Q.all("li .check-mail").removeClass("loading"),Q.all("li .check-mail").removeClass("loading"),e.fire("MailLog",{m:"checkMail: Done - Inbox string is reset"}),t=e.one("#inboxcontainer #msg-list"),t&&t.focus();if(l)for(n in l)r=l[n],i=Q.one('li.inbox-sub i[data-mboxid="'+n+'"]'),e.fire("MailLog",{m:"checkMail: Done - "+n+" string is reset"}),i&&i.setContent(r.pretty_name||r.server_addr);e.fire("checkmail:succeeded"),P.set("isCheckingMail",!1),J=null}function kt(t){var n=t.folderInfo.fid,i=s.isDraftFid(n),a=n==="%40C%40Chats",f=s.isInboxFid(n),l=s.isSpamFid(n),c=s.isArchiveFid(n),h=f&&e.one('#Folders [data-fid="Inbox"]'),p=h&&h.one(".unread-count"),d=i||a?t.total:t.unread,v="{{str_nav_inbox_unread_attr}}",m="",y=t.unread>0?"{{str_nav_"+n.toLowerCase()+"_unread_aria_attr}}":"{{str_nav_"+n.toLowerCase()+"}}",b={},w,E,S=r.strings,x,T,N;if(c)return;i?(v=d===1?"{{str_nav_draft_attr}}":"{{str_nav_drafts_attr}}",y=v):a?(v=d===1?"{{str_nav_conv_attr}}":"{{str_nav_convs_attr}}",y=v):l&&(y=t.unread>0?"{{str_nav_spam_unread_aria_attr}}":"{{str_nav_spam}}"),w=ot(n),w&&(t.isSystem===!1||!i&&!s.isSentFid(n)||h)&&(b.email_str=d===1?"{{str_email_cnt_one}}":"{{str_email_cnt_multi}}",b.total_cnt=t.total,m=t.folderInfo.name+" - "+o("{{str_nav_folder_email_cnt}}",b,null,null,S),x=h||w,t.unread>0?(x.addClass(B),b.unread_cnt=t.unread,T=o("{{str_nav_folder_unread_cnt}}",b,null,null,S),m+=" ("+T+")",t.isSystem||(y=t.folderInfo.name+": "+T)):(x.removeClass(B),t.isSystem||(y=t.folderInfo.name))),E=w&&w.one(".unread-count"),E&&X.isNumber(d)&&(d<0&&(d=0),d?(g({m:"Updating folder count UI for the folder",folder:w.getAttribute("data-fid"),count:d}),E.setHTML("("+u(d)+")"),E.removeClass("invisible"),p&&(p.setHTML("("+u(d)+")"),p.removeClass("invisible"))):(E.addClass("invisible"),E.setHTML(""),p&&(p.addClass("invisible"),p.setHTML(""))),b.inbox_unread_cnt=d,a&&(b.conv_cnt=d),t.isSystem?E.set("title",o(v,b,null,null,S)):(w.one("i").set("title",m),w.one(".unread-count").set("title",m)),h&&(h.one("i").set("title",m),h.one("span").set("title",m)),y=o(y,b,null,null,S),N=w.one("a"),N&&N.setAttribute
("aria-label",y))}function Lt(e){var t=e.folderInfo.fid,n=ot(t),r;n=n&&n.one("a");if(n){var i=e.total,u=i===1?"str_email_cnt_one":"str_email_cnt_multi",a="{{str_nav_folder_email_cnt}}",f={total_cnt:i,email_str:strings[u]};s.isDraftFid(t)?(a=i===1?"{{str_nav_draft_attr}}":"{{str_nav_drafts_attr}}",f.inbox_unread_cnt=i):t==="%40C%40Chats"&&(a=i===1?"{{str_nav_conv_attr}}":"{{str_nav_convs_attr}}",f.conv_cnt=i),z&&(a="{{str_nav_email_from_ctcts_attr}}",f.email_ctcts_cnt=i),r=b(e.folderInfo.name)+" - "+o(a,f,null,null,strings),n.set("title",r),n=n.one("i"),n&&n.set("title",r)}}function At(t,n){var r=wt(),i=[],s,o;e.use("mail-ui-folder-state",function(e){s=e.mail.ui.folderState,n?(i=s.getExpandedFolderFids(n),o=s.getSectionStates(n),s.applySectionsState(n)):i=s.updateExpandedFoldersFids(),Neo.drawFolders({folders:{folder:t}},i,o),Ot(n),r>=0?Et(r):bt(),U&&P.set("fid",{fid:U}),U=null})}function Ot(t){var n=r.userDataObj&&r.userDataObj.otherYahooMboxes&&r.userDataObj.otherYahooMboxes.otherYahooMboxesTotal?"userSendPref.defaultID":"userSendPref.loggedInAlias",s=h.get(n),u=NeoConfig.accounts.imapInAccounts,a;NeoConfig.imapIn&&u&&u.length>0&&(a=e.mail.Controller.ImapIn,t||(t=a.getCurrentAccountId()),v&&v.accounts[t]&&($=v.accounts[t].acctUnreadCount,s=a.getAccountAttribute(t,"description"))),e.config.doc.title=$>0?o("{{str_page_title_unread}}",{unread_cnt:$,title:s},null,null,strings):o("{{str_page_title}}",{title:i.escapeHtml(s)},null,null,strings),V=null,$===0&&i.features.enabled("faviconNotify")&&e.use("mail-ui-favicon-notify",function(e){e.mail.ui.faviconNotify.setFaviconHref()})}function Mt(t){var n,r=0,i,o,u,a,f=d,l=NeoConfig.imapIn,c=s.getInboxFid(),h=et.one('#custom-folders > .folder[data-fid="'+c+'"]'),p=t.length,g,b;for(n=0;n<p;n++){u=t[n],o=u.folderInfo.fid;if(s.isDraftFid(o)||o==="%40C%40Chats"||o==="Sync%20Trap"||s.isSpamFid(o)||s.isTrashFid(o)||s.isSentFid(o)||y&&s.isArchiveFid(o))continue;l?(b=u.acctId,v.accounts[b]||(v.accounts[b]={acctUnreadCount:0,totalFolderUnreadCount:0,inboxFid:s.getInboxFid(b)}),f=v.accounts[b],c=f.inboxFid):f=d,g=o===c,i=0,a=0,m[o]?i=u.unread-m[o]:i=u.unread,m[o]=u.unread,!g||h?(f.totalFolderUnreadCount+=i,o.indexOf("Inbox%5c")===0&&(r=1)):g&&(a=i),l&&(f.acctUnreadCount+=i),r&&a&&(f.totalFolderUnreadCount+=a)}l?e.use(["mail-ui-imap-in","mail-controller-imapin"],function(e){Ot(e.mail.Controller.ImapIn.getCurrentAccountId()),e.mail.ui.ImapIn.updateAccountsUnreadCount(v.accounts)}):_t(f)}function _t(e){if(!e)return;e.totalFolderUnreadCount>0?(et.addClass("has-unread"),tt.setHTML("("+u(e.totalFolderUnreadCount)+")"),tt.removeClass("invisible")):(et.removeClass("has-unread"),tt.addClass("invisible"),tt.setHTML("")),tt.set("title",o(strings.str_nav_folder_unread_cnt,{unread_cnt:e.totalFolderUnreadCount}))}var E="#custom-folders",S="#smart-folders",x="#nav-smart-folders",T="#storm-listnav",N=".foldername",C="filtering-search",k="filter-on",L="multiple-account",A="a[role=link]",O="a[role=tab]",M="button",_=T+" "+A+", "+T+" "+M+", "+T+" "+O+", "+E+" "+A,D='a[tabindex="0"]',P=this,H="selected",B="has-unread",j="hasnomsg",F="hasmultimsg",I={"in":"Inbox",chats:"%40C%40Chats",drafts:"Draft",sent:"Sent",folder:"%40B%40Bulk",spam:"%40B%40Bulk",trash:"Trash"},q={Inbox:"str_tabs_inbox",Draft:"str_tabs_drafts",Sent:"str_tabs_sent","%40B%40Bulk":"str_tabs_spam","%40C%40Chats":"str_tabs_conversations",Trash:"str_tabs_trash"},R=Neo&&Neo.fid||"",U,z=!1,W=e.mail.Controller.Folders,X=e.Lang,V=null,$,J=null,K=NeoConfig.imapIn,Q=t(T),G=t(E),Z=t("body"),et=t("#Folders"),tt=et.one("#folder-count"),nt,rt,it=0,st;e.on("ds:folder:change",function(t,n,r,i){var o,u,a,f,l,c,h=e.JSON.stringify;if(i==="launch"){for(u in n){o=n[u],a=o.folderInfo.fid;if(a.indexOf("Sync%20Trap")===0)continue;s.isInboxFid(a)&&($=o.unread),o.total||(f=ot(a),f&&f.replaceClass(F,j))}NeoConfig.imapIn||Ot(),pt(),Mt(n);return}if(!t)At(n,i==="ruefc"),K&&(ct(),e.one(".searcher")&&ht());else for(u in r){if(!r[u]){e.fire("MailLog",{m:"Cannot_read_property_unread_of_undefined",info:"ofs = "+h(t)+", nfs = "+h(n)+", "+"cset = "+h(r)+" reason = "+i},1,"JS Error Tracker");continue}o=n[u],a=o&&o.folderInfo&&o.folderInfo.fid,i==="ruefc"&&(o.folderInfo.name=strings.str_nav_email_from_ctcts,l=s.getSystemFolderName(a,o.folderInfo.name,!0),c=e.mail.ui.Workspace.getFolderContent(),NeoConfig.bidi?l=c.widget.msgList.getFolderNameBidi(l,o.folderInfo.dir,o.total):l+="  <i>("+o.total+")</i>",c.set("title",l));if(X.isNumber(r[u].unread)||s.isDraftFid(a))kt(o,i==="ruefc"),Mt(n),s.isInboxFid(a)&&($+=o.unread-t[u].unread,$<0&&e.fire("MailLog",{m:"Inbox unread count goes negative",info:"folder.unread = "+o.unread+", ofs[i].unread = "+t[u].unread},1,"Negative unread count"),Ot());o.total!==t[u].total&&Lt(o,i==="ruefc"),f=ot(a,i==="ruefc"),f&&(o.total>0?f.replaceClass(j,F):f.replaceClass(F,j))}}),e.on("ds:folder:add",function(e,t){t!=="move"&&t!=="qf_folder"&&(U=e.folderInfo.fid)}),e.on("ds:folder:remove",function(t){var n="Inbox",r,i;t.folderInfo.fid===P.get("fid").fid&&(NeoConfig.imapIn&&(r=e.mail.Controller.ImapIn,i=r.getCurrentAccountId(),n=r.getFolderByType(s.InboxFolderType,i).folderInfo.fid),U=n)}),e.on("ds:folder:rename",function(e,t){e.folderInfo.fid===P.get("fid").fid&&(U=t.folderInfo.fid)}),e.on("checkmail:pressed",e.throttle(function(t){var n=t?"":"Inbox";e.fire("MailLog",{m:"User forced a checkmail",info:n}),Tt(n)},1e3)),e.on("newfolder:pressed",function(e){yt({dataAction:"folder-new",targetId:e},null)}),e.after("tabChange",function(){null===V&&(V=e.later(1e3,null,Ot,null,!1))}),NeoConfig.imapIn&&e.on("imapin:currentAccountSet",function(e){_t(v.accounts[e.id])}),e.augment(P,e.Attribute),ut(),P.after("isCheckingMailChange",function(t){e.fire("MailLog",{m:"checkmail is "+t.newVal?"in progress":"complete"})}),NeoConfig.imapIn&&(e.after("accounts:select",function(t){e.use("minty_module_shell_navigation_pane_inbox_sticky_refresh",function(e){var n=e.ui.Templates.minty_module_shell_navigation_pane_inbox_sticky_refresh,r=yui.mail.Controller.ImapIn
.getFoldersByAcct(t.acctId),i=r.length,u="",a="",f="",l="",c="",h="",p="",d=strings.str_nav_archive,v,m,g,y,b,w;if(t.switchAccount){v={has_inbox_unread:function(){return o(n.has_inbox_unread,null,v,null,strings)},has_spam_unread:function(){return o(n.has_spam_unread,null,v,null,strings)},has_trash_unread:function(){return o(n.has_trash_unread,null,v,null,strings)},unread_data:function(){return o(n.unread_data,null,v,null,strings)},unread_data1:function(){return o(n.unread_data1,null,v,null,strings)},unread_data2:function(){return o(n.unread_data2,null,v,null,strings)}};for(m=0;m<i;m++){b=r[m];if(b.isSystem){w=b.folderInfo.fid;switch(s.getFolderTypeByFid(w)){case s.InboxFolderType:f=w;break;case s.DraftFolderType:h=w;break;case s.SentFolderType:l=w;break;case s.SpamFolderType:c=w;break;case s.TrashFolderType:a=w;break;case s.ArchiveFolderType:case s.ExternalAllFolderType:if(NeoConfig.archive){p=w;break}}b.types.indexOf(s.ArchiveFolderType)>-1&&b.types.indexOf(s.ExternalAllFolderType)>-1&&(d=strings.str_nav_all_mail)}}g={global_url_base:NeoConfig.global_url_base,leftpane_selected_item:"selected",imap_in_delete_icon:" icon-delete",inbox:"selected",inbox_fid:f,chats_fid:u,drafts_fid:h,sent_fid:l,spam_fid:c,trash_fid:a,archive_fid:p,archive_name:d},y=o(n.base,g,v,null,strings),Q.all(".sysfolder").remove(),Q.insert(y,0),d===strings.str_nav_all_mail&&Q.one(".archive.sysfolder").addClass("allmail"),e.use("mail-ui-list-item-editor",function(e){e.mail.ui.ListItemEditor.removeInput("force")}),At(r,t.acctId),G.removeClass(C)}}),P.set("fid",{fid:W.getPrimaryFolderByAccount(t.acctId)})}),e.on("imapin:accountAdded",pt),e.on("imapin:accountRemoved",pt)),e.mix(P,{render:xt,renderMailboxes:gt,checkMail:Tt,handleFolderActions:yt,updateTitle:Ot,getListOfMatchingFolders:lt,getFolderSearchMatches:ft,findMatchedFolders:ht,updateSearchableFolders:ct,updateFolderUnreadCountMarkup:_t})};e.namespace("mail"),e.mail.FoldersView=new E},"1.0.0",{requires:["io-base","yui-throttle","common-utils","mail-controller-folders","attribute","node","mail-persist-meta-data","common-persist-user-data","mail-ui-accounts","common-ui-tabs-base","mail-common-utils-features","node-event-simulate","node-focusmanager","mail-model-datastore","mail-ui-folder-utils"]});


YUI.add("mail-persist-user-preferences",function(e){function r(e){this.attributeConfig={userFeaturePrefs:{},userUIPrefs:{value:{displayPersonalFolders:NeoConfig.expandPF,expandExtAccounts:NeoConfig.expandEA,msgListDensity:NeoConfig.msgListDensity}},userSpamPrefs:{},userSendPrefs:{},switches:{},livewordsPrefs:{},popForwardPrefs:{},loaded:{value:!1}},this.addAttrs(this.attributeConfig,e),e?this.set("loaded",!0):this.load()}e.namespace("mail.persist");var t,n=["userFeaturePrefs","userUIPrefs","userSpamPrefs","userSendPrefs","switches","livewordsPrefs","popForwardPrefs"];r.prototype.load=function(){var t=this;e.mail.net.Transport.request("GetUserPreferences",{},{success:function(e){var n=e.body.result.userPrefs;for(var r in n)t.set(r,n[r]);t.set("loaded",!0)},failure:function(){}},!0)},r.prototype.save=function(){var e={},t,r;for(r=0;r<n.length;r++)t=n[r],e[t]=this.get(t);this.saveRequest(e)},r.prototype.saveRequest=function(t){e.mail.net.Transport.request("SetUserPreferences",{setprefs:t},{success:function(){},failure:function(){}},!0)},r.prototype.afterSettingsChange=function(){this.get("loaded")&&this.save()},e.augment(r,e.Attribute),e.mail.persist.UserPreferences=new r;for(t=0;t<n.length;t++)e.mail.persist.UserPreferences.after(n[t]+"Change",e.mail.persist.UserPreferences.afterSettingsChange)},"1.0.0",{requires:["attribute","mail-net-transport","json"]});


YUI.add("mail-persist-meta-data",function(e){function y(){this.addAttr("_save",{value:!0})}function b(){var t=["simpleCustomViews"];y.prototype._get=e.mail.persist.MetaData._get=e.Attribute.prototype.get,y.prototype.get=e.mail.persist.MetaData.get=function(e){var n,r=t.indexOf(e)>=0;r&&(e+=".json");if(m)if(NeoConfig.mailEnv!=="dev")try{n=v.getSync(c+e)}catch(i){n=this._get(e)}else n=v.getSync(c+e);else n=this._get(e);return r?{json:n}:n},y.prototype._set=e.mail.persist.MetaData._set=e.Attribute.prototype.set,y.prototype.set=e.mail.persist.MetaData.set=function(e,n){var r,i=t.indexOf(e)>=0;i&&(e+=".json",n=n.json),m?(r=v.set(c+e,n),u.push(r)):r=this._set(e,n)},v.occurEvent("metaDataInit")}var t=0,n=!1,r=e.common.Utils,i=2e3,s=r.settings.value("metaDataSaveInterval",3e4),o=[],u=[],a=function(e){var t=o.length,n;for(n=0;n<t;n++)o[n](e);o=[],u=[]},f,l,c="metaData.",h,p,d,v=e.mail.controller.v3.settings.userSettings,m=r.features.enabled("isMetaDataMigrated")||NeoConfig.forceToV3UserSetting,g;e.namespace("mail.persist"),y.prototype.wait=function(){this.set("_save",!1)},y.prototype.resume=function(){this.set("_save",!0)},y.prototype.parse=function(t,n){var r;if(/^_/.test(t.name)){e.fire("util:ymstats",{name:"metaData_privateKey",tags:{keyName:t.name}});return}n+=t.name;if(t.meta&&t.meta.length>0){this._set(n,{}),n+=".";for(r=0;r<t.meta.length;r++)t.meta[r].meta&&this.parse(t.meta[r].meta,n),this.parse(t.meta[r],n)}else t.value&&this._set(n,t.value)},y.prototype.make_cascade=function(e,t){var n;for(n in e){if(/^_/.test(n))continue;typeof e[n]=="object"?(t.push({name:n,meta:[]}),this.make_cascade(e[n],t[t.length-1].meta)):t.push({name:n,value:e[n]})}},y.prototype.cascade_dump=function(){var e=[],t,n,r,i=this.getAttrs();for(t in i){if(/^_/.test(t))continue;n=i[t],r={name:t},typeof n=="object"?(r.meta=[],this.make_cascade(n,r.meta)):r.value=n,e.push(r)}return{meta:e}},y.prototype.load=function(){var t=this;e.mail.net.Transport.request("GetMetaData",{},{success:function(n){var r=n.body.result.meta,i,s;for(i=0;i<r.length;i++)s=r[i],t.attrAdded(s.name)||t.addAttr(s.name),t.wait(),t.parse(s,""),t.resume();e.fire("metaDataLoadComplete")},failure:function(){}},!0)},y.prototype.update=function(){},y.prototype.save=function(t){t&&e.Lang.isFunction(t)&&o.push(t),m&&Promise.all(u).then(a)},y.prototype.__save=function(){var i="passive";t=d===s?0:Date.now(),p=null,n=!1;if(!this.get("_save"))return;if(NeoGV.isYdod){r.settings.value("ydodActiveAPI",[]).indexOf("SetMetaData")>-1&&(i="active"),e.fire("util:ymstats",{name:"ydodBlock",tags:{api:"SetMetaData",mode:i},include:{farm:!0}});if(i==="active")return}if(m){a({});return}e.mail.net.Transport.request("SetMetaData",this.cascade_dump(),{success:function(e){a(e)},failure:function(e){a(e)},suppressStat:!0,suppressNotification:!0},!0)},y.prototype.set=function(o,u,a){var f=e.Attribute.prototype.set,l,c,h;if(o.indexOf("._")>0)return;/^_/.test(o)||e.fire("SplunkLog","debug_metadata",{key:o,val:u},r.settings.value("SplunkLogLevel","sample"));if(o.indexOf(".")>0){l=o.split(".");for(h=0;h<l.length;h++)c?c+="."+l[h]:c=l[h],this.get(c)?c===o&&f.apply(this,[o,u]):c===o?f.apply(this,[o,u]):f.apply(this,[c,{}])}else f.apply(this,[o,u]);if(a||/^_/.test(o)){a&&(n=!0);return}p||(d=Date.now()-t>s?i:s,p=e.later(d,this,this.__save))},e.augment(y,e.Attribute),f=new y;if(typeof NeoConfig.metaDataObj!="undefined"&&NeoConfig.metaDataObj){g=NeoConfig.metaDataObj;for(h=0;h<g.length;h++){l=g[h];if(/^_/.test(l.name))continue;f.addAttr(l.name,{}),f.parse(l,"")}}else f.load();f.attrAdded("neo")||f.addAttr("neo",{pref:{}}),f.get("neo.pref")||f.set("neo",{pref:{}}),e.one(window).on("beforeunload",function(){if(p||n)p&&p.cancel(),o.length=0,f.__save()});var w={"metaData.neo.pref.rhythmHistory":!1,"metaData.typeTag":-1,"metaData.neo.pref.savedSearch":"[]","metaData._save":!1,"metaData.simpleCustomViews.json":JSON.stringify(NeoConfig.smartviewsFolders)};if(m&&!v.hasEventOccured("metaDataInit")){var E=v.getMigrationKeys("metaData","launch"),S=v.getMigrationKeys("metaData","postLaunch"),x=v.getMigrationKeys("unmapped","postLaunch");S=S.concat(x),Object.keys(w).forEach(function(e){v.ingest(e,w[e])}),Array.isArray(NeoConfig.metaDataObj)?E.forEach(function(e){v.ingest(e,f.get(e.split(".").slice(1).join(".")))}):Object.keys(NeoConfig.metaDataObj).forEach(function(e){if(e.indexOf("attributeList")>=0){v.ingest(e.replace("attributeList","attributes"),NeoConfig.metaDataObj[e]);return}v.ingest(c+e,NeoConfig.metaDataObj[e])}),v.get(S).then(b)}m&&v.hasEventOccured("metaDataInit")&&setTimeout(b,0),e.mail.persist.MetaData=f},"1.0.0",{requires:["attribute","mail-net-transport","mail-common-utils-features","mail-controller-v3-user-settings","mail-common-utils-settings"]});


YUI.add("mail-track",function(e){e.namespace("mail.track");var t={boss:["a","978500493",!1,"boss"],newsfeed_listview:["a","978500495",!1,"newsfeed","newsfeed_listview"],newsfeed_openstory:["a","978500496",!1,"newsfeed","newsfeed_openstory"],welcome_gx:["a","978500241",!1,"DEFAULT","welcome_galaxy"],launch_welcome:["a","978500273",!1,"DEFAULT","welcome_galaxy"],launch_inbox:["a","978500271",!1,"messagelist","folder_inbox"],launch_compose:["a","978500270",!1,"compose","compose_new"],launch_message:["a","978500272",!1,"messagelist","msgread_tabview"],launch_inbox_empty:["a","978500271",!1,"emptyfld","folder_inbox"],launch_welcome_ssl:["a","978500285",!1,"DEFAULT","welcome_galaxy"],launch_inbox_ssl:["a","978500286",!1,"messagelist","folder_inbox"],launch_compose_ssl:["a","978500288",!1,"compose","compose_new"],launch_message_ssl:["a","978500287",!1,"messagelist","msgread_tabview"],launch_inbox_empty_ssl:["a","978500286",!1,"emptyfld","folder_inbox"],launch_welcome_ssl_win10:["a","159500005",!1,"DEFAULT","welcome_galaxy"],launch_inbox_ssl_win10:["a","159500009",!1,"messagelist","folder_inbox"],launch_compose_ssl_win10:["a","159500015",!1,"compose","compose_new"],launch_message_ssl_win10:["a","159500012",!1,"messagelist","msgread_tabview"],launch_inbox_empty_ssl_win10:["a","159500009",!1,"emptyfld","folder_inbox"],launch_welcome_low:["a","978500293",!1,"DEFAULT","welcome_galaxy"],launch_inbox_low:["a","978500294",!1,"messagelist","folder_inbox"],launch_compose_low:["a","978500296",!1,"compose","compose_new"],launch_message_low:["a","978500295",!1,"messagelist","msgread_tabview"],launch_inbox_low_empty:["a","978500294",!1,"emptyfld","folder_inbox"],launch_welcome_optin:["a","978500360",!1,"DEFAULT","welcome_galaxy"],launch_inbox_optin:["a","978500361",!1,"messagelist","folder_inbox"],launch_inbox_optin_empty:["a","978500361",!1,"emptyfld","folder_inbox"],action_menu:["b","978500002",!0],inbox_menu_print:["b","978500004",!0],lftpane_add_folder:["b","978500006",!0],attch_dwd_av_display:["b","978500008",!0],attch_dwd_av_click:["b","978500009",!0],attch_upload_av_display:["b","978500010",!0],attch_upload_av_click:["b","978500011",!0],attach_upload_classic:["b","978500020",!0],checkmail_all_click:["b","978500068",!0],checkmail_auto:["b","978500069",!0],compose_new:["a","978500077",!1,"compose","compose_new"],compose_save:["a","978500077",!0,"compose","compose_save"],compose_new_ssl:["a","978500422",!1,"compose","compose_new"],compose_forward:["a","978500079",!1,"compose","compose_fwd"],compose_reply_sender:["a","978500081",!1,"compose","compose_reply"],compose_reply_all:["a","978500246",!1,"compose","compose_reply_all"],compose_draft:["a","978500266",!1,"compose","compose_draft"],autocompose_valentine:["a","978500502",!0,"compose","autocompose_valentine"],compose_new_win10:["a","159500026",!1,"compose","compose_new"],compose_save_win10:["a","159500026",!0,"compose","compose_save"],compose_new_ssl_win10:["a","159500042",!1,"compose","compose_new"],compose_forward_win10:["a","159500044",!1,"compose","compose_fwd"],compose_reply_sender_win10:["a","159500031",!1,"compose","compose_reply"],compose_reply_all_win10:["a","159500033",!1,"compose","compose_reply_all"],compose_draft_win10:["a","159500029",!1,"compose","compose_draft"],dd_msg_to_folder:["b","978500084",!0],dd_msg_to_trash:["b","978500085",!0],empty_spam:["b","978500087",!0],empty_trash:["b","978500088",!0],empty_spam_ssl:["b","978500484",!0],mark_spam_ssl:["b","978500486",!0],sent_ssl:["a","978500414",!1,"sent","send_confirm"],folderview_inbox_ssl:["a","978500434",!1,"messagelist","folder_inbox"],folderview_inbox_empty_ssl:["a","978500434",!1,"emptyfld","folder_inbox"],folderview_bulk:["a","978500091",!1,"messagelist","folder_bulk"],folderview_bulk_ssl:["a","978500432",!1,"messagelist","folder_bulk"],folderview_draft:["a","978500092",!1,"messagelist","folder_draft"],folderview_draft_ssl:["a","978500433",!1,"messagelist","folder_draft"],folderview_inbox:["a","978500093",!1,"messagelist","folder_inbox"],folderview_sent:["a","978500095",!1,"messagelist","folder_sent"],folderview_archive:["a","978500501",!1,"messagelist","folder_archive"],folderview_archive_ssl:["a","978500501",!1,"messagelist","folder_archive"],folderview_sent_ssl:["a","978500437",!1,"messagelist","folder_sent"],folderview_trash:["a","978500096",!1,"messagelist","folder_trash"],folderview_trash_ssl:["a","978500489",!1,"messagelist","folder_trash"],folderview_custom:["a","978500267",!1,"messagelist","folder_custom"],folderview_custom_ssl:["a","978500436",!1,"messagelist","folder_custom"],folderview_inbox_frm_wel:["a","978500094",!1,"messagelist","fwinbox_frm_welcome"],folderview_chat:["a","978500439",!1,"messagelist","folder_chat"],folderview_chat_ssl:["a","978500438",!1,"messagelist","folder_chat"],folderview_inbox_ssl_win10:["a","159500068",!1,"messagelist","folder_inbox"],folderview_inbox_empty_ssl_win10:["a","159500068",!1,"emptyfld","folder_inbox"],folderview_bulk_win10:["a","159500055",!1,"messagelist","folder_bulk"],folderview_bulk_ssl_win10:["a","159500066",!1,"messagelist","folder_bulk"],folderview_draft_win10:["a","159500056",!1,"messagelist","folder_draft"],folderview_draft_ssl_win10:["a","159500067",!1,"messagelist","folder_draft"],folderview_inbox_win10:["a","159500057",!1,"messagelist","folder_inbox"],folderview_sent_win10:["a","159500062",!1,"messagelist","folder_sent"],folderview_sent_ssl_win10:["a","159500071",!1,"messagelist","folder_sent"],folderview_archive_win10:["a","159500074",!1,"messagelist","folder_archive"],folderview_archive_ssl_win10:["a","159500074",!1,"messagelist","folder_archive"],folderview_archive_empty_win10:["a","159500074",!1,"emptyfld","folder_archive"],folderview_archive_empty_ssl_win10:["a","159500074",!1,"emptyfld","folder_archive"],folderview_trash_win10:["a","159500063",!1,"messagelist","folder_trash"],folderview_trash_ssl_win10:["a","159500073",!1,"messagelist","folder_trash"],folderview_custom_win10:["a","159500061",!1,"messagelist","folder_custom"
],folderview_custom_ssl_win10:["a","159500070",!1,"messagelist","folder_custom"],folderview_inbox_frm_wel_win10:["a","159500058",!1,"messagelist","fwinbox_frm_welcome"],folderview_chat_win10:["a","159500064",!1,"messagelist","folder_chat"],folderview_chat_ssl_win10:["a","159500072",!1,"messagelist","folder_chat"],folderview_bulk_empty:["a","978500091",!1,"emptyfld","folder_bulk"],folderview_bulk_empty_ssl:["a","978500432",!1,"emptyfld","folder_bulk"],folderview_draft_empty:["a","978500092",!1,"emptyfld","folder_draft"],folderview_draft_empty_ssl:["a","978500433",!1,"emptyfld","folder_draft"],folderview_inbox_empty:["a","978500093",!1,"emptyfld","folder_inbox"],folderview_sent_empty:["a","978500095",!1,"emptyfld","folder_sent"],folderview_sent_empty_ssl:["a","978500437",!1,"emptyfld","folder_sent"],folderview_archive_empty:["a","978500501",!1,"emptyfld","folder_archive"],folderview_archive_empty_ssl:["a","978500501",!1,"emptyfld","folder_archive"],folderview_trash_empty:["a","978500096",!1,"emptyfld","folder_trash"],folderview_trash_empty_ssl:["a","978500489",!1,"emptyfld","folder_trash"],folderview_custom_empty:["a","978500093",!1,"emptyfld","folder_custom"],folderview_custom_empty_ssl:["a","978500434",!1,"emptyfld","folder_custom"],folderview_chat_empty:["a","978500439",!1,"emptyfld","folder_chat"],folderview_chat_empty_ssl:["a","978500438",!1,"emptyfld","folder_chat"],help_dd_click:["b","978500098",!0],help_dd_click_blog:["b","978500099",!0],help_dd_click_help:["b","978500100",!0],help_dd_click_newfeature:["b","978500101",!0],help_dd_click_mobile:["b","978500105",!0],help_dd_click_options:["b","978500197",!0],msgheader_addtoAB:["b","978500155",!0],msgread_reading_pane:["a","978500162",!1,"messagelist","msgread_preview"],msgread_reading_pane_timed_ad:["a","978500162",!0,"messagelist","msgread_preview"],message_tabpane:["a","978500163",!1,"messagelist","msgread_tabview"],message_tabpane_timed_ad:["a","978500163",!0,"messagelist","msgread_tabview"],msgread_reading_pane_ssl:["a","978500301",!1,"messagelist","msgread_preview"],message_tabpane_ssl:["a","978500302",!1,"messagelist","msgread_tabview"],msgread_reading_pane_low:["a","978500297",!1,"messagelist","msgread_preview"],message_tabpane_low:["a","978500298",!1,"messagelist","msgread_tabview"],previewpane_close:["a","978500334",!1,"messagelist","msgread_pp_close"],previewpane_expand:["a","978500336",!1,"messagelist","msgread_pp_open"],msgread_reading_pane_win10:["a","159500094",!1,"messagelist","msgread_preview"],message_tabpane_win10:["a","159500087",!1,"messagelist","msgread_tabview"],msgread_reading_pane_ssl_win10:["a","159500099",!1,"messagelist","msgread_preview"],message_tabpane_ssl_win10:["a","159500103",!1,"messagelist","msgread_tabview"],msgread_reading_pane_low_win10:["a","159500077",!1,"messagelist","msgread_preview"],message_tabpane_low_win10:["a","159500081",!1,"messagelist","msgread_tabview"],scroll_spam:["a","978500212",!1,"messagelist_scroll"],scroll_contacts:["a","978500213",!1,"messagelist_scroll"],scroll_draft:["a","978500214",!1,"messagelist_scroll"],scroll_folder:["a","978500215",!1,"messagelist_scroll"],scroll_inbox:["a","978500216",!1,"messagelist_scroll"],scroll_msgpane:["a","978500217",!1,"messagelist_scroll"],scroll_search:["a","978500218",!1,"messagelist_scroll"],scroll_sent:["a","978500219",!1,"messagelist_scroll"],scroll_trash:["a","978500220",!1,"messagelist_scroll"],search_refinement:["a","978500222",!1,"searchrefinement","search_refinements"],search_snipp_chkbox:["a","978500223",!1,"search","search_snipp_chkbox"],search_people:["a","978500494",!1,"search","search_people"],search_results:["a","978500252",!1,"search","search_results"],search_results_empty:["a","978500252",!1,"emptysearch","search_results_empty"],empty_sponsored_results:["a","978500252",!1,"emptyspresults","empty_sponsored_results"],search_refinement_win10:["a","159500112",!1,"searchrefinement","search_refinements"],search_snipp_chkbox_win10:["a","159500113",!1,"search","search_snipp_chkbox"],search_people_win10:["a","159500116",!1,"search","search_people"],search_results_win10:["a","159500114",!1,"search","search_results"],search_results_empty_win10:["a","159500114",!1,"emptysearch","search_results_empty"],empty_sponsored_results_win10:["a","159500114",!1,"emptyspresults","empty_sponsored_results"],sent:["a","978500224",!1,"sent","send_confirm"],sent_api:["a","978500224",!1,"messagelist","send_confirm"],mark_spam:["b","978500225",!0],spell_chk:["b","978500226",!0],switch_mail:["b","978500227",!0],switch_mail_cancel:["b","978500228",!0],contacts_tab:["a","978500278",!1,"onlySKY","contacts"],calendar_zodiac:[null,"967178001",null,null,null]},n=function(e){return e.match(/launch_inbox/)?e="launch_inbox_optin":e.match(/launch_/)&&(e="launch_welcome_optin"),NeoConfig.neoOptIn=!1,e};e.mail.track.getTrackingParam=function(r,i){var s={};if(r&&typeof t[r]!="undefined"){NeoConfig.neoOptIn&&(r=n(r)),r.match(/launch_/)&&(s.launch=!0);if(NeoConfig.isSSL&&!r.match(/_ssl/)){var o=r+"_ssl";t[o]&&(r+="_ssl")}if(NeoConfig.isWinApp&&!r.match(/_win10/)){var u=r+"_win10";t[u]&&(r+="_win10")}s.type=t[r][0],s.name=t[r][3]||null,s.evt={},s.evt.sp=t[r][1],s.evt.npv=t[r][2];if(typeof t[r][4]!="undefined"){var a=t[r][4];typeof i!="undefined"&&e.Lang.trim(i)!==""&&typeof i!="object"?s.evt.trace=a+":"+i:s.evt.trace=a}}return s},function(){var t=function(t,n){var r=e.mail.ui.FolderUtils,i,s,o;n?n.msgPane&&n.msgPane.message?e.use("mail-ui-messagepane-utils",function(e){i=n.msgPane.fid,s=r.get(i),o=r.getSystemFolderInfoName(i,s),n.fire("darlaEvent",{action:t,value:{siteAttr:e.mail.ui.MessagePaneUtils.getAdSiteAttribsFromMesgObj(n.msgPane.message,i),foldername:o}})}):n.fire("darlaEvent",{action:t}):e.fire("darlaEvent",{action:t}),e.fire("mbEvent:"+t)};e.after("previewPane:expanded",function(e){t("previewpane_expand",e)}),e.after("previewPane:collapsed",function(e){t("previewpane_close",e)}),e.after("verticalPreview",function(e){t("previewpane_expand",e)}),e.after("checkmail:clicked"
,function(){})}()},"1.0.0",{requires:["common-utils","mail-ui-folder-utils"]});


YUI.add("mail-common-tracker",function(e){var t=NeoConfig,n=window.NeoGV||{},r=e.common.Utils.features.enabled("rapidUlt")||t.isUltThrottled||t.isRpdWithLH||t.expBucketId!=="0",i,s="",o="",u=1e3,a=500,f=function(t){r&&(e.common.Utils.Rapid?e.fire("rapid:perf",t.data):n.rapidQueue.push({type:"rapid:perf",data:t.data}))},l=function(i){var s=i.args||{},u,f,l=i.append||{},c;u={ck:{action:i.action,args:s,append:l,spid:i.spid,thrd:t.hasConv}},f=e.JSON.stringify(u);if(!o||o!==f)r&&(e.common.Utils.Rapid?e.fire("rapid:click",u.ck):n.rapidQueue.push({type:"rapid:click",data:u.ck})),o=f,setTimeout(function(){o=""},a)},c=function(i){var o=i.action,a=i.append||{};if(o){var f;if(window.NeoGV&&NeoGV.cancelViewBeacon){NeoGV.cancelViewBeacon=!1;if(o.substr(0,11)==="folderview_")return}var l={ln:{action:o,append:a,thrd:t.hasConv}};f=e.JSON.stringify(l);if(!s||s!==f)r&&(e.common.Utils.Rapid?e.fire("rapid:view",l.ln):n.rapidQueue.push({type:"rapid:view",data:l.ln})),s=f,setTimeout(function(){s=""},u)}};e.on("mt:view",c),e.on("mt:click",l),e.on("mt:perf",f),n.rapidQueue=[]},"1.0.0",{requires:["mail-common-utils-features"]});


YUI.add("mail-ui-workspace-base",function(e){function I(){var n=1;window.onerror=function(r,i,s,o,u){var a,f,l,c,h="UNHANDLED";a=typeof r=="string"?r.replace(/\s+/g,"-").substr(0,64):"empty",f=typeof i=="string"?i:"empty",l=f!=="empty"&&f!==""&&f!==" "&&f!=="undefined"&&f!=="null",c=f.indexOf("s.yimg.com/zz/combo")<0&&f.indexOf("neo/launch")<0&&f.indexOf("storm/launch")<0;if(a.indexOf("YWA-BeaconScheduler")>=0||l&&c)h="EXT_UNHANDLED";n&&(n=0,e.use("common-utils-error",function(){var e=r+" "+[i,s,o].join(":");n=1,t.error.report(e,h,u,1,1,1)}))}}var t=e.common.Utils,n=e.mail,r=e.mail.ui.FolderUtils,i=t.substitute,s=t.escapeHtml,o=t.unescapeHtml,u=e.mail.persist.MetaData,a=t.loadDarlaAndExecute,f=e.config.win||window,l=f.Neo||0,c,h=NeoConfig,p=!h.pfm||!h.pfm.count,d=0,v=!1,m,g=["_shared_module_toolbar_compose","_shared_module_compose_message_header_fresh","_shared_module_offscreen_bin_compose","_shared_module_offscreen_bin_compose_menu_color_picker","_shared_module_offscreen_bin_compose_menu_spellcheck","_shared_module_offscreen_bin_compose_modal_cancel_compose","_shared_module_offscreen_bin_compose_menu_spell_langs","_shared_module_compose_reply"],y=!1,b,w=!1,E="%40S%40Search",S=e.one("body"),x,T=e.one("#nav"),N=h.calendarTabEnabled&&T.one(".icon-calendar"),C,k=e.one(".frost-container"),L=86400,A=NeoConfig.msgListObj,O,M=e.UA.ie,_="neo.pref.keyTasksPanel",D=t.features.enabled("instantCloseOnSend"),P="attributes.web.keyTasksPanel",H=e.mail.controller.v3.settings.userSettings,B,j=!1,F=t.features.enabled("isMetaDataMigrated")||NeoConfig.forceToV3UserSetting;h.pagedResults=0,h.bidi&&g.push("comms-intl-bidihighlight"),NeoGV.isChromeIncognito=0,function(){var e=window.RequestFileSystem||window.webkitRequestFileSystem;e&&e(window.TEMPORARY,1,function(){},function(){NeoGV.isChromeIncognito=1})}(),e.fire("mt:click",{action:"launch"}),e.namespace("mail.ui"),x=function(){function St(){var t,n,r,i,s;t=e.one(".list-view-items");if(!t)return;n=t.get("clientHeight"),r=t.get("scrollHeight"),NeoConfig.hasConv?i=t.one(".list-view-item-container"):i=t.one(".list-view-item"),s=i&&i.get("offsetHeight")||25,s*h.pageSize<n&&(h.messagesPerPage=Math.ceil(n/s),h.messagesPerPage>100&&(h.messagesPerPage=100),h.pageSize=Math.max(h.messagesPerPage,h.pageSize),r<=n&&(wt=!0),e.fire("util:ymstats",{name:"page_size_changed_as_per_screen",include:{bucket:!0}}))}function xt(){var t=S.get("winHeight"),n=e.one("#theAd");t<=702&&n&&(h.adScroll||e.UA.ie)&&n.addClass("low_res"),y&&(a(function(e){e.fire("renderPrefetchedAd",{action:y.isFolderEmpty&&y.goTo===1?m+"_empty":m})},!1),y=!1),NeoConfig.hasAds&&n&&n.get("clientHeight")===0&&e.fire("util:ymstats",{name:"adblocker_unique"})}function Tt(){e.use("comet","base",function(e){var n=t.settings.value("comet_url"),r=t.settings.value("breaking_news_comet_channel"),i=e.initComet(n);e.on("comet:ready",function(t){t.message.originalURI===n&&i.subscribe(r,function(t){e.fire("breakingnews:cometNotification",t)})})})}function Nt(){var t=new e.EventTarget;t.publish("ucs:playLogo",{broadcast:2,emitFacade:!0}),t.fire("ucs:playLogo")}function Ct(){if(S.hasClass("pc-photo")){var e=S.one("#preloadBg"),t=S.one("#bg"),n,r;e&&(n=e.getAttribute("data-bg-h"),n&&(r=new Image,r.onload=function(){t.setStyle("backgroundImage","url("+n+")"),t.addClass("loaded")},setTimeout(function(){r.src=n},0)))}}function kt(e){NeoConfig.yodaReadEnabled&&(h.hasConv?e.use("minty_module_toolbar_inbox_message_thread","mail-ui-convpane-read","mail-common-precache-thread"):e.use("minty_module_toolbar_inbox_message_fresh","common-ui-menu-helper","mail-ui-messagepane-read","mail-common-precache-unread")),e.use("mail-ui-workspace-postload",function(e){f.postLoadInit(e)})}function Lt(e){var n=["mail-ui-workspace-fresh","mail-ui-workspace-stats","mail-ui-boss","mail-ui-recorder","mail-common-cachewarmer","contacts-api-config","contacts-ui-contactseventstranslator","mail-ui-mb-controller","mail-error","common-utils-error","mail-ui-log-events","comet","mail-ui-rr-backfill-controller",h.neoJsHeader.module],i=h.browser,s,o;M&&M<14?(h.backButton=0,h.backButtonFull=0,h.backButtonSearch=0):typeof window.history.pushState=="function"&&n.push("mail-ui-backbutton"),h.farmMaintenanceNotification&&n.push("mail-ui-maintenancenotification"),S.hasClass("browsereol")&&n.push("mail-ui-greylist"),S.hasClass("tos-disclosure")&&n.push("mail-ui-tos-disclosure"),NeoConfig.isWinApp&&n.push("mail-ui-windows-helper"),NeoConfig.yodaReadEnabled||(h.hasConv?n.push("minty_module_toolbar_inbox_message_thread","mail-ui-convpane-read","mail-common-precache-thread"):n.push("minty_module_toolbar_inbox_message_fresh","common-ui-menu-helper","mail-ui-messagepane-read","mail-common-precache-unread")),h.notification&&n.push("common-ui-notification"),h.bidi&&n.push("comms-intl-bidi"),h.themeJSModule!=="false"&&n.push(h.themeJSModule),f.initMessageKeywords=!1,!h.targetingOptOut&&h.hasAds&&Ot()&&h.enableMessageKeywords&&(f.initMessageKeywords=!0,n.push("mail-ui-messagekeywords")),f.initMessageCategories=!1,!h.targetingOptOut&&t.features.enabled("messageCategories")&&(f.initMessageCategories=!0,n.push("mail-ui-messagecategories")),NeoConfig.imapIn&&n.push("mail-ui-imap-in","mail-controller-imapin"),t.features.enabled("persist")&&n.push("mail-controller-persist"),t.features.enabled("desktopNotification")&&n.push("mail-ui-desktop-notifications"),NeoConfig.offerYsetNewTabExt&&!u.get("neo.pref.newTabExt.onboard")&&n.push("mail-ui-onboarding-new-tab-ext"),t.features.enabled("snow")&&n.push("mail-ui-snowflakes"),h.theme.isSmartTop&&n.push("mail-ui-smarttop-container"),t.features.enabled("useAccusoftPreview")||n.push("mail-ui-lightdocpreview-controller"),t.features.enabled("breakingNews")&&n.push("mail-ui-breakingnews"),n.push("contacts-ui-hovercard-plugin"),n.push(At),e.use.apply(e,n),(o=e.one("#low-bandwidth-container"))!==null&&o.remove(!0),f.presetDataItems(),f.getBandwidthMode()!=="broadband"?_t():e.fire("ws:postLoad"),s=e.Cookie.get("YM.OVERVIEW"),s==="1"&&(e.Cookie.remove("YM.OVERVIEW"
,{domain:"mail.yahoo.com",path:"/"}),NeoConfig.serverTime-NeoConfig.userRegTime<L&&e.fire("util:ymstats",{name:"signup_from_overview",tags:{agent:i}})),NeoConfig.isRegOnboardingEnabled&&t.features.enabled("openMsgWithImport")&&A&&A.length&&(O=A[A.length-1],e.Lang.isString(O.flags)&&O.flags.indexOf("unread")>=0&&O.msgicon==="certified-ssl"&&NeoConfig.serverTime-O.rawDate<=L&&e.fire("openMessage",{msg:O.mid,fid:"Inbox",callFromLaunch:!0})),NeoConfig.onboarding.taskPanelEnabled&&t.features.enabled("keyTasksPanel")?r.get("Inbox").total>0&&!NeoConfig.previewPanePref&&qn("Inbox",K.widget.msgList._listview._srcNode):(F?(B=H.getSync(P),j=B&&Array.isArray(B)&&B.length!==0):j=e.mail.persist.MetaData.get(_),j&&(e.fire("util:ymstats",{name:"keyTasksPanel_key_present_on_launch",include:{bucket:!0}}),In("keyIsSet")))}function At(e){var n=d===1,r=e.mail.common,i=r&&r.cachewarmer,s;f.mbController=(new e.mail.ui.mbController).init(),NeoConfig.isGTAEnabled&&NeoConfig.intl==="us"&&NeoConfig.lang==="en-US"&&(!NeoConfig.partnerType||NeoConfig.partnerType==="ycorp")&&e.use("mail-ui-ads-mobilizer",function(e){e.mail.ui.Ads.Mobilizer.init()}),h.prefetchAd&&parseInt(h.prefetchAdType,10)===2&&xt(),h.themeJSModule!=="false"&&e.mail.ui.themes[h.themeJSModule].init(),t.features.enabled("predictiveSearch")&&(NeoGV.predictiveSearchRendered||NeoGV.predictiveSearchDismiss)&&e.use("mail-ui-searchmyworld",function(e){new e.mail.ui.PredictiveSearch.SMW("#search-my-world-slot",!0)}),t.features.enabled("breakingNews")&&e.mail.ui.breakingNews.init(Tt),t.features.enabled("video")&&e.use("mail-ui-vd-controller"),i&&(i.setupLaunch(n),parseInt(h.disablePrefetchLaunchMsgs,10)===0&&(f.getBandwidthMode()==="broadband"||NeoConfig.yodaReadEnabled)&&n&&!(p++)&&i.addInboxPreFetching(),NeoConfig.hasAds&&t.features.enabled("videoEmptyFolder")&&t.features.enabled("videoEmptyFolderPrefetch")&&(s=["mail-ui-ads-emptyfolder-video","mail-ui-vd-controller","mail-track","mail-ui-vd-dataservice-channel","mail-ui-vd-view-folder","mail-ui-vd-model-uuid","videoplayer"],i.warmUp("efv",s,0,!1)),i.run()),f.getBandwidthMode()==="broadband"&&_t(),f.getBandwidthMode()!=="broadband"&&e.fire("ws:postLoad"),NeoConfig.isRegOnboardingEnabled&&(setTimeout(function(){S.hasClass("onboarding-on")&&(e.fire("util:ymstats",{name:"onboarding_mask_timeout",tags:{bandwidth:NeoConfig.bandwidthMode?NeoConfig.bandwidthMode:"broadband"}}),e.fire("ws:regonboarding_timeout"))},t.settings.value("onboardingMaskTimeout")||15e3),e.fire("ws:onboarding"),e.use("onboarding-ult",function(e){e.fire("mt:click",{action:"onboarding_new_user_exp"})})),NeoConfig.isFirstTimeLaunch&&(e.fire("mt:click",{action:"first_time_launch"}),function(){var e=Math.random()+"",n=e*1e13,r="https://6518610.fls.doubleclick.net/activityi;src=6518610;type=mbrship;cat=mshipcfm;u1="+NeoConfig.hashedGUID+";u2=new;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+n+"?",i='<iframe id="neoNewUserBeacon" src="'+r+'" height="1px" width="1px" frameborder="0" style="display:none"></iframe>';S.append(i),setTimeout(function(){t.remove(S.one("#neoNewUserBeacon"))},15e3)}()),f.initMessageKeywords&&e.mail.ui.MessageKeywords.initialize(),new e.mail.ui.HoverCard,f.initMessageCategories&&e.mail.ui.MessageCategories.initialize();if(NeoConfig.hasAds&&e.UA.chrome&&t.features.enabled("chromeDSSExtension")){var o=parseInt(u.get("neo.pref.chrome.dss.ext"),10),a=t.settings.value("chromeDSSExtensionFrequency"),l=Math.round(Date.now()/1e3);(!o||l>a+o)&&e.use("mail-ui-chrome-dss-ext")}h.theme.isSmartTop&&e.mail.ui.SmartTopContainer.render(),h.showFeedback&&!t.features.enabled("feedback")&&f._setupFeedback(),Mt(),f.sendStats()}function Ot(){var t=["CMUSGRD2S01","CMUSGRCM02","CMUSGRCM03","CMUSGRCM04","CMUSGRCM05","CMUSGRCM06","CMUSGRCM07","CMUSGRCM09","CMUSGRCM10","CMUSGRCM11","CMUSGRCM12","CMUSGRCM13","CMUSGRCM14","CMUSGRCM15","CMUSGRCM16"];return e.Array.indexOf(t,h.expBucketId)>-1}function Mt(){if(!h.userVoiceFeedbackPopup)return;window.UserVoice=window.UserVoice||[],function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//widget.uservoice.com/GnqW94kJH38RyG8SOBiAg.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()}function _t(){var n=["ucs-search","cache-base","cache-offline","cache-plugin","node-menunav","substitute","event-mousewheel","event-hover","event-outside","event-touch","event-move","event-flick","event-tap","querystring-stringify","rapid-base"],r=t.features.enabled("rapidUlt")||h.isUltThrottled||h.isRpdWithLH||h.expBucketId!=="0";r&&(n.unshift("common-utils-rapid"),t.features.enabled("flowRecorder")&&n.push("mail-ui-flow-recorder")),e.namespace.apply(window,["YAHOO.YAHOO.i13n"]).WEBWORKER_FILE=t.settings.value("rapidWorkerJsPath")+"?appid="+t.settings.value("appid")+"&wssid="+NeoConfig.wssid,e.use(n,function(e){e.mail.ui[h.neoJsHeader.headerClass].render(),h.setFinished&&h.setFinished("uh2"),h.isBizmail&&e.fire("change:username"),t.features.enabled("launchRecorder")&&e.fire("rc:flow",{name:"launch",capacity:t.settings.value("launchFlowCapacity")}),l.Event.removeHandler(document,"click",l.globalClickForSearchBtn),l.Event.removeHandler(document,"keydown",l.glocalEnterBtnForSearchBar),e.use("ucs-logodebug",function(){Nt()})}),h.hasUh2Notification&&e.Lang.later(9e3,null,function(){e.use("uh2-notification-base",function(){var e=!1;h.isInternalIP&&(e=window.location.href.match(/&rtb_extra=1/)||window.location.href.match(/\?rtb_extra=1/)),e&&((new Image).src="/"+h.scriptBase+"/rtbeacon.gif?uh2_done=1")})})}function Dt(n){function f(e,t,n){t.type="newsfeedtab",Cn(t,e),e.widget=t,t.newsfeedTab=e,n&&n()}function p(){function k(){var e=(new Date).getDate();e!==C&&(N.setAttribute("data-day",e),C=e)}var i=!1,o=!1;ht||zt(),e.mail.ui.Tictacs.init(),e.fire("ws:initLoad"),e.mail.Tabs.setPageMode(0),h.tabs&&e.use("common-ui-navtabs");var p=e.one(tt),d,v,g,w;!lt&&p&&(lt=new X({root:p.one(nt),menu:{template:function(t,n){var r=h.mnuTmplMap[t.replace("btn","menu")],i=
r?["mail-ui-inboxmenu-base",r]:"mail-ui-inboxmenu-base";e.use(i,function(e){e.mail.ui.InboxMenu.insert(t,n)})},keys:function(t,n){e.use("mail-ui-inboxmenu-base",function(e){n(e.mail.ui.InboxMenu.getValidKeys(t))})},enterAccel:function(t){e.use("mail-ui-inboxmenu-base",function(e){t(e.mail.ui.InboxMenu.getEnterAccel())})}}}),lt.on("itemSelected",Ut),c.originalNav=lt,ct=p.one(rt)),e.use("mail-ui-composeview-compose-loader","common-ui-lozengeDD");var E=function(){if(l.msgHdrStack.length){var t=e.one("#tablist .messagetabs.active a"),r=0,i=[],s,o,u=!1;v="Inbox",t&&(o=parseInt(t.getAttribute("tabindex"),10)),e.all("#tablist .messagetabs").each(function(t){r=parseInt(t.one("a").getAttribute("tabindex"),10);var n="div#shellcontent #messageid"+r;t.remove(),s=e.mail.model.DataStore.Messages.toMessage(v,l.msgHdrStack[r]),r===o?u=[s,n]:i.push([s,n])}),u&&(i.push(u),n=2),i&&setTimeout(function(){var t,n=e.mail.Tabs.getActiveTab(),r=function(t){var n=e.one(t);n&&n.remove()};for(t in i)e.fire("openMessage",{fid:v,msg:i[t][0]},e.bind(r,null,i[t][1]));n&&e.mail.Tabs.switchToTab(n)},10)}};n===1&&(E(),m=h.low_bandwidth?"launch_inbox_low":NeoConfig.isSSL?"launch_inbox_ssl":"launch_inbox");if(!K){var S,x;e.fire("Y.mail.ui.Workspace:switchToInbox:start"),v=l&&l.fid||"Inbox",x={fid:v,dontBind:vt,type:"list"},h.hasConv?d=new e.mail.ui.ConvView(x):d=new e.mail.ui.MessagesView(x),o=d.isEmpty(v),d.once("renderComplete",function(){s.fire("initComplete",S)}),w={p_label:strings.str_nav_left_folders,s_label:v,widget:d,ult:{action:"folder_tab"}},S=e.one("#inboxcontainer"),S&&(w.yTabEl=e.one("#tabinbox").get("parentNode"),w.yTabContentEl=S,w.inactive=n!==1,w.sync=!0,W.set("active",!w.inactive)),K=Nn(w),K.widget.set("loaded",1),K&&(K.on("activeChange",function(e){W.set("active",e.newVal)}),r=1,e.fire("Y.mail.ui.Workspace:switchToInbox:complete"))}var T=d&&d.get("active")?d:g;!i&&n===1&&T&&(y={isFolderEmpty:o,goTo:n}),h.noDarla||i||y&&(h.prefetchAd?(h.prefetchAdType===1&&xt(),e.fire("mt:view",{action:o&&n===1?m+"_empty":m})):!h.mrd&&!h.mrd.action&&a(function(){T.fire("darlaEvent",{action:o&&n===1?m+"_empty":m})},!1)),!Q&&h.contactsTabEnabled&&(w={yTabEl:e.one("#tabcontacts").get("parentNode"),label:"Contacts",noDefault:!0,inactive:!0,forcePane:!0,sync:!0,ult:{action:"contacts_tab",spid:"contacts_tab"},init:function(t,n){e.use("contacts-ui-contactsview",function(e){var r=e.contacts.ui.getContactsViewInstance();r.type="contactstab",Cn(r,t),t.widget=r,e.contacts.ui.ContactsView.contactsTab=t,n()})}},Q=Nn(w)),!G&&h.calendarTabEnabled&&(w={yTabEl:e.one("#tabcalendar").get("parentNode"),label:"Calendar",noDefault:!0,inactive:!0,forcePane:!0,sync:!0,ult:{action:"calendar_tab",spid:"calendar_zodiac"},init:function(t,n){function r(){Cn(b,t),t.widget=b,e.calendar.ui.CalendarView.calendarTab=t,n()}e.calendar?r():e.use("calendar-ui-calendarview",function(){Wt(),r()})}},G=Nn(w),e.on("nav:refreshCalendar",k),k()),!Z&&h.notepadTabEnabled&&(w={yTabEl:e.one("#tabnotepad").get("parentNode"),label:"Notepad",noDefault:!0,inactive:!0,forcePane:!0,sync:!0,ult:{action:"notepad_tab",spid:"notepad_tab"},init:function(t,n){e.use("notepad-ui-notepadview",function(e){var r=e.notepad.ui.getNotepadViewInstance();r.type="notepadtab",Cn(r,t),t.widget=r,e.notepad.ui.NotepadView.notepadTab=t,n()})}},Z=Nn(w)),!et&&t.features.enabled("newsFeedTab")&&(w={yTabEl:e.one("#tabnewsfeed").get("parentNode"),label:"newsfeed",noDefault:!0,inactive:!0,forcePane:!0,sync:!0,noToolbar:!0,widgetType:"newsfeed",ult:{action:"newsfeed_tab"},init:function(n,r){clearTimeout(Et),!t.features.enabled("newsstream")&&!s.newsFeedController?e.use("mail-ui-newsfeed-controller",function(e){s.newsFeedController=(new e.mail.ui.newsFeedController).init();var t=s.newsFeedController.getView();f(n,t,r)}):e.use("newsstream-ui-newsstreamview",function(e){var t=e.NewsStream.ui.getNewsStreamViewInstance();t.type="newsfeedtab",f(n,t,r)})}},et=Nn(w)),Q&&t.features.enabled("shuttleCloudBadge")&&!u.get("neo.pref.shuttleCloudBadge")&&e.one(".nav-item-contacts .contacts-flag").removeClass("hidden")}var r,i=t.parseQueryString(),s=this;m="launch_welcome"+(h.low_bandwidth?"_low":NeoConfig.isSSL?"_ssl":""),I(),e.namespace("contacts"),e.contacts.clientConfig={requestFn:e.common.net.SessionMgr.requestProxy,wssid:h.wssid,guid:h.neoguid,wspath:h.socdirProxyPath},h.strings&&(strings.str_ctrl=h.strings.str_ctrl,strings.str_enter=h.strings.str_enter,strings.str_ctrl_shift=h.strings.str_ctrl_shift,strings.str_ctrl_alt=h.strings.str_ctrl_alt,strings.str_right_click=h.strings.str_right_click),h.windowId=Math.round(Math.random()*1e9);if(h.multitask){var o=h.hasConvView?"ds:conv:":"ds:msg:";e.on(o+"remove",function(e,t,n){if(n){var r,i=t.length;for(r=0;r<i;r++)Pt(t[r])}}),h.hasConv?e.on("ds:conv:change",function(){var e,t,n,r,i,s,o,u;e=[].slice.call(arguments),t=h.hasConv?e[0]:e[4],n=e[1],r=e[2];if(t==="move"){u=n.length;for(o=0;o<u;o++)s=n[o].fid,i=r[o].fid,Pt(n[o])}}):e.on("ds:msg:change",function(){var e,t,n,r,i,s;e=[].slice.call(arguments),t=e[4],r=e[5],n=e[2];if(t==="move"){s=n.length;for(i=0;i<s;i++)Pt({mid:n[i].mid,fid:r}),n[i].srcMid&&Pt({mid:n[i].srcMid,fid:r})}})}return t.startConsole(i.ylog),p(),d=n,h.mrd&&h.mrd.action&&Zt(null,!0),r}function Pt(t){var n,r,i,s,o;if(!t.cid&&!t.mid)return;n={fid:t.fid},h.hasConv&&t.cid?(i=z.model.ConvStore.Conversations,o=i.getPermCidPart,n.cid=o(t.cid),n.tabKey="cid"):t.mid&&(r=z.model.DataStore.Messages,s=r.getPermMidPart,n.mid=s(t.mid),n.tabKey="mid"),e.fire("tab:removeRef",{data:n})}function Ht(t,n){var r=e.one("#paneshell"),i=strings.str_tog_loadRTLCss?"right":"left";n?(t.set("shellcontentOffset",r.one("#shellcontent").getStyle(i)),r.one("#shellcontent").setStyle(i,"0"),r.addClass("withoutshellnavigation")):(r.one("#shellcontent").setStyle(i,t.get("shellcontentOffset")),r.removeClass("withoutshellnavigation"))}function Bt(t,n){n?e.one("#shellnavigation").all(".items").addClass("hidden"):e.one("#shellnavigation").all(".items").removeClass("hidden")}function jt(t,n){n?e.one
("#main").addClass("withouttoolbar"):e.one("#main").removeClass("withouttoolbar"),e.fire("mbEvent:"+(n?"hide":"rotate"))}function Ft(t){var n=e.one(tt),r,i;lt&&t.newVal&&(r=lt.get("content"),r&&r.remove(),i=t.newVal,i=i?i.get("content")||"":"",i&&n.insert(i,0),n.hasClass("hidden")&&n.removeClass("hidden"),lt&&lt.set("active",0),lt=t.newVal,lt&&lt.set("active",1))}function It(e){if(ct&&e.target.get("active")){var t=e.prevVal,n=e.newVal,r=n?n.get("content")||"":"";r!==pt&&(ct.setContent(r),t&&t.set("active",0),pt=r,n&&n.set("active",1))}}function qt(n){(t.features.enabled("LFTCache")||t.features.enabled("LFTCacheCtrl"))&&e.fire("util:ymstats",{name:"UI_LIST_RENDER_COMPLETE",include:{bucket:!0,farm:!0},tags:{switched:n}})}function Rt(n,i){var s=Date.now();e.detach("list-stat:renderComplete"),e.detach("tab:reactivated"),e.detach("list-stat:tabDone"),e.fire("stat:feature_invoke",{message:"UI_LIST_START_SUCCESS",feature_group:"LIST"});if(n&&K&&K.widget.msgList.get("fid")===n.fid)var o=function(t){t&&(t.type==="messagelist"||t.type==="convlist")&&(e.fire("stat:feature_complete",{message:"UI_LIST_COMPLETE_SUCCESS",feature_group:"LIST"}),qt(0)),u.detach()},u=e.once(["tab:reactivated","list-stat:tabDone"],o);else e.once("list-stat:renderComplete",function(t){e.fire("FolderRender:complete"),e.fire("stat:feature_latency",{message:"UI_LIST_COMPLETE",feature_group:"LIST",value:t.endTime-s}),e.fire("stat:feature_complete",{message:"UI_LIST_COMPLETE_SUCCESS",feature_group:"LIST"}),qt(1)});if(!n||!n.fid)return;var a=new t.Stopwatch("FolderView"),f=h.bidi,c=n.extraParams||n.smartFolder&&n.forceRefresh,p=n.smartFolder&&!n.forceRefresh,d=n.fid;v||(v=!0,m=h.low_bandwidth?"launch_inbox_low":NeoConfig.isSSL?"launch_inbox_ssl":"launch_inbox"),d=d.replace(/%2f/g,"%5c");var g=n.bb;$.get(d,{success:function(t){n=t;var s=n.folderInfo.fid,o=n.folderInfo.name,u=r.getSystemFolderName(s,o,p),v,m=h.roundTrip,y,b=window.rt_LogTime,w;i?(y=W.get("fid"),y&&y.fid!==s&&W.set("fid",{fid:s,name:o,checkMail:!1})):(K?(f&&(u=K.widget.msgList.getFolderNameBidi(u,n.folderInfo.dir,n.total)),K.set("title",u),NeoConfig.backButtonFull&&!g&&(J.getActiveTabIndex()||K.widget.msgList.get("fid")!==s)&&e.fire("initPage",{fid:s}),K.widget.msgList.stopwatch=a,K.widget.msgList.set("extraParams",c),K.widget.msgList.set("fid",s),v=K.widget.msgList.get("fid")===s,e.mail.Tabs.switchToTab(K)):(Dt(1),f&&(u=K.widget.msgList.getFolderNameBidi(u,n.folderInfo.dir)),K.set("title",u)),l.fid=s,w=function(){d===l.fid&&(m&&b&&(m.t3&&(b("t3",m.t3,!0),delete m.t3),m.t4&&(b("t4",m.t4,!0),delete m.t4)),a&&a.stop())},K.widget.handledInitialRender||(w(),K.widget.msgList.stopwatch=null,K.widget.handledInitialRender=!0),K.widget.once("renderComplete",function(){w(),K.widget.msgList.stopwatch=null}),e.one("#btn-conv-view span")&&e.one("#btn-conv-view span").set("innerHTML",e.mail.ui.common.StringUtils.getSortKeyString(K.widget.msgList.sortedColumn.action)))}})}function Ut(t){var n=t?t.dataAction:0,r,i=t?t.item:0;switch(n){case"compose":case"autocompose":r={action:"compose_new_nav_toolbar",spid:"compose_new"},i&&i.hasClass("menu-active-item")&&(r.action="compose_menu_toolbar_sel",r.append={ltxt:"compose"}),e.mail.Tabs.getActiveTab().widgetType==="messagepane"&&(r.append={sec:"msgReadTlbr"}),e.fire("mt:click",r),n==="autocompose"&&(e.fire("util:ymstats",{name:"autocompose"}),r.action="autocompose_invoke",e.fire("mt:click",r)),e.fire("newMessage",{noScroll:!0,flavor:n});break;case"new-conv":}}function zt(){Xt(),e.Lang.later(0,null,function(){W.render(),(wt&&NeoConfig.totalListItems>NeoConfig.msgListObj.length||NeoConfig.lmv3LaunchBailoutCode)&&K.widget.msgList.refresh()}),J.render(),e.mail.ui.SearchBar.render(),ht=1,e.fire("stat:feature_latency",{message:"UI_LAUNCH_COMPLETE",feature_group:"LAUNCH",value:Date.now()-NeoGV.startTime}),e.fire("stat:feature_complete",{message:"UI_LAUNCH_SUCCESS",feature_group:"LAUNCH"}),f.fire("renderComplete")}function Wt(t){G&&(b=e.calendar.ui.getCalendarViewInstance(),b.type="calendartab",b.render(G.elContent,t))}function Xt(){function n(t){t.hasClass("calendar")&&e.fire("openCalendar"),t.hasClass("contacts")&&e.fire("openContacts"),t.hasClass("notepad")&&e.fire("openNotepad"),t.hasClass("settings")&&e.fire("openOptions"),t.hasClass("newsfeed")&&e.fire("openNewsfeed")}function i(t){var n=e.one("#tabs"),r,i;n&&(r=n.one('[data-tid="'+t+'"]'),r&&(i=r.get("parentNode"),i.hasClass("hidden")&&(J.autoCloseTabs(),i.removeClass("hidden"))),e.fire("tab:resize"))}function s(){var t=e.mail.Tabs,n=t.getActiveTab(),r=!1,s,o=n&&n.widget&&n.widget.fid,u=R.one('>li[data-fid="'+o+'"]')||R.one('li[data-fid="'+o+'"]'),a=n.get("widget"),f=n.widgetType,l=R.all(">li");t.switchLaterNav=null,e.one("#toolbar").removeClass("with-backsearch");if(f==="convpane"||f==="messagepane"){var c=n.prevTabId,p=t.getTabById(c);r=p&&p.widgetType==="search"}a&&a.NAME==="AuthorView"?("multitask"!==S.getAttribute("data-open")&&e.fire("navigation:switch",{type:"none"}),k&&k.addClass("defrost")):k&&k.removeClass("defrost"),r?(s=e.one(".search-nav"),s&&s.removeClass("hidden"),S.getAttribute("data-open")==="searchNav"&&e.fire("navigation:switch",{type:"none"}),e.one("#toolbar").addClass("with-backsearch")):u?(l.hasClass("selected")?l.removeClass("selected"):null,u.addClass("selected"),U.removeClass("open"),t.switchLaterNav=null,S.getAttribute("data-open")==="searchNav"&&e.fire("navigation:switch",{type:"none"})):o&&o===E&&(R.all("li.selected").removeClass("selected"),h.multitask&&t.holdNavSwitch?t.switchLaterNav="searchNav":e.fire("navigation:switch",{type:"searchNav"})),n.isRemovable||i(n.get("id")),n.isRemovable?T.addClass("subtab-active"):T.removeClass("subtab-active")}e.once("mail-ui-composeview-compose-loader:loaded",function(){var t=["mail-ui-workspace-rum"];t.push(function(e){e.mail.ui.Rum.init()}),e.use.apply(e,t)}),e.once(h.tictac?"tictacs-loaded:ws:postLoad":"ws:postLoad",function(){e.fire("core-modules-loaded"),e.fire("load:autosuggest"),NeoConfig.hasAds&&h.mrd&&h.mrd.action?e.
once("adRendered",function(){Ct()}):Ct(),NeoGV.postLoadFired=1}),W.on("fidChange",function(n){var i=n.prevVal||{},s=i.fid,o=n.newVal.fid,u=e.one("div.menu-group.coupons"),a=n.newVal.smartFolder||i.smartFolder;t.features.enabled("expiringCoupons")&&e.one("#menu-conv-view")&&u&&(r.isInboxFid(o)?u.show():u.hide()),t.assert(o.search("_")===-1);if(K){var f=s;f||(f=l&&l.fid||"Inbox"),(o!==f||o===f&&a)&&K.widget.set("loaded",0)}Rt(n.newVal)}),e.on("openMessage",bn),e.on("openConv",yn),e.on("tab:click",function(t){var n=t&&t.cfg&&t.cfg.ult,i,s;n&&(s=l.fid,s&&n.action==="folder_tab"&&(r.isInboxFid(s)||r.isDraftFid(s)||r.isSentFid(s)||r.isTrashFid(s)?i="folderview_"+s.toLowerCase():r.isSpamFid(s)?i="folderview_bulk":s==="%40c%40chats"?i="folderview_chat":i="folderview_custom",n.spid=i),e.fire("mt:click",n))}),mt=e.once("newMessage",function(t){e.fire("load:autosuggest"),ln(t)}),e.once("FullCompose:fullComposeReady",function(){mt.detach(),e.on("newMessage",ln)}),l.openCompose&&e.fire("newMessage"),e.on("editMessage",pn),e.on("updateDataStore",An),e.on("startPrefetch",function(t){var n=e.mail.common,r=n&&n.cachewarmer,i=t.msgHdrList,s=t.fid,o=t.preCacheMids;r&&r.preFetchMessages(s,i,100,o)}),e.on("prefetchConversations",function(n){var r=NeoConfig.bandwidthMode?NeoConfig.bandwidthMode:"broadband",i=NeoConfig.yodaReadEnabled?NeoConfig.yodaMessagePrefetchThreshold[r]:NeoConfig.messagePrefetchThreshold[r],s=i.limit||10,o=i.batch||3,u=n.startIndex||0,a=n.fid,f,l,c=[];if(!NeoConfig.enableMessagePrefetch||!NeoConfig.hasConv||!n.cids)return;for(l=u;l<n.cids.length&&l<u+s&&o>0;l++)t.features.enabled("yodaConversationRead")&&NeoConfig.yodaControllerLoaded?n.cids[l]&&c.push({conversationId:n.cids[l].conversationId||n.cids[l].cid,cfid:n.cids[l].cfid||n.cids[l].fid}):z.model.ConvStore.Conversations.isCached(a,n.cids[l].cid)||c.push({cid:n.cids[l].cid,fid:a,checksum:n.cids[l].checksum,msgs:["PREFETCH_MESSAGE"],anchorDate:n.cids[l].anchorDate,totalUnread:n.cids[l].totalUnread,totalMsgs:n.cids[l].totalMsgs}),o--;if(!c.length)return;if(t.features.enabled("yodaConversationRead")&&NeoConfig.loadYodaController)NeoConfig.loadYodaController.then(function(){setTimeout(function(){e.mail.controller.v3.api.getConversations({items:c,getDisplay:!0,isPrefetchCall:!0,showTAE:!1,statTAE:!1})},0)});else{f=z.Controller.batch(),f.setAsReadOp(!0);for(l=0;l<c.length;l++)z.Controller.Conversations.batchAddConvPrefetch(f,l,a,c[l],"CacheWarmer");f&&f.execute({suppressCodes:["*"],backgroundLogs:["*"]})}}),e.on("openInbox",function(){W.set("fid",{fid:"Inbox",name:strings.str_tabs_inbox})}),e.on("openRUEFCInbox",function(){W.set("fid",{fid:"Inbox",extraParams:{maxMessagesToScanForContacts:h.msgsToScanContacts||2e3},smartFolder:!0,name:strings.str_nav_email_from_ctcts})}),e.on("openContacts",tn),e.on("openCalendar",on),e.on("openNotepad",nn),e.on("openFolder",Rt),e.on("openNewsfeed",rn),e.on("ds:folder:system:switch",n),e.on("tabChange",s);var o=e.one("#signout");o&&(o.on("click",function(t){e.fire("signout"),t.preventDefault()}),e.on("signout",zn)),e.on("addContact",sn),e.on("mrd:launch",Zt),e.on("update:density",Mn),e.on("update:previewPane",_n),e.on("showMultitaskingOnboarding",Dn),e.on("windowresize",function(){e.fire("cv:fixupList")}),window.onbeforeunload=Un,window._TBCD=en,e.on("themes:change",function(e){var t;e.info&&e.info.meta&&(t=e.info.meta.darktab?"addClass":"removeClass",S[t]("tictac-dark-theme"))}),e.on("navigation:switch",function(t){e.use("mail-ui-workspace-ext",function(){f._setupNavigationSwitchForNav(t)})}),e.one("window").on("load",function(){var t=window.performance,n=[];if(!NeoConfig.log_assetlatency||!t||!t.getEntries||!t.timing)return;if(!NeoConfig.inThrottleAssetLatency||t.timing.loadEventStart-t.timing.responseStart<NeoConfig.log_assetlatency_onload_delay)return;n=t.getEntries(),e.Lang.later(1e3,null,function(){Vt(n)})}),NeoGV.hasSessionStorage&&sessionStorage.setItem("MTTI",Math.round(l.performance.now()));if(t.features.enabled("yodaMessageUpdate",!1)&&!NeoConfig.hasConvView||t.features.enabled("yodaConversationUpdate",!1)&&NeoConfig.hasConvView)NeoConfig.yodaUpdateEnabled=!0;if(t.features.enabled("yodaMessageRead",!1)&&!NeoConfig.hasConvView||t.features.enabled("yodaConversationRead",!1)&&NeoConfig.hasConvView)NeoConfig.yodaReadEnabled=!0;if(NeoConfig.yodaUpdateEnabled||NeoConfig.yodaReadEnabled)NeoConfig.loadYodaController=(new Promise(function(t){e.use("mail-controller-v3",function(){NeoConfig.yodaControllerLoaded=!0,t()})})).then(function(){NeoConfig.yodaControllerLoaded=!0});e.once("core-modules-loaded",function(){t.features.enabled("pensiveLaunchCallout")&&e.use("mail-ui-onboarding-pensive","mail-ui-onboarding",function(e){e.mail.ui.onboarding.pensive.init()})})}function Vt(t){var n={},r,i=t.length,s={};for(r=0;r<i;r++)s=t[r],n[s.name]={start:s.fetchStart,duration:s.duration,conn:s.connectEnd-s.connectStart,dns:s.domainLookupEnd-s.domainLookupStart};e.use("common-net-sessionmgr",function(){var t=[];t.push(e.JSON.stringify(n)),e.common.net.SessionMgr.requestProxy("/neo/assetStat",{method:"POST",data:t.join("&"),service:"assetStat"})})}function $t(){h.hasConvView?h.hasConvV3&&f.presetConvs():f.presetMsgs()}function Jt(t){e.fire("util:ymstats",{name:t,unit:"requests",type:"gauge",dataum:1,tags:{bandwidth:NeoConfig.bandwidthMode?NeoConfig.bandwidthMode:"broadband",isMailPlus:NeoConfig.hasAds?0:1}})}function Kt(){var n,r,i,s,o;if(parseInt(h.launchMsgPrefetch,10)===1&&h.prefetchObj&&h.prefetchObj.isConv&&h.prefetchObj.result){i=h.prefetchObj.result,i=e.JSON.parse(t.parseMultiPartResponse(i.conv,i.boundary));for(n in i){r=i[n];if(!r.success)continue;o=r[r.key],r.id.indexOf("GDM")!==-1||r.id.indexOf("getdisplaymessage")!==-1?(s=o.result&&o.result.message[0],s&&Yt(s)):(r.id.indexOf("LMT")!==-1||r.id.indexOf("listmessagesinthread")!==-1)&&o.result&&Qt(o.result)}st=it={},e.detach(yt),e.detach(gt)}}function Qt(t){var n=t.conversation.cid;st[n]||(at[n]="server",ft++,e.mail.Controller.Conversations.preset({fid:"Inbox",conv
:t}))}function Gt(){if(parseInt(h.launchMsgPrefetch,10)===1&&h.prefetchObj&&h.prefetchObj.result){var t=h.prefetchObj.result.message;for(var n in t)Yt(t[n]);h.prefetchObj.prefetchLimitReached&&(it={},e.detach(yt))}}function Yt(n){var r=NeoConfig.yodaReadEnabled&&NeoConfig.yodaControllerLoaded,i,s,o,u;n.sourceFolderInfo&&n.sourceFolderInfo.fid?u=n.sourceFolderInfo.fid:u="Inbox";if(!it[n.mid]){ot[n.mid]="server",ut++;if(h.vertPane)if(r)h.msgListObj&&(o=h.msgListObj.map(function(e){return e.mid}),e.mail.controller.v3.helper.translateMid(n,o));else{var a=0;while(a<20){i=h.msgListObj[a];if(i&&n.mid===i.mid){n.snippet=i.snippetStr||"";break}a++}}Jt(bt),e.mail.Controller.Messages._preset({fid:u,msgObj:n}),h.hasConvView&&e.mail.Controller.Conversations&&!r&&e.mail.Controller.Conversations.presetMsg({fid:u,msgObj:n})}n.sourceFolderInfo||(s={key:"missingsourceFolderInfo",mid:n.mid,yid:NeoConfig.loginId,host:NeoConfig.hostName,wssid:NeoConfig.wssid,time:Date.now()},t.netError(e.JSON.stringify(s)))}function Zt(t,n){e.use("mail-controller-mrd",function(e){e.mail.Controller.MRD&&(n?e.mail.Controller.MRD.handleLaunch():e.mail.Controller.MRD.handleClick(t))})}function en(t){t&&e.use("mail-controller-mrd",function(e){e.mail.Controller.MRD.handleToolbar(t)})}function tn(t){e.fire("Y.mail.ui.Workspace:openContacts:start"),e.use("contacts-ui-contactsview",function(e){var n=e.contacts.ui.getContactsViewInstance(t);n.updateConfig(t),e.mail.Tabs.switchToTab(Q)})}function nn(){e.fire("Y.mail.ui.Workspace:openNotepad:start"),e.use("notepad-ui-notepadview",function(e){var t=e.notepad.ui.getNotepadViewInstance();t.updateConfig(),e.mail.Tabs.switchToTab(Z)})}function rn(){e.fire("Y.mail.ui.Workspace:openNewsfeed:start"),e.mail.Tabs.switchToTab(et)}function sn(t,r,i,o){var u=s(r);t===r&&(t=""),e.use("contacts-ui-hovercard-addedit",function(){(new n.ui.HoverCardAddEdit({action:i||o?"editContact":"addContact",data:o?o:i?{fields:i}:{name:s(t),email:u,endpoints:{smtp:[{ep:"smtp:"+u}]}}})).show()})}function on(){G&&h.calendarTabEnabled&&e.mail.Tabs.switchToTab(G)}function un(){var t=J.getByType("compose"),n=!1,r,i;for(var s in t){r=t[s].widget;if(NeoConfig.imapIn){i=r.getDraftAcctId();if(r.isClean()&&i===e.mail.Controller.ImapIn.getCurrentAccountId())return n=!0,s}else if(r.isClean())return s}return null}function an(t){var n,r,i=J.getByType("compose"),s=function(t){t&&t.widgetType==="compose"&&e.fire("stat:feature_complete",{message:"UI_COMPOSE_SWITCH_SUCCESS",feature_group:"COMPOSE"})};if(t)J.switchToTab(i[t]);else for(var o in i){n=i[o],r=n.widget;if(r.isClean()){e.once(n.get("active")===1?"tab:reactivated":"tabChange",s),J.switchToTab(n);return}}}function fn(e){var t=e.widget;if(t){var n=t.tab||J.getActiveTab();n.detach("closeHalted"),n.on("closeHalted",function(e){e.halt(!0)})}}function ln(n,r){var i=!!n&&!!n.oMsg,s=n&&n.fromContact,o;i&&(n.parentMsg=t.getVal(n,"oMsg"),n.parentMsg.fid=t.getVal(n,"fid")),n&&!n.startTime&&(n.startTime=Date.now(),e.fire("stat:feature_invoke",{message:"UI_COMPOSE_START_SUCCESS",feature_group:"COMPOSE"}),e.detach("compose-stat:fullComposeReady"));if(!i&&!s){o=f.getComposeReusableTabId();if(o){f.switchToCleanCompose(o);return}}NeoConfig.mrd=NeoConfig.mrd||{},NeoConfig.mrd.param=NeoConfig.mrd.param||{},NeoConfig.mrd.param.autocompose=!1,NeoConfig.mrd.param.enhanceOnboardingLinks=!1,n&&(n.flavor==="autocompose"&&t.features.enabled("autocomposeValentines")?(NeoConfig.mrd.param.autocompose=!0,NeoConfig.mrd.param.stationeryId="loveHearts",n.cbfn||e.fire("util:ymstats",{name:"compose_valentine_autocompose",tags:{source:"heartClick"}})):n.flavor==="enhancronboard"&&(NeoConfig.mrd.param.enhanceOnboardingLinks=!0)),fn(n),e.once("compose-stat:fullComposeReady",function(){e.fire("stat:feature_latency",{message:"UI_COMPOSE_COMPLETE",feature_group:"COMPOSE",value:Date.now()-n.startTime}),e.fire("stat:feature_complete",{message:"UI_COMPOSE_COMPLETE_SUCCESS",feature_group:"COMPOSE"})}),n.forceNew=r,n.openAsDraft=!1,hn(n)}function cn(t){e.use("contacts-api","contacts-api-utils",function(e){var n=e.contacts,r=n.utils,i=n.api;r.areContactsLoaded()||(t?e.Lang.later(0,null,function(){i.load()}):i.load())})}function hn(t){var n=f;e.use("mail-ui-composeview-compose-loader",function(){var r=new e.mail.ui.Compose.ComposeLoader({context:t,workspace:n,force:t.forceNew,tabs:J,strings:{str_tabs_compose_fresh:strings.str_tabs_compose_fresh},openAsDraft:t.openAsDraft});r.addModule("mail-ui-rteview-v3"),r.addModule("mail-ui-rte-formatter-v3"),r.load()})}function pn(e){e=e||{},e.forceNew=!1,e.openAsDraft=!0,hn(e)}function dn(t,n){t.oMsg&&t.fid&&(n.CMGStart=new Date,NeoConfig.yodaReadEnabled&&NeoConfig.yodaControllerLoaded?e.mail.controller.v3.api.getSimpleBodyofMessages({messageList:[t.oMsg],sourceFid:t.fid,filter:{truncateAt:null},blockImages:"none",success:function(){n.CMGEnd||(n.CMGEnd=new Date,n.wasCached=!1)},failure:function(){}}):e.mail.Controller.Messages.get({fid:t.fid,msg:t.oMsg,cachekey:"ComposeOrigin",ovparams:{truncateAt:null}},{success:function(e,t){n.CMGEnd||(n.CMGEnd=new Date,t&&t.respProps&&(n.wasCached=t.respProps.wasCached))},failure:function(){}}))}function vn(n,r,i){i.start(1,"GetTabCB");var s=e.mail.model.DataStore.Messages.getPermMidPart,o=n.msgPane&&n.msgPane.get("message"),u=o&&o.message&&o.message.mid||"",a=o&&o.message&&o.message.cid||"",f=u&&n.msgPane.fullView&&s(r.mid)===s(u);if(o&&n.msgPane.fullView&&!u&&!a){var l=h.loginId;l+=":"+(o.fid||"MISSING FID"),o.message&&o.message.header&&o.message.header.receivedDate?l+=":"+o.message.header.receivedDate:l+=":MISSING MESSAGE BODY",e.use("common-utils-error",function(){t.error.report("MissingMidError in hasMsgTab for YID:FID:REC_DATE"+l,1)})}return f&&n.msgPane.markAsRead&&n.msgPane.markAsRead(),f}function mn(t,n,r){r.start(1,"GetTabCB");var i=e.mail.model.ConvStore.Conversations.getPermCidPart,s=t.msgPane&&t.msgPane.get("message"),o=s&&s.message&&s.message.cid||"",u=o&&t.msgPane.fullView&&i(n.cid)===i(o);return u}function gn(n,i){try{var u=n.fid,f=n
.msg.msgs&&(!h.hasConvView||r.isDraftFid(u)&&n.msg.totalMsgs===1)?n.msg.msgs[n.msg.msgs.length-1]:n.msg,l=n.sortCol||0,c=n.query||0,p=n.extras||{},d=n.searchRequestAttrs||{},v=n.searchListMgr||{},m=n.index||0,g=n.noScroll,y=50,b=n.arrMsgSeq||0,w=b&&b.length||0,S=m-y>0?m-y:0,x=b&&(m+y<w?m+y:w)||null,T=b&&b.slice(S,S+x>w?x:S+x)||0,N=S,C=t.Stopwatch,k=C.get("MsgInPreview"),L=null,A={},O=!1,M=n.callFromLaunch?n.callFromLaunch:!1,_,D=n.isConv&&!n.midtocid?"cid":"mid",P="",H,B,j,F,I,q,R="",U=function(){M&&a(function(e){k.start(1,"TabDarlaEvent"),e.fire("darlaEvent",{action:h.low_bandwidth?"launch_message_low":NeoConfig.isSSL?"launch_message_ssl":"launch_message"})},!1)};typeof f=="string"&&(f=n.isConv&!n.midtocid?{cid:f}:{mid:f});if(f&&!f[D])return;e.fire("MessagePane:inception",{fid:u,message:f}),k=new C("MsgInTab"),k[D]=f[D],k.isConv=n.isConv,u===E&&(j=f.fid?f.fid:f.sourceFolderInfo.fid),O=u===E&&j==="Draft",document.onselectstart=function(){return!1},setTimeout(function(){document.onselectstart=null},500);if(f.mid&&(r.isDraftFid(u)||O)){e.detach("read-stat:draftRendered"),e.once("read-stat:draftRendered",function(){n.isConv?(e.fire("stat:feature_latency",{message:"UI_READ_DRAFTCONV_COMPLETE",feature_group:"READ",value:Date.now()-n.startTime}),e.fire("stat:feature_complete",{message:"UI_READ_DRAFTCONV_COMPLETE_SUCCESS",feature_group:"READ"})):(e.fire("stat:feature_latency",{message:"UI_READ_DRAFTMESSAGE_COMPLETE",feature_group:"READ",value:Date.now()-n.startTime}),e.fire("stat:feature_complete",{message:"UI_READ_DRAFTMESSAGE_COMPLETE_SUCCESS",feature_group:"READ"}))}),e.fire("editMessage",{oMsg:f,fid:O?j:u,action:"edit",enableRetry:O?!0:!1,noScroll:g});return}L=n.isConv&&n.msg.cid?J.getTab(function(e){return mn(e,f,k)}):J.getTab(function(e){return vn(e,f,k)}),L&&(e.mail.Tabs.destroyTabWidget(L),L=null),h.multitask&&!L&&(A.fid=n.fid,n.isConv&&!n.midtocid?(A.cid=z.model.ConvStore.Conversations.getPermCidPart(f.cid),A.tabKey="cid"):(A.mid=z.model.DataStore.Messages.getPermMidPart(f.mid),A.tabKey="mid"),Pt(A)),cn(),k.start(1,"NewView"),L?(L.invisible=0,H=L.widget,B=H.msgPane,H.fid=B.fid=u,H.stopwatch=B.stopwatch=k,B.sortedColumn=l,B.searchQuery=c,B.extras=p,B.searchRequestAttrs=d,B.searchListMgr=v,B.processData=n.processData,B.type=n.type,B.arrMessageSequence=T,B.arrMessageSequenceStartIndex=N,H.callFromLaunch=M,k.start(1,"preload"),B.preload(f),e.fire("MailLog",{m:"message preloaded"})):(e.fire("MailLog",{m:"Creating new view"}),_={msgList:0,fid:u,cid:n.msg.cid,message:f,submessage:n.submsg,midtocid:n.midtocid,neighbors:n.neighbors,sortedColumn:l,searchQuery:c,extras:p,arrMessageSequence:T,arrMessageSequenceStartIndex:N,callFromLaunch:M,stopwatch:k},n.isConv&&n.fid!=="%40C%40Chats"?H=new e.mail.ui.ConvView(_):H=new e.mail.ui.MessagesView(_),B=H.msgPane),H.once("renderComplete",function(){n.isConv||(Wn(k,H,B),e.fire("stat:feature_latency",{message:"UI_READ_MESSAGE_COMPLETE",feature_group:"READ",value:Date.now()-n.startTime}),e.fire("stat:feature_complete",{message:"UI_READ_MESSAGE_COMPLETE_SUCCESS",feature_group:"READ"})),U(),i&&i()}),n.isConv&&B.once("renderConvComplete",function(){Wn(k,H,B),e.fire("stat:feature_latency",{message:"UI_READ_CONV_COMPLETE",feature_group:"READ",value:Date.now()-n.startTime}),e.fire("stat:feature_complete",{message:"UI_READ_CONV_COMPLETE_SUCCESS",feature_group:"READ"})}),k.start(1,"EscapeMessageSubject"),I=n.isConv?f.subject||strings["str_msg-view_tab_no_subject"]:f.header&&f.header.subject||f.subject||strings["str_msg-view_tab_no_subject"],I=s(o(I)),n.type==="search"&&(I=I.replace(new RegExp("\\^_([^^]*?)\\^_","g"),"$1")),h.bidi&&(P=n.isConv?f.subjectDir||"":f.header&&f.header.subjectDir||f.subjectDir||"",P===""&&e.Intl.detectDirection&&(P=e.Intl.detectDirection(I))),n.isConv&&n.type!=="search"?(q=f&&f.recipients,q&&q.length&&(R=s(o(q[q.length-1].name)))):f.header&&f.header.from&&(R=e.mail.ui.PaneUtils.getName(f.header.from)),k.start(1,"AddCW");var W={data:A,p_label:R,s_label:I,s_labelDir:P,widget:H,isRemovable:!0,forcePane:n.isConv,noScroll:g,extras:p,searchQuery:c};L?W.tab=L:W.acwHandler=wn,W.acwHandlerArgs={stopwatch:k,msgPane:B,fid:u,message:f,neighbors:n.neighbors,usedTabPool:F,isConv:n.isConv},n.isConv&&e.one("#shellcontent").addClass("loadingConv"),L=Nn(W),B&&B.fire("convAddedToDOM")}catch(X){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-workspace-workspace:1",X,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-workspace-workspace:1"),e.use("common-utils-error",function(){t.error.report("openMessageError",X,1,1,1)})}}function yn(t,n){e.fire("stat:feature_invoke",{message:"UI_READ_CONV_START_SUCCESS",feature_group:"READ"}),t=t||{},t.isConv=1,t.startTime=Date.now(),gn(t,n)}function bn(t,n){e.fire("stat:feature_invoke",{message:"UI_READ_MESSAGE_START_SUCCESS",feature_group:"READ"}),t=t||{},t.startTime=Date.now(),t.msg&&t.msg.mid&&ot[t.msg.mid]==="server",t.isConv=h.hasConvView?1:0,t.isConv&&(t.midtocid=!0),t.isConv=h.hasConvView&&!t.forceMessageOpen?1:0,t.isConv&&t.fid==="%40C%40Chats"?e.use("mail-ui-messagesview-base",function(){gn(t,n)}):gn(t,n);var r=t.msg.flags&&t.msg.flags.isRead;w||(r,w=!0)}function wn(e){var t=e.cfg.acwHandlerArgs;t.stopwatch.start(1,"TabCallFromLaunch"),t.stopwatch.title="MsgInTab Stopwatch\n",t.stopwatch.start(1,"PostOpenMessage");if(t.usedTabPool)try{t.msgPane.set("message",{fid:t.fid,message:t.message,neighbors:t.neighbors})}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-workspace-workspace:2",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-workspace-workspace:2")}}function En(t,n){e.use("common-ui-dialog-helper",function(e){setTimeout(function(){var t={hd:strings.str_modal_tabdeactivate_title,bd:strings.str_modal_tabdeactivate_body};e.common.ui.DialogHelper.confirm(t,{ok:{handler:n},cancel:{}})},0)})}function Sn(e){var t;try{t=J.createTab(e),t.on("tab:add",Tn
),e.acwHandler&&t.on("tab:add",e.acwHandler)}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-workspace-workspace:3",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-workspace-workspace:3")}return t}function xn(e){var t=e.tab||Sn(e);try{J.addTab(e,t)}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-workspace-workspace:4",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-workspace-workspace:4")}return t}function Tn(t){var n=t.cfg,r=t.tab;r.reuse||Cn(n.widget,r);if(!n.inactive)try{e.mail.Tabs.switchToTab(r)}catch(i){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-workspace-workspace:5",i,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-workspace-workspace:5")}}function Nn(t){if(!t.sync){var n=J.getActiveTab();if(!J.canDeactivateTab(n))return n===e.mail.ui.optionsTab?e.fire("tab:deactivateOptionsTab",{newTab:!0,addtab:function(){xn(t)}}):En(n,function(){xn(t)}),null}return xn(t)}function Cn(e,t){var n,r;try{if(e){var i=[];t.detachWidget&&t.detachWidget(),n=function(t){var n=t.currentTarget&&t.currentTarget.widget&&t.currentTarget.widget.msgPane&&t.currentTarget.widget.msgPane.message;e.get("hideToolbar")&&jt(e,t.newVal),e.get("hideNavbar")&&Ht(e,t.newVal),e.get("clearNavbar")&&Bt(e,t.newVal),h.msgrData=h.msgrData||{},h.msgrData.message=n&&n.fid==="%40C%40Chats"?n:null},e.get("navToolbar")||e.set("navToolbar",c.originalNav),t.after("navKeysChange",function(e){f.set("navKeys",e.newVal)}),t.activeChangeHandle&&t.activeChangeHandle.detach(),t.activeChangeHandle=t.after("activeChange",n),r=function(n){n.newVal&&e.set&&(t.reuse||t.detachWidget())},i.push(t.on("closeChange",r)),e.on&&(i.push(e.on("navToolbarChange",Ft)),i.push(e.on("contentToolbarChange",It))),t.evtHandles=i,t.detachWidget=function(){var e,n=t.evtHandles,r=n.length,i;for(i=0;i<r;i++)e=n[i],e&&e.detach(),n[i]=null;t.evtHandles=[]}}}catch(s){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-workspace-workspace:6",s,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-workspace-workspace:6")}}function kn(t){t!==f.get("navKeys")&&(dt&&dt.detach(),t&&(dt=e.on("key",t.onKeyDown,e.one("document"),"down:"+t.charCodes.join(","),f),e.UA.os==="macintosh"&&e.UA.gecko&&e.on("key",t.onKeyPress,e.one("document"),"press:63",f)))}function Ln(){On()}function An(t){t.modifiedObjs.userdata&&e.common.persist.UserData.load(!0),t.modifiedObjs.metadata&&u.load(),typeof t.msgPaneVisible!="undefined"&&K.widget.previewPaneUIChange(t.msgPaneVisible)}function On(t){if(t){try{var n=window.location.href.split("#")[0],r=n.indexOf("?")!==-1,i=n.indexOf(".rand")!==-1,s=".rand="+Math.round(Math.random()*1e9),o="";i?o=n.replace(/\.rand\=([\d]+)/g,s):o=r?n+"&"+s:n+"?"+s,window.location.href=o;return}catch(a){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-workspace-workspace:7",a,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-workspace-workspace:7")}window.location.reload()}else e.common.persist.UserData.load(!0),u.load()}function Mn(t){e.use("mail-ui-workspace-ext",function(){f._switchDensity(t)})}function _n(t){e.use("mail-ui-workspace-ext",function(){f.setUdbKey(t)})}function Dn(n){if(h.tabs||NeoConfig.isRegOnboardingEnabled)return;e.use("mail-ui-onboarding","minty_module_offscreen_bin_multitask_callout_rollup",function(e){var r=e.ui.Templates.minty_module_offscreen_bin_multitask_callout_rollup,i=decodeURIComponent(h.multitaskHelpUrl),s=t.ezSub(r.base,{tabs_learn_more_url:i,user_locale:h.lang.replace("-","_")},r),o=e.one("#multitask");o.scrollIntoView(),o.addClass("nav-open"),e.fire("onboard:tip",{node:o.one("button"),template:s,fn:function(){e.fire("onboard:tipclose"),n&&n.queuedObCallback&&n.ctx&&n.queuedObCallback.apply(n.ctx)},dir:"left",offset:[33,-30]}),h.showMultitaskTutorial=!1,e.use("mail-ui-workspace-ext",function(){f.setUdbKey({multitask_onboarding:1})})})}function Pn(){return K}function Hn(){return K.widget.msgList}function Bn(t){var n=e.mail.Tabs.tabs,r,i,s,o;for(r=0;r<n.length;r++){s=n[r].widget;if(s&&(o=s.get("composeWidgets"))&&o.length)for(i=0;i<o.length;i++)if(t(o[i]))return h.hasConvView&&s.msgPane&&s.msgPane.message&&s.msgPane.message.msgs&&s.msgPane.message.msgs.length===1?null:{compose:o[i],tab:n[r]}}return null}function jn(e){return Bn(function(t){return t.matchOrigin(e)})}function Fn(){var t=e.mail.Tabs.getActiveTab(),n,r=t?t.widget:null,i;if(r&&(i=r.get("composeWidgets"))&&i.length)for(n=0;n<i.length;n++)if(i[n]&&i[n].get("active"))return!0;return!1}function In(t){e.use("mail-ui-workspace-ext",function(){f.setUdbKey({reg_onboarding:1})}),e.once("click",function(){NeoConfig.onboarding.taskPanelEnabled=0}),F?H.set(P,[]):e.mail.persist.MetaData.set(_,undefined),e.fire("util:ymstats",{name:"keyTasksPanel_reset_key",include:{bucket:!0},tags:{reason:t?t:"unknown"}}),e.use("mail-ui-keytaskpanel-ult",function(e){e.fire("mt:click",{action:"keyTasks_reset"})})}function qn(t,n,i){var s=NeoConfig.serverTime,o=NeoConfig.serverTime,u=r.get("Inbox").total,a;if(!NeoConfig.onboarding.taskPanelEnabled||!r.isInboxFid(t))return;F?(a=H.getSync(P),a&&Array.isArray(a)&&a.forEach(function(e){e.indexOf("panelTimer")!==-1&&(s=parseInt(e.split(":")[1],10))})):e.mail.persist.MetaData.get(_)&&(s=JSON.parse(e.mail.persist.MetaData.get(_)).panelTimer);if(u>40||o-s>2592e3){In("renderCheckFailed");return}if(u===0&&!NeoConfig.previewPanePref&&(!i||!i.isEmptyFolder))return;e.fire("util:ymstats",{name:"keyTasksPanel_renderPanel_success",include:{bucket:!0}}),e.use("mail-ui-keytaskpanel-panelview",function(e){i&&typeof i.insertPreview=="function"&&i.insertPreview(),e.mail.ui.keytaskpanel.PanelView.renderPanel(n),NeoConfig.previewPanePref&&!NeoConfig.hasConv&&u===0&&
e.one(".key-task-panel").setAttribute("data-view","nonconv")})}function Rn(e,t){var n=0,r;return r=Bn(function(r){(r.get("dirty")&&r.get("dirty")!=="ForceClose"||D&&(r.draft.state==="sending"||r.draft.state==="savingAndSending"))&&n++;if(e&&!r._canClose(t))return!0}),r?-1:n}function Un(e){var t,n=0,r;t=window.onBeforeUnloadBizMail;if(t){t();return}try{n=Rn()}catch(i){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-workspace-workspace:8",i,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-workspace-workspace:8")}n&&(D?r=strings.str_error_ComposeSendingNavigateAway:r=strings.str_error_ComposeNavigateAway);if(r&&n)return window.event&&(window.event.returnValue=r),e&&e.returnValue&&(e.returnValue=r),r}function zn(){setTimeout(function(){try{e.Cookie.remove("YM.MAILBOXV3",{path:"/",domain:NeoConfig.cookieDomain}),e.Cookie.remove("YM.BM",{path:"/",domain:"mail.yahoo.com"}),window.location.href=i(strings.str_cfg_url_signout,{},null,null,strings)}catch(t){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-workspace-workspace:9",t,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-workspace-workspace:9")}},100)}function Wn(e,t,n){e&&e.stop(),t&&delete t.stopwatch,n&&delete n.stopwatch}var f=this,x=e.one("div#main"),q="#storm-listnav",R=x.one(q),U=x.one("#Folders"),z=e.mail,W=z.FoldersView,X=z.ui.Toolbar,V=z.Controller,$=V.Folders,J=z.Tabs,K,Q,G,Z,et,tt="#toolbar",nt=".switcher",rt=".commontasks",it={},st={},ot={},ut=0,at={},ft=0,lt,ct,ht,pt,dt,vt,mt,gt,yt=e.on("ds:msg:remove",function(e,t){if(e==="Inbox")for(var n in t)it[t[n].mid]=!0}),bt="msg_cache_add",wt=!1,Et;e.on("setUdbKey",function(t,n){e.use("mail-ui-workspace-ext",function(){f.setUdbKey(t,n)})}),window.addEventListener("resize",function(){t.cacheWindowSize({height:window.innerHeight,width:window.innerWidth})}),t.features.enabled("scout")&&!NeoConfig.isRegOnboardingEnabled&&NeoConfig.onboardingList&&e.use("mail-ui-onboarding-dispatcher",function(e){e.mail.ui.onboarding.dispatcher.setNextCalloutTimer("launch")}),NeoConfig.isRegOnboardingEnabled&&function(){var t,n,r;n=new Promise(function(t){e.once("ws:regonboarding_timeout",function(){t()})}),t=new Promise(function(t){e.once("ws:onboarding_done",function(){t()})}),r=Promise.race([t,n]),r.then(function(){e.one("body").removeClass("onboarding-on")})}(),t.features.enabled("newUserDefaultSignature")&&NeoConfig.isRegOnboardingEnabled&&!(NeoConfig.serverTime-NeoConfig.userRegTime>86400&&!NeoConfig.hasAds)&&e.use("mail-controller-imapin",function(e){var t=e.mail.Controller.ImapIn.getCurrentAccount(),n=strings.str_launch_default_signature_text2,s,o;if(t.signatureActive)return;s={id:r.PrimaryAcctId,signatureActive:!0,signature:i(n,{},null,null,strings)},o={success:function(){e.fire("util:ymstats",{name:"launch_default_signature",tags:{value:"success"},include:{bucket:!0}})},failure:function(){e.fire("util:ymstats",{name:"launch_default_signature",tags:{value:"failure"},include:{bucket:!0}})}},e.mail.Controller.ImapIn.updateAccount(s,o)}),h.hasConvView&&(gt=e.on("ds:conv:remove",function(e,t){if(e==="Inbox")for(var n in t)st[t[n].cid]=!0})),e.once("ds:msg:change",function(){vt=1}),t.features.enabled("autoCheckNetwork")&&e.use("common-net-pulse",function(){}),St(),e.after(["update:density","update:previewPane","windowresize"],t.debounce(function(){var n,r;St(),n=K.widget.msgList._listview.get("pageSize"),r=h.pageSize,n<r&&(K.widget.msgList._listview.set("pageSize",r),t.features.enabled("LFTCache")&&e.use("mail-model-liststore",function(){e.mail.model.ListStore.ListCache.invalidate()}),K.widget.msgList.get("pageCount")>1&&K.widget.msgList.refresh())},1e3)),e.on("load-address-book-contacts",function(e){var t=e.delay||!1;cn(t)}),e.on("bindContentWidget",function(e){Cn(e.cw,e.tab)}),e.augment(f,e.Attribute),f.addAttrs({navKeys:{setter:kn}}),e.mix(f,{addContentWidget:Nn,init:Dt,oldPostLoad:Lt,postLoad:kt,render:zt,signout:zn,moUpdate:Ln,presetMsgs:Gt,presetConvs:Kt,presetDataItems:$t,refreshPersistData:On,getFolderContent:Pn,getMessageList:Hn,getComposeDirtyCount:Rn,renderKeyTasksPanel:qn,resetKeyTaskPanelKey:In,composeEnumerate:Bn,composeFindOrigin:jn,isComposeActiveInCurrentTab:Fn,prefetchedMidsHash:ot,prefetchComposeOrigin:dn,getComposeReusableTabId:un,switchToCleanCompose:an,composeDeps:g})},e.mail.ui.Workspace=new x,c=e.mail.ui.Workspace},"1.0.0",{requires:["mail-platform","event-resize","mail-controller-tictacs","mail-modules","mail-templates","mail-ui-foldersview-base","common-ui-tabs-base","common-ui-toolbar-base","mail-ui-searchbar","common-utils-stats","mail-persist-meta-data","mail-ui-common-string-utils","mail-common-tracker","ymma-stats","mail-ui-navkeys","mail-common-utils-features","mail-ui-folder-utils","mail-controller-v3-user-settings"]});


YUI.add("mail-ui-workspace-postload",function(e){var t=NeoConfig,n=Neo.performance,r=e.mail.ui.Workspace,i=e.common.Utils.features,s=e.common.Utils.settings,o=e.mail.api.utility,u,a,f=0,l=s&&s.value("customAdBlockThreshold")||30;e.mix(r,{getBandwidthMode:function(){return a?a:(a="broadband",n.now()>NeoConfig.cableBandwidthDelayLimit&&(a="cable"),n.now()>NeoConfig.dialupBandwidthDelayLimit&&(a="dialup"),NeoConfig.bandwidthMode=a,e.fire("util:ymstats",{name:"bandwidth",tags:{browser:NeoConfig.browser,info:a}}),a)},enableTrendingNow:function(){var t=e.one("#paneshell"),n=e.one("#trendingNode"),r=e.mail.ui.darla.getEligibleRightRailAdPos();n||(n=e.Node.create('<div id="trendingNode" aria-hidden="true"></div>'),t.append(n)),e.use("mail-ui-trending-controller",function(){e.mail.ui.trendingController.init({adPosition:r})})},isElemVisible:function(t){return typeof t=="string"&&(t=e.one(t)),t&&!(t.hasClass("hidden")||t.get("clientHeight")===0||t.getStyle("display")==="none"||t.getStyle("visibility")==="hidden"||t.getStyle("opacity")<.75)||!1},isAdPositionBlocked:function(t){var n,r=this;if(t&&u===t){n=e.one("#slot_"+t);if(n&&!r.isElemVisible(n))return!0}return!1},checkAdBlock:function(){var t=this,n=t.isAdPositionBlocked(u),r=e.one("#theAd");r&&!t.isElemVisible(r)||n?(f++,l<f&&(e.fire("util:ymstats",{name:"custom_ad_block_handled"}),i.enabled("adBlockTrendingNow")?(r.setStyle("display","none"),t.enableTrendingNow()):setTimeout(function(){window.location.href="/neo/launch?reason="+s.value("AdBlockUnblockRoughSeasCode")},1e3))):f=0},showAttribution:function(){var t=e.one(".attribution-bar"),n=e.one(".attribution");t&&t.show(),n&&n.hasClass("hidden")&&n.removeClass("hidden")},hideAttribution:function(){var t=e.one(".attribution-bar");t&&t.hide()},renderMinUpsell:function(t,n){var r=e.mail.ui.Workspace,i=e.one(".attribution-bar"),s,o,u=e.one("#norrin-upsell");i&&i.hide(),t&&t==="close"&&e.use("norrin-min-upsell_css","minty_module_shell_navigation_pane_inbox_copyright",function(e){s=e.ui.Templates.minty_module_shell_navigation_pane_inbox_copyright,o=e.common.Utils.substitute(s.norrin_upsell,0,0,0,strings),u.setHTML(o)}),e.fire("util:ymstats",{name:"norrin_min_upsell_shown",include:{bucket:!0},tags:{reason:n||"unknown"}}),e.fire("mt:click",{action:"norrin_min_upsell_shown"}),e.on("boss:afterShow",r.showAttribution),e.on("boss:hide",r.hideAttribution)},postLoadInitCB:function(){var t=this,n=!1,o=5e3,a=t.getBandwidthMode(),f=e.one("#norrin-upsell"),l=function(){n||(window.setTimeout(function(){r.oldPostLoad(e)},50),n=!0)};a==="cable"?o=1e4:a==="dialup"&&(o=2e4),e.one("window").on("load",l),e.one("window").on("blur",this.onMailNavigateOut,this),window.setTimeout(l,o),this.registerAdsOnNavigateOut(),function(){var r=e.one("#theAd"),o=e.one("#trendingNode");if((!NeoConfig.hasAds||!i.enabled("AdBlockUnblock"))&&!i.enabled("adBlockTrendingNow"))return;e.on("adReturned:LREC",function(){u="LREC"}),e.on("adReturned:SKY",function(){u="SKY"}),e.on("adRendered",function(){e.one("body").hasClass("withoutad")||(r.getStyle("display")!=="block"&&r.setStyle("display","block"),window.setTimeout(e.bind(t.checkAdBlock,t),3e3))}),r&&r.get("clientHeight")===0&&(i.enabled("adBlockTrendingNow")&&!o?t.enableTrendingNow():setTimeout(function(){window.location.href="/neo/launch?reason="+s.value("AdBlockUnblockRoughSeasCode")},5e3))}(),i.enabled("heartBeat")&&e.use("mail-ui-heartbeat",function(e){e.mail.ui.heartBeat.init()}),i.enabled("popin2imapUpsell")&&NeoConfig.accounts.popAccounts&&NeoConfig.accounts.popAccounts.length&&e.use("mail-ui-onboarding-popin-to-imap"),i.enabled("norrinMinUpsell")&&t.renderMinUpsell(!0,"onLaunch"),e.on("showNorrinMinimizedUpsell",t.renderMinUpsell),f&&f.on("click",function(){e.fire("util:ymstats",{name:"norrin_min_upsell_click",include:{bucket:!0}}),e.fire("mt:click",{action:"norrin_min_upsell_click"}),e.common.Utils.norrinOptInXhrCall()}),e.common.Utils.isQualifiedForCoupons()&&e.use("mail-ui-workspace-postload-coupons"),e.common.Utils.isEligibleForUnsubSuggestion()&&e.mail.controller.v3.settings.userSettings.get(["attributes.web.unsubscribeTimestamp","attributes.web.showUnsubscribeNotification","attributes.web.numUnsubscribedItems"]).then(function(t){e.Lang.isArray(t)&&t.forEach(function(t){t.key==="attributes.web.showUnsubscribeNotification"&&t.value&&e.use("mail-ui-unsub-api")})},function(e){}),function(){var t=/^(1-)?\d{10}$/,n=e.common.Utils,r="";NeoConfig.basicAuthUser===1&&(NeoConfig.recoveryPhone!==""?r=t.test(NeoConfig.recoveryPhone)?2:1:r=0,e.fire("util:ymstats",{name:"basic_auth_has_recovery",tags:{intl:NeoConfig.intl,hasValidPhone:r,webMailScore:n.getSegmentData("webMail").currSegScore,mobileMailScore:n.getSegmentData("mobileWeb").currSegScore,iosScore:n.getSegmentData("ios").currSegScore,androidScore:n.getSegmentData("android").currSegScore}}))}(),i.enabled("resetUnseenCount")&&setTimeout(function(){NeoGV.hasResetUnseenCount||e.fire("folders:resetV2UnseenCount")},5e3),i.enabled("alerts")&&e.use("mail-controller-alertstore",function(e){e.mail.Controller.AlertStore.checkAlerts()}),e.on("showMobileGenericUpsell",function(t){e.use("mail-ui-onboarding-mobile-upsell-generic",function(e){e.mail.ui.onboarding.mobileUpsellGeneric.init(t)})}),i.enabled("mailLimit")&&(e.on("mail:invokeFetchFiltersBlockSenders",function(){e.fire("mail:fetchFiltersBlockSenders",{callback:t.updateMailLimitMarkup})}),e.on("closeOptions",function(){e.fire("mail:fetchFiltersBlockSenders",{callback:t.updateMailLimitMarkup})}),e.on("mail:updateMailLimitMarkup",t.updateMailLimitMarkup)),i.enabled("doUserSettingMigration")&&!i.enabled("hasAllUserSettingMigrated")&&setTimeout(function(){t.migrateUserSetting()},1e3),i.enabled("hasAllUserSettingMigrated")&&e.fire("util:ymstats",{name:"hasAllUserSettingMigrated",include:{farm:!0}})},setSmartViewMigrationUDB:function(){var t=this;e.fire("setUdbKey",{user_setting_migration:"smart_custom_view"},{success:function(){t.fireSmartViewMigrationStat("success","success")},failure:function(
){t.fireSmartViewMigrationStat("success","failure")}})},migrateSmartView:function(){i.enabled("doSmartCustomViewMigration")&&e.use("mail-api-migration-customviews",function(e){e.mail.api.migration.customviews.migrate().then(function(e){e})})},migrateUserSetting:function(){var t=this,n=s.value("userSettingMigrationUrl"),r=document.createElement("a"),u=o.getNamedLock("yoda-write");r.href=n,n=n+"?crumb="+window.escape(NeoConfig.crumb)+"&clientId=YMailNeo",u.lock(),setTimeout(function(){u.unlock()},3e3);if(!r.hostname||r.hostname!==window.location.hostname){(new Image).src=n,t.fireUserSettingMigrationStat({},"unknown","beacon"),t.migrateSmartView();return}e.io(n,{timeout:3e4,method:"GET",on:{complete:function(n,r){var s=r&&r.status===200;u.unlock(),t.fireUserSettingMigrationStat(r,s?"success":"failure","xhr"),i.enabled("doSmartCustomViewMigration")?e.use("mail-api-migration-customviews",function(e){e.mail.api.migration.customviews.migrate().then(function(e){s=s&&e,e||t.fireSmartViewMigrationStat("failure","notdone"),s&&t.userSettingRefreshDialog()})}):s&&t.userSettingRefreshDialog()}}})},fireUserSettingMigrationStat:function(t,n,r){e.fire("util:ymstats",{name:"do_usersetting_migration",tags:{result:n,status:t.status,statusText:t.statusText,reqType:r},include:{farm:!0}})},fireSmartViewMigrationStat:function(t,n){e.fire("util:ymstats",{name:"do_smartview_migration",tags:{result:t,setUdb:n},include:{farm:!0}})},userSettingRefreshDialog:function(){e.use("common-ui-dialog-helper",function(e){e.common.ui.DialogHelper.confirm({hd:e.common.Utils.substitute(strings.str_heartbeat_dialog_header,null,null,null,strings),bd:strings.str_heartbeat_dialog_body},{ok:{text:strings.str_heartbeat_btn_reload,handler:function(){NeoConfig.isWinApp?e.use("mail-ui-windows-helper",function(e){e.mail.ui.windows.helper.appNotify("mailRefresh")}):window.location.reload(!0)}},cancel:{text:strings.str_heartbeat_btn_later,handler:function(){}}})})},updateMailLimitMarkup:function(t){var n=e.one("body");if(!n)return;t.filters===!0?n.hasClass("mlF")||n.addClass("mlF"):t.filters===!1&&n.hasClass("mlF")&&n.removeClass("mlF"),t.blockSenders===!0?n.hasClass("mlB")||n.addClass("mlB"):t.blockSenders===!1&&n.hasClass("mlB")&&n.removeClass("mlB")},postLoadInit:function(){var n=this,i=n.getBandwidthMode();(t.isCorpmail||NeoConfig.enableWorkspacePostLoadV2)&&i!=="broadband"?e.use([t.hasConv?"minty_module_toolbar_inbox_message_thread":"minty_module_toolbar_inbox_message_fresh"]).then(e.use([t.hasConv?"mail-ui-convpane-read":"mail-ui-messagepane-read","mail-common-cachewarmer"])).then(e.use(r.composeDeps)).then(function(){n.postLoadInitCB()})["catch"](function(){n.postLoadInitCB()}):(e.use(r.composeDeps),n.postLoadInitCB())},onMailNavigateOut:function(){var t;document.activeElement&&document.activeElement.tagName.toLowerCase()!=="iframe"&&(e.fire("mail:navigateOut"),e.Lang.later(50,null,function(){t&&t.detach(),t=e.one("window").once("focus",function(){e.fire("mail:navigateIn")})}))},registerAdsOnNavigateOut:function(){var t=s.value("rotateAdsOnNavigateOutTimer"),n;i.enabled("rotateAdsOnNavigateOut")&&e.on("mail:navigateOut",function(){n=Date.now(),e.once("mail:navigateIn",function(){Date.now()-n>t&&e.fire("darla:show",{npv:!0}),e.fire("mbEvent:rotate",{source:"adboost"})})})}},1)},"1.0.0",{requires:["mail-ui-workspace-base","mail-common-utils-features","mail-persist-meta-data","mail-ui-folder-utils","mail-api-utility","common-net-sessionmgr","common-utils-onboarding"]});


YUI.add("mail-ui-workspace-rum",function e(t){function m(e,n,r,i){d&&t.fire("util:ymstats",{name:e,unit:n,type:r,dataum:i,tags:u,include:{farm:!0}})}function g(){var e=NeoConfig.launchPVID.replace(/[^a-zA-Z]/g,""),t=e.length,n,r="";for(n=8;n<t;n++)n%2===0&&(r+=e.charAt(n));return r}function y(e,t,n){d&&(n==="nav"?o.perf_navigationtime=2:n==="common"?(o.perf_commontime||(o.perf_commontime={}),o.perf_commontime.initialPageLoad||(o.perf_commontime.initialPageLoad={}),o.perf_commontime.initialPageLoad[e]=t):n==="user"&&(o.perf_usertime||(o.perf_usertime={}),o.perf_usertime.utm||(o.perf_usertime.utm={}),o.perf_usertime.utm[e]=t))}function b(){d&&(t.fire("mt:perf",{data:o}),o={})}function w(n,o){var u,a=0,f=0,l=0,c=0,h=0,p=0,d=0,g=0,w=0,E=0,S=0,x=0,T=0,N=0,C=0,k=0,L=0,A=0,O=0,M=0,_=0,D=0,P,H=r.length,B=i.length;if(!o){s.data=[],s.data.push(n),a=n.pageLoadTime,f=Math.round(n.aft),l=Math.round(n.visuallyComplete),u=n.httpRequests,c=n.resources.length,y("AFT",f,"common"),y("AFT1",f,"common"),y("PLT",a,"common"),y("VIC",l,"common");if(NeoGV&&NeoGV.ads)for(var j in NeoGV.ads)NeoGV.ads.hasOwnProperty(j)&&NeoGV.ads[j].nvLoadTime&&(y("AD_"+j,Math.round(NeoGV.ads[j].nvLoadTime),"user"),NeoGV.ads[j].nvSfLoadTime&&y("AD_"+j+"_SF",Math.round(NeoGV.ads[j].nvSfLoadTime),"user"));b(),m("mail_plt","ms","duration",a),m("mail_aft","ms","duration",f),m("mail_vic","ms","duration",l),m("mailhtreqs_onloadCached","requests","gauge",u.onloadCached),m("mailhtreqs_onloadCount","requests","gauge",u.onloadCount),m("mailhtreqs_vicCached","requests","gauge",u.cached),m("mailhtreqs_vicCount","requests","gauge",u.count);for(D=0;D<c;D+=1){P=n.resources[D];for(_=0;_<H;_+=1)P.url.indexOf(r[_])!==-1&&(g+=1,P.duration>0&&P.duration>h&&(h=P.duration),d+=P.duration>0?P.duration:0,P.durationFromNStart<=a&&(x+=1,P.duration>0&&P.duration>w&&(w=P.duration),S+=P.duration>0?P.duration:0));g>0&&(p=d/g),x>0&&(E=S/x);for(_=0;_<B;_+=1)P.url.indexOf(i[_])!==-1&&(k+=1,P.duration>0&&P.duration>T&&(T=P.duration),C+=P.duration>0?P.duration:0,P.durationFromNStart<=a&&(M+=1,P.duration>0&&P.duration>L&&(L=P.duration),O+=P.duration>0?P.duration:0));k>0&&(N=C/k),M>0&&(A=O/M)}m("mailycs_maxtimeVIC","ms","duration",h),m("mailycs_maxtimeOnload","ms","duration",w),m("mailycs_avgtimeVIC","ms","duration",p),m("mailycs_avgtimeOnload","ms","duration",E),m("mailbcn_maxtimeVIC","ms","duration",T),m("mailbcn_maxtimeOnload","ms","duration",L),m("mailbcn_avgtimeVIC","ms","duration",N),m("mailbcn_avgtimeOnload","ms","duration",A)}e.finished=!0,t.fire(v,e.finished)}var n={message_read:"message_read",message_send:"message_send",message_sendSave:"message_sendSave",message_list:"message_list",search_latency:"search_latency",AD_SKY:"AD_SKY",AD_WSKY:"AD_WSKY",AD_LREC:"AD_LREC",AFT:"AFT",VIC:"VIC",TL1:"TL1",MTTI:"MTTI",MTTC:"MTTC"},r=[".yimg.com"],i=["csc.beap","geo.yahoo","scorecard","ads.yahoo","beap.bc.yahoo","beap.adss.yahoo","lh.secure"],s=window.YAFT,o={},u,a=NeoConfig.bandwidthMode?NeoConfig.bandwidthMode:"broadband",f=t.UA.chrome?"chrome":"other",l=t.namespace("mail.ui.Rum"),c=window.performance,h=t.common.Utils,p=h.perf,d=h.features.enabled("lighthouse_beacon"),v="rum:yaftFinished";t.UA.ie?f="ie":t.UA.gecko?f="firefox":t.UA.safari&&(f="safari"),u={ua:f,bandwidth:a,isMailPlus:NeoConfig.hasAds?0:1},l.init=function(){function l(){return{farm:NeoConfig.farm,isForce:h.features.enabled("force"),feColo:NeoConfig.colo,mbColo:NeoConfig.mbColo,userColo:NeoConfig.ABOriginColo||"NA",country:NeoConfig.ipCountry,imapIn:!!NeoConfig.multipleAccounts,partner:!!NeoConfig.partnerType,plus:!NeoConfig.hasAds,corpmail:!!NeoConfig.isCorpmail}}function E(e,n){var r=l();r.mbColo&&r.userColo!=="NA"&&(r=t.merge(r,{key:e,value:n}),t.fire("SplunkLog","user_geo_postdata",r,"sample"))}function S(){var e=s.data[0]||{},n=c.timing||{},r=l();r.mbColo&&r.userColo!=="NA"&&(r=t.merge(r,{firstByte:n.responseStart-n.connectEnd,onLoad:n.loadEventStart-n.navigationStart,serverResp:n.responseEnd-n.requestStart,aft:Math.round(e.aft),domInt:n.domInteractive-n.navigationStart,msgList:o,mtti:u,mttc:a}),t.fire("SplunkLog","user_geo_data",r,"critical"))}var r=this,i={},o=null,u=null,a=null;if(s){i={modules:["shellnavigation-inner","storm-listnav","shellcontent","nav","yucs-top-bar","yucsHead","slot_","UH","games-widget"],modulesExclude:["yucs-",NeoConfig.ccAb&&g()||"slot_MB"],canShowVisualReport:NeoConfig.isInternal?1:0,useNativeStartRender:!0,maxWaitTime:2e3,generateHAR:!0},s.init(i,w);if(NeoGV&&NeoGV.ads)for(var f in NeoGV.ads)NeoGV.ads.hasOwnProperty(f)&&NeoGV.ads[f].nvLoadTime&&s.triggerCustomTiming("slot_"+f,"",NeoGV.ads[f].nvLoadTime)}NeoGV.hasSessionStorage&&(u=sessionStorage.getItem("MTTI"),a=sessionStorage.getItem("MTTC"),o=sessionStorage.getItem("lh_msglist")),d?(c&&c.timing&&c.timing.loadEventEnd?(y("","","nav"),b()):window.addEventListener("load",function(){y("","","nav"),b()},!1),u!==null&&(y(n.MTTI,u,"user"),m("mail_mtti","ms","duration",u),sessionStorage.removeItem("MTTI")),a!==null&&(y(n.MTTC,a,"user"),m("mail_mttc","ms","duration",a),sessionStorage.removeItem("MTTC")),o!==null&&(y(n.message_list,o,"user"),m("mail_mttmsglist","ms","duration",o),sessionStorage.removeItem("lh_msglist")),(u!==null||a!==null||o!==null)&&b(),t.on("MessagePane:inception",function(){r.stopwatch=Date.now()}),t.on("MessagePane:rendered",function(e,t,i,s,o){var u;r.stopwatch&&(u=Date.now()-r.stopwatch,y(n.message_read,u,"user"),m("mail_mttmsgread","ms","duration",u),E(n.message_read,u),b(),r.stopwatch=null)}),t.on("SentStart",function(){r.sentwatch=Date.now()}),t.on("SentSuccess",function(e,t,i){var s;r.sentwatch&&(s=Date.now()-r.sentwatch,i=n[i]||n.message_send,y(i,s,"user"),m("mail_mttmsgsend","ms","duration",s),i===n.message_send&&E(i,s),b(),r.sentwatch=null)}),t.on("lhStat:feature_latency",function(e){var t,r;e&&e.message&&e.duration&&(t=e.duration,r=e.message,y(n[r],t,"user"),r===n.search_latency&&E(r,t),b())})):(e.finished=!0,t.fire(v,e.finished)),p.supportsMemory()&&h.features.enabled("perfMemoryLogging")&&(h.createPoll
({sec:600},function(){var n=t.mix({hasAds:NeoConfig.hasAds},p.sessionMemory());t.fire("SplunkLog","perf_mem_log",n,"critical")})(),t.on("MessagePane:inception",function(){p.startMeasurement("render_msg")}),t.on("MessagePane:rendered",function(){var e=p.endMeasurement("render_msg"),n;e&&(n=p.sessionMemory(),n.timing=e,t.fire("SplunkLog","message_open_latency",n,"info"))}),t.on(["LM:complete","LFT:complete"],function(){p.startMeasurement("folder_render")}),t.on("FolderRender:complete",function(){var e=p.endMeasurement("folder_render"),n;e&&(n=p.sessionMemory(),n.timing=e,t.fire("SplunkLog","folder_render_latency",n,"info"))})),c&&c.now&&h.features.enabled("perfCPULogging")&&NeoConfig.mailEnv!=="dev"&&t.use("mail-ui-workspace-rum-cpu"),t.once(v,function(){NeoConfig.ABOriginColo?S():t.once("contacts:api:origincolo",function(){S()})})},l.yaftFinished=function(n){e.finished===undefined?t.once(v,function(){n(e.finished)}):n(e.finished)}},"1.0.0",{requires:["event","mail-common-utils-features","common-utils","common-utils-performance"]});


YUI.add("mail-ui-factory-base",function(e){function r(t){var n=e,r,i,s=t.split("."),o=s.length;for(i=0;i<o;i++)i===o-1?r=s[i]:n=n[s[i]];return[n,r]}function i(e,t){if(!e||!t)return;var i=r(e),s=i[0],u=i[1],a;s[u]&&s[u]!==t&&(e in n||(n[e]=s[u]),a=s[u],s[u]=t,o(e,t,a))}function s(e){if(e&&e in n){var t=r(e),i=t[0],s=t[1],u,a;u=i[s],i[s]=n[e],a=i[s],a!==u&&o(e,a,u)}}function o(e,n,r){t.fire("uifactory:change",{ns:e,newCtor:n,oldCtor:r})}e.namespace("mail.ui");var t=e.mail.ui.Factory={},n={};e.augment(t,e.EventTarget),e.mix(t,{register:i,unregister:s})},"1.0.0");


YUI.add("mail-ui-basewidget",function(e){var t="Neo",n=":",r=function(n){var r=this;n||(n={}),r.prefix=n.prefix||t,r.emitFacade=n.emitFacade||!0,e.EventTarget.call(r,{emitFacade:r.emitFacade})};r.prototype.constructor=r;var i={_getEventName:function(e,t){var r=this,i=r.prefix;return t||(t=r),t.NAME&&(i=t.NAME),t.constructor&&t.constructor.NAME&&(i=t.constructor.NAME),{ev:i+n+e,name:i,type:e}},neoEvent:function(t,n){var r=this,i=e.Lang.isObject(n)?n:{},s=r.prefix,o=r,u;return n.context&&(o=n.context),n.addTarget===1&&o.addTarget(e),u=r._getEventName(t,o),s=u.name,i.prefix=s,i.emitFacade=r.emitFacade,r.publish(u.ev,i)},neoFire:function(e){var t=this,n=Array.prototype.slice.call(arguments);return n[0]=t._getEventName(e).ev,t.fire.apply(t,n)}};r.prototype=i,e.mix(r,e.EventTarget,!1,null,1),e.namespace("common.Utils.event"),e.common.Utils.event=r;var s=function(e){var t=this;s.superclass.constructor.call(t,e),t.NAME||(t.NAME="BaseWidget")};e.extend(s,e.common.ui.ContentWidget),e.augment(s,e.common.Utils.event),e.namespace("mail.ui").BaseWidget=s},"1.0.0",{requires:["common-ui-contentwidget"]});


YUI.add("mail-ui-header",function(e){var t=e.common.Utils.substitute,n=e.common.persist.UserData,r=e.common.Utils,i=e.mail.ui.headerUtils,s=function(){};e.extend(s,e.mail.ui.HeaderBase),e.mix(s.prototype,{omModifiedHeaderMenuFlag:!1,omMenuObj:{},omModifiedOptionsMenuFlag:!1,omOptionsMenuObj:{},calAddedOptionsMenuFlag:!1,calOptionsMenuObj:null,render:function(){var t=this,n,s,o=!1,u=e.one("#yucs-signout")||e.one("#yuhead-me-signout")||e.one("#yucs .yucs-signout"),a=e.one("#yucs-profile-panel"),f=a.one("#yucs-fs-mobile-upsell"),l=a.one("#yucs-fs-mobile-upsell-image"),c=a.one("#yucs-fs-mobile-upsell-hd"),h=a.one("#yucs-fs-mobile-upsell-bd"),p=a.one("#yucs-fs-mobile-upsell-link"),d={"font-size":"13px",color:"#444444","line-height":"16px","font-weight":"normal","text-align":"center"};e.on("menu:config",t.setUhMenuConfig,t),e.on("change:username",t.setUhUsername),e.on("search:config",t.setSearchBtnText);var v=!1,m=!1;e.Global.on("ucs:userMenuShow",function(){var t=this;if(t.omModifiedHeaderMenuFlag||!v){var n=new e.EventTarget;n.publish("ucs:userMenuItems",{broadcast:2,emitFacade:!0});var r=[],i=[],s,o,u,a,f=!0;if(t.omMenuObj&&t.omMenuObj.length){for(var l=0;a<t.omMenuObj.length;l++)u=t.omMenuObj[l],u.icon["class"]!=="signout"&&u.data_action.search("offline")===-1&&(o={menuText:u.label,actionType:"customEvent",actionData:u.data_action,icon:u.icon["class"].substr(5),isActive:u.selected},i.push(o),f&&u.selected&&(f=!1));r.push(i);for(var c=0;a<t.omMenuObj.length;c++){u=t.omMenuObj[c];if(u.icon["class"]==="signout"||u.data_action.search("offline")>-1)s=[{menuText:u.label,actionType:"customEvent",actionData:u.data_action,isDisabled:f}],r.push(s)}}if((e.common.Utils.features.enabled("isUserDataMigrated")||NeoConfig.forceToV3UserSetting)&&NeoConfig.allMailboxes&&Array.isArray(NeoConfig.allMailboxes)){var h=NeoConfig.allMailboxes.filter(function(e){return e.id!==NeoConfig.V3MailboxId}).map(function(e){var t=e.type==="BIZMAIL"?"|isBizmail":"";return{menuText:e.email,actionType:"customEvent",actionData:"mailbox|"+e.id+t,highlightDisable:!0,isDisabled:!1}});r.push(h)}else if(NeoConfig.userDataObj&&NeoConfig.userDataObj.otherYahooMboxes&&NeoConfig.userDataObj.otherYahooMboxes.otherYahooMboxesTotal){var p=NeoConfig.userDataObj.otherYahooMboxes.otherYahooMboxesTotal,d=NeoConfig.userDataObj.otherYahooMboxes.yMbox,m=[];for(a=0;a<p;a++)s={menuText:d[a].email,actionType:"customEvent",actionData:"bizmail|"+a,highlightDisable:!0,isDisabled:!1},m.push(s);r.push(m)}n.fire("ucs:userMenuItems",{menuGroups:r,reset:!0}),v=!0,t.omModifiedHeaderMenuFlag=!1}},t),e.Global.on("ucs:userMenuItemClick",function(e){var t=e.actionData.split("|");i.handleUHMenus({dataAction:t[0],uhArgs:t})}),e.Global.once("ucs:helpDebugMenuShow",function(){e.use("mail-debug",function(e){t.setUhDropdown(t,"_shared_module_offscreen_bin_menus_debug",e.mail.Debug.getDebugMenuObj,"ucs:helpDebugMenuItems");if(NeoConfig.isInternalIP!==1){var n=e.one("#yuhead-help-panel");n.removeChild(n._node.lastChild)}})}),e.Global.on("ucs:helpDebugMenuItemClick",function(t){e.use("mail-debug",function(e){e.mail.Debug.handleDebugOption({dataAction:t.actionData})})}),e.Global.on("ucs:utilityMenuShow",function(){if(t.omModifiedOptionsMenuFlag||!m||t.calAddedOptionsMenuFlag){var e="_shared_module_offscreen_bin_menus_options_fresh";t.setUhDropdown(t,e,i.getOptionsMenuObj,"ucs:utilityMenuItems",{omOptionsMenuObj:t.omOptionsMenuObj,calOptions:t.calOptionsMenuObj},i.logOptionsLinkViews);if(t.omModifiedOptionsMenuFlag||!m)t.omModifiedOptionsMenuFlag=!1,m=!0;t.calAddedOptionsMenuFlag&&(t.calAddedOptionsMenuFlag=!1)}else i.logOptionsLinkViews()}),e.Global.on("ucs:utilityMenuItemClick",function(e){i.handleUHMenus({dataAction:e.actionData})}),e.Global.on("ucs:logoDebug",function(e){i.showDialogBox({altKey:!0,preventDefault:function(){}})});var g=e.mail.persist.MetaData,y="neo.pref.genericUpsell.signout";u&&NeoConfig.isRecentMobileUser!==1&&(NeoConfig.accounts.imapInAccounts&&NeoConfig.accounts.imapInAccounts.length>0&&r.features.enabled("mobileUpsellGenericSignoutImapIn")||r.getSegmentData("imap").currSegScore!==-1&&r.features.enabled("mobileUpsellGenericSignoutImap")||r.features.enabled("mobileUpsellGenericSignout"))&&!g.get(y)&&u.once("click",function(t){t.halt(),g.set(y,1),e.fire("showMobileGenericUpsell",{onCancel:function(){e.mail.ui.Workspace.signout()},showSignOutBtn:1})});if(r.features.enabled("alternateSignoutOverview")&&NeoConfig.isRecentMobileUser!==1&&u){var b=r.parseQueryString(u.getAttribute("href")),w=r.settings.value("alternateSignout");b[".done"]=r.settings.value("overviewSignoutUrl")+"v="+w,u.setAttribute("href",r.mergeQueryString(u.getAttribute("href"),b))}f&&c&&h&&p&&!NeoConfig.isRecentMobileUser&&(r.features.enabled("mobileUpsellGenericUH")||r.features.enabled("mobileUpsellGenericUHImapIn")&&NeoConfig.accounts&&NeoConfig.accounts.imapInAccounts)&&(n=e.Node.create("<i>"),n.addClass("Va(m) W(a) Lh(1) Mx(10px) C(#8d919d)"),c.setStyles(d),h.setStyles(d),h.setStyles({"padding-right":"5px",display:"inline"}),f.setStyles({"text-align":"center"}),p.setStyles({display:"inline",cursor:"pointer"}),c.setHTML(r.ezSub(strings.str_mobile_upsell_mobileUpsellGetAppUH_header,null,null,strings)),h.setHTML(r.ezSub(strings.str_mobile_upsell_mobileUpsellGetAppUH_body,null,null,strings)),e.one("#yucs-fs-mobile-upsell-link a").setHTML(r.ezSub(strings.str_mobile_upsell_mobileUpsellGetAppUH_link,null,null,strings)),f.removeClass("D\\(n\\)"),p.on("click",function(t){t.halt(),e.fire("showMobileGenericUpsell",{source:"account-switch-menu"})})),e.Global.on("ucs:signout",function(t){e.fire("util:ymstats",{name:"ucs_signOut",tags:{intl:NeoConfig.intl,currentSegScore:r.getSegmentData("webMail").currSegScore},include:{bucket:r.features.enabled("alternateSignoutOverview")}}),r.features.enabled("alternateSignoutOverview")&&NeoConfig.isRecentMobileUser!==1&&e.fire("mt:click",{action:"uh_signout_lnk"}),e.fire("signout"),e.Cookie.remove("YM.MAILBOXV3",{path:"/",domain:NeoConfig.cookieDomain}),e.Cookie
.remove("YM.BM",{path:"/",domain:"mail.yahoo.com"})}),NeoConfig.isCorpmail&&(corpsignout(e),e.all(".yucs-profile-items-panel a").each(function(e){var t=e.getAttribute("href");if(t.indexOf("profile")!==-1||t.indexOf("edit")!==-1)e.ancestor().setAttribute("style","display:none;"),o=!0}),o&&e.one(".yucs-profile-items-panel .yucs-separator").setAttribute("style","display:none;")),this.rendered=1,e.fire("header:rendered")},setSearchBtnText:function(e){if(!window.ucs)return;var t=ucs.UhSearchInterface.setVertSearchBtnText;!e.mode||e.mode==="default"?t(strings.str_uh_searchmail):t(e.searchLabel)},setUhUsername:function(){if(NeoConfig.isBizmail){var t=r.escapeHtml(n.get("userSendPref.defaultFromAddress"));e.Lang.later(0,null,function(){var n=new e.EventTarget;n.publish("ucs:userNameChange",{broadcast:2,emitFacade:!0}),n.fire("ucs:userNameChange",{username:t})})}},setUhMenuConfig:function(e,t,n){n=n||this;switch(e.id){case"btn-uh-account":n.omModifiedHeaderMenuFlag=!0,n.omMenuObj=t,n.setUhOpiStatus(e.icon["class"].substr(5));break;case"btn-options":n.omModifiedOptionsMenuFlag=!0,n.omOptionsMenuObj=t;break;case"btn-caloptions":n.calAddedOptionsMenuFlag=!0,n.calOptionsMenuObj=t}},setUhOpiStatus:function(t){var n=new e.EventTarget;n.name="ucs",n.publish("ucs:opiUpdateStatus",{broadcast:2,emitFacade:!0}),n.fire("ucs:opiUpdateStatus",{opiStatus:t})},setUhDropdown:function(n,r,i,s,o,u){o=o||{},e.use(r,function(e){var a=e.ui.Templates[r],f=i(a,o),l;NeoConfig.isCorpmail?(f.upgrade=!1,f.om_options=!1,f.account_info=!1):f.account_info=!0,l=t(a.base,f,{},null,strings);var c=n.getMenuGroupsFromMarkup(l),h=new e.EventTarget;h.publish(s,{broadcast:2,emitFacade:!0}),h.fire(s,{menuGroups:c,reset:!0}),u&&u()})},getMenuGroupsFromMarkup:function(t){var n=/<ul(.*?)<\/ul>/gm,i=/<li(.*?)<\/li>/gm,s=/data-action=(.)(.*?)\1.*?>\s*<a\s*href=(.)(.*?)\3\s*title=(.)(.*?)\5\s*>(.*?)<\/a>/,o=/data-action=(.)(.*?)\1.*?>\s*<a\s*href=(.)(.*?)\3\s*>(.*?)<\/a>/,u,a,f,l,c,h=[];while(u=n.exec(t)){l=u[0];var p=[];while(a=i.exec(l)){c=a[0],f=s.exec(c)||o.exec(c);if(f){var d=f[2],v=f[4],m=f[f.length-1],g={menuText:m};switch(d){case"upgrade":g.actionType="link",g.url=v,g.target="_blank";break;case"help":r.features.enabled("inProductHelp")?g.actionType="customEvent":(g.actionType="link",g.url=v,g.target="_blank");break;case"help_upgrade":case"fullmail":case"feedback":case"legal":case"privacy":case"ads":case"copyright":case"link":case"tumblr":g.actionType="link",g.url=v,g.target="_blank";break;default:g.actionType="customEvent"}d==="fullmail"&&(g.target="_self"),g.actionData=d,p.push(g)}}!e.common.Utils.isEmpty(p)&&h.push(p)}return h},showMobilizer:function(t){t.preventDefault(),e.use("mobilizer",function(){YMobilizer.load({app:"mail.new",lang:NeoConfig.lang,proxy:NeoConfig.launch_protocol+window.location.host+"/"+NeoConfig.scriptBase+"/mobilizer_proxy.html"})})}},!0),e.namespace("mail.ui.Header"),e.mail.ui.Header=new s,e.namespace("test.Header"),e.mix(e.test.Header,{headerObj:e.mail.ui.Header,setUhMenuConfig:e.mail.ui.Header.setUhMenuConfig,getOmMenuObj:function(){return e.mail.ui.Header.omMenuObj},setUhOpiStatus:e.mail.ui.Header.setUhOpiStatus,setUhDropdown:e.mail.ui.Header.setUhDropdown,getMenuGroupsFromMarkup:e.mail.ui.Header.getMenuGroupsFromMarkup,getHelpMenuObj:i.getHelpMenuObj,getOptionsMenuObj:i.getOptionsMenuObj,showDialogBox:i.showDialogBox,showMobilizer:e.mail.ui.Header.showMobilizer,handleUHMenus:i.handleUHMenus,switchToBizmailAcct:i.switchToBizmailAcct})},"1.0.0",{requires:["node","mail-ui-header-base","mail-ui-header-utils","common-utils","common-persist-user-data"]});


YUI.add("mail-ui-header-base",function(e){var t=function(){};t.prototype={render:function(){},bindUI:function(){}},e.namespace("mail.ui.HeaderBase"),e.mail.ui.HeaderBase=t},"1.0.0");


YUI.add("mail-ui-header-utils",function(e){var t=e.common.Utils,n=t.substitute,r={getHelpMenuObj:function(e){var n={send_feedback_menu:strings.str_tog_sendFeedbackEnabled?e.send_feedback_menu:"",report_problem_url:NeoConfig.stormUserVoice,report_problem:NeoConfig.strings.reportProblem,upgrade:strings.str_cfg_tog_mailUpgradeEnabled&&NeoConfig.isBizmail!=="1"?e.upgrade:"",adfree:"",ads:strings.str_cfg_tog_aboutOurAdsEnabled?e.ads:"",copyright:strings.str_cfg_tog_disableCopyrightLink?"":e.copyright,tos_url:"atos",return_to_original:NeoConfig.hideReturnLink!=="1"?e.return_to_original:"",get_the_app:t.features.enabled("mobileUpsellGetApp")?e.get_the_app:"",new_in_mail:t.features.enabled("uhTumblrLink")?e.new_in_mail:"",switch_to_full:NeoConfig.low_bandwidth?e.switch_to_full:"",full_mail_url:"/"+NeoConfig.scriptBase+"/launch?full=1",new_feature_url:NeoConfig.newFeatureURL,str_menu_privacy_policy:strings.str_menu_privacy_policy,mailpro:""};return NeoConfig.partnerType==="sky"&&(n.send_feedback_menu=""),NeoConfig.deprecateMailPlus&&strings.str_cfg_tog_mailUpgradeEnabled&&NeoConfig.isBizmail!=="1"&&(n.upgrade="",t.features.enabled("mailProEligible")?n.mailpro=e.mailpro:n.adfree=e.adfree),n.send_feedback_menu=NeoConfig.stormUserVoice?n.send_feedback_menu:"",n.hide_help_ul=n.send_feedback_menu||n.return_to_original||n.switch_to_full?"":e.hide_help_ul,NeoConfig.intl==="us"&&NeoConfig.lang==="ko-KR"&&(n.str_cfg_url_tos="http://info.yahoo.com/legal/us/yahoo/utos/ko-kr/",n.str_cfg_url_copyright="http://info.yahoo.com/legal/us/yahoo/copyright/ko-kr/"),n},getOptionsMenuObj:function(i,s){var o=s.omOptionsMenuObj,u={},a=s.calOptions,f,l={url_minty_options:"#",url:i.url,cal_options:"",om_options:"",upgrade:"",adfree:""};strings.str_cfg_tog_mailUpgradeEnabled&&NeoConfig.isBizmail!=="1"&&(NeoConfig.deprecateMailPlus&&!NeoConfig.isEmailOrPhoneReg?(l.upgrade="",t.features.enabled("mailProEligible")||(l.adfree=n(i.adfree,{adfree_service_payment_url:t.settings.value("adfree_service_payment_url")},0,0,strings))):(l.upgrade=i.upgrade,l.adfree=""));if(o)for(f=0;f<o.length;f++)u={data_action:o[f].data_action,title:o[f].title,label:o[f].label,id:o[f].id},l.om_options+=n(i.om_options,u,0,0,strings);return a&&(l.cal_options+=n(i.cal_options,u,0,0,strings)),l=e.mix(l,r.getHelpMenuObj(i)),l},showDialogBox:function(n){n.preventDefault();if(n.altKey){if(typeof NeoConfig=="undefined")return;var r=["Neo Version: \n","Build number: ",NeoConfig.buildNumber,"\n","Feature Version: ",t.settings.value("featureFlipperVersion"),"\n","Build time: ",NeoConfig.buildTime,"\n","Build: ",NeoConfig.git_branch,"\n \n","SHA Hash: ",NeoConfig.git_hash,"\n \n","Hostname: ",NeoConfig.hostName||window.location.hostname];NeoConfig.expBucketId!=="0"&&r.push("\n \nBucket: "+NeoConfig.expBucketId),NeoConfig.isWinApp&&r.push("\n \nWindows Build Version: "+NeoGV.winAppVersion),e.use("common-ui-dialog-helper",function(e){var t=e.common.ui.DialogHelper;t.alert({modal_classes:"lg",hd:"Version",bd:"<pre>"+r.join("")+"</pre>"+'<button onclick=yui.fire("printLog")>Show Client Log</button> <button onclick=yui.fire("printWaterfall")>Show Waterfall</button> <button onclick=yui.fire("printHAR")>Show HAR</button>'})})}else yui.fire("openInbox")},handleUHMenus:function(n,r){var i=r||this,s=n.dataAction,o="uh_"+s+"_lnk";switch(s){case"help_upgrade":case"fullmail":case"feedback":case"legal":case"privacy":case"ads":case"copyright":case"link":e.fire("mt:click",{action:o});break;case"upgrade":e.fire("util:ymstats",{name:"ad_free_mail_click"});break;case"help":t.features.enabled("inProductHelp")&&e.use("mail-ui-inhelp",function(e){e.mail.ui.InProductHelpView.showHelp()}),e.fire("darlaEvent",{action:"help_dd_click_"+s}),e.fire("mt:click",{action:o});break;case"options":t.perf.startMeasurement("UH_open_options"),e.fire("openOptions",{origin:"UH"}),e.fire("mt:click",{action:o});break;case"Calendar_options":if(!e.calendar)break;e.fire("openCalendar"),e.fire("calendarOptions",this),e.fire("mt:click",{action:o});break;case"themes":e.use("mail-ui-themes",function(e){e.mail.ui.Themes.showThemesDialog()}),e.fire("mt:click",{action:o});break;case"bizmail":var u=n.uhArgs&&n.uhArgs[1]||n.item._node.getAttribute("data-index");i.switchToBizmailAcct(u);break;case"mailbox":var a=n.uhArgs&&n.uhArgs[1]||n.item._node.getAttribute("data-index"),f=!!n.uhArgs&&!!n.uhArgs[2]&&n.uhArgs[2]==="isBizmail";i.switchToMailBox(a,f);break;case"keys":e.use("mail-ui-shortcuts-dialog",function(e){e.mail.ui.ShortcutsDialog.show()});break;case"getApp":e.fire("showMobileGenericUpsell",{source:"settings"});break;default:}},switchToMailBox:function(t,n){e.Cookie.setSubs("YM.MAILBOXV3",{mailbox:t,bizmail:n},{path:"/",domain:NeoConfig.cookieDomain}),e.Cookie.remove("YM.BM",{path:"/",domain:"mail.yahoo.com"}),window.location.reload(!0)},switchToBizmailAcct:function(t){var n=NeoConfig.userDataObj.otherYahooMboxes.yMbox[t],r=n.email.split("@"),i=n.isBizmail,s,o={domain:r[1],sid:n.sledid,silo:n.silo,account:r[0],farm:n.farm};window.onBeforeUnloadBizMail=function(){i?e.Cookie.setSubs("YM.BM",o,{path:"/",domain:"mail.yahoo.com"}):(e.Cookie.remove("YM.BM",{path:"/",domain:"mail.yahoo.com"}),e.Cookie.remove("YM.MAILBOXV3",{path:"/",domain:NeoConfig.cookieDomain}),e.Cookie.remove("YM.MAILBOXV3",{path:"/",domain:"mail.yahoo.com"}))},n.url?s=n.url:s="https://mail.yahoo.com",document.location.replace(s)},logOptionsLinkViews:function(){e.fire("mt:view",{action:"options_menu"})}};e.namespace("mail.ui.headerUtils"),e.mail.ui.headerUtils=r},"1.0.0",{requires:["common-utils","common-persist-user-data","mail-common-utils-settings","common-utils-performance"]});


YUI.add("mail-common-lowbandwidth",function(e){function t(){if(e.Cookie.get("YM.NEO_LITE")===null){var t=e.common.persist.NeoData,n=new Date;n.setDate(n.getDate()+30),e.Cookie.set("YM.NEO_LITE","1",{path:t.get("cookiePath"),domain:t.get("cookieDomain"),expires:n})}}e.namespace("mail.common"),e.namespace("mail.common.LowBandwidth"),e.mix(e.mail.common.LowBandwidth,{setLWCookie:t})},"1.0.0",{requires:["node"]});


YUI.add("mail-controller-tictacs",function(e){function r(t,r,i){return e.use(r).then(function(e){e.Array.each(r,function(t){var r=NeoConfig.tictacsClientConf[n][t].name;if(!e.Tictac[r]||!e.Tictac[r].loader)return;try{e.Tictac[r].loader.apply(null,i)}catch(s){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-tictacs:1",s,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-tictacs:1")}}),e.fire("tictacs-loaded:"+t)})}var t=function(){},n;e.mix(t.prototype,{init:function(){var t,i,s,o=NeoConfig.isAMT||!!NeoConfig.isInternal||!!NeoConfig.isInternalIP;i={};if(!NeoConfig.tictac)return;for(t in NeoConfig.tictacsClientConf)if(NeoConfig.tictacsClientConf.hasOwnProperty(t)){n=t,s=NeoConfig.tictacsClientConf[t];break}e.Object.each(s,function(e,t){var n=e.event;if(!n)return;if(!o||window.location.search.indexOf(e.name+"=0")===-1)i[n]||(i[n]=[]),i[n].push(t)}),e.Object.each(i,function(t,n){n==="load"?r("load",t,[]):e.after(n,function(){r(n,t,arguments)})})},loadTictac:function(e){var t=[].slice.call(arguments,1);return r(e,[e],t)}}),e.namespace("mail.ui"),e.mail.ui.Tictacs=new t});


YUI.add("mail-ui-button-ctxt",function(e){function h(){var e=NeoConfig.launchPVID.replace(/[^a-zA-Z]/g,""),t=e.length,n,r="";for(n=8;n<t;n++)n%2===0&&(r+=e.charAt(n));return r}function p(e,t){var n=m(e),r;c.features.enabled("mbListNativeView")?(r=v(e),r&&t===i?(e.replaceClass(n,s),e.removeClass("msgChecked")):d(e,n,t)):d(e,n,t)}function d(e,t,n){t?n?e.replaceClass(t,n):e.removeClass(t):e.addClass(n),n===i?e.removeClass("msgChecked"):e.addClass("msgChecked")}function v(e){if(!NeoGV.mbToggle){var t=e.ancestor("#shellinner"),n=NeoConfig.ccAb&&"#"+h()||"#slot_MB";if(t){var r=t.one(n+" .cbox .mb-checkbox");if(r)return r.get("checked")}}}function m(e){var t,n;for(t=0;t<l;++t){n=f[t];if(e.hasClass(n))return n}return null}function g(t){var f=t.node||t.item,l=t.root,h=t.action,p;if(!f||!l)return!1;f.get("tagName")==="A"&&(f=f.get("parentNode"));if(f.hasClass(a))return!1;p=m(l);switch(p){case i:if(f.hasClass(n)||f.hasClass(r))return!1;break;case o:if(f.hasClass(n))return!1;break;case u:case s:if(c.features.enabled("mbListNativeView")){var d=e.mail.Tabs.getActiveTab().get("widget").type;if(d==="convlist"||d==="messagelist")if(h!=="delete"&&v(l))return!1}if(NeoConfig.convReplyBtnsInTlbr&&(h==="reply_sender"||h==="reply_all"||h==="forward")&&l.hasClass("disableReplyGroup"))return!1}return!0}function y(t,n){var r={"folder-empty-spam":"%40B%40Bulk","folder-empty-trash":"Trash"},i=r[t],s;i&&(n=e.one('#storm-listnav li.sysfolder[data-fid="'+i+'"]')),n&&(s=m(n));if(s)switch(t){case"folder-allread":case"folder-empty":case"folder-empty-spam":case"folder-empty-trash":return s===o}return!0}function b(e,n){var r=this,a=i;n=n?n:!1,e>1?a=o:n?a=u:e===1&&(a=s),r.get(t)!==a&&r.set(t,a)}function w(t){var n=t.node,r=n.get("parentNode"),s=n.get("id").replace("btn-","menu-"),o=e.one("#"+s),u=m(r)||i;o&&(r&&r.hasClass("disableReplyGroup")?o.addClass("list-checked"):o.removeClass("list-checked")),p(o,u)}function E(){var t,n=e.one("#menu-msglist"),r=e.one("#pagetoolbar");n&&r&&(t=m(r)||i,p(n,t))}function S(e,t){var n=this,r;e&&t&&(r=m(e)||i,p(t,r)),NeoConfig.tog_empty_folders||n.patchFolderMenu(t)}function x(t){var n,r=["spam","trash"],s,o,u;for(n in r)s=e.one("#storm-listnav li."+r[n]),s&&t&&(o=t.one('li[data-action="folder-empty-'+r[n]+'"]'),o&&(u=m(s)||i,p(o,u)))}function T(n){var r=this;T.superclass.constructor.call(r,n),r._evts.push(e.on("listItemSelect",function(e){e&&r.setButtonContext(e.total)})),r.addAttrs({BUTTON_CTXT_ATTR:{}}),r._evts.push(r.on(t+"Change",function(e){var t=this.root;t&&(p(t,e.newVal),e.newVal!=="hasnomsg"?t.one(".multimsg").setAttribute("tabindex",0):t.all(".multimsg").setAttribute("tabindex",-1))}))}var t="buttonContext",n="onemsg",r="multimsg",i="hasnomsg",s="hasonemsg",o="hasmultimsg",u="hasthreadmsg",a="disabled",f=[i,s,o,u],l=f.length,c=e.common.Utils;e.extend(T,e.mail.ui.Toolbar,{buttonEnabled:g,setNodeButtonMenu:w,setButtonContext:b}),e.namespace("mail.ui").Toolbar=T,e.namespace("mail.ui").ContextButton={setNodeMessageListMenu:E,setNodeFolderMenu:S,patchFolderMenu:x,folderActionEnabled:y,buttonEnabled:g}},"1.0.0",{requires:["common-ui-toolbar-base","mail-common-utils-features"]});


YUI.add("ymma-stats",function(e){function l(){this._bind()}var t=e.common.Utils,n=t.features,r=null,i={},s,o,u=NeoConfig.statThrottlePct,a,f="yid="+NeoConfig.loginId;NeoConfig.stat&&(r=new t.NetworkQueue(t.settings.value("statEndpoint"),{type:"string",onFailure:function(){t.ymmastats._sendStat({name:"yamas_stat_call_failure"})},retries:0})),e.mix(l.prototype,{setKey:function(t,n){typeof t=="object"&&e.mix(i,t,!0),typeof t=="string"&&(i[t]=n)},getKey:function(e){return i[e]},stat:function(e,t,i,o,a){if(n.enabled("autoCheckNetwork")&&!NeoGV.isOnline)return;if(!NeoConfig.stat||!u)return;i=i?i:"blocks",o=o?o:"counter",a=a?a:"1";if(o==="duration"&&(a>6e4||a<0))return!1;o==="counter"&&(a*=100/u);if(e==="ue_client_error"||e==="webservice_latency")t+=",mlcluster="+NeoConfig.cluster;t?t+=",":t="",t.indexOf("colo")===-1?t+="colo="+NeoConfig.colo+","+f:t+=f,t.indexOf("ymreqid")===-1&&(t+=",ymreqid="+NeoConfig.uuid),s=e+"~"+i+"~"+o+"~"+a+"~"+t,r&&r.add(s)},_sendStat:function(t){var n=this,r=[],i;t&&(t.tags||(t.tags={}),i=t.include,i&&(i.bucket&&(t.tags.bkt=NeoConfig.expBucketId),i.env&&(t.tags.env=NeoConfig.mailEnv),i.farm&&(t.tags.farm=NeoConfig.farm?NeoConfig.farm.substr(1):"xxxx")),e.Object.each(t.tags,function(e,t){e=n._sanitizeDimensions(e),r.push(t+"="+e)},n),r.length>6&&(r=r.slice(0,6)),r=r.join(","),t.name&&typeof t.name.replace=="function"&&(t.name=t.name.replace(/[^a-zA-Z0-9]/g,"_")),t.unit?n.stat(t.name,r,t.unit,t.type,t.dataum):n.stat(t.name,r))},_sanitizeDimensions:function(e){return e&&typeof e.replace=="function"&&(e=e.replace(/[^a-zA-Z0-9.-]/g,"_")),typeof e=="number"&&e.toString().length>9&&!isNaN(Date.parse(new Date(e)))&&(e="containsTimestamp"),e},_sendLaunchStats:function(){var t=[],n=[],i,s,o,u,a,f,l=this;t=NeoConfig.launchStats,e.Array.each(t,function(e){if(!e)return;n=e.split("~"),i=n[0],o=n[1],u=n[2],a=u==="counter"?1:n[3],s=n[4],s&&(s=l._convertToObject(s)),f={name:i,tags:s,unit:o,type:u,datum:a},this._sendStat(f)},this),r&&r.flush()},_getTags:function(t,n){var r=[],i={message:{value:1},tae:{value:1},api:{value:1},visible:{value:"yes"},iscorpmail:{value:!!NeoConfig.isCorpmail},intl:{value:NeoConfig.intl},bkt:{value:NeoConfig.expBucketId},farm:{value:NeoConfig.farm?NeoConfig.farm.substr(1):"xxxx"},env:{value:NeoConfig.mailEnv},hasMultiple:{value:NeoConfig.multipleAccounts}};for(var s=0;s<t.length;s++)if(n[t[s]])r.push(t[s]+"="+n[t[s]]);else{if(!e.Lang.isObject(i[t[s]]))return!1;r.push(t[s]+"="+this._sanitizeDimensions(i[t[s]].value))}return r.join(",")},_fireStat:function(e,t,n,r){var i=this,s,o;s={name:e,tags:i._getTags(t,n),unit:r?"ms":"",type:r?"duration":"",dataum:r?n.value:""},s.tags&&(o=i._convertToObject(s.tags),s.tags=o),i._sendStat(s)},_convertToObject:function(e){var t,n=e.split(",");return t=n.reduce(function(e,t){var n=t.split("="),r=n[0],i=n[1];return e[r]=i,e},{}),t},_fireFeatureStatWin10:function(e,t,n){this._fireStat(e,t,n),NeoConfig.isWinApp&&this._fireStat(e+"_win10",t,n)},_bind:function(){var t=this;e.on("util:ymstats",e.bind(t._sendStat,t)),e.once("ws:postLoad",function(){NeoConfig.stat&&NeoConfig.launchStats&&t._sendLaunchStats()}),e.on("stat:feature_invoke",function(e){o=e.feature_group,delete e.feature_group,t._fireFeatureStatWin10("feature_invoke_"+o,["message","farm","env","hasMultiple","bkt"],e)}),e.on("stat:feature_complete",function(e){a=e.feature_group,delete e.feature_group,t._fireFeatureStatWin10("feature_complete_"+a,["message","farm","env","hasMultiple","bkt"],e),o=""}),e.on("stat:feature_fail",function(e){a=e.feature_group,a===o&&(o=""),delete e.feature_group,t._fireFeatureStatWin10("feature_fail_"+a,["api","message","visible","env","farm","hasMultiple"],e)}),e.on("stat:feature_latency",function(e){var n=["farm","message","env"];a=e.feature_group,delete e.feature_group,t._fireStat("feature_latency_"+a,n,e,!0)})}}),e.namespace("common.Utils.ymmastats"),t.ymmastats=new l},"1.0.1",{requires:["mail-common-utils-settings","mail-common-utils-features","common-utils-net-queue"]});


YUI.add("mail-platform",function(){},"1.0.0",{requires:["mail-core-feature"]});


YUI.add("mail-core-feature",function(e){e.namespace("mail.Core").feature=function(t){var n=e.common.Utils.features.enabled(t);return typeof n=="undefined"&&(n=NeoConfig?NeoConfig[t]:null),{isOn:function(){return n?n===!0||n==="true"||n===1||n==="1":!1},isOff:function(){return!this.isOn()}}}},"1.0.0",{requires:["mail-common-utils-features"]});


YUI.add("mail-common-utils-featureflipper",function(e){function t(e,t,n,r){this[t]=e||{},this._entryKey=t,this._valueKey=n,this._booleanOnly=r}t.prototype={},t.prototype.constructor=t,t.prototype._value=function(e,t){var n=this,r=n._entryKey,i=n._valueKey,s=n._booleanOnly,o=this[r][e],u=o&&o.except,a;if(typeof o=="undefined")return t;if(o===null)return t;if(o[i]!==undefined){for(var f=0;u&&f<u.length;f++){var l=u[f];if(n._groupMatch(l)){a=l;break}}return a?a[i]:o[i]}return s&&o!==!0&&o!==!1?t:o},t.prototype._now=function(){return new Date},t.prototype._groupMatch=function(e){var t=this;for(var n in e){var r=e[n];switch(n){case this._valueKey:break;case"after":if(t._now()<new Date(r))return!1;break;default:}}return!0},e.namespace("common.Utils").FeatureFlipper=t},"1.0.0",{requires:[]});


YUI.add("mail-common-utils-features",function(e){function n(e){t.call(this,e,"features","enabled",!0)}var t=e.common.Utils.FeatureFlipper;n.prototype=new t,n.prototype.constructor=n,n.prototype.enabled=function(e,t){return this._value(e,t)};var r=NeoConfig.FF_features,i=new n(r);e.namespace("common.Utils").features=i},"1.0.0",{requires:["mail-common-utils-featureflipper"]});


YUI.add("common-utils-net-queue",function(e){"use strict";function s(e){var t=null;if(e&&typeof e=="object")try{t=JSON.stringify(e)}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-utils-net-queue:1",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-utils-net-queue:1")}return t}function o(e){return typeof e=="string"?e:null}function u(t,n){n=n||{};var i=this;i.endpoint=t,i.type=n.type,i.ioConfig={headers:{"Content-Type":i.type==="object"?"application/json":"text/plain"},method:"POST",timeout:r.value("statTimeout"),on:{failure:n.onFailure||function(){},timeout:function(t,n){e.fire("MailLog",{m:"STAT_TIMEOUT_REASON="+n.readyState})}}},i._normalize=i.type==="object"?s:o,i.salvageDatum=n.salvageDatum,i.retries=n.retries||0,i.periodic=n.periodic||!1,i.periodTime=n.periodTime||r.value("statQueueTimer"),i._data=[],window.addEventListener("beforeunload",e.bind(i._unload,i))}function a(){return n.enabled("nativeUnloadBeacon")&&"sendBeacon"in navigator}var t=e.common.Utils,n=t.features,r=t.settings,i=r.value("statQueueLen");e.mix(u.prototype,{_makeRequest:function(t,n){var r=this,i=e.mix({data:t},r.ioConfig),s;if(n<=0){e.io(r.endpoint,i);return}s={failure:function(e,i){r.ioConfig.on.failure(e,i),r._makeRequest(t,n-1)}},i.on=e.mix(s,r.ioConfig.on),e.io(r.endpoint,i)},_makeNativeBeacon:function(e){var t=new Blob([e],{type:this.ioConfig.headers["Content-Type"]});navigator.sendBeacon(this.endpoint,t)},_send:function(e){var t=this,n=t.type==="object"?"["+t._data.join(",")+"]":t._data.join("\n");e&&a()?t._makeNativeBeacon(n):t._makeRequest(n,t.retries),t._data.length=0},_unload:function(){clearTimeout(this.poll);var e=this.flush(!0),t=Date.now();if(e&&!a())while(Date.now()-t<100);},add:function(e){var t=this,r;if(n.enabled("autoCheckNetwork")&&!NeoGV.isOnline)return;r=t._normalize(e),!r&&t.salvageDatum&&(r=t._normalize(t.salvageDatum(e)));if(!r)return;t._data.push(r),t._data.length>i?(clearTimeout(t.poll),t.flush()):t.poll=t.poll||setTimeout(t.flush.bind(t),t.periodTime)},flush:function(e){var t=this;return t.periodic&&(clearTimeout(t.poll),t.poll=null),n.enabled("autoCheckNetwork")&&!NeoGV.isOnline&&!e?!1:t._data.length?(t._send(e),!0):!1}}),e.namespace("common.Utils").NetworkQueue=u},"1",{requires:["io-base","mail-common-utils-settings","mail-common-utils-features"]});


YUI.add("mail-common-utils-settings",function(e){function n(e){t.call(this,e,"settings","value",!1)}var t=e.common.Utils.FeatureFlipper;n.prototype=new t,n.prototype.constructor=n,n.prototype.value=function(e,t){return this._value(e,t)};var r=NeoConfig.FF_settings,i=new n(r);e.namespace("common.Utils").settings=i},"1.0.0",{requires:["mail-common-utils-featureflipper"]});


YUI.add("common-utils-jsonparse",function(e){e.namespace("common.Utils").json={tryParse:function(e,t){try{return JSON.parse(e)}catch(n){return typeof t=="function"&&t(e,n),null}}}},"1.0.0",{requires:[]});


YUI.add("mail-controller-v3-user-settings",function(e){function l(){var t=[];return f?f:(f=a.JSONClone(e.common.Utils.settings.value("dataMigrationMap",{})),a.eachKeys(f,function(e,n){n.expandsWith&&t.push({key:n.expandsWith,value:n})}),t.forEach(function(t){var n=e.common.Utils.settings.value(t.key,[]);n.forEach(function(e){f[e]=t.value})}),f)}function c(e){var t=l(),n=t[e];return n?[n.apiType,n.paramKey].join("."):e}function h(e){var t=l(),n=e,r;return a.eachKeys(t,function(t,i){r=[i.apiType,i.paramKey].join("."),r===e&&(n=t)}),n}function p(e,t){return e=""+e,t=""+t,e===t}function d(e,t,n){switch(t){case"number":return isNaN(e*1)?n:e*1;case"boolean":return!!e;case"string":return""+e;case"undefined":return n;default:return e}}function v(t){var n=t.key,r=t.value,i=t.toV3,s=l(),o=s[n],f,h,v;if(!o)return r;if(o.negateBoolean)if(r===!0||r==="true")r=!1;else if(r===!1||r==="false")r=!0;return o.v3ValueList||o.v2ValueList?i?a.getClosestMatch(r,o.v3ValueList):a.getClosestMatch(r,o.v2ValueList):o.isInList?i?(f=u.getSync(c(n)),r?(o.trim&&(n=n.replace(o.trim,"")),f.push(n),f=e.Array.dedupe(f)):f.indexOf(n)>=0&&f.splice(f.indexOf(n),1),[].concat(f)):Array.isArray(r)?(o.trim&&(n=n.replace(o.trim,"")),r.indexOf(n)>=0):!1:o.valueMap?i?(h=r,a.eachKeys(o.valueMap,function(e,t){p(t,h)&&(v=e)}),d(v,typeof o.defaultValue,o.defaultValue)):(v=r,h=o.valueMap[v],d(h,typeof h,o.valueMap[o.defaultValue])):o.truthyValue!==undefined&&o.falsyValue!==undefined?i?(v=y(r),typeof v=="boolean"?v:o.truthyValue===r?!0:o.falsyValue===r?!1:o.defaultValue):r?o.truthyValue:o.falsyValue:i?(r=r===undefined||r===null?o.defaultValue:r,d(r,typeof o.defaultValue,o.defaultValue)):r}function m(e){var t=(c(e)||"").split(".");return{source:t[0],param:t.slice(1).join("."),fullKey:t.join(".")}}function g(e){return Array.isArray(e)||(e=[{value:e}]),e.reduce(function(e,t){if(t.value===undefined||t.value===null)e=!0;return e},!1)}function y(e){return e==="0"||e===0||e==="false"||e==="FALSE"||e==="-1"?!1:e==="1"||e===1||e==="true"||e==="TRUE"?!0:e}function b(e,t){return t.forEach(function(t){e.forEach(function(e){t.key===e.key&&(e.value===undefined||e.value===null)&&(e.value=t.value)})}),e}function w(e,n){var r=this;if(!n)throw"settings must not be null";return o(r,{storeRaw:function(e,t){var r,i=!0;return r=n,e.split(".").forEach(function(e){r[e]||(r[e]={}),r=r[e]}),i=r.value!==t,r.value=t,r.lastUpdated=new Date,i},readRaw:function(e){return t(n,e)},readValue:function(t){var n=e.parse,i=r.readRaw(t),s;return i?(typeof n!="function"?s=i.value:s=n(i.value),a.JSONClone(s)):undefined},readValues:function(e){return e.map(function(e){return{key:e,value:r.readValue(e)}})},getUnavailableKeys:function(e){var t=r.readValues(e);return t.reduce(function(e,t){return(t.value===undefined||t.value===null)&&e.push(t.key),e},[])},storeValue:function(t,n){var i=r.readRaw(t.fullKey),s=e.dump;return typeof s=="function"?i?r.storeRaw(t.fullKey,s(i.value,n,t.param)):r.storeRaw(t.fullKey,s({},n,t.param)):r.storeRaw(t.fullKey,n)},getAdapterValue:function(t){return typeof e.val=="function"?e.val(this.readRaw(t).value):this.readRaw(t).value}}),r}function E(){function p(e){var n;return e?(n=f[e.source])?(n.settings=new w(n,t),n):null:null}function d(e){var t=e.reduce(function(e,t){var n=t.source;return e[n]||(e[n]={}),e[n].fullKeys||(e[n].fullKeys=[]),e[n].fullKeys.push(t.fullKey),e[n].source=n,e[n].adapter=p(t),e},{}),n=[];return a.eachKeys(t,function(e,t){n.push({source:e,adapter:t.adapter,fullKeys:t.fullKeys})}),n}function y(e){var t=(e||[]).map(function(e){return m(e)}),n=d(t);return n.reduce(function(e,t){return e&&t.adapter},!0)?(e=null,Promise.all(n.map(function(t){return new Promise(function(e){var n=t.adapter,r,i=n.settings.getUnavailableKeys(t.fullKeys);i.length>0?n.get(i.map(function(e){return m(e).param})).then(function(s){s.forEach(function(e){e&&n.settings.storeRaw([t.source,e.key].join("."),e.value)}),r=n.settings.readValues(t.fullKeys),e(r)}):(r=n.settings.readValues(t.fullKeys),e(r))})})).then(function(e){return e.reduce(function(e,t){return e=e.concat(t),e},[])})):Promise.reject(new Error("unknown key or source "+e))}function E(e,t){var n=(e||[]).map(function(e){return m(e)}),r=d(n),i=[];if(!r.reduce(function(e,t){return e&&t.adapter},!0))throw new Error("unknown key or source "+e);return e=null,r.forEach(function(e){i=i.concat(e.adapter.settings.readValues(e.fullKeys))}),t&&(i=b(i,t)),i}function S(e,t,n){var r=m(e),i=p(r);return i?(e=null,new Promise(function(s,o){var u=i.settings.storeValue(r,t);n&&u?i.set(r.param,i.settings.getAdapterValue(r.fullKey)).then(function(t){t?s(t):o(t)}):s(!0)})):Promise.reject(new Error("unknown key or source "+e))}var e=this,t={},o=[],u={set:function(){return Promise.resolve(!0)},get:function(){return Promise.resolve(!1)}},f={attributes:new r,accounts:new i,savedsearches:new s,metaData:u,userData:u};return n(e,{_remapKey:function(e){return c(e)},_remapValue:v,getMigrationKeys:function(e,t){var n=l();return Object.keys(n).filter(function(r){var i=r.split(".")[0],s=n[r].loadAt;return i===e&&s===t})},getDefaultValueMap:function(e){var t=l(),n={},r=Object.keys(t).filter(function(t){return t.split(".")[0]===e});return r.forEach(function(e){n[e]=v({key:e,value:t[e].defaultValue,toV3:!1})}),n},_inspect:function(){return t},init:function(){},get:function(t){return Array.isArray(t)?y(t).then(function(e){return e.map(function(e){return{key:h(e.key),value:v({key:h(e.key),value:e.value,toV3:!1})}})}):y([t]).then(function(e){return v({key:t,value:e[0].value,toV3:!1})})},set:function(t,n){return S(t,v({key:t,value:n,toV3:!0}),!0)},ingest:function(t,n){return S(t,v({key:t,value:n,toV3:!0}),!1)},occurEvent:function(e){return this.hasEventOccured(e)?!1:(o.push(""+e),!0)},hasEventOccured:function(e){return o.indexOf(""+e)>=0},getSync:function(e,t){var n=null;Array.isArray(e)?n=E(e,t):n=E([e],t!==undefined?[{key:e,value:t}]:undefined);if(g(n))throw new Error("values not available for key(s) "+e);return Array.isArray(e)?n.map(function(e)
{return{key:h(e.key),value:v({key:h(e.key),value:e.value,toV3:!1})}}):v({key:e,value:n[0].value,toV3:!1})}}),e}var t=e.common.Utils.getVal,n=e.mix,r=e.mail.controller.v3.settings.AttributeAdapter,i=e.mail.controller.v3.settings.AccountsAdapter,s=e.mail.controller.v3.settings.SavedSearchesAdapter,o=e.mix,u=null,a=e.mail.api.utility,f;NeoConfig.userSettings||(NeoConfig.userSettings=u=new E,u.init()),e.namespace("mail.controller.v3.settings").userSettings=NeoConfig.userSettings},"1.0.0",{requires:["mail-api-utility","common-utils","array-extras","mail-common-utils-settings","mail-controller-v3-user-settings-savedsearches-adapter","mail-controller-v3-user-settings-attribute-adapter","mail-controller-v3-user-settings-accounts-adapter"]});


YUI.add("mail-api-utility",function(e){"use strict";function n(e,t){(typeof e=="object"?Object.keys(e):[]).forEach(function(n){t(n,e[n])})}function r(e,t){var i=Array.isArray(e)?[]:{};return e?t<=0?".":typeof e!="object"?e:(n(e,function(n){i[n]=r(e[n],t-1)}),i):null}function i(e){try{return JSON.parse(JSON.stringify(e))}catch(t){return typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-api-utility:1",t,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-api-utility:1"),null}}function s(e,t){var r=[];return t||(t="root"),e===null||e===undefined?[]:typeof e!="object"?[{key:t,depth:t.split(".").length-1,size:JSON.stringify(e).length}]:(n(e,function(n){r=r.concat(s(e[n],t+"."+n))}),r)}function o(e,t,n){var r=t.split("."),i=r.length-1,s=e;r.forEach(function(e,t){if(t===0)return;if(s===undefined||s===null)return;if(t===i){s[e]=n;return}s=s[e]})}function u(e,t){var n=t.split("."),r=null,i=n.length-1,s=e;return n.forEach(function(e,t){if(t===0)return;if(s===undefined||s===null)return;t===i&&(r=s[e]),s=s[e]}),r}function a(e){var t,n=new Array(256),r,i=-1,s=0,o=e.length,u,a;for(a=0;a!==256;++a)t=a,t=t&1?-306674912^t>>>1:t>>>1,t=t&1?-306674912^t>>>1:t>>>1,t=t&1?-306674912^t>>>1:t>>>1,t=t&1?-306674912^t>>>1:t>>>1,t=t&1?-306674912^t>>>1:t>>>1,t=t&1?-306674912^t>>>1:t>>>1,t=t&1?-306674912^t>>>1:t>>>1,t=t&1?-306674912^t>>>1:t>>>1,n[a]=t;n=typeof Int32Array!="undefined"?new Int32Array(n):n;for(s=0;s<o;)t=e.charCodeAt(s++),t<128?i=i>>>8^n[(i^t)&255]:t<2048?(i=i>>>8^n[(i^(192|t>>6&31))&255],i=i>>>8^n[(i^(128|t&63))&255]):t>=55296&&t<57344?(t=(t&1023)+64,u=e.charCodeAt(s++)&1023,i=i>>>8^n[(i^(240|t>>8&7))&255],i=i>>>8^n[(i^(128|t>>2&63))&255],i=i>>>8^n[(i^(128|u>>6&15|t&3))&255],i=i>>>8^n[(i^(128|u&63))&255]):(i=i>>>8^n[(i^(224|t>>12&15))&255],i=i>>>8^n[(i^(128|t>>6&63))&255],i=i>>>8^n[(i^(128|t&63))&255]);return r=i^-1,r=(new window.Uint32Array([r]))[0].toString(16),r}function f(e,t){var n,r,i,a,f,l,c,h=JSON.stringify(e).length;if(t>=h)return h;r=s(e),r=r.sort(function(e,t){return e.depth===t.depth?t.size-e.size:t.depth-e.depth}),i=r.length;for(n=0;n<i;n++){a=h-t,f=u(e,r[n].key),l=typeof f=="string",c=l?0:2;if(a<=0)break;if(a+5<r[n].size){f=(""+f).substr(0,r[n].size-(a+5))+"...",o(e,r[n].key,f);break}o(e,r[n].key,"."),h-=JSON.stringify(f).length-3}return h}function l(e,t){var n,r,i,s,o;if(e===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof t!="function")throw new TypeError("predicate must be a function");n=Object(e),i=n.length>>>0,s=arguments[1];for(r=0;r<i;r++){o=n[r];if(t.call(s,o,r,n))return o}return undefined}function c(e,t){var n,r,i,s,o;if(e===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof t!="function")throw new TypeError("predicate must be a function");n=Object(e),i=n.length>>>0,s=arguments[1];for(r=0;r<i;r++){o=n[r];if(t.call(s,o,r,n))return r}return-1}function h(e,t,n){var r=c(e,n);return r===0?e:(r>0&&e.splice(r,1),e.unshift(t),e)}function p(e,t){var n,r,i;e=e||"",t=t||"";if(e.length===0)return t.length;if(t.length===0)return e.length;n=[];for(r=0;r<=t.length;r++)n[r]=[r];for(i=0;i<=e.length;i++)n[0][i]=i;for(r=1;r<=t.length;r++)for(i=1;i<=e.length;i++)t.charAt(r-1)===e.charAt(i-1)?n[r][i]=n[r-1][i-1]:n[r][i]=Math.min(n[r-1][i-1]+1,Math.min(n[r][i-1]+1,n[r-1][i]+1));return n[t.length][e.length]}function d(e,t){var n;return typeof e!="string"||!Array.isArray(t)?null:(n={distance:Number.MAX_VALUE,value:t[0]},t.reduce(function(t,n){var r=p(n,e);return t.distance>r?{distance:r,value:n}:t},n).value)}function v(e,t){var n=[new e(t)],r=(t||{}).maxRequest,i=0;return{getYoda:function(){return n[i].serialize().length>=(r||10)&&(n.push(new e(t)),i+=1),n[i]},serialize:function(){return n.map(function(e){return e.serialize()})},sync:function(){var e=0,t=[];return new Promise(function(r){function i(){if(e>=n.length){r(t);return}if(!n[e].hasItemToSync()){t.push({});return}n[e].sync().then(function(n){e+=1,t.push(n),i()})}setTimeout(i,0)})}}}function m(e){function c(){var e,n,i,o;if(f.length<=0)return;f.sort(function(e,n){return t[e].ts-t[n].ts}),e=f[0],n=t[e].ts-Date.now(),i=s-(Date.now()-r),o=Math.max(0,i,n),clearTimeout(u),u=setTimeout(l,o)}var t={},n=e||{priority:0,minDelay:1,priorityList:{}},r=Date.now(),i=typeof n.priority=="number"?n.priority:0,s=typeof n.minDelay=="number"?n.minDelay:0,o=n.priorityList||{},u=null,a=0,f=[],l=function(){};return l=function(){var e=f.shift(),n=t[e];delete t[e],r=Date.now(),n.yoda.sync().then(function(e){n.promises.forEach(function(t){t(e)}),u=null,c()})},{serializeSync:function(e,n){return s+i===0?e.sync():(n||(n="serial-"+a,a++),new Promise(function(r){var s=f.indexOf(n),u=Date.now()+(o[n]||i);s>=0&&f.splice(s,1),f.push(n),t[n]?(t[n].yoda=e,t[n].ts=u,t[n].promises.push(r)):t[n]={yoda:e,ts:u,promises:[r]},c()}))}}}function g(e,t,n){var r=c(e,n);return r>=0?e:(e.push(t),e)}function y(e,t,n){var r=0,i,s=9007199254740991,o;if(!Array.isArray(t)||!Array.isArray(n)||typeof e!="string")return;return o=n.length,n.forEach(function(e){e.__order=s}),t.forEach(function(t,i){for(r=0;r<o;r++){if(!t||!n[r])continue;if(n[r][e]===t[e]){n[r].__order=i;break}}}),i=n.sort(function(e,t){return e.__order-t.__order}),n.forEach(function(e){delete e.__order}),i}function b(){var e=new m,t=0,n=0,r=this,i=[];return r.lock=function(){t===0&&(n=Date.now()),t+=1},r.unlock=function(){t>0&&(t-=1),t<=0&&(i.forEach(function(t){e.serializeSync(t.yoda).then(t.resolve)}),i=[])},r.getState=function(){return t},r.execute=function(e){return t===0?(r.lock(),e.sync().then(function(e){return r.unlock(),e})):new Promise(function(t){i.push({yoda:e,resolve:t})})},r}function w(e){if(!e)throw new Error("name is required");return t._locks||(t._locks={}),t._locks[e]||(t._locks[e]=new b),t._locks[e]}var t=NeoConfig||window;e.namespace("mail.api").utility={trimObjectLeaves:f,getShallowObject:r,getObjectLeaves:s,getObjectVal:u,setObjectVal:o,JSONClone:i,findUnshift:h,arrayFind:l,
arrayFindIndex:c,matchOrder:y,getStringDistance:p,getClosestMatch:d,findPush:g,crc32:a,getYodaTrain:v,eachKeys:n,SerializedWriter:m,getNamedLock:w}},"1.0.0",{requires:[]});


YUI.add("mail-controller-v3-user-settings-accounts-adapter",function(e){function r(t){var n=e.mail.model.DataStore.Accounts.getAll(),r,i=["FREE","SENDAS","ALIAS","DEA","PARTNER","BIZMAIL"];return n?(n.length<1&&(n=NeoConfig.accounts.ALL),r=n.filter(function(e){return i.indexOf(e.type)>=0&&e.isSending===!0}),r.length<1&&(r=n.filter(function(e){return e.isPrimary===!0})),r.length<1?null:r[0][t]):null}function i(t){return(e.mail.model.DataStore.Accounts.getPrimaryAccount()||n(NeoConfig,"accounts.primaryAccount.0")||{})[t]}function s(){var t=e.mail.model.DataStore.Accounts.getAccountsByType("DEA")||n(NeoConfig,"accounts.deaAccounts")||[];return t?t.map(function(e){return{address:e.email,fromName:e.sendingName}}):[]}function o(){var t=e.mail.model.DataStore.Accounts.getAccountsByType("ALIAS")||n(NeoConfig,"accounts.aliases")||[];return t?t.map(function(e){return{address:e.email,isDefault:e.isSending}}):[]}function u(){var t=(e.mail.model.DataStore.Accounts.getAll()||n(NeoConfig,"accounts.ALL")||[]).filter(function(e){if(e.type==="SENDAS"||e.type==="POPIN")return!0});return t?t.map(function(e){return{address:e.email,isDefault:e.isSending}}):[]}function a(){var n=this;return t(n,{get:function(t){return t?(Array.isArray(t)||(t=[t]),Promise.all(t.map(function(t){var n=t;return new Promise(function(a){e.use("mail-model-datastore",function(){switch(n){case"defaultSendAddress":case"defaultFromAddress":a({key:t,value:r("email")||""});break;case"defaultFirstName":case"defaultFromName":a({key:t,value:r("sendingName")||""});break;case"defaultLastName":a({key:t,value:""});break;case"loggedInAlias":a({key:t,value:i("sendingName")||i("email")||""});break;case"replyToAddress":a({key:t,value:r("replyToAddress")});break;case"aliases":a({key:t,value:o()});break;case"aliasesTotal":a({key:t,value:o().length});break;case"extAccount":a({key:t,value:u()});break;case"extAccountsTotal":a({key:t,value:u().length});break;case"deaName":a({key:t,value:s()});break;case"deaNamesTotal":a({key:t,value:s().length});break;default:a({key:t,value:null})}})})}))):Promise.reject(new Error("unknow key"))},set:function(){throw new Error("Not implemented !!")}}),n}var t=e.mix,n=e.common.Utils.getVal;e.namespace("mail.controller.v3.settings").AccountsAdapter=a},"1.0.0",{requires:[]});


YUI.add("mail-controller-v3-user-settings-attribute-adapter",function(e){function f(){function c(t){return function(){var o=arguments;return new Promise(function(a){e.use("mail-api-yoda","mail-api-attribute-selector","mail-api-attribute-updater",function(s){n=s.Mail.Api.Yoda,r=s.Mail.Api.AttributeSelector,i=s.Mail.Api.AttributeUpdater,t.apply(u,o).then(function(e){a(e)})})})}}function h(e){return e.success&&e.result&&e.result[0]&&e.result[0].id==="mailboxSize"&&(e.result[0].value={mailboxSize:e.result[0].value}),e.success&&e.result&&e.result[0]&&e.result[0].id==="xobni"&&(e.result[0].value={xobni:e.result[0].value.xobnifiedState}),e}function p(e,t){return e==="xobni"?{xobnifiedState:t.xobni}:t}var u=this,f={showTAE:!1,statTAE:!0,ignoreRequestCountForRetry:!0,actionTitle:"mailsettings"},l=new s.SerializedWriter({priority:a.any,minDelay:0,priorityList:a});return t(u,{get:c(function(t){var i=new n(f);return t?(Array.isArray(t)||(t=[t]),t.forEach(function(e){var t=new r;t.selectKey(e),i.attributes.get(t)}),NeoConfig.mailEnv==="dev"&&console.log("attributeAdapterFunctions--->get====>>>",t),i.sync().then(function(e){return e.attributes.get.map(function(e){return e=h(e),e.success?(delete e.result[0].value.mutable,{key:e.result[0].id,value:e.result[0]}):null})})):Promise.reject(new Error("unknow key"))}),set:c(function(t,u){var a=s.JSONClone(u),c=new n(f),h=(new r).selectKey(t),d;return a=p(t,a),a.testAndSet="$(testAndSet)",d=(new i({attributeSelector:h})).setValue(a),o.indexOf(t)>=0?c.attributes.update(d):c.attributes.pipe(h,{typeName:"attributes",serialize:function(){return{select:{testAndSet:"$..testAndSet"}}}}).attributes.update(d).closePipe(),NeoConfig.mailEnv==="dev"&&console.log("attributeAdapterFunctions--->set====>>>","metaData."+t,u),l.serializeSync(c,t).then(function(e){return e.attributes.update[0].success})}),parse:function(e){return e.value[e.id]},val:function(t){return t.value},dump:function(t,n,r){if(t.value&&t.id){if(t.value[t.id]===n)return t;t.value[t.id]=n}else t.value={},t.id=r,t.value[r]=n;return s.JSONClone(t)}}),u}var t=e.mix,n,r,i,s=e.mail.api.utility,o="xobni",u={any:1},a=e.common.Utils.settings.value("attributeWriteDelay",u)||u;e.namespace("mail.controller.v3.settings").AttributeAdapter=f},"1.0.0",{requires:["mail-api-utility"]});


YUI.add("mail-controller-v3-user-settings-savedsearches-adapter",function(e){function f(e){var t={};return!e||!Array.isArray(e)?{}:(e.forEach(function(e){t[e.id]=e}),t)}function l(){function c(t){return function(){var r=arguments;return new Promise(function(f){e.use("mail-api-migration-customviews","mail-api-savedsearch-selector","mail-api-yoda","mail-api-savedsearch-updater",function(n){i=n.Mail.Api.Yoda,s=n.Mail.Api.MessageSelector,o=n.Mail.Api.SavedSearchSelector,u=n.Mail.Api.SavedSearchUpdater,a=n.mail.api.migration.customviews,t.apply(l,r).then(function(e){f(e)})})})}}var l=this;return t(l,{get:c(function(t){return new Promise(function(e,n){n(t.map(function(e){return{key:e,value:null}}))})}),set:c(function(s,u){var l=n(u);return new Promise(function(t){(!l||!Array.isArray(l))&&t(!1),(new i(r)).savedSearches.get(new o).sync().then(function(n){var s=n.savedSearches.get[0],o,u=new i(r),c,h,p={createList:[],updateList:[],deleteList:[]};s.success||t(!1),o=f(s.result.filter(function(e){return e.types.indexOf("USER")>=0})),c=l.map(function(e){return{id:e.viewId,name:e.name,query:a.generateLmv3QueryFromCustomView(e)}}),h=f(c),c.forEach(function(e){o[e.id]?o[e.id].name!==e.name&&p.updateList.push(e):p.createList.push(e)}),Object.keys(o).forEach(function(e){var t=h[e];t||p.deleteList.push(e)}),p.createList.forEach(function(t){var n=new e.Mail.Api.SavedSearchSelector,r=new e.Mail.Api.SavedSearchUpdater({savedSearchSelector:n});r.setName(t.name),r.setQuery(t.query),r.setTypes(["USER"]),u.savedSearches.create(r)}),p.updateList.forEach(function(t){var n=new e.Mail.Api.SavedSearchSelector,r=new e.Mail.Api.SavedSearchUpdater({savedSearchSelector:n.id(t.id)});r.setName(t.name),r.setQuery(t.query),r.setTypes(["USER"]),u.savedSearches.update(r)}),p.deleteList.forEach(function(t){var n=new e.Mail.Api.SavedSearchSelector;u.savedSearches.remove(n.id(t))}),u.hasItemToSync()||t(!0),u.sync().then(function(){var e=!0;u._eachResponses(function(t,n,r,i){e=e&&i.success}),t(e)})})})})}),l}var t=e.mix,n=e.common.Utils.json.tryParse,r={showTAE:!1,statTAE:!1,actionTitle:"customviews-adapter"},i,s,o,u,a;e.namespace("mail.controller.v3.settings").SavedSearchesAdapter=l},"1.0.0",{requires:["mail-api-utility"]});


YUI.add("mail-controller-imapin",function(e){function l(){}function c(e){n.setCurrentAccount(e)}function h(){var e=this;return n.getPrimaryAccount().id===e.getCurrentAccountId()}function p(){return n.getCurrentAccount()}function d(){var e=n.getCurrentAccount();return e?e.id:s.PrimaryAcctId}function v(){var e=n.getSelectedAccount();return e?e.id:s.PrimaryAcctId}function m(){return n.getCurrentAccount().folderPrefix}function g(e,t){var n=r.getFoldersByAccount(t),i=n.length,s,o;for(o=0;o<i;o++){s=n[o];if(s.folderInfo.name===e)return s}}function y(e,t){var n=r.getFoldersByAccount(t),i=n.length,s,o;for(o=0;o<i;o++){s=n[o];if(s.types.indexOf(e)!==-1)return s}}function b(e){var t=this,n=[];return n.push(t.getFolderByType(o,e).folderInfo.fid,t.getFolderByType(u,e).folderInfo.fid,t.getFolderByType(a,e).folderInfo.fid),n}function w(e){return r.getFoldersByAccount(e)}function E(e,t){var r=n.get(e);return r&&t in r?r[t]:null}function S(t,r){var i=new e.Mail.Core.Net.Transport(new e.Mail.Core.Net.Policies.ListFoldersPolicy),s=e.Mail.Core.Net.Helpers.V3RequestHelper,o={logInfo:{},options:{responseType:"json",timeout:f},suppressNotification:!0,suppressStat:!1,upload:!1},u=n.get(t.id),a=s.getV3RequestUrl("accounts",{id:t.id}),l={description:t.accountName,type:u.type},c;t.signature&&(l.signature=t.signature,l.signatureActive=t.signatureActive),c=i.request(a,{account:l},o),c.then(function(i){n.update(i.result),e.fire("ds:account:change"),r.success()},function(t){r.failure(t)})}function x(t){var n=e.Cookie.get("YM.IMAP_SYNC"),r,i,s;if(t.status!=="ENABLED")return;n?n=JSON.parse(n):n={},i=t.id,s=t.serverUri.split("//").pop(),n[i]={initialTime:Date.now(),provider:s},r=new Date(Date.now()+12e5),e.Cookie.set("YM.IMAP_SYNC",JSON.stringify(n),{expires:r})}var t=e.mail.model.DataStore,n=t.Accounts,r=t.Folders,i=e.common.Utils,s=e.mail.ui.FolderUtils,o=s.SpamFolderType,u=s.TrashFolderType,a=s.DraftFolderType,f=i.settings.value("mailWsTimeout",35e3);e.on("imapin:accountAdded",x),l.prototype={setCurrentAccount:c,getCurrentAccount:p,getCurrentAccountId:d,getSelectedAccountId:v,getCurrentAccountPrefix:m,getFoldersByAcct:w,getFolderByName:g,getFolderByType:y,getMsgPermDeleteFolders:b,isPrimaryAccount:h,getAccountAttribute:E,updateAccount:S},e.namespace("mail.Controller").ImapIn=new l},"1.0.0",{requires:["mail-model-datastore","mail-ui-folder-utils","mail-common-utils-settings","cookie"]});


YUI.add("common-ui-conv-listview",function(e){function D(){var e=NeoConfig.launchPVID.replace(/[^a-zA-Z]/g,""),t=e.length,n,r="";for(n=8;n<t;n++)n%2===0&&(r+=e.charAt(n));return r}function H(){return s.debounce(function(){e.fire("listview:scroll",{scrollTop:this.scrollTop})},200)}function B(){this._lazyAddAttrs=!1,this._debouncedFireScrollEvent=H(),B.superclass.constructor.apply(this,arguments),this.currPage=0,this.scrollTop=0}function j(){this._lazyAddAttrs=0,j.superclass.constructor.apply(this,arguments)}var t=e.namespace("common.ui"),n=e.Node,r=n.one,i=e.Object,s=e.common.Utils,o=21,u=27,a=0,f=n.getDOMNode,l="pageSize",c="pageCount",h="-",p=".",d="page",v="list",m="id",g="input",y="refresh",b="reload",w="maxRequestSize",E="selected",S="subselected",x="#",T="selectionCount",N="getElementsByTagName",C=Neo.getScrollbarWidth(),k=NeoConfig.ccAb&&D()||"slot_MB",L="search-my-world-slot",A=e.mail.model.ListStore.ListCache,O,M,_,P=function(t){return function(){var n=this,r=arguments;e.use("common-ui-conv-listview-ext",function(){try{n[t].apply(n,r)}catch(i){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-ui-listview-conv-listview:1",i,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-ui-listview-conv-listview:1"),e.use("common-utils-error",function(){s.error.report("ConvView-ListExt error for API "+t,i,1,1,1)})}})}};e.mix(B,{NAME:"listview",ATTRS:{page:{value:0,setter:function(e){return e<0?0:e}},pageCount:{getter:function(){return Math.ceil(this.get("model").get(v).length/this.get(l))}},pageSize:{value:50,setter:function(e){var t=this.get("maxRequestSize");return t||(t=200),e<t?e:t}},entireElementChecks:{value:!1},requestSize:{value:200,setter:function(e){var t=this.get("maxRequestSize");return t||(t=200),e<t?e:t}},maxRequestSize:{value:200},selectionCount:{setter:function(e){return e>1&&(this.checkmode=1),e},getter:function(){return this.selCount()}},selectionType:{getter:function(){return this.selType()},value:"none"},selection:{getter:function(){return i.keys(this._sel)},setter:P("_setSelection")},subselection:{getter:function(){return this._subselIndex}},focused:{value:!1,setter:function(e){return e}},activeItem:{value:null},isActive:{value:!0},model:{valueFn:function(){return new j},setter:function(t){var n=this;return n.detachAll(),t&&(t.after(b,function(t){n.set(d,0,{noupdate:1}),n._sel={},n._clearSelect(),n.set("focused",1),s.features.enabled("LFTCache")&&t.reason==="fidchange"&&A.isCached(n.listObj.fid)&&A.cacheLength(n.listObj.fid)?(n._model.set("length",A.cacheLength(n.listObj.fid)+100),n._model.set(v,A.get(n.listObj.fid),{subtype:"liststore"}),e.later(0,n,n._sync,[1,t.reason])):n._sync(1,t.reason)}),t.after(y,function(e){n._ss=i.values(n._sel),n.set(d,0,{noupdate:1}),e.data?n._model.setRange(0,e.data):n._model.request(0,n.get(w))}),t.after("listChange",P("_listchange"),n,1),t.after("requestfail",P("_handleFailure"),n)),n._model=t,n._model}},status:{setter:function(){this._parentNode&&P("_setStatus").apply(this,arguments)}},showFocus:{value:!1},selectVersion:{value:1},cellHeight:{value:0},freeze:{value:0}}}),e.extend(B,e.Base,{LIST_CLASS_NAME:"list-view-items",ITEM_CLASS_NAME:"list-view-item",ITEM_MASTER_CLASS_NAME:"list-view-item-master",ITEM_DETAIL_CLASS_NAME:"list-view-item-detail",STATUS_CLASS_NAME:"list-view-status",PAGE_CLASS_NAME:"list-view-items-page",ITEM_SUBCONTAINER_CLASS_NAME:"list-view-item-subcontainer",ITEM_CONTAINER_CLASS_NAME:"list-view-item-container",IGNORE_FLAG:"flag",IGNORE_ICON:"icon",IGNORE_ARROW:"arrow",IGNORE_DELETE:"delete-msg",IGNORE_ARCHIVE:"archive-msg",IGNORE_RESTORE:"restore-msg",IGNORE_SRCH:"msg-lst-srch",EXPAND_CLASS_NAME:"arrow",RETRY_CLASS_NAME:"expansion_retry",IGNORE_CLASS_NAME_INFO:"info",IGNORE_UNREAD:"info-unread",CHECKBOX:"input",HEADER_CLASS_NAME:"list-header",STATUS_ROLE:"row",SELECTIONTYPENONE:"none",SELECTIONTYPEMAIN:"main",SELECTIONTYPESUB:"sub",SELECTIONTYPEMIXED:"mixed",ANCHORED_LABEL_CLASS_NAME:"anchored-header",initializer:function(){this._bind(),this._maxLength=0,this._guid=e.guid(),this._sel={},this._subselIndex=-1,this.checkmode=0},render:function(r){var i=this,u=0,a=n.one(r),f=i.get("model").get(v),c=a.one(p+i.LIST_CLASS_NAME),h=i.get(l),d=c.all("div"+p+i.ITEM_CLASS_NAME),g=e.mail.persist.MetaData,y=g.get("deleteCancelCount"),b=s.features.enabled("hideHoverDelete"),w=s.settings.value("maxCountDeleteCancelBeforeHide"),E=!NeoConfig.trashInList||b&&+y>=w;d.each(function(e){e.set(m,i._id(u++))}),i._srcNode=c,i._parentNode=a,i._bindEvents(a),i._r=1,s.features.enabled("timeChunk")&&(i._rawAnchorNode=a.get("parentNode").one(p+i.ANCHORED_LABEL_CLASS_NAME)._node,i._rawAnchorNode.style[NeoConfig.isRTL?"left":"right"]=C+"px",O=t.AnchoredHeader,M=t.TimeChunk),s.features.enabled("predictiveSearch")&&(i.smwNode=i._srcNode.one("#search-my-world-slot")),i._maxLength=Math.max(h*o,c.get("offsetHeight")),f[i.start()]||i._sync(),E&&i._srcNode.all(".icon-small-delete").addClass("hidden")},updateAnchoredLabel:function(t,n,r,i){var s=this,o=0,u=s._srcNode,f,l;n=n||u.get("scrollTop"),t&&(s.clearTimeChunckEffectiveOffsetCache(),s._rawSectionHeaderNodes=O.getSectionHeaders(u)),s._smwEl&&s._smwEl.innerHTML!==""&&(a===0&&(a=s._smwEl.offsetHeight),o=a),O.updateAnchoredLabel(n,s._rawSectionHeaderNodes,s._rawAnchorNode,o,!0),r==="liststore"&&(f=s._srcNode.one(".list-view-item-date-label"),l=A.getDirtyFids(),l.indexOf(i)!==-1&&f&&(f.append(e.Node.create('<span class="s-loader lftcache"></span>')),A.unmarkDirty(i)))},scrollToTop:function(){this._srcNode.set("scrollTop",0)},pageUpOrDown:function(t){var n=e.one(".list-view-items").get("offsetHeight"),r=this._srcNode.get("scrollTop");r=t?r-n:r+n,this._srcNode.set("scrollTop",r)},home:function(){this.set(d,0)},end:function(){this.set(d,Math.max(this.get(c)-1,0))},next:function(){this.get("freeze")!==1&&this.get(d)<=this.get(c)-1&&(this.set("freeze",1),this.set(d,this.get(d)+1))},previous:function(){this.set(d,this.get(d)-1)},getTrueCountItems
:function(){var t=r(x+this._id(this.stop()-1));return t?this.stop()-this.start():e.all("#inboxcontainer .list-view-item-master").size()},hasAllSelected:function(){return this.checkmode&&this.get(T)>=this.stop()-0},hasAnySelected:function(){return this.checkmode&&this.get(T)<=this.stop()-0},getTrueEndItem:function(){var t=r(x+this._id(this.stop()-1)),n;return t||(n=e.all("#inboxcontainer .list-view-item-master"),t=n.item(n.size()-1)),t},selectAll:function(e){return e=!!e,this._selectRange(0,e,this.stop()-1),e},selectSome:function(e){var t=0,n=this._model.get(v),r=0,i;this._clearSelect();var s={isRead:["totalUnread",!1],isunRead:["totalUnread",!0],isFlagged:["totalFlagged",!0],isunFlagged:["totalFlagged",!1]};for(t=r;t<this.stop();t++)!!n[t]&&!!n[t][s[e][0]]===s[e][1]&&(this._sel[t]=n[t]);i=this.selCount(),this.set(T,i),i&&(this.checkmode=1),this.sync()},selCount:function(){var e=0,t;for(t in this._sel)this._sel[t]&&e++;return e},selType:function(){var e=this.SELECTIONTYPENONE,t;for(t in this._sel)e=this._isSubindex(this._toIndexN(t))?e===this.SELECTIONTYPEMAIN?this.SELECTIONTYPEMIXED:this.SELECTIONTYPESUB:e===this.SELECTIONTYPESUB?this.SELECTIONTYPEMIXED:this.SELECTIONTYPEMAIN;return e},getItemEl:function(e){return r(x+this._id(e))},traverse:function(e){var t=this,n=r(p+t.LIST_CLASS_NAME),i=n.all("div"+p+t.ITEM_CLASS_NAME),s,o;i.each(function(n){s=t._getIndexN(n),o=t._model.get(v)[s],e&&e(n,o,s)})},_setSelected:function(){},_renderItem:function(e){return e+""},_showSubitems:function(){},_renderSubitem:function(){},_focusItem:function(e){e.focus()},_id:function(e){return this._guid+h+(typeof e=="object"?e.join(h):e)},_idSub:function(e,t){return e+h+t},start:function(){return this.get(d)*this.get(l)},stop:function(){return Math.min(this.start()+this.get(l),this._model.get(v).length)},refresh:function(e,t,n){this._parentNode&&(e?this.get("model").refresh(t):this.get("model").reload(n))},sync:function(){this._sync()},getCurrentPage:function(t){var n=this._srcNode.all("."+this.PAGE_CLASS_NAME),r;return!t&&(t=this._srcNode.get("scrollTop")),n.each(function(n,i){if(!e.Lang.isValue(r)&&n.get("offsetTop")>=t)return r=i>0?i-1:0,!1}),e.Lang.isValue(r)?r:n.size()-1},_getPageNode:function(e){return this._srcNode.all("."+this.PAGE_CLASS_NAME).item(e)},renderPage:function(t){var n=this.get(l),r=t*n,i=Math.min(r+n,this._model.get(v).length),s=this._model.get(v),o=this._sel,u=[],a=[],f=this._getPageNode(t),c=this.listObj?this.listObj.sortedColumn.sortOrder:"",h,p,d;if(r>i)return!0;for(p=r;p<i;p++)h=s[p],h?(a.push(h),NeoConfig.timeChunk&&this.listObj.timeChunk&&(h.addDateLabel=M.addDateLabel(p,h,p>0?s[p-1]:"",c)),u.push(this._renderItem(h,p,o[p],this._id(p),!1))):d=1;return!d&&f?(f.set("innerHTML",u.join("")),NeoConfig.rearrangeMb&&NeoConfig.timeChunk&&t===0&&e.fire("mbEvent:rotate"),NeoConfig.timeChunk&&c==="down"&&M.updateThisWeekLabel(),!0):!1},updatePage:function(t){var n=this,r=n._srcNode,i=n.get("cellHeight"),s=n.get("pageSize")*i,o="",a=0,f,l,c,h,d;e.Lang.isValue(t)||(t=this.getCurrentPage()),f=r.all(p+n.PAGE_CLASS_NAME),c=f.size()-1,n.clearTimeChunckEffectiveOffsetCache();for(h=0;h<=c;h++)l=f.item(h),h>=t-1&&h<=t+1||h===c||l.one(".expanded")?l.one(p+n.ITEM_CONTAINER_CLASS_NAME)||(l.setStyle("height","auto"),n.renderPage(h)):(NeoConfig.timeChunk&&(o=l.all(".list-view-item-date-label"),a=o.size()),s=n.get("pageSize")*i+a*u,h===0&&(d=n._mbAdEl?n._mbAdEl.offsetHeight:0,s+=d),l.setStyle("height",s+"px"),l.setHTML(o))},_renderVisiblePages:P("_renderVisiblePages"),resetFocus:function(){this.setAttrs({activeItem:null,focused:!1}),this._clearSelect(),this.fire("lv:resetFocus")},_bind:function(){var t=this;t.after("pageChange",function(e){e.details&&!e.details[0].noupdate&&t._appendConversations(t.start(),t.stop())},t),NeoConfig.timeChunk&&(e.on("updateDensity",function(){e.Lang.later(1e3,t,t.updateAnchoredLabel,[!0,!1])}),t.listObj&&t.listObj.after("fidChange",function(){O&&t.updateAnchoredLabel(!0,!1)}))},_appendConversations:P("_appendConversations"),_keydown:P("_keydown"),_isCheckboxBorder:P("_isCheckboxBorder"),_sync:P("_sync"),_blur:P("_blur"),_selectRange:P("_selectRange"),_expandItem:P("_expandItem"),_resetSelection:P("resetSelection"),_getListItem:function(e,t){var n=this,r=e.target||e,i,s;return s=r.ancestor(function(e){return!t&&(e.hasClass(n.IGNORE_ARROW)||e.hasClass(n.IGNORE_FLAG)||e.hasClass(n.IGNORE_DELETE)||e.hasClass(n.IGNORE_ARCHIVE)||e.hasClass(n.IGNORE_RESTORE)||e.hasClass(n.IGNORE_SRCH)||e.hasClass(n.IGNORE_CLASS_NAME_INFO)||e.hasClass(n.IGNORE_UNREAD))&&(i=1),e&&e.hasClass(n.ITEM_CLASS_NAME)&&!e.hasClass(n.HEADER_CLASS_NAME)||i},!0),i?0:s},_getIndexN:function(e){var t=e.get(m).split(h),n=1*t.pop(),r=t.pop(),i=t.pop();return i?[1*r,n]:n},_toIndexS:function(e){return typeof e=="object"?e.join(h):e.toString()},_toIndexN:function(e){var t=e.split(h);return t.length===1?t[0]:[t[0],t[1]]},_formatIndexS:function(e,t){return e+h+t},_getIndexS:function(e){var t=this;return t._toIndexS(t._getIndexN(e))},_isSubindex:function(e){return typeof e=="object"},_getSubindex:function(e){return typeof e=="object"?e[1]:-1},_getMainindex:function(e){return typeof e=="object"?e[0]:e},_getItemContainer:function(e){var t=this;return e.ancestor(function(e){return e.hasClass(t.ITEM_CONTAINER_CLASS_NAME)})},_getMasterItem:function(e){var t=this,n=null,r=t._getItemContainer(e);return r&&(n=r.one(p+t.ITEM_MASTER_CLASS_NAME)),n},_getSubitemContainer:function(e){var t=this._getItemContainer(e);return t&&(t=t.one("."+this.ITEM_SUBCONTAINER_CLASS_NAME)),t},_getNeighborMasterItem:function(e,t){var n=this._getItemContainer(e),r=this._getIndexN(e);return n&&(n=t?this.getItemEl(r+1):this.getItemEl(r-1)),n},_getEndDetailItem:function(e,t,n){var r=this._getItemContainer(e).all(p+this.ITEM_DETAIL_CLASS_NAME),i;if(r){i=r.item(t?0:r.size()-1);if(i&&(n||i.get("parentNode").getStyle("display")!=="none"))return i}return null},_getNodeType:function(e){return this._isSubindex(this._getIndexN(e))?this.SELECTIONTYPESUB:this.SELECTIONTYPEMAIN
},_selectToRender:function(){var e={},t,n,r;for(r in this._sel)t=this._toIndexN(r),n=-1,this._isSubindex(t)&&(n=t[1],t=t[0]),e[t]||(e[t]=[]),e[t].push(n);return e},_checkbox:function(e){var t=e.target||e,n,r=NeoConfig.hoverPreview?!1:t.hasClass("info");if(t.hasClass("cbox")||t.get("parentNode").hasClass("cbox")||r||t.hasClass("fixed")&&t.hasClass("start")||(t.get("type")||"").toLowerCase()==="checkbox"||this._isCheckboxBorder(e)){n=f(t).parentNode[N](g);if(n&&n.length>0)return{state:n[0].checked}}},_isTextField:function(e){var t=e.target||e;if(t.get("type")&&t.get("type")==="text")return!0},_isFormControl:function(e){var t=e.target||e,n=t.get("nodeName");return n==="BUTTON"||n==="INPUT"},_entireElementCheck:function(e){if(this.get("entireElementChecks")){var t=this,n=e.target||e,r,i;i=n.ancestor(function(e){return e.hasClass(t.ITEM_CLASS_NAME)},!0);if(i){r=f(i)[N](g);if(r)return{state:r[0].checked}}}},_showSelectedItem:function(e,t){var n=t?"addClass":"removeClass",r=n==="removeClass"?-1:0,i;e[n](E),e.setAttribute("tabindex",r),n==="removeClass"&&(e.setAttribute("aria-selected",!1),e.one("input").setAttribute("aria-checked",!1)),this._isSubindex(this._getIndexN(e))||(i=this._getItemContainer(e),i[n](S),i.all(p+this.ITEM_DETAIL_CLASS_NAME).each(function(e){e[n](S)}))},_select:function(t,n,r,i,s,o){var u=this,a=u.selCount(),l,c,h,p,d,v;n=!!n;if(t){v=u.getItemEl(u._getIndexN(t)),v&&t!==v&&(t=v),h=u._getIndexN(t),p=u._toIndexS(h);if(!r||r&&r.compareTo(t)){if(document.getElementById(t.get("id"))){u._showSelectedItem(t,n),a===1&&n&&s&&(c=f(e.Node.one(x+u._id(u.get("selection")[0])))[N](g),c&&(c[0].checked=n));if(a>=1||i)c=f(t)[N](g),c&&(c[0].checked=n,t.set("aria-selected",n),t.one("input").set("aria-checked",n),n?t.one("input").setAttribute("title",strings.str_msg_list_checkbox_checked):t.one("input").setAttribute("title",strings.str_msg_list_checkbox_not_checked),u.checkmode=a>1?1:n,u._lastSel&&n&&(d=u._lastSel.all("input"),d&&d.item(0)&&d.item(0).set("checked",!0)))}n?(l=u._model.valueAt(h),l&&(u._sel[p]=l)):delete u._sel[p],o||u.set(T,u.selCount())}else u._selectRange(t,n,r,o)}},_selectByIndex:function(e,t,n,r,i,s){var o;t?(o=this._model.get(v)[e],o&&(this._sel[e]=o)):this._sel[e]=null,this._select(this.getItemEl(e),t,n,r,i,s)},_clearSelect:function(t){var n=this.selCount(),r,i,s;n&&!t&&(n===1&&this._lastSel?(NeoConfig.previewPanePref&&e.UA.gecko>0&&(r=this._lastSel.ancestor("#msg-list"),i=r&&r.next(".threadpane.tripane"),s=i&&i.one("#rtetext"),s&&(s.focus(),s.blur())),this._select(this._lastSel,0)):this.selectAll(!1)),this.checkmode=0,this._lastSel=this._lastSS=0,this._sel={},n&&this.set(T,this.selCount())},_clearSubselect:function(){var e,t;for(e in this._sel)t=this._toIndexN(e),this._isSubindex(t)&&(this._select(r(x+this._id(t)),0),this._sel[e]=null)},_adjustShiftSelection:function(e,t){var n,r,i,s,o;return t&&(n=this._getNodeType(t),r=this._getNodeType(e),s=this._getMasterItem(e),i=this._getMasterItem(t),n===this.SELECTIONTYPEMAIN?e=s:(o=this._getItemContainer(t).all(p+this.ITEM_DETAIL_CLASS_NAME),o&&(e=o.item(this._getIndexN(i)>this._getIndexN(s)?0:o.size()-1)))),e},_onSelect:function(t){function w(){var s=!1;if(r){u?l=!y:l=i?!i.state:1,l&&!u&&!a&&(!i||!n.checkmode)&&(l===1&&n._sel[n._getIndexS(r)]&&n.selCount()===1&&!f(r)[N](g)[0].checked&&!b?s=!0:n._clearSelect()),n.set("showFocus",!1),a?(n._lastSel=l?r:0,n._select(r,1,n._lastSS,1,0,1),n.set(T,n.selCount())):(n._lastSel=0,s?n.selCount()===1&&!e.Lang.isUndefined(h)&&(n._subselIndex=h,n.fire("subselect")):(n._select(r,l,0,i||t.button>1,u,1),e.Lang.isUndefined(h)||(n._subselIndex=h),n.set(T,n.selCount())),n._lastSel=l?r:0,n._focusItem(r),n._subselIndex=-1),(n.selCount()===1||!a)&&l&&(n._lastSS=r),n.setAttrs({activeItem:r||null,focused:1}),t.preventDefault();if(i||u||a)p=n._model.isCollapsible(n._model.valueAt(c)),e.fire("mt:click",{action:p?"click_select_thrd":"click_select",append:{ltxt:[l,",",a,",",u,",",n.selCount()].join("")}})}}var n=this,r=t.which===3?n._getListItem(t,!0):n._getListItem(t),i=n._checkbox(t)||n._entireElementCheck(t),o=t.type,u=t.metaKey||t.ctrlKey,a=t.shiftKey,l,c,h,p,d,v,m,y,b;if(!r)return;c=n._getIndexN(r),n._isSubindex(c)&&(h=n._getSubindex(c),r=n._getMasterItem(r)),v=n.SELECTIONTYPEMAIN,y=r.hasClass(E),b=n.listObj?n.listObj.isStale():!1,o==="mousedown"&&(_=!y)&&w(),o==="mouseup"&&!_&&y&&t.button<2&&w();if(o==="click"||o==="dblclick")y&&!i&&!u&&!a&&(m=n._model.valueAt(c),p=n._model.isCollapsible(m),d=n._isSubindex(c),n.fire("command",{e:t,index:d?n._getSubindex(c):n._getMainindex(c),subindex:d?n._getSubindex(c):-1,mainindex:n._getMainindex(c),item:m}),s.features.enabled("fetchMessageDisplayOnHover")&&n.hoverPrefetch&&n.hoverPrefetch.logHoverClickStats(c)),t.preventDefault()},clearTimeChunckEffectiveOffsetCache:function(){O&&O.clearOffsetCache()},_mouseOverCallback:function(e,t){this.fire("convlistview:mouseover",{index:e,item:t})},_onMouseOver:function(t){var n=this._getListItem(t,1),r=n&&this._getIndexN(n);e.Lang.isNumber(r)&&this.hoverPrefetch.onItemMouseOver(r,this._model.valueAt(r),this._mouseOverCallback.bind(this))},_bindEvents:function(t){var n=this;t.on("mousedown",n._onSelect,n),t.on("mouseup",n._onSelect,n),t.on("click",n._onSelect,n),t.on("dblclick",n._onSelect,n),t.on("keydown",function(){n._keydown.apply(n,arguments)}),t.on("focus",function(e){n.setAttrs({activeItem:n._getListItem(e,1)||null,focused:!0})}),t.on("blur",function(){n._blur.apply(n,arguments),n.setAttrs({focused:!1})}),s.features.enabled("fetchMessageDisplayOnHover")&&e.use(["event-mouseenter","mail-controller-v3-hoverprefetch"],function(e){n.hoverPrefetch=new e.mail.controller.v3.HoverPrefetch({type:"message"}),n._srcNode.on("mouseover",function(t){e.later(0,n,n._onMouseOver,[t])},n),n._srcNode.on("mouseleave",function(t){e.later(0,n,n.hoverPrefetch.clearMouseOverEvent,[!0])},n)}),n._srcNode.on("scroll",function(e){var t=e.currentTarget,r=t.get("scrollTop"),i=t.get("offsetHeight"),o=t.get("scrollHeight"),u=(r+i)/o*100,a=n.getCurrentPage
(r),f=n._rawSectionHeaderNodes,l=n._mbAdEl,c=n._smwEl;n.scrollTop=r,s.features.enabled("fetchMessageDisplayOnHover")&&n.hoverPrefetch&&n.hoverPrefetch.clearMouseOverEvent(),a!==n.currPage&&(n.updatePage(a),n.currPage=a,NeoConfig.timeChunk&&(n._rawSectionHeaderNodes=O.getSectionHeaders(n._srcNode)));if(NeoConfig.timeChunk){if(!f||!f[0]||!f[0].parentNode||!f[0].parentNode.parentNode)n._rawSectionHeaderNodes=O.getSectionHeaders(n._srcNode);if(!l||!l.parentNode)n._mbAdEl=n._srcNode._node.querySelector("#"+k);if(!c||!c.parentNode)n._smwEl=n._srcNode._node.querySelector("#"+L);n.updateAnchoredLabel(!1,r)}u>=70&&n.next(),n.fire("listview:scroll",{scrollTop:r,currPage:a});try{n._debouncedFireScrollEvent()}catch(h){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-ui-listview-conv-listview:2",h,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-ui-listview-conv-listview:2")}}),n.after("showFocusChange",function(e){r(p+n.LIST_CLASS_NAME)[e.newVal?"addClass":"removeClass"]("showfocus")})}}),e.mix(j,{NAME:"listmodel",ATTRS:{KEY:{value:"id"},SUBKEY:{value:"subid"},list:{value:[]},length:{setter:function(e){this.get(v).length=e},getter:function(){return this.get(v).length}}}}),e.extend(j,e.Base,{NAME:"listmodel",valueAt:function(e){var t=this.get(v);if(typeof e=="string"){var n=e.split(h);e=n.length===1?n[0]:[n[0],n[1]]}return typeof e=="object"?this.getSubitem(t[e[0]],e[1]):t[e]},setRange:P("setRange"),update:P("update"),remove:P("remove"),reverse:P("reverse"),indexesOf:P("indexesOf"),refresh:function(e){this._refresh=1,this.fire(y,e)},reload:function(e){this.set("length",0),this.fire(b,{reason:e})}}),t.ConvListModel=j,t.ConvListView=B},"1.0.0",{requires:["base-base","node","event-focus","common-utils","mail-common-utils-features","common-ui-anchored-header","common-ui-timechunk","common-ui-conv-listview-ext","mail-persist-meta-data"]});


YUI.add("common-ui-conv-listview-ext",function(e){var t=e.Node,n=e.one,r=e.Lang,i=e.Array,s=e.common.Utils,o=s.features,u=s.settings,a=e.Object,f=e.common.ui.TimeChunk,l=e.mail.model.DataStore.Folders,c="#",h="list",p="requestSize",d="pageSize",v="page",m="dash",g="pageCount",y="loading",b=".",w="fidchange",E="setrange",S="selected",x="remove",T="update",N="renderComplete",C="list-stat:scrolRenderComplete",k="KEY",L="SUBKEY",A="reverse",O="focused",M="tabIndex",_="height",D="prefetch",P="outofsync",H="append",B=n("body"),j=n("#main"),F,I,q;e.mix(e.common.ui.ConvListView.prototype,{_selectRange:function(t,n,r,i){var s=this,o=s._getIndexN,u,a,f,l,c;t._node&&(t=o(t)),r._node&&(r=o(r)),f=l=r;if(e.Lang.isNumber(r)){u=s._isSubindex(f),a=s._isSubindex(t);if(u!=a)return;if(u){if(s._getMainindex(f)!=s._getMainindex(t))return;t=s._getSubindex(t),f=s._getSubindex(f)}c=t<=f?-1:1;while(f!==t+c)s._selectByIndex(l,n,0,1,0,1),u?l[1]+=c:l+=c,f+=c}i||s.set("selectionCount",s.selCount())},_updateItem:function(r,i,s){var o=this,u="list-view-item-date-label",a="this-week",f="data-tc-label",l=i?o.stop()-1:r,h=o._model.valueAt(l),p=n(c+o._id(r)),d=p?o._getItemContainer(p):null,v=o.get("activeItem"),m,g,y,w,E,S,x,T,N,C,k,L,A,_,D;if(h&&p){S=v&&v._node?o._getIndexN(v):-1,w=o._lastSel&&o._lastSel._node?o._getIndexN(o._lastSel):-1,E=o._lastSS&&o._lastSS._node?o._getIndexN(o._lastSS):-1,m=o.get(O)&&v,g=r==o._getMainindex(w),y=r==o._getMainindex(E),o.fire("beforeItemUpdate"),x=o._selectToRender(),NeoConfig.timeChunk&&o.listObj.timeChunk&&(L=p&&p.get("parentNode"),A=L&&L.previous(),_=NeoConfig.rearrangeMb&&A&&A.previous(),_&&_.hasClass(u)?(h.addDateLabel="",_.hasClass(a)&&(h.thisWeek=a,h.label=_.getAttribute(f))):A&&A.hasClass(u)?(h.addDateLabel="",A.hasClass(a)&&(h.thisWeek=a,h.label=A.getAttribute(f))):h.addDateLabel=""),h.msgs&&h.msgs[0]&&(h.snippet=h.msgs[0].snippet),k=t.create(o._renderItem(h,l,x[l],o._id(l),s));if(i){if(m||g)T=p.next(b+o.ITEM_CLASS_NAME)||k;d.remove(),k&&o._srcNode.append(k)}else d&&d.replace(k);o.fire("itemUpdate",{itemIndex:l,itemNode:k}),e.fire("listview:itemUpdate",k,h),m&&v!=null&&o._getMainindex(S)==r&&(T=n(c+o._id(S)),T&&o._focusItem(T)),g&&(N=n(c+o._id(w)),N&&(o._lastSel=N)),y&&(C=n(c+o._id(E)),C&&(o._lastSS=C)),r==o.start()&&!v&&(D=k?k.one(".list-view-item"):null,D&&(D.set(M,0),o._focusItem(D,1)))}},_handleFailure:function(e){var t=this;e.start!==0&&e.reason!=="prefetch"&&t.set("page",t.get("page")-1,{noupdate:1}),t.set("freeze",0)},_synclist:function(){var e=this;e._ss&&a.size(e._ss)&&(e._sel=e._model.indexesOf(e._ss)),e._sync(),e._lastSS=0,a.some(e._sel,function(t,n){return e._lastSel=e.getItemEl(n),1}),e._ss=0},_listchange:function(t){var n=this,r=n._sel,i={},o=n.checkmode,f,l,c,p,m,y,b,S,N=t.subtype||"DEFAULT";try{switch(t.subtype){case w:n.selCount()?(n._ss=a.values(r),n._synclist()):f=1;break;case E:n._synclist();break;case H:n._appendConversations(n.start(),n.stop());break;case D:break;case T:n._updateItem(t.index,!1,t.expand);break;case A:b=a.keys(r),m=b.length,c=n._model.get("length"),m===1?(y=b[0],S=y==c-y?y:c-y-1,n.set(v,Math.floor(S*1/n.get(d))),i[S]=r[b[0]]):n.set(v,0),n._clearSelect(1),n._sel=i,f=1,n.checkmode=o;break;case x:n._clearSelect(1),t.list&&t.list.length&&(l=n.getItemEl(t.list[0]))&&(n._set("activeItem",l),n._model.get(h).length===parseInt(t.list[0],10)?n._select(n.getItemEl(t.list[0]-1),1):n._select(l,1)),n.get("isActive")||n._set("activeItem",null),p=n.get(g),n.get(v)>=p&&n.set(v,p-1),f=1,n.setAttrs({focused:!0});break;case P:n._removeLoadingIndicator(),f=1,e.fire("util:ymstats",{name:"LFT_outofsync",include:{farm:!0}}),e.fire("SplunkLog","debug_lft_outofsync",{fid:e.Object.getValue(n,["listObj","fid"])},u.value("SplunkLogLevel","sample"));break;default:f=1}f&&n._sync(!1,N)}catch(C){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-ui-listview-conv-listview-ext:1",C,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-ui-listview-conv-listview-ext:1"),s.error.report("ConvView-ListExt listchange error for subtype: "+t.subtype,C,1,1,1)}},_appendConversations:function(t,n){var r=this,i=r._model.get(h),s=0,o=r.get(d)*2,u=[],a=r._sel,l=r._srcNode,c=[],p=r.listObj?r.listObj.sortedColumn.sortOrder:"",v,m;if(I!==t||q!==n)r.setUpScrollSuccessRateStats(),I=t,q=n;if(r._r){r.fire("beforeRender"),r.fire("appendConversations"),r.set("showFocus",!1);for(m=t;m<n;m++){v=i[m];if(!v){s=1;break}c.push(i[m]),NeoConfig.timeChunk&&r.listObj.timeChunk&&(v.addDateLabel=f.addDateLabel(m,v,m>0?i[m-1]:"",p)),u.push(r._renderItem(v,m,a[m],r._id(m),!1))}s?(r._insertLoadingIndicator(),r._model.request(t,o,H)):l.all("."+r.PAGE_CLASS_NAME).size()*r.get(d)<t+1&&(r._removeLoadingIndicator(),l.appendChild('<div role = "presentation" id="'+e.guid()+'"class = "'+r.PAGE_CLASS_NAME+'">'+u.join("")+"</div>"),NeoConfig.timeChunk&&p==="down"&&f.addThisWeekLabel(),r.set("freeze",0),r.fire(N,{silent:!0}),r.fire(C))}},_insertLoadingIndicator:function(){var e=this,t=e._srcNode,n="listloading";t.one("#"+n)||t.appendChild("<div id="+n+' class="s-loader"></div>')},_removeLoadingIndicator:function(){var e=this,t=e._srcNode.one("#listloading");t&&t.remove().destroy(!0)},_renderVisiblePages:function(){var e=this,t=e._srcNode.get("scrollTop"),n=e.getCurrentPage(t),r,i=n-1<0?n:n-1;for(r=i;r<=n+1;r++)e.renderPage(r)},_sync:function(t,i){function a(){var r=this,u=r._model.get(h),a=0,l=r.stop(),c=t,v=r._srcNode,m=r._statusNode,g=r._maxLength,y=r._sel,w=r.get("activeItem"),E=r.get(d),x=e.Object.getValue(r,["listObj","fid"]),T=v.one("."+r.PAGE_CLASS_NAME),C=r.listObj?r.listObj.sortedColumn.sortOrder:"",k=r.get("page"),L=[],A=[],M=0,D,H,F,I,q,R,U,z,W,X,V;T&&(F=parseInt(T.getComputedStyle("height"),10)),q=r.getCurrentPage();if(r._r){r.fire("beforeRender"),r.set("showFocus",!1);for(W=a;W<l;W++){X=u[W];if(!X){i!==P&&(c=1,M=W);break}A.push(u[W]),W%E===0&&(I=W/E,W!==0&&L.push("</div>"),!F||I>=q-1&&I<=q+1||I===k?L.push('<div role = "presentation" class = "'+
r.PAGE_CLASS_NAME+'">'):L.push('<div role = "presentation" class = "'+r.PAGE_CLASS_NAME+'" style="height:'+F+'px">'));if(I>=q-1&&I<=q+1||I===k)W%E===0,NeoConfig.timeChunk&&r.listObj.timeChunk&&(X.addDateLabel=f.addDateLabel(W,X,W>0?u[W-1]:"",C)),L.push(r._renderItem(X,W,y[W],r._id(W),!1))}L.length&&L.push("</div>"),c?l-M<200?(H=t?r.get(d)*2:r.get(d),R=Math.max(l-M,H)||r.get(p),r._model.request(M,R,i)):r.refresh(1):(m&&m.addClass("hidden"),o.enabled("predictiveSearch")?(U=e.Node.create(L.join("")||"<div></div>"),U&&r.smwNode&&(z=r.smwNode.one(".search-my-world"),x==="Inbox"&&z?(U.insert(r.smwNode,0),B.addClass("no-mb")):NeoConfig.moneyballEnabled&&B.removeClass("no-mb")),s.remove(v.get("children")),v.insert(U)):(s.remove(v.get("children")),v.setHTML(L.join(""))),NeoConfig.timeChunk&&C==="down"&&(n(".list-view-items").removeClass("etw").setAttribute("data-tc-label",""),f.addThisWeekLabel()),v.setStyle(_,"auto"),A.length&&(V=B&&B.hasClass("notoolbar")||j&&j.hasClass("withouttoolbar"),V||(i==="liststore"?e.fire("mbEvent:re-render"):(e.fire("mbEvent:rotate"),e.fire("rotateD2S")))),r.set("freeze",0)),r._maxLength=Math.max(g,v.get("offsetHeight")),t?r.set("activeItem",null):(D=r._parentNode,w=D.one(b+r.ITEM_CLASS_NAME+b+S),w||(i==="remove"?(A=D.all(b+r.ITEM_CLASS_NAME),w=A.item(A.size()-1)):w=D.one(b+r.ITEM_CLASS_NAME)),w&&(r.set("activeItem",w),r.get(O)&&r._focusItem(w),r._lastSel=w)),i!=="liststore"&&(e.fire("mohawk:ready"),!NeoConfig.previewPanePref&&NeoConfig.onboarding.taskPanelEnabled&&s.features.enabled("keyTasksPanel")&&e.mail.ui.Workspace.renderKeyTasksPanel(x,r._srcNode));if(!c){if(this.selCount()){if(r._lastSel)W=r._getIndexN(r._lastSel);else for(W in y)break;r._lastSS=r._lastSel=r.getItemEl(W)}i!=="liststore"&&i!==P&&r._prefetch(i),e.fire("listview:sync",i),r.fire(N)}o.enabled("timeChunk")&&r.updateAnchoredLabel(!0,!1,i,x)}}var u=this;u._tmSync&&u._tmSync.cancel(),u._tmSync=r.later(0,u,a)},_resetScrollTop:function(){var e=this._parentNode.one(b+this.LIST_CLASS_NAME);e.set("scrollTop",0)},_setStatus:function(t){var n=this,r,i=!1,s="";r=n._statusNode,t=t||"",i=t.hideLoader||!1,s=t.tmpl||t,!r&&n._parentNode&&(r=e.Node.create('<div role="'+n.STATUS_ROLE+'" tabindex="-1" class="status '+n.STATUS_CLASS_NAME+'"></div>'),r.addClass("hidden"),n._statusNode=r,n._parentNode.one("#lv-statuses-container").prepend(r),n._maxLength=Math.max(500,n._srcNode.get("offsetHeight"))),r&&(i?r.removeClass(y):r.addClass(y),s==="loading-icon"&&(s='<div class="s-loader"></div>'),n._status=s||"",s&&n.get("focused")&&r.focus(),r.setContent(n._status),r.removeClass("hidden"),n._srcNode.setContent(""),n._srcNode.setStyle(_,n._maxLength+"px"))},_prefetch:function(e){var t=this,n=t._model.get(h),r=t.stop(),i=Math.min(n.length,r+t.get(d))-1;e==="remove"&&(i-=u.value("LFTDeleteBufferSize",0)),r<n.length&&!n[i]&&t._model.request(r,t.get(d)*2,D)},_setSelection:function(e){function u(){s=t._model.get(h),i.each(e,function(e){o[e]=s[e]||1,n=e}),t._sel=o}var t=this,n,s=t._model.get(h),o={};t._clearSelect(),e=e?r.isObject(e)?a.keys(e):r.isArray(e)?e:[e]:[],u(),n&&(s[n]||t.once(N,u,t),t.set("page",Math.floor(n/t.get(d)),{noupdate:1})),t._sync()},_blur:function(){return},_moveToItem:function(e,t){var n=this,r=!0,i={188:1,190:1},s;if(e){n._focusItem(e);if(!t.metaKey&&!t.ctrlKey||t.ctrlKey&&!t.keycodeOverride&&i[t.keyCode]){t.shiftKey&&n._lastSel?n._select(n._lastSel,0,e,1,0,!0):n._clearSelect(),n._lastSel=e,n._select(e,1,n._lastSS,t.shiftKey);if(n.selCount()==1||!t.shiftKey)n._lastSS=e;r=!1}t.subselect&&(s=this._getSubindex(n._getIndexN(e)))>=0&&(n._subselIndex=s,n.fire("subselect"),n._subselIndex=-1),n.set("showFocus",r)}t.halt&&t.halt()},_expandItem:function(e,t,n){var r,i,s=this,o=s._model;o.expanding||(o.expanding=!0,(r=s._getSubitemContainer(n))?(s._showSubitems(r,e),o.expanding=!1):o.getSubitem(e,0)?(o.update(t,e,!0),n=s.getItemEl(t),i=s._getItemContainer(n),i.removeClass("expanded"),o.expanding=!1,s._expandItem(e,t,n)):o.requestSub(e,t),s.set("activeItem",n),s.set("showFocus",null),s.fire("expand"))},_getNeighborItem:function(e,t){var n=this,r,i,s,o=n._getIndexN(e),u=b+n.ITEM_DETAIL_CLASS_NAME;if(n._isSubindex(o))i=e[t?"next":"previous"](u),i||(i=n._getMasterItem(e),t&&(i=n._getNeighborMasterItem(i,t)));else{if(t&&e.ancestor(".list-view-item-container").hasClass("expanded")&&(r=n._getSubitemContainer(e)))if(i=n._getEndDetailItem(r,!0,!1))return i;i=n._getNeighborMasterItem(e,t);if(i&&!t&&i.ancestor(".list-view-item-container").hasClass("expanded")&&(r=n._getSubitemContainer(i)))if(s=n._getEndDetailItem(r,!1,!1))return s}return i},_resetSelection:function(e){var t=this,n,r,i,s,o=null,u=a.keys(t._sel);if(u)for(n=0;n<u.length;n++){r=t._toIndexN(u[n]);if(t._getMainindex(r)==e){i=t._getSubindex(r);if(i==-1){o=r;break}if(o==null||t._getSubindex(r)<t._getSubindex(o))o=r}}if(o!=null){t._clearSelect();if(s=t.getItemEl(o))t._set("activeItem",s),t._select(s,1);t.get("isActive")||t._set("activeItem",null)}},_disableMouseHover:function(){var t=this,n=e.one("#msg-list");if(!n)return;t.keyboardActiveEvent||(n.addClass("keyboard-active"),t.keyboardActiveEvent=n.on("mousemove",t._enableMouseHover,t))},_enableMouseHover:function(t){var n=this,r=e.one("#msg-list");n.clientX&&n.clientY?t.clientX!==n.clientX&&t.clientY!==n.clientY&&(r&&r.removeClass("keyboard-active"),n.keyboardActiveEvent.detach(),n.keyboardActiveEvent=null,n.clientX=null,n.clientY=null):(n.clientX=t.clientX,n.clientY=t.clientY)},_keydown:function(t){var r=this,i=r.get("activeItem"),s,o,u=b+r.ITEM_CLASS_NAME,a,f=r._getListItem(t,1),l,h,p,d,v,m,g,y=f?f.hasClass(S):0,w=0,E;r._disableMouseHover(),E=i?r._getIndexN(r.get("activeItem")):r._lastSel?r._getIndexN(r._lastSel):w,i||(i=r.getItemEl(E));if(!i||!r._srcNode.contains(i)){var x=Math.floor(E/r.get("pageSize"));r.renderPage(x,r._srcNode.all("."+r.PAGE_CLASS_NAME).item(x)),i=r.getItemEl(E)}r._set("activeItem",i);switch(t.keyCode){case 37:case 39:if(r.selCount()==1&&!r.get("previewPaneEnabled")){d=r._getIndexN(i),v=r.getItemEl(d)
,m=r._getItemContainer(v);if(m.hasClass("expanded")&&t.keyCode===37||!m.hasClass("expanded")&&t.keyCode===39){h=r._isSubindex(d),p=r._model.valueAt(d),l=r._model.isCollapsible(p),h&&(d=r._getMainindex(d));if(l||h)v=n(c+r._id(d)),r._expandItem(p,d,v),t.halt()}}break;case 38:case 40:case 188:case 190:e.fire("HoverCard:hideHoverCard"),t.altKey?(s=r.getItemEl(t.keyCode===38||t.keyCode===188?r.start():r.stop()-1),s&&(t.keyCode===40||t.keyCode===190)&&(o=r._getEndDetailItem(s,!1,!1))&&(s=o)):i&&(s=r.selCount()?r._getNeighborItem(i,t.keyCode===40||t.keyCode===190):i,s&&r._isSubindex(r._getIndexN(s))&&(g=t.ctrlKey,t.shiftKey=!1,t.ctrlKey=t.metaKey=!0,t.subselect=!g,!g&&r.selCount()==1&&r.get("selection")[0]!=r._getMainindex(r._getIndexN(s))&&(r._clearSelect(),r._select(r._getMasterItem(s),1))),!t.shiftKey&&!t.metaKey&&!t.ctrlKey&&r._lastSel&&r._lastSel.get("id")!==i.get("id")&&!r._isSubindex(r._getIndexN(i))&&(s=i)),s&&(!t.shiftKey&&!t.metaKey&&!t.ctrlKey&&r.selCount()&&r._clearSelect(),s=r.getItemEl(r._getIndexN(s)),r._moveToItem(s,t)),t.halt();break;case 32:if(t.metaKey||t.ctrlKey||t.altKey)return;if(r._model.get("length")===0)return;f||(f=r.getItemEl(E),y=f?f.hasClass(S):0);if(r._isSubindex(r._getIndexN(f)))return;if(!r._checkbox(t)){if(r._isFormControl(t))return;t.shiftKey?r._selectRange(r._lastSS,!r._sel[r._getIndexN(i)],f):(y&&!r.checkmode?a=1:a=!y,r._select(f,a,0,1),r._lastSel=r._lastSS=a?f:0),t.halt()}break;case 13:r.selCount()==1&&(d=r._getIndexN(i),p=r._model.valueAt(d),h=r._isSubindex(d),l=r._model.isCollapsible(p),h||!l||!r.get("expandOnClick")?(r.fire("command",{e:t,index:h?r._getSubindex(d):r._getMainindex(d),subindex:h?r._getSubindex(d):-1,mainindex:r._getMainindex(d),item:p}),r.get("previewPaneEnabled")||t.halt()):(v=n(c+r._id(d)),r._expandItem(p,d,v),t.halt()));break;case 36:r.scrollToTop(),t.halt();break;case 33:if(t.ctrlKey)break;r.pageUpOrDown(!0),t.halt();break;case 34:if(t.ctrlKey)break;r.pageUpOrDown(!1),t.halt()}},_isCheckboxBorder:function(e){var t=e.target,n,r=0,i=0,s,o;if(t.hasClass("list-view-item"))return NeoConfig.hoverPreview||(o=t.one("div.info"),o&&(r=o.get("offsetWidth"))),s=t.one("input"),s&&(i=s.get("offsetWidth")),n=t.getX()||0,e.clientX>n&&e.clientX<n+i+r},getPageIndex:function(e){var t=this,n=t.get("page"),r=t.get("pageSize"),i=t._getListItem(e,1),s=t._getIndexN(i),o=s-n*r;return o},setUpScrollSuccessRateStats:function(){var t=this;t.scrolRenderCompleteHandler&&t.scrolRenderCompleteHandler.detach(),e.fire("stat:feature_invoke",{message:"UI_LIST_CONV_SCROLL_START_SUCCESS",feature_group:"LIST"}),t.scrolRenderCompleteHandler=t.once(C,function(){e.fire("stat:feature_complete",{message:"UI_LIST_CONV_SCROLL_COMPLETE_SUCCESS",feature_group:"LIST"})})}},1),e.mix(e.common.ui.ConvListModel.prototype,{setRange:function(e,t,n){var r=this,i=t.length,s=t||[],o=r.get(h),u=o.length;n=n||E,r._refresh&&(o=[],o.length=u,r._refresh=0);while(i--)o[e+i]=s[i];r.set(h,o,{subtype:n,start:e})},update:function(e,t,n){var r=this.get(h);try{r[e]=t,this.set(h,r,{subtype:T,index:e,expand:n})}catch(i){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-ui-listview-conv-listview-ext:2",i,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-ui-listview-conv-listview-ext:2"),s.error.report("ConvView-ListExt update error",i,1,1,1)}},remove:function(t){var n=this,s=r.isArray(t)?i(t).sort(i.numericSort):a.keys(t),o=s.length,u=n.get(h);s=i(s).sort(i.numericSort),e.fire(n.NAME+":remove",u,s);while(o--)u.splice(s[o],1);n.set(h,u,{subtype:x,list:s})},reverse:function(){var e=this,t=e.get(h);t.reverse(),e.set(h,t,{subtype:A})},indexesOf:function(e,t,n){var s,o,u=this,a,f,l,c,p=u.get(t?L:k),d=u.get(h),v={},g={},y=d.length;e=r.isArray(e)?e:[e],i.each(e,function(e){v[e[p]]=e});for(s=0;s<y;s++){a=d[s];if(t){l=u.getSubitemCount(a);for(o=0;o<l;o++)f=u.getSubitem(a,o),f&&v[f[p]]&&(c=s+m+o,g[s+m+o]=f)}else if(a=d[s]&&v[a[p]])g[s]=a}return n&&n(g),g}},1)},"1.0.0",{requires:["common-ui-conv-listview","common-ui-notification","mail-common-utils-features","mail-common-utils-settings","common-utils","mail-model-datastore"]});


YUI.add("common-ui-anchored-header",function(e){var t=26,n={},r={};e.namespace("common.ui").AnchoredHeader={clearOffsetCache:function(){r={}},_getEffectiveOffsetTop:function(e){var t=e.getAttribute("data-tc-label"),i=r[t],s,o,u,a,f;if(typeof i!="undefined")return i;if(!e||!e.parentNode)return 0;s=e.parentNode.previousSibling,f=e.offsetTop;while(s)s.className==="list-view-items-page"?(u=n[s.id],typeof u!="undefined"?f+=u:(o=s.offsetHeight,f+=o,n[s.id]=o)):s.id==="coupons_div"&&(a=s.offsetHeight,f+=a,n[s.id]=a),s=s.previousSibling;return r[t]=f,f},updateAnchoredLabel:function(e,r,i,s,o){var u=this,a=r.length,f,l,c=!1,h=o?e-s:e,p=i.firstChild,d,v,m,g,y;n={};for(f=a-1;f>=0;f--)v=t,l=r[f],g=o?u._getEffectiveOffsetTop(l):l.offsetTop,g<h&&!c&&(d=r[f+1],d&&(y=o?u._getEffectiveOffsetTop(d):d.offsetTop,h+t+1>y&&(v=y-h)),m=v+"px",p.innerHTML=l.innerHTML,p.style.lineHeight=m,i.style.height=m,i.style.top=s,i.style.display="block",c=!0);c||(i.style.display="none")},getSectionHeaders:function(e){return e._node.querySelectorAll(".list-view-item-date-label")}}},"1.0.0",{requires:[]});


YUI.add("common-ui-timechunk",function(e){var t=4,n="this-week",r=".list-view-items",i=".list-view-item-date-label",s="data-tc-label",o=".result",u=NeoConfig.strings.dateObj;e.namespace("common.ui").TimeChunk={updateThisWeekLabel:function(){var t=this,o=e.one(r),a,f,l,c,h,p,d;if(o){a=o.all("."+n),f=o.one(i),l=o.getAttribute(s),c=a.size();for(h=0;h<c;h++)p=a.item(h),d=p.getAttribute(s),l&&l>d?p.remove(!0):l===d?p===f?p.setHTML(u.tw):p.setHTML(u.etw):p.removeClass(n);t.updateFirstLabel()}},updateFirstLabel:function(t){var n,a=t?o+" "+r+" "+i:r+" "+i,f=e.one(a);f&&(n=f.getAttribute(s),n.indexOf("em")===0?f.setHTML(u[n.replace("e","")]):n.indexOf("ey")>=0&&f.setHTML(n.split("_")[1]))},addDateLabel:function(e,t,r,i){var s,o,u,a,f;return t.addDateLabel=!1,t.dateLabel="",o=(t.anchorDate||t.receivedDate)*1e3,r?(!r.labelStart&&!r.labelEnd&&(s=this.getDateLabel((r.anchorDate||r.receivedDate)*1e3),r.labelStart=s.labelStart,r.labelEnd=s.labelEnd,r.dateLabel=s.dateLabel,r.label=s.label,r.thisWeek=s.thisWeek),i==="up"?r&&o<r.labelEnd?t.labelEnd=r.labelEnd:(u=this.getDateLabel(o),t.dateLabel=u.dateLabel,t.labelEnd=u.labelEnd,f=u.thisWeek,f&&(t.thisWeek=n)):r&&o>=r.labelStart?(t.labelStart=r.labelStart,t.label=r.label,r.thisWeek&&(t.thisWeek=n)):(u=this.getDateLabel(o),f=u.thisWeek,t.label=u.label,f&&(t.thisWeek=n),t.dateLabel=u.dateLabel,t.labelStart=u.labelStart)):(u=this.getDateLabel(o),a=u.label,t.dateLabel=u.dateLabel,t.labelStart=u.labelStart,t.labelEnd=u.labelEnd,f=u.thisWeek,t.label=a,f&&(t.thisWeek=n),t.label==="t"),t.dateLabel},getDateLabel:function(e,t){return Neo&&Neo.getDateLabel?Neo.getDateLabel((new Date).setHours(0,0,0,0),e,t):""},addThisWeekLabel:Neo.addThisWeekLabel}},"1.0.0",{requires:[]});


YUI.add("mail-ui-maillist",function(e){var t=e.common.Utils,n=t.escapeHtml,r=t.unescapeHtml,i=e.mail.ui.Accounts,s=e.mail.ui.FolderUtils,o=e.mail.Controller,u=o.Folders,a=e.common.persist.UserData,f=["externalAccounts","aliases","disposableAddresses"],l=f.length,c,h,p="date",d=200,v=function(){c=i.buildAccountList()},m=e.mail.model.ListStore.ListCache,g=!1,y=!1,b=!1,w,E,S;for(h=0;h<l;++h)a.after("knownAddress|"+f[h]+"Change",v);var x=function(e){function n(){x.superclass.constructor.call(t)}var t=this;t._requests=[],e=e||{},t.evt=[],t.folderIDSortCol={},t.listAPIObj={},t.scrollTop=0,t.showScrollToSearch=!0,t.isPreviewVisible=yui.one("#inboxcontainer").hasClass("prevPaneVisible"),n()};e.extend(x,e.common.ui.ContentWidget),e.mix(x.prototype,{getColorIndicator:function(e,t){var n=e||t;return c=c||i.buildAccountList(),n&&c[n]?c[n]:""},getFolder:function(t){var n=this;u.get(n.fid,{success:function(r){var i=r.folderInfo;i.localizedName||(i.localizedName=s.getSystemFolderName(i.fid,i.name,e.Lang.isObject(n.extraParams))),t(r)}})},getFolderNameBidi:function(t,n,r,i){return typeof t=="undefined"?"":(typeof i=="undefined"&&(i=strings.str_tog_loadRTLCss?"rtl":"ltr"),typeof n=="undefined"&&(n=NeoConfig.bidi&&e.Intl.detectDirection?e.Intl.detectDirection(t,i):""),t=(n==="rtl"?"\u202b":"\u202a")+t+"\u202c",t+=i==="rtl"?"\u200f":"\u200e",t)},updateTitle:function(){var e=this;e.getFolder(function(t){var n=t.folderInfo.localizedName;e.set("title",n)},!0)},setLabel:function(){var e=this;e.getFolder(function(t){e.parentNode.one(".list-view").set("aria-label",t.folderInfo.localizedName)},!1)},setFocusNodeAttr:function(e){return this.set("focusNode",e),e},removeSelection:function(){var e=this,t=e._listview;t?(e.setFocusNodeAttr(t.getItemEl(t.start())),t.set("selection",0)):NeoConfig.previewPanePref||e._listview.clearSelection(0,1,1)},formatFromName:function(t,i,s){var o=this,u=strings.str_cfg_tog_show_contact_name&&e.contacts&&e.contacts.utils,a,f,l={nameDir:""};return o.isSentOrDraftCtx?t&&(f=t,l.nameDir=i?i:NeoConfig.bidi&&e.Intl.detectDirection?e.Intl.detectDirection(f):""):s&&(a=s.name?s.name:s.email,f=u?e.contacts.utils.getShownContactName(s):a,NeoConfig.bidi&&(e.Intl.detectDirection&&f?l.nameDir=e.Intl.detectDirection(f):s.nameDir&&(l.nameDir=s.nameDir))),l.name=f?n(r(f)):" ",l},initAttrs:function(e){var t=this,n={selectCount:{getter:function(){return t._listview?t._listview.getSelectCount():0}},selectType:{getter:function(){return t._listview&&t.listview.getSelectType?t._listview.getSelectType():null}},fid:{setter:t.setFid},extraParams:{setter:t.setExtraParams},title:{value:t.title},fullpane:{setter:t.setFullpane},vertical:{value:e.vertical},view:{getter:function(){return t._listview}},sortInfo:{getter:function(){return t.sortedColumn}},page:{getter:function(){return t._listview?t._listview.get("page"):-1}},pageCount:{getter:function(){return t._listview?t._listview.get("pageCount"):-1}}};t.addAttrs(n)},setExtraParams:function(e){var t=this;t.extraParams=e},pushRequest:function(e){this._requests.length>=2&&this._requests.shift(),this._requests.push(e)},reset:function(){var e=this;e.folder=null,e.cancelRequests(),NeoConfig.msgrData={reply:{},spam:{spims:[]},message:null}},cancelRequests:function(){for(var e=0;e<this._requests.length;e++)this._requests[e].abort();this._requests.length=0,this.sorting=0},setScrollToSearchV2View:function(){var e=this,t=e.rootNode||yui;t.all(".inf-scroll-btn-v2").removeClass("fadeout"),t.all(".scroll-to-top-parent").removeClass("fadeout"),t.all(".inf-scroll-btn").addClass("fadeout"),g=!1,y=!1,b=!1},setScrollToSearchV1View:function(){var e=this,t=e.rootNode||yui;t.all(".inf-scroll-btn").removeClass("fadeout"),t.all(".inf-scroll-btn-v2").addClass("fadeout"),t.all(".scroll-to-top-parent").addClass("fadeout"),g=!1,y=!1,b=!1},refresh:function(n){var r=this,i;r.fid==="%40C%40Chats"?i=strings[NeoConfig.hasConv?"str_msg_list_loading_ims":"str_msg_list_loading_conversation"]:i="loading-icon",t.features.enabled("LFTCache")?(n!=="fidchange"&&n!=="checkmail"||!m.isCached(r.fid)||!m.cacheLength(r.fid))&&r._listview.setStatus(i):r._listview.setStatus(i),e.fire("MailLog",{m:"Maillist refresh"}),r._listview.refresh(null,null,n),s.isSpamFid(r.fid)||!t.features.enabled("scrollToSearchV2")||r.isPreviewVisible?r.setScrollToSearchV1View():r.setScrollToSearchV2View(),r.rootNode&&(r._listview.scrollToTop(),t.rAF(function(){r.toggleScrollTopBtn(0)}))},restoreSortOrder:function(){var e=this,n=e.folderIDSortCol;e.sortedColumn=n[e.fid],e.sortedColumn||(e.sortedColumn=e.columns.date,e.sortedColumn.action=p),e.sortedColumn.sortOrder=(t.isEmpty(n)?NeoConfig.sortOrder||"down":0)||e.sortedColumn.sortOrder,e.showSortOrder()},showSortOrder:function(){},setFullpane:function(t){var n=this;t?(n.rootNode.addClass("inbox-fullpane"),n.rootNode.setStyles({width:"auto",height:"auto"})):e.use("common-persist-cookie-data",function(e){var t=e.common.persist.getCookie(),r=n.get("vertical"),i;r?(i=t.get("pos.h2slider"),i=i&&i.substr(1),i&&parseInt(i,10)<NeoConfig.minMessagelistWidth&&(i=NeoConfig.minMessagelistWidth),i=Math.max(i?i:NeoConfig.vertPane?330:630,0),n.rootNode.setStyles({width:i,height:"auto"})):(i=t.get("pos.vslider"),n.rootNode.removeClass("inbox-fullpane"),i&&parseInt(i,10)<NeoConfig.minBottomPreviewHeight&&(i=NeoConfig.minBottomPreviewHeight),i=Math.max(i||NeoConfig.minBottomPreviewHeight,0),n.rootNode.setStyles({height:i,width:"auto"}))})},getFolderTrackAction:function(e,t){var n=this,r=s.PrimaryAcctId,i=t?{Inbox:"scroll_inbox","%40C%40Chats":"scroll_inbox",Draft:"scroll_draft",Sent:"scroll_sent",Trash:"scroll_trash","%40B%40Bulk":"scroll_spam"}:{Inbox:"folderview_inbox","%40C%40Chats":"folderview_chat",Draft:"folderview_draft",Sent:"folderview_sent",Trash:"folderview_trash","%40B%40Bulk":"folderview_bulk"},o,u=e||n.folder&&n.folder.total===0;return t||(i[s.getArchiveFid(r)]="folderview_archive"),o=i[n.fid]||(t?"scroll_folder":"folderview_custom"),u&&!t?o+"_empty":o},createDisplayAdSlot:function(){var t=
e.one("#inboxcontainer"),n=e.one("#slot_MON2");n||(n=e.Node.create('<div id="slot_MON2" class="ch_mod gxBoom boom hidden"><div id="tgtMON2" class="darla" tabindex="-1" hidefocus="true"></div></div>'),t.appendChild(n))},destroyDisplayAdSlot:function(e){e.remove()},handleDarlaEvent:function(n,r){var i=this,s=t.features.enabled("emptyFolderDisplayAd"),o=e.one("#slot_MON2");n&&s?i.createDisplayAdSlot():o&&i.destroyDisplayAdSlot(o),i.fire("darlaEvent",{action:i.getFolderTrackAction(n,r),emptyFld:n})},bindInfiniteScroll:function(){var n=this,r,i,s,o,u,a=n.rootNode.one(".list-view-items"),f=n.rootNode.one(".inf-scroll-btn .scroll-to-search"),l=n.rootNode.one(".inf-scroll-btn-v2 .scroll-to-search"),c=n.rootNode.all(".scroll-to-top"),h=n.rootNode.one(".scroll-to-search-input"),p=n.rootNode.all(".scroll-to-adv"),d=n.rootNode.one(".close-scroll-to-search");n.page=1,n.prevY=0,n.debouncedFn=t.debounce(function(){u=n._listview.get("cellHeight"),NeoConfig.adOpt?(r=Math.floor(a.get("offsetHeight")/2),s=u*10,o=u*20,i=r>s?r>o?o:r:s):i=u*25,Math.abs(n.prevY-n.scrollTop)>i&&(n.rotateAds(),n.prevY=n.scrollTop)},200),c.on("click",function(){n._listview.scrollToTop(),e.fire("util:ymstats",{name:"tmp_scroll_to_top",tags:{conv:NeoConfig.hasConvView}}),n.handleDarlaEvent(!1)}),p.on("click",function(t){var r=n.fid;r==="Draft"&&(r="Drafts"),e.fire("search:jumpToAdvancedSearch",{folders:[{fid:r}]}),t.halt(),e.fire("util:ymstats",{name:"scroll_to_adv_search",tags:{source_action:"folder"}})}),h.on("mousedown",function(e){e.stopPropagation()}),f.on("click",function(){f.addClass("wide"),h.focus()}),l&&l.on("click",function(){e.fire("search:jumpToSearch",{keyword:"",showPromo:!0}),l.addClass("hidden"),d.addClass("hidden"),g=!1,e.fire("util:ymstats",{name:"click_scroll_to_search"})}),h.on("blur",function(e){e.currentTarget.set("value",""),f.removeClass("wide")}),h.on("valuechange",function(t){t.newVal&&(e.fire("search:jumpToSearch",{keyword:t.newVal}),f.addClass("invisible"),t.currentTarget.set("value",""),e.fire("util:ymstats",{name:"scroll_to_search",tags:{source_action:"inbox"}}))}),d&&d.on("click",function(){l.addClass("hidden"),d.addClass("hidden"),n.showScrollToSearch=!1,e.fire("util:ymstats",{name:"close_scroll_to_search"})}),e.on("messageDensityChange",n.updateDensity,n),n._listview.on("listview:scroll",function(e){n.onListScroll(e),n.debouncedFn()}),e.on("mbEvent:rotate",function(){n._listview.clearTimeChunckEffectiveOffsetCache()})},onListScroll:function(e){var n=this;n.scrollTop=e.scrollTop,n.refreshList&&n.triggerAutoCheckMail(),t.rAF(function(){n.toggleScrollTopBtn(e.scrollTop)})},updateDensity:function(){var t=this,n=e.one("#inboxcontainer").hasClass("vp");t._listview.set("cellHeight",n?e.mail.persist.MetaData.get("neo.pref.general.snippets")!=="-1"?NeoConfig.vertPaneCellHeight[1]:NeoConfig.vertPaneCellHeight[0]:NeoConfig.cellHeight[NeoConfig.msgListDensity]),t._listview.updatePage(),t._listview._renderVisiblePages()},canShowScrollToSearch:function(){var e=this,n=e.fid,r=s.isInboxFid(n),i=s.isSpamFid(n),o=this._listview._srcNode.get("scrollTop");return t.features.enabled("scrollToSearchV2")&&!e.isPreviewVisible?!i&&e.showScrollToSearch&&o>=1e3:r&&o>=0},canShowRefineSearch:function(){var e=this,n=e.fid,r=s.isInboxFid(n),i=s.isSpamFid(n),o=t.features.enabled("scrollToSearchV2");return(e.isPreviewVisible||!o)&&!r&&!i},toggleScrollTopBtn:function(t){var n=this,r=n.rootNode,i,o;if(t<=0){r.all(".scroll-to-top").addClass("hidden"),r.all(".scroll-to-search").addClass("hidden"),r.all(".scroll-to-adv").addClass("hidden"),o=r.one(".inf-scroll-btn-v2"),o&&o.one(".close-scroll-to-search").addClass("hidden"),g=!1,y=!1,b=!1;return}i=r.one(".inf-scroll-top:not(.fadeout)"),!g&&this.canShowScrollToSearch()&&(E=i.one(".scroll-to-search"),i.hasClass("inf-scroll-btn-v2")&&i.one(".close-scroll-to-search").removeClass("hidden"),E.removeClass("hidden"),E.removeClass("invisible"),s.isInboxFid(n.fid)?e.fire("util:ymstats",{name:"show_scroll_to_search_in_inbox"}):e.fire("util:ymstats",{name:"show_scroll_to_search_in_folder"}),e.fire("util:ymstats",{name:"show_scroll_to_search"}),g=!0),y||(i.hasClass("inf-scroll-btn")?w=i.one(".scroll-to-top"):w=r.one(".scroll-to-top-parent").one(".scroll-to-top"),w.removeClass("hidden"),y=!0),!b&&this.canShowRefineSearch()&&(S||(S=i.one(".scroll-to-adv")),S.removeClass("hidden"),b=!0)},rotateAds:function(){var t=this;t.handleDarlaEvent(!1),e.fire("mbEvent:rotate",{source:"scroll"}),e.fire("rotateD2S"),e.fire("util:ymstats",{name:"maillist_page_scroll",tags:{conv:NeoConfig.hasConvView}})},isUserOnTop:function(){return this.scrollTop<100},triggerAutoCheckMail:function(t){var n=this;n.refreshList&&n.isUserOnTop()&&(n.requestItems(0,n._listview.get("requestSize")||d,{success:function(r,i,s){n._listview.setLength(s),n._listview.refresh(1,{data:i}),t==="refresh"&&n._listmodel.fire("MailListModel:data",{data:i}),e.fire("prefetchConversations",{fid:n.fid,cids:i})},failure:function(){n.refreshList=1}},"autoCheckMail"),n.refreshList=0)}},!0),e.mail.ui.MailList=x},"1.0.0",{requires:["common-ui-contentwidget","mail-controller-folders","common-persist-user-data","mail-ui-accounts","mail-model-datastore","io","event-valuechange","mail-common-utils-features","mail-ui-folder-utils","mail-model-liststore"]});


YUI.add("mail-ui-conv-maillist-view",function(e){function r(e){var t=this;t.listObj=e.listObj,r.superclass.constructor.apply(this,arguments)}var t=e.namespace("mail.ui"),n=10;e.extend(r,e.common.ui.ConvListView,{_renderItem:function(e,t,n,r,i){var s=this;return s.listObj.renderItem(e,t,n,r,i)},_focusItem:function(t,n){var r=this,i=r.listObj.setFocusNodeAttr(t);i&&!n&&!e.common.Utils.isControlActive(!0)&&i.focus()},_showSubitems:function(e,t){var n=this;return n.listObj.showSubitems(e,null,t)},_renderSubitems:function(e,t){var n=this;return n.listObj.renderSubitems(e,t)},_renderSubitem:function(e,t,n,r){var i=this;return i.listObj.renderSubitem(e,t,n,r)},getSelected:function(t,r,i,s){var o=this,u=o.get("selection"),a=u.length,f=u.length,l=[],c=[],h={},p={},d,v,m,g,y=!1,b=o._model.get("KEY"),w=o._model.get("SUBKEY");while(f--)d=o._model.valueAt(u[f]),d&&(m=o.listObj.isSubitem(d),y=y||m,g=m?w:b,c.push(d[g]),h[d[g]]=d,p[d[g]]=u[f]);a===1&&i&&s&&!NeoConfig.noCache&&(e.fire("MailLog",{m:"Current value of sel"+o.get("selection")}),v=parseInt(o._getMainindex(o._toIndexN(u[0])),n),i(o._model.get("list"),v,l,s)),t({arr:c,map:h,neighbors:l,selmap:p})},isSelectedThread:function(){var e=this,t=e.get("selection"),n,r;return t.length>=1?(n=e._model.valueAt(t[0]),r=n&&n.totalMsgs>1?!0:!1):r=!1,r},setStatus:function(e){var t=this;t.set("status",e)},setLength:function(e){var t=this;t._model.set("length",e)},refreshBody:function(){var t=this;e.fire("MailLog",{m:"sync for refreshBody"}),t.sync()},updateUlSize:function(){},updateItemByIndex:function(e){var t=this,n=!1,r;r=t.getItemEl(e),r&&(n=r.get("parentNode").hasClass("expanded")?!0:!1),t._model.update(e,t.listObj._listmodel.valueAt(e),n)},getSelectClass:function(){return""},getSelectCount:function(){var e=this;return e.get("selectionCount")},getSelectType:function(){var e=this;return e.get("selectionType")},reverse:function(e){var t=this;t._model.reverse(),t.get("selectionCount")||(e?t.end():t.home())},toggleScrollPos:function(){var e=this;e.end()},setScrollByIndex:function(){},getItem:function(e){var t=this,n=t.listObj._listmodel.valueAt(t._getIndexN(t._getListItem(e,1)));return n},setItems:function(e,t,n){var r=this;r._model.set("length",n),r._model.setRange(e,t)},selectLastSingle:function(){var e=this;return{item:e._model.valueAt(e.get("selection").pop())}},clear:function(e,t,n){var r=this;n?r._model.get("list").length=0:r._model.reload()},clearSelection:function(){},setSelected:function(e,t){var n=this,r={},i=n._model.get(t?"SUBKEY":"KEY");r[i]=e,n._model.indexesOf(r,t,function(e){n.set("selection",e)})},movetoByKey:function(t){var n=this,r={},i=n._model.get("KEY"),s,o;r[i]=t,n._model.indexesOf(r,!1,function(t){t&&(s=n.listObj._listview.getItemEl(e.Object.keys(t)[0]),s&&n.listObj._listview._moveToItem(s,{}))})},removeByKey:function(t,n){var r=this,i=r._model.get(n?"SUBKEY":"KEY"),s=[];e.Array.each(t,function(e){var t={};t[i]=e,s.push(t)}),r._model.indexesOf(s,n,function(t){e.common.Utils.traceMsg("removing indexes from model, count "+e.Object.keys(t).length),r._model.remove(t)})}}),t.ConvMailListView=r},"1.0.0",{requires:["common-ui-conv-listview","common-utils"]});


YUI.add("mail-ui-listview-controls",function(e){var t=e.common.Utils,n=e.mail.ui.FolderUtils,r=t.substitute,i=e.ui.Templates,s=e.Plugin.Menu,o="_shared_module_offscreen_bin_menus_message_list_sortby",u="_shared_module_offscreen_bin_menus_message_list_cbox_select",a="up",f={SearchList:["flagged","unRead","conv"],ConversationList:["sender","recipient","conv","subject","relevance"],MessageList:["conv","relevance"],MessageListTo:["conv","sender","relevance"],list:["conv","recipient","relevance"],listTo:["conv","sender","relevance"]},l=function(e,t,n){var r=this;r.list=t,r.type=n,r.node=e,r.template=null};e.mix(l.prototype,{setup:function(){var e=this;try{return e["_"+e.type+"Setup"].apply(e,arguments)}catch(t){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-maillist-base-listview-controls:1",t,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-maillist-base-listview-controls:1")}return!1},_paginationSetup:function(t){var n=this,r=n.list.get("view");return t&&(n.template=t),r&&(r.after("renderComplete",e.bind(n._pageChange,n)),r.after("updatePagination",e.bind(n._pageChange,n))),n._pageChange(!1),!0},_pageFooterSetup:function(t){var n=this,r=n.list.get("view");return t&&(n.template=t),r&&(r.after("renderComplete",e.bind(n._nextPage,n)),r.after("updatePagination",e.bind(n._nextPage,n))),n._nextPage(!1),!0},_sortoptionsSetup:function(e,t){var n=this;e&&(n.template=e),n._handleSortMenu(t)},_handleSortMenu:function(t){var n=this;n.node.addClass("pressed"),n.createMenuFor(o,n.node,"#menu-ml-sortby",{},function(){var r=n.node.menu.getMenuNode();n.updateSortMenu(t),r.on("menuSelected",function(t){var i=t.dataAction,s=n.list,o=r.one("li.sortby");e.fire("mt:click",{action:"msglist_sortMnu",append:{ltxt:i}}),s.fire("sortList",{sortType:i,targetNode:t.item.get("parentNode"),currentSortedColumn:o})}),r.after("menu:state",function(t){var r=t.state;r==="hide"&&(n.node.removeClass("pressed"),n.node.unplug(e.Plugin.Menu),this.destroy(!0))})})},showOrHideSortNodes:function(t,n){t.each(function(t){var r=t.get("parentNode"),i=t.getAttribute("data-action");e.Array.indexOf(n,i)>=0?i==="sender"||i==="subject"?r.addClass("disabled").show():r.hide():r.show()})},updateSortInViewMenu:function(e,t){var r=this,i=r.list.NAME,s=e.hasClass("optionMenu")?e:e.ancestor("#menu-conv-view"),o=s.all(".sortby-group a"),u=s.one(".sortby-group .sortby"),l,c,h,p;i==="MessageList"&&t&&(n.isSentFid(t)||n.isDraftFid(t))?i="MessageListTo":i==="SearchList"&&(p={Sent:!0,Draft:!0,"%40C%40Chats":!0},r.list.get("data").type==="list"&&(i=p[r.list.get("fid")]?"listTo":"list")),h=f[i],l=r.list.get("sortInfo"),l.action==="date"&&(l.action=l.action+(l.sortOrder===a?"-asc":"-desc")),u&&(u.removeClass("sortby").removeClass("asc").removeClass("desc").removeAttribute("aria-sort"),u.one("b")&&u.one("b").removeClass("icon-chevron-down").removeClass("icon-chevron-up"),u.one("i.icon-checkmark").removeClass("icon-checkmark")),c=s.one('a[data-action="'+l.action+'"]').get("parentNode"),c.one("i.icon").addClass("icon-checkmark"),c.one("b")&&c.one("b").removeClass("icon-chevron-down").removeClass("icon-chevron-up"),c.addClass("sortby "+(l.sortOrder===a?"asc":"desc")),c.one("b")&&c.one("b").addClass(l.sortOrder===a?"icon-chevron-up":"icon-chevron-down"),c.setAttribute("aria-sort",l.sortOrder===a?"ascending":"descending"),r.showOrHideSortNodes(o,h)},updateSortMenu:function(e){var t=this,r=t.list.NAME,i=t.node.menu.getMenuNode(),s=i.all("a"),o=i.one(".sortby"),u,l,c,h;r==="MessageList"&&e&&(n.isSentFid(e)||n.isDraftFid(e))?r="MessageListTo":r==="SearchList"&&(h={Sent:!0,Draft:!0,"%40C%40Chats":!0},t.list.get("data").type==="list"&&(r=h[t.list.get("fid")]?"listTo":"list")),c=f[r],u=t.list.get("sortInfo"),u.action==="date"&&(u.action=u.action+(u.sortOrder===a?"-asc":"-desc")),l=i.one('a[data-action="'+u.action+'"]').get("parentNode"),o&&o.removeClass("sortby").removeClass("asc").removeClass("desc").removeAttribute("aria-sort"),l.addClass("sortby "+(u.sortOrder===a?"asc":"desc")),l.setAttribute("aria-sort",u.sortOrder===a?"ascending":"descending"),t.showOrHideSortNodes(s,c)},_selectoptionsSetup:function(e){var t=this;e&&(t.template=e),t._handleSelectMenu()},_handleSelectMenu:function(){var t=this;t.node.get("parentNode").addClass("pressed"),t.createMenuFor(u,t.node,"#menu-ml-cbox",{},function(){var n=e.one("#menu-ml-cbox");n.on("menuSelected",function(e){var n=e.dataAction;t.list.fire("selectMessages",{action:n})},t),n.after("menu:state",function(n){var r=n.state;r==="hide"&&(t.node.get("parentNode").removeClass("pressed"),t.node.unplug(e.Plugin.Menu),this.destroy(!0))})})},createMenuFor:function(t,n,s,o,u,a){a=a||{},e.use("common-ui-menu-helper",t,function(e){var f=e.common.ui.MenuHelper,l=r(i[t].base,null,a,null,strings),c;e.Lang.isString(s)&&(s=e.one(s)),s||(s=l),o&&o.loading&&(c=o.loading.node?o.loading.node:s,f.createLoadingMenu(c)),f.create(n,{menu:s},u)})},_nextPage:function(n){var i,s=this,o=s.node,u,a=s.template;if(n&&(!(i=o.get("parentNode"))||!i.get("parentNode")))return;e.one(".list-view-items").appendChild(r(a.footer_wrapper,0,0,0,strings)),o=e.one(".pagination-footer");var f=s.list.get("page")+1,l=s.list.get("pageCount"),c=f===l,h={class_disabled_next:f===l?" disabled":" enabled",class_disabled_first:f===1?" disabled":" enabled",aria_disabled:c?"true":"false"};o.setContent(r(a.infinite_scroll_footer,h,0,0,strings)),o.detach("click"),o.on("click",function(n){var r=t.getDataAction(n),i,o,a;a=r.action,a.indexOf("-page")!==-1&&(a=a.substr(0,a.indexOf("-page")));if(a){i=n.target.ancestor(function(e){return e.get("tagName").toLowerCase()==="span"},!0),i&&!i.hasClass("disabled")&&(o=e.config.win||window,o.scrollTo(0,0));if(e.Lang.isNull(n.target.ancestor(".disabled"))){s.list.fire("pageAction",{args:{action:a}});var f=n.target.ancestor(".list-view-footer")||n.target.ancestor(".pagination-footer");i&&i.get("id")==="btn-load-more"?u="load_more":u="nav_"+a+(f?"_btm":""),e.fire("mt:click"
,{action:u})}}n.preventDefault(),n.stopPropagation()})},_pageChange:function(t){var n,i=this,o=i.node,u=i.template;if(!o)return;if(t&&(!(n=o.get("parentNode"))||!n.get("parentNode")))return;var a=i.list.get("page")+1,f=i.list.get("pageCount"),l=a===1,c=a===f,h={first_class_disabled:l?" disabled":" enabled",first_aria_disabled:l?"true":"false",current:a,total:f,last_class_disabled:c?" disabled":" enabled",last_aria_disabled:c?"true":"false"};o.one("#btn-ml-count")&&o.one("#btn-ml-count").menu&&o.one("#btn-ml-count").unplug(s),o.setContent(r(u.pagination_inner,h,0,0,strings)),o.detach("dblclick"),o.on("dblclick",function(t){t.target.ancestor(".pagination-count")&&e.use("mail-common-inline-edit",function(n){n.log("Enabling Editable Pagination control for Message View toolbars");var r=new n.mail.common.EditablePaginationControl(o,{setPage:function(e){i.list.fire("pageAction",{args:{action:"page",val:e}})},getPageTotal:function(){return i.list.get("pageCount")},getCurrentPage:function(){return i.list.get("page")}},t);r.enableEditablePagination(t);var s=t.target.ancestor(".list-view-footer")||t.target.ancestor(".pagination-footer");e.fire("mt:click",{action:"nav_page"+(s?"_btm":"")})}),t.stopPropagation()}),NeoConfig.pagedResults&&(o.detach("click"),o.on("click",i._arrowClick,i),o.on("keydown",function(e){e.keyCode===13&&i._arrowClick(e)},i))},_arrowClick:function(n){var r=this,i=t.getDataAction(n),s=r.list.folder,o,u,a;a=i.action,a.indexOf("-page")!==-1&&(a=a.substr(0,a.indexOf("-page")));if(a){o=n.target.ancestor(function(e){return e.get("tagName").toLowerCase()==="span"},!0),o&&!o.hasClass("disabled")&&(u=e.config.win||window,u.scrollTo(0,0));if(e.Lang.isNull(n.target.ancestor(".disabled"))){r.list.fire("pageAction",{args:{action:a}});var f=n.target.ancestor(".list-view-footer")||n.target.ancestor(".pagination-footer");e.fire("mt:click",{action:"nav_"+a+(f?"_btm":"")})}}n.preventDefault(),n.stopPropagation()},_handleMenu:function(){}}),e.mail.ui.ListViewControls=l},"1.0.0",{requires:["mail-ui-folder-utils"]});


YUI.add("mail-ui-conv-maillist-model",function(e){function n(e){var t=this;t.listObj=e.listObj,n.superclass.constructor.apply(this,arguments)}var t=e.namespace("mail.ui");e.extend(n,e.common.ui.ConvListModel,{request:function(e,t,n){var r=this;r.requestItems(e,t,{success:function(e,i,s){(n==="append"||n==="fidchange")&&i.length<t&&e+i.length<s&&(n="outofsync"),r.set("length",s),r.setRange(e,i,n),n==="checkmail"&&r.fire("MailListModel:data",{data:i})},failure:function(){r.fire("requestfail",{start:e,reason:n})}},n)},requestItems:function(e,t,n,r){var i=this;i.listObj.requestItems(e,t,n,r)},getSubitem:function(e,t){var n=this;return n.listObj.getSubitem(e,t)},getSubitemCount:function(e){var t=this;return t.listObj.getSubitemCount(e)},isSubitem:function(e){var t=this;return t.listObj.isSubitem(e)},requestSub:function(e,t){var n=this,r;n.listObj.renderIndex=t,n.requestSubitems(e,function(e){r=n.get("list")[t],r&&e&&e.snapshotTime&&r.snapshotTime&&r.snapshotTime>e.snapshotTime&&(e.snapshotTime=r.snapshotTime),n.update(t,e,!0),n.expanding=!1})},requestSubitems:function(e,t){var n=this;n.listObj.requestSubitems(e,t)},isCollapsible:function(e){return e&&e.totalMsgs>1?!0:!1}}),t.ConvMailListModel=n},"1.0.0",{requires:["common-ui-conv-listview"]});


YUI.add("mail-ui-convlist-base",function(e){var t=e.mail.Controller.Conversations,n=e.mail.model.ConvStore.Conversations,r=n.getPermCidPart,i=e.mail.model.DataStore.Folders,s=e.mail.model.DataStore.Accounts,o=e.common.Utils,u=e.mail.ui.common.StringUtils,a=o.escapeHtml,f=o.unescapeHtml,l=o.substitute,c=e.common.persist.UserData,h=e.mail.persist.MetaData,p=[],d=10,v=e.mail,m=v.Controller.ImapIn,g=v&&v.model?v.model.DataStore.Messages:{},y=g.getPermMidPart,b="Trash",w="%40B%40Bulk",E="date",S="down",x="up",T=null,N=strings.str_cfg_tog_hkr_siu===!0?"hkr_siu":"cg_siu",C=strings.str_cfg_tog_hkr_siu===!0,k={"http://mail.yimg.com/a/i/cal/bell4.gif":"bell","http://mail.yimg.com/a/i/us/pim/ybang_16x16_1.gif":"certified"},L=o.settings.value("maxParticipantsCount"),A=1,O=e.mail.ui.FolderUtils,M=e.mail.model.ListStore.ListCache,_=o.features,D=o.settings,P=D.value("verifiedInboxServicesDomainsMap",{}),H=_.enabled("retryOnTimeoutConnErr"),B=D.value("wsReadTimeout"),j,F,I=function(t){function u(t,r,i){t===n.fid&&(A!==i&&(i==="checkmail"?n.sorting||(e.fire("MailLog",{m:"sync from flushConv"}),n.refresh(i)):(n.refreshList=1,n.triggerAutoCheckMail(i))),n.updateTitle())}var n=this;t=t||{},n.evt=[],n.lastMsgIdx=-1,n.timeChunk=!0,n.isSentOrDraftCtx=!1,I.superclass.constructor.call(n,t);var r=[],i=e.one("#inboxcontainer div.inbox.thread-content"),s=i&&i.all("div.list-view-item.selected"),o;s&&s.each(function(e){r.push(e.one("input").get("value"))}),n.selectedCids=r,n.title="",n.infiniteScrollHandlers=[],n.restoreSortOrder(),!t.dontBind&&O.isInboxFid(t.fid)&&(o=NeoConfig&&NeoConfig.msgListObj),n.view=t.view||{},n.dontBind=t.dontBind,n.template=t.TEMPLATE||NeoConfig.msgListTmpl,n.pageSize=NeoConfig.pageSize||50,n.paginationCntrls=null,!o||t.fid==="%40S%40Search"?n.createPaginatedList(o):n.createPaginatedList(o,NeoConfig.totalConversations),n.initAttrs(t),n.set("fid",t.fid||"Inbox"),n.evt.push(n.on("visibleChange",function(e){e.newVal&&(n.needFlush&&(u(n.fid),n.needFlush=0),NeoGV.masStarted=!1)}),e.on("ds:msg:flush",u,n),e.on("ds:conv:change",n.changeConv,n),e.on("ds:conv:refresh",n.changeConv,n),e.on("ds:conv:remove",n.removeConv,n),e.on("checkmail:before",n.removeSelection,n),e.on("ds:msg:remove",n.removeConvByMid,n)),e.mix(n,{update:function(){n._listview.refreshBody()}})};e.extend(I,e.mail.ui.MailList),e.mix(I.prototype,{NAME:"ConversationList",renderItem:function(t,n,r,i,s){var o=this,u;return e.server&&!t||!t?"":(t.expanded&&(s=!0),u=o.lastMsgIdx=t.msgs.length-1,t.msgs.length&&(t.colorIndicator=o.getColorIndicator(t.msgs[u].externalPopServer,t.msgs[u].xapparentlyto)),o.renderIndex=n,o.renderExpand=s,j=i,F=r,l(o.template.message,t,o.formatters,t,strings,null,o))},isRenderSelected:function(e,t){var n;if(e)for(n=0;n<e.length;n++)if(t===e[n])return!0;return!1},createPaginatedList:function(t,r){var i=this,s=0,o=0,u=t?t.length:0,a,l=!1,c=r?l?r-u:0:0,p=[],v,m=i.pageSize,g,y;if(u){for(s=0;s<u;s++)o=Math.max(o,t[s].rawDate);v=Date.now();for(s=0;s<u;s++)a=t[s],p[c++]={cid:a.cid,anchorDate:a.anchorDate,colorIndicator:a.colorIndicator,fid:a.fid,subject:a.subject?f(a.subject):"",subjectDir:NeoConfig.bidi&&a.subjectDir?a.subjectDir:"",totalMsgs:a.totalMsgs,totalUnread:a.totalUnread,totalFlagged:a.totalFlagged,totalHasAttach:a.totalHasAttach,totalDraft:a.totalDraft,recipients:a.participantList,xapparentlyto:a.xapparentlyto,checksum:a.checksum,snapshotTime:o,receivedDate:a.rawDate,receivedDateAria:a.rawDate,snippet:a.snippetStr?a.snippetStr:"",size:a["data-size"]&&parseInt(a["data-size"].split("=").pop().replace('"',""),d),msgicon:a.msgicon?a.msgicon:"",msgCountsByFolder:a.msgCountsByFolder,msgs:[{mid:a.mid,fid:a.mfid,cid:a.cid,flags:a.mflags}]},a.messageInfo&&a.summary&&n.setPrefetch(a,"Inbox",v)}I.setConvHeaderList(p),r&&(p.length=r),g=new e.mail.ui.ConvMailListModel({KEY:"cid",SUBKEY:"mid",length:r,list:p,listObj:i}),y=new e.mail.ui.ConvMailListView({model:g,pageSize:m,requestSize:function(){return m<=100?m*2:m}(),listObj:i,expandOnClick:!NeoConfig.hasConvView,cellHeight:e.one("#inboxcontainer").hasClass("vp")?h.get("neo.pref.general.snippets")!="-1"?NeoConfig.vertPaneCellHeight[1]:NeoConfig.vertPaneCellHeight[0]:NeoConfig.cellHeight[NeoConfig.msgListDensity]}),i._listmodel=g,i._listview=y,i.vlist=y,l&&y.end(),i.parentNode&&i.render(i.parentNode),i._listview.on("command",i.onCommand,i),i._listview.on("selectionCountChange",i.onListViewSelect,i,!0),i._listview.on("selectionCountChange",i.updateSelectAllCheckbox,i,!0),i._listview.on("subselect",i.onSubselect,i,!0),i._listmodel.on("MailListModel:data",i.onModelDataRefresh,i),i._listview.on("convlistview:mouseover",function(t){var n=t.item&&[{conversationId:t.item.cid,cfid:t.item.fid}];NeoConfig.yodaReadEnabled&&n&&NeoConfig.loadYodaController.then(function(){e.mail.controller.v3.api.hoverPrefetch({type:"conversations",options:{items:n,isPrefetchCall:!0,getDisplay:!0}})})},i),e.common.Utils.features.enabled("desktopNotification")&&e.use("mail-ui-desktop-notifications",function(e){e.mail.ui.desktopNotifications.initNotifyModel(i)}),(_.enabled("faviconNotify")||_.enabled("titleNotify"))&&e.use("mail-ui-favicon-notify",function(e){e.mail.ui.faviconNotify.init(i)}),e.on("ui:currentFolder",i.updateSelectAllCheckbox,i,!0)},updateSelectAllCheckbox:function(){var e=this,t,n,r,i;window.setTimeout(function(){e.selectAllNode&&(e._listview.hasAllSelected()?e.selectAllNode.setAttrs({checked:!0,indeterminate:!1}):(t=e.parentCW,n=t&&t.msgList,r=n&&n._listview,i=r&&r.checkmode,e.selectAllNode.setAttrs({checked:!1,indeterminate:i&&e._listview.selCount()>0})))},0)},onCommand:function(e){function n(n){var r,i,s=o.wcopy(n.map[n.arr[0]]);e.subindex!==-1&&(i=t._listview._formatIndexS(e.mainindex,e.subindex),r=o.wcopy(t._listview._model.valueAt(i))),t.fire("command",{e:e.e,fid:e.subindex!==-1?t.getMsgFid(e.item):t.fid,message:s,index:e.index,submessage:r,neighbors:n.neighbors})}var t=this;t._listview.getSelected(n,null,I.getNeighbors,t.fid)},onModelDataRefresh:function(){var e=this;setTimeout(function(
){e.fire("MailList:modelRefresh",{list:e})},300)},getNewMsgs:function(e){var t=this.vlist.get("model").get("list"),n=[],r=t.length,i,s,o,u,a,f,l;if(!e)return[];for(u=0;u<r&&t[u].receivedDate>e;u++){i=t[u],s={fid:O.getInboxFid(),cid:i.cid,msgs:[]};if(i&&i.msgs){f=i.msgs,o=f.length;for(a=0;a<o&&f[a].receivedDate>e;a++)l=f[a],O.isInboxFid(l.sourceFolderInfo.fid)&&!l.flags.isRead&&s.msgs.push(l);s.msgs.length>0&&n.push(s)}}return n},getMostRecentTimestamp:function(){var e=this.vlist.get("model").get("list")[0];return e&&e.receivedDate},onSubselect:function(){this.onListViewSelect({newVal:1})},onListViewSelect:function(t){function a(e){var r=!0,s,a,f,l,c;for(s in e.map){a=n.getMsgFid(e.map[s]);if(!O.isDraftFid(a)&&!O.isSentFid(a)){r=!1;break}}u&&r&&u.addClass("disabled"),t.newVal===1&&!n._listview.checkmode&&(f=n._listview._toIndexN(e.selmap[e.arr[0]]),l=o.wcopy(e.map[e.arr[0]]),(i=n._listview.get("subselection"))!=-1&&(c=o.wcopy(n._listview._model.valueAt(n._listview._formatIndexS(f,i)))),n.fire("singleSelect",{fid:n._listview._isSubindex(f)?n.getMsgFid(l):n.fid,message:l,submessage:c,neighbors:e.neighbors}))}var n=this,r,i,u;u=n.parentCW.subToolbars instanceof Array?n.parentCW.subToolbars[n.fid].root.one("#btn-move"):"",u&&u.removeClass("disabled"),n.set("selectCount",t.newVal),r=n.rootNode.one(".list-header-wrapper .count"),t.newVal>0?r&&r.setContent(l(strings.str_msg_selected,{num_selected_msgs:t.newVal})):r&&r.setContent(""),s.getAccountsByType("IMAPIN").length===0&&O.isInboxFid(n.fid)&&!o.isCalloutShown("archiveOnboarding")&&e.use("mail-ui-onboarding-archive",function(e){e.fire("callout:action",{name:"archiveOnboarding",action:"init"})}),s.getAccountsByType("IMAPIN").length===0&&O.isArchiveFid(n.fid)&&!o.isCalloutShown("restoreInboxOnboarding")&&e.use("mail-ui-onboarding-archive",function(e){e.fire("callout:action",{name:"restoreInboxOnboarding",action:"init"})}),t.newVal>0&&n._listview.getSelected(a,null,I.getNeighbors,n.fid)},changeConv:function(t,i,s,u,a){function H(){t==="msg:add"&&f.fid===a.fid&&(O.isDraftFid(f.fid)||O.isSentFid(f.fid))&&(e.fire("MailLog",{m:"ChangeConv msg:add refresh"}),f.refreshList=1,f.triggerAutoCheckMail())}var f=this,l=0,c=0,h=s?s.length:0,p={},d={},v=f._listview,m=f._listview?f._listmodel.get("list"):f.vlist.arrItems,g=[],y=function(e){f._listview._model.indexesOf(e,!1,function(e){f._listview._resetSelection(Object.keys(e)[0])})},E,S,x,T,N,C,k,L,A,M,_,D=m.length,P;a=a||{};if(t==="move"){O.isDraftFid(f.fid)||f.moveConv(i,s,u);return}if(a.fromSearch||s.length===1&&!n.canConvOverlapInFids(f.fid,s[0].fid))if(!a.fromConv||t!=="msg:move")return;if(h>0){for(E=0;E<h;E++)N=r(s[E].cid),p[N]=s[E],d[N]=s[E];E=0,x=f.fid!==b&&f.fid!==w;while(E<D&&l!==h){M=m[E],M&&(C=r(M.cid));if(M&&C in p){if(C in d){L=(f.fid,p[C]),k=m[E],S=0,A=T=null;if(!L.sparse)A=e.mail.model.ConvStore.Conversations.toConvInfoEvent(f.fid,L);else if(L.moved){P=a.mids?a.mids.length:0;for(c=0;c<M.msgs.length;c++)M.msgs[c].fid===f.fid&&S++;x&&a.fid!==b&&a.fid!==w?S>P||a.srcFid&&a.srcFid!==f.fid?f.requestSubitems(L,y,!0):(e.fire("MailLog",{m:"sync from changeConv 1"}),f.removeConv(f.fid,[L])):S===0&&(e.fire("MailLog",{m:"sync from changeConv 2"}),f.removeConv(f.fid,[L]))}else A=L;if(A){if(!A.anchorDate&&t!=="lmt"&&(t!=="msg:remove"||!x)){_=!0;break}k.snapshotTime>=A.snapshotTime&&(T=k.snapshotTime),m[E]=o.merge(k,A,!0),T&&(m[E].snapshotTime=T),g.push(E)}}l++}E++}_?(e.fire("MailLog",{m:"ChangeConv reload refresh"}),f.refresh()):g.length>1?(v.refreshBody(),f.updateTitle()):g.length===1?(v.updateItemByIndex(g[0]),t==="msg:remove"&&(L.totalMsgs===0||O.isDraftFid(f.fid)&&L.totalDraft===0?f.removeConv(f.fid,[L]):a.reason!=="savedraft"&&f.parentCW&&f.parentCW.msgPane&&!f.parentCW.msgPane.get("active")&&f._listview._resetSelection(g[0]))):H()}else H()},removeConv:function(t,n){var r=this,i,s,o;if(t===r.fid)if(n){s=[],o=n?n.length:0;for(i=0;i<o;i++)s.push(n[i].cid);r._listview.removeByKey(s)}else e.fire("MailLog",{m:"sync from removeConv"}),r._listview.refresh()},removeConvByMid:function(e,t){var n=this,r=n._listmodel.get("list"),i,s,o,u=[];if(O.isDraftFid(e)&&e===n.fid){for(s=0;s<r.length;s++){i=r[s];if(i&&i.msgs&&i.msgs.length===1)for(o=t.length-1;o>-1;o--)y(t[o].mid)===y(i.msgs[0].mid)&&(u.push(i),t.splice(o,1));if(t.length===0)break}u.length&&n.removeConv(e,u)}},movetoItemById:function(e){var t=this;t._listview.movetoByKey(e)},findCidByMid:function(e,t){var n=this,r=n._listmodel.get("list"),i,s,o;if(e===n.fid)for(s=0;s<r.length;s++){i=r[s];if(i&&i.msgs&&i.msgs.length)for(o=0;o<i.msgs.length;o++)if(y(t)===y(i.msgs[o].mid))return i.cid}return null},moveConv:function(e,t){if(e&&t){var n=!1,r=this,i=e?e.length:0,s;for(s=0;s<i;s++)if(t[s].fid===r.fid){n=!0;break}n&&(r._listview.refresh(1),r.updateTitle())}},setPrevPaneVisibility:function(){this._listview.set("previewPaneEnabled",!!NeoConfig.previewPanePref)},render:function(t){function i(){var r,i;n.template||(n.template=e.ui.Templates._shared_module_message_list_threaded_rollup),r=n.template,i={message_list_full_pane:"",user_pref_height:"",conv_list_width:"",conv_list_height:"",thread:"",has_multiple_mailboxes:"",conv_list_header:"",get_message_response:"",show_from_header:r.show_from_header?l(r.show_from_header,0,0,0,strings):"",search_results:r.search_results||"",show_snippet:"",show_snippet1:"",show_snippet_else:r.show_snippet_else,show_snippet_else1:r.show_snippet_else1,inf_scroll_top:r.inf_scroll_top},n.parentNode.set("innerHTML",l(n.template.base,i,0,0,strings)),n.render(t)}var n=this,r;n.parentNode=e.Node.one(t),n.set("parentNode",n.parentNode),n.rootNode=n.parentNode.one(".inbox.thread-content"),n.set("rootNode",n.rootNode);if(!n.rootNode){if(!n.template){e.use("_shared_module_message_list_threaded_rollup",i);return}i()}r=n.rootNode.one(".list-view"),(n.fid!=="Inbox"||n.dontBind)&&n.rootNode.one(".list-view .list-view-items").set("innerHTML",""),n._listview.render(r),n.bindUI(),n.setPrevPaneVisibility(),n.set("focusNode",n.rootNode.one(".list-view .list-view-items"
)),n.listRender=1,n.fire("render"),e.on("timeChunkSettingChange",function(){n.sortedColumn.action!=="date"&&NeoConfig.timeChunk?n.sortList("date"):n.refresh()}),e.on("unsubscribe:deleteCompleted",function(){n.refresh()})},isStale:function(){var e=this,t=e.parentCW,n=t.msgPane;return n&&n.isStale?!0:!1},requestItems:function(n,r,i,s){var o=this,u=this.fid==="%40C%40Chats",a="Client.FolderIdDoesntExist",f=o.extraParams,c=t.list,h=s==="autoCheckMail"||s==="prefetch",p={start:n,numCInfos:r||100,fid:o.fid,sortKey:o.sortedColumn.sortKey,sortOrder:o.sortedColumn.sortOrder,groupBy:o.sortedColumn.groupBy,bidiDetection:NeoConfig.bidi},d,v;if(f)for(v in f)p[v]=f[v];d={success:function(t){var r=t.convInfo;e.fire("stat:feature_complete",{message:"UI_APPEND_CONV_COMPLETE_SUCCESS",feature_group:"LIST"}),o.folder=t.folder,i.success(n,r,o.folder.totalConversations),o.sorting=0},failure:function(t){h||e.fire("stat:feature_fail",{message:"UI_APPEND_CONV_COMPLETE_FAILURE",feature_group:"LIST",api:"ListFolderThreads",visible:"yes"}),i.failure(),o._listview.get("page")===0&&!h&&o._listview.setStatus(l(o.template.loading_error,0,0,0,strings),!0),u&&t.code===a&&o.handleDarlaEvent("%40C%40Chats"),o.sorting=0},timeout:NeoConfig.wsListTimeout||6e4,suppressCodes:h?["*"]:[],suppressNotification:!0,suppressLogs:u&&[a],exceptCodes:[999],retryCodes:h?[]:["Server.Malformed-unk"],stopwatch:o.stopwatch},H&&(d.timeout=B),_.enabled("yodaConversationRead")&&NeoConfig.loadYodaController?NeoConfig.loadYodaController.then(function(){o.pushRequest(e.mail.controller.v3.api.getConvList({fid:p.fid,start:p.start,count:p.numCInfos,groupBy:p.groupBy,sortKey:p.sortKey,sortOrder:p.sortOrder,success:function(t){d.success(t),m.isPrimaryAccount()&&(!document.hasFocus||document.hasFocus&&document.hasFocus())&&p.start===0&&p.sortKey==="date"&&p.sortOrder==="down"&&!p.groupBy&&O.isInboxFid(p.fid)&&e.mail.controller.v3.api.resetUnseen()},failure:d.failure}))}):o.pushRequest(c.call(t,p,d,++A)),e.fire("stat:feature_invoke",{message:"UI_APPEND_CONV_START_SUCCESS",feature_group:"LIST"})},showSubitems:function(t,n){var r=this,i=t.ancestor(".list-view-item-container"),s=i.one(".list-view-item"),o=r._listview._getIndexN(s),u,a,f,l,c;i.hasClass("expanded")?(c=parseInt(t.getComputedStyle("height"),10)+"px",t.setStyle("height",c),i.removeClass("expanded"),s.setAttribute("aria-expanded","false"),s.one(".arrow").setAttribute("aria-label",strings.str_conv_expand_label),r._listview._model.valueAt(o).expanded=u=r.renderExpand=!1,e.later(0,t,t.setStyle,["height",0])):(f=r.rootNode.one(".list-view-item-container.expanded .list-view-item-subcontainer"),f&&r.showSubitems(f,!0),a=t.get("children").size(),l=(parseInt(i.one(".list-view-item-master").getStyle("height"),d)+(e.UA.ie?1:0))*a+"px",T&&(T.stop(T.wasCached?"ConvListExpandCached":"ConvListExpandNotCached"),T=null),t.setStyle("height",l),i.addClass("expanded"),s.setAttribute("aria-expanded","true"),s.one(".arrow").setAttribute("aria-label",strings.str_conv_collapse_label),s.focus(),r.renderExpand=!0,u=!0,r._listview._model.valueAt(o).expanded=!0),n||e.fire("mt:click",{action:u?"expand_thrd":"collapse_thrd"})},getSubitem:function(e,t){return e&&e.detail?e.msgs[t]:null},getSubitemCount:function(e){return e.detail?e.msgs.length:0},isSubitem:function(e){return e.mid?!0:!1},getAllAccountEmails:function(){var e={},t=c.get("externalAccounts.extAccount")||[],n=c.get("aliases.alias")||[],r=c.get("disposableAddresses.deaName")||[],i=NeoConfig.accounts&&NeoConfig.accounts.imapInAccounts?NeoConfig.accounts.imapInAccounts:[],s=t.concat(n,r),o={defaultID:c.get("userSendPref.defaultID"),defaultFromAddress:c.get("userSendPref.defaultFromAddress")},u=i.length,a=s.length,f,l,h;o.defaultID&&(e[o.defaultID]=1),o.defaultFromAddress&&(e[o.defaultFromAddress]=1);for(h=0;h<u;h++)f=i[h],f.isPrimary||(e[f.email]=1);for(h=0;h<a;h++)if(l=s[h].address)e[l]=1;return e},requestSubitems:function(n,r,i){var s=t.get,u,a=this,f={fid:a.fid,cid:n.cid,checksum:n.checksum,anchorDate:n.anchorDate},c,h,p,d;T=new o.Stopwatch("ConvListExpand"),d=function(t){p=a._listview.getItemEl(a.renderIndex),p.addClass("expand_error"),h=p.one(".thread_expansion_error"),h||e.use("_shared_module_message_list_thread_expansion_error",function(){var n={can_retry:function(){return t.convPermDeleted?"":l(e.ui.Templates._shared_module_message_list_thread_expansion_error.can_retry,null,null,null,strings,null,a)}};p.one(".subj").hide(),h=e.Node.create(l(e.ui.Templates._shared_module_message_list_thread_expansion_error.base,0,n,0,strings)),p.insertBefore(h,p.one(".date"))})};var v={success:function(e){var t,n=a.get("view");e.detail=!0,r&&r(e),T.wasCached=v.respProps&&v.respProps.wasCached?1:0,p=n.getItemEl(a.renderIndex),p.removeClass("expand_error"),i||(p.get("parentNode").removeClass("expanded"),t=n._getSubitemContainer(p),a.showSubitems(t,null)),c&&(c.cancel(),p.removeClass("loading"))},failure:function(e){a._listmodel.expanding=!1,d(e),c&&(c.cancel(),p=a._listview.getItemEl(a.renderIndex),p.removeClass("loading"))},errorPosition:12};c=e.later(500,a,function(){p=a._listview.getItemEl(a.renderIndex),p&&p.addClass("loading")}),_.enabled("yodaConversationRead")&&NeoConfig.yodaControllerLoaded?(u=e.mail.controller.v3.api.getConversation({cfid:f.fid,conversationId:f.cid,success:v.success,failure:v.failure,getDisplay:!1,pane:!1}),u&&u[0]&&u[0].abort&&a.pushRequest(u[0])):a.pushRequest(s.call(t,f,v,++A))},getSelected:function(e){function n(t){var n=t&&t.arr?t.arr.length:0,r=[],i;for(i=0;i<n;i++)r.push(t.map[t.arr[i]]);e(r)}var t=this;t._listview.getSelected(n,null,I.getNeighbors,t.fid)},setFid:function(t){var n=this;if(n.fid!==t||n.extraParams)n.prevFid=n.fid,n.reset(),n.fid=t,n._listview&&(strings.str_cfg_tog_preserve_msglist_scroll&&n._listview.setRefreshScrollToBottom(!1),e.fire("MailLog",{m:"sync from setfid"}),n.refresh("fidchange"))},formatParticipantsList:function(e,t){var n=this,r=[],i=e.recipients,s=n.template,o="",u=i.length,c;switch(u){case 0:return"";case 1:return n.
isSentOrDraftCtx?o=e.msgs[0]&&e.msgs[0].toEmail?a(f(e.msgs[0].toEmail)):"":o=n.getParticipantName(i[0],u,0),l(s.participant_name,{firstParticipant:o,moreParticipants:" "});default:r.push('<div class="name"></div>');for(c=u-1;c>0;c--){r.push(l(s.nameIterator,{from:n.getParticipantName(i[c],u,c)})),t--;if(!t)break}return l(s.participant_name,{firstParticipant:n.getParticipantName(i[0],u,0),moreParticipants:l(s.moreParticipants,{nameIterator:r.join("")})})}},getParticipantName:function(e,t,n){var r=this,i,s,o;return t>1&&e.email===r.currentAccountEmail?i=strings.str_me_lowercase:(o=r.isSentOrDraftCtx?e:r.formatFromName(null,null,e),t===1?i=o.name?o.name:o.email:(s=o.name?o.name.split(" "):[o.email],i=s[0]),i=a(f(i))),n===0?i+=t>2?"&hellip;":t===1?"":", ":n!==t-1&&(i+=", "),i||"&nbsp"},getMsgFid:function(e){var t;return e.fid?t=e.fid:e.folderInfo&&e.folderInfo.fid?t=e.folderInfo.fid:e.sourceFolderInfo&&e.sourceFolderInfo.fid?t=e.sourceFolderInfo.fid:t=this.fid,t},getInboxService:function(e){var t=e.srvmap,n="",r,i,s;if(!t){i=e.msgs[0].inboxservices||[],e.srvmap=t={};for(r=i.length-1;r>=0;r--)t[i[r].name]=i[r].value}return!strings.str_cfg_tog_certified_icon&&t.crt&&delete t.crt,(C||!t.crt)&&(t[N]||t.siu||e.msgicon)&&(t&&t[N]?n=k[t[N]]||"":e.msgicon&&(n=e.msgicon)),/^certified/.test(n)&&e.recipients&&e.recipients.length===1&&(s=e.recipients[0].email||"",t.fantasySportsService=/^sports-fantasy-replies@/.test(s)?"fantasy-certified":""),NeoConfig.isSSL&&n==="certified"&&(n="certified-ssl"),!n&&P&&P[t.verifieddomain]&&(n=P[t.verifieddomain]),t.inboxService=n,n},getMsgFromEmail:function(e){return e.from?e.from.email:e.header&&e.header.from?(e.from=e.header.from,e.header.from.email):""},getMsgReceivedDate:function(e){return e.receivedDate?e.receivedDate:e.header&&e.header.receivedDate?e.header.receivedDate:Math.floor(Date.now()/1e3)},formatters:{addDateLabel:function(e,t,n){return e.addDateLabel?l(n.template.addDateLabel,t,n.formatters,0,strings):""},isThisWeek:function(e,t,n){return e.thisWeek?l(n.template.isThisWeek,t,n.formatters,0,strings):""},id:function(){return j},cid:function(e){return e.cid},subject:function(e){return e.subject?a(f(e.subject)):strings["str_msg-view_no_subject"]},subjectDir:function(e){return NeoConfig.bidi&&e.subjectDir?a(f(e.subjectDir)):""},xapparentlyto:function(e,t,n){return e.msgs[n.lastMsgIdx].xapparentlyto},status_conv:function(e){var t="&nbsp;";return e.totalReplied?t=strings["str_msg_list_info-replied"]:e.totalForwarded?t=strings["str_msg_list_info-forwarded"]:e.totalUnread&&(t=strings["str_msg_list_info-unread"]),t},status_title:function(e){var t="",n=e.srvmap.inboxService||"";if(n==="certified"||n==="certified-ssl")t=l(strings.str_msg_list_info_verified_attr,strings);return t},checkbox_label:function(e,t,n){return l(strings.str_msg_list_checkbox_label,{convnumber:n.renderIndex+1})},checked:function(e,t,n){return n._listview&&F&&n._listview.checkmode?" checked=true ":""},containerselect:function(){return F?" subselected ":""},page_conversation_history:function(e){return l(e.template.page_conversation_history,e,e.formatters,0,strings)},archiving_disabled:function(e){return l(e.template.archiving_disabled,e,e.formatters,0,strings)},from:function(e){return a(f(e))},participant_name:function(e,t,n){return n.formatParticipantsList(e,L)},fromDir:function(){return""},fromTooltip:function(e){var t,n=e.recipients.length;if(n===1)t=e.recipients[0].email;else if(n>1){t="";for(var r=0;r<n-1;r++)t+=(e.recipients[r].name?e.recipients[r].name:e.recipients[r].email)+", ";t=t.substr(0,t.length-2)+" ",t+=strings.str_msg_list_from_sender_and+" "+e.recipients[n-1].name}return a(f(t))},sender:function(e,t,n){return l(n.template.sender,0,0,0,strings,null,n)+" "+a(f(e.from.name))},received_date:function(e){return o.dateFormatter(new Date(e.anchorDate*1e3),strings.str_tog_dateformat_header_long_l10n)},date:function(e,t,n){return e.anchorDate?o.dateFormatter(new Date(e.anchorDate*1e3),strings.str_tog_dateformat_messagelist_timeonly_l10n):e.receivedDate?o.dateFormatter(new Date(e.msgs[n.lastMsgIdx].receivedDate*1e3),strings.str_tog_dateformat_messagelist_timeonly_l10n):""},receivedDate:function(e){var t=e.anchorDate*1e3;return o.dateFormatter(new Date(t),Neo.getDateFormat(t,!0))},receivedDateAria:function(e){return o.dateFormatter(new Date(e.anchorDate*1e3),strings.str_tog_dateformat_messagelist_aria)},expanded:function(e,t,n){return e.msgs.length>1&&n.renderExpand?n.template.expanded:""},snippetStr:function(e,t,n){var r=n;return e.snippet&&r.fid!=="%40C%40Chats"?a(f(e.snippet)):""},snippet:function(e,t,n){var r=h.get("neo.pref.general.snippets")!="-1"?!0:!1;return n.fid!=="%40C%40Chats"&&r?l(n.template.snippet,e,n.formatters,e,strings,null,n):""},omitsnippetline:function(e,t,n){var r=h.get("neo.pref.general.snippets")!="-1"?!0:!1;return n.fid!=="%40C%40Chats"&&r?"":l(n.template.omitsnippetline,e,n.formatters,e,strings,null,n)},hasAttach:function(e,t,n){return e.totalHasAttach?n.template.hasAttach:""},size:function(e){return Math.ceil(e.size/1e3)},is_threadofone:function(e,t,n){return e.totalMsgs<=1?l(n.template.is_threadofone,null,null,null,strings,null):""},ariaExpanded:function(e,t,n){return e.totalMsgs>1?l(n.template.ariaExpanded,e,n.formatters,e,strings,null,n):""},threadCount:function(e){return e.totalMsgs>1?e.totalMsgs:""},thread_cnt:function(e,t,n){return e.totalMsgs>1?l(n.template.thread_cnt,e,n.formatters,e,strings,null,n):""},thread_cnt1:function(e,t,n){return e.totalMsgs>1?l(n.template.thread_cnt1,e,n.formatters,e,strings,null,n):""},flags:function(e,t,n){return[F?" selected ":" ",e.totalUnread>0?" unread ":"",e.totalFlagged>0?" flagged ":"",n.getInboxService(e)].join(" ")},flag_info:function(e){var t="",n=e.srvmap.inboxService||"";return n?t=n:e.totalUnread?t="unread":e.totalReplied?t="replied":e.totalForwarded&&(t="forwarded"),"info-"+t},flag_info_extra:function(e){var t=e.srvmap&&e.srvmap.fantasySportsService;return t?"info-"+t:""},bold:function(e){return e.totalUnread?"bold"
:""},flag_info_hover:function(e){var t=e.srvmap.inboxService||"";return t==="certified"||t==="certified-ssl"?"info-"+t:""},hasTrashIcons:function(t,n,r){var i=e.mail.persist.MetaData,s=i.get("deleteCancelCount"),o=e.common.Utils.features.enabled("trashInList"),u=e.common.Utils.features.enabled("hideHoverDelete"),a=D.value("maxCountDeleteCancelBeforeHide"),f=!o||u&&+s>=a;if(!f)return l(r.template.hasTrashIcons,null,r.formatters,null,strings,null,r)},hasTrashIcons_message:function(t,n,r){if(e.common.Utils.features.enabled("trashInList"))return l(r.template.hasTrashIcons_message,null,r.formatters,null,strings,null,r)},flag_star:function(e,t,n){return l(n.template.flag_star,e,n.formatters,e,null,null,n)},flag_attachment:function(e,t,n){return e.totalHasAttach?n.template.hasAttachment:""},isFlagged1:function(e,t,n){return e.totalFlagged>0?l(n.template.isFlagged1,e,n.formatters,e,strings,null,n):""},isFlagged2:function(e,t,n){return e.totalFlagged>0?l(n.template.isFlagged2,e,n.formatters,e,strings,null,n):""},isFlagged_else1:function(e,t,n){return e.totalFlagged>0?"":l(n.template.isFlagged_else1,e,n.formatters,e,strings,null,n)},isFlagged_else:function(e,t,n){return e.totalFlagged>0?"":l(n.template.isFlagged_else,e,n.formatters,e,strings,null,n)},isFlagged:function(e,t,n){return e.totalFlagged>0?l(n.template.isFlagged,e,n.formatters,e,strings,null,n):""},hide_attachments_else:function(e,t,n){return l(n.template.hide_attachments_else,e,n.formatters,null,e.totalHasAttach?strings:null,null,n)},contains_attachment:function(e,t,n){return e.totalHasAttach?l(n.template.hide_attachments_else,0,0,0,null,null,n):""},to_frm_srch_title:function(e,t,n){return NeoConfig.strings[n.isSentOrDraftCtx?"str_mas_to_srch_attr":"str_mas_frm_srch_attr"]},inboxservices:function(t,n,r){try{var i=t.srvmap,s=t.msgs[r.lastMsgIdx].inboxservices&&e.Lang.isString(t.msgs[r.lastMsgIdx].inboxservices)&&t.msgs[r.lastMsgIdx].inboxservices.match("data-certified")?[{name:"crt",value:"transactional"}]:[],o;if(!i){t.srvmap=i={};for(o=s.length-1;o>=0;o--)i[s[o].name]=s[o].value}return(C||!i.crt)&&(i[N]||t.msgicon)?l(r.template.inboxservices,t,r.formatters,t,null,null,r):""}catch(u){return typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-maillist-conv-convlist:1",u,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-maillist-conv-convlist:1"),""}},msgicon:function(e){var t=e.srvmap,n={"http://mail.yimg.com/a/i/cal/bell4.gif":"https://s.yimg.com/nq/i/cal/bell4.gif","http://mail.yimg.com/ok/u/assets/sprite/fresh/y_16x16_1.gif":"https://s.yimg.com/ok/u/assets/sprite/fresh/y_16x16_1.gif"},r;return o.isSSL()&&t&&t[N]&&n[t[N]]&&(t[N]=n[t[N]]),r=t&&t[N]?t[N]:e.msgicon,r&&r.match(/ybang_/g)&&(r=r.replace("a/i/us/pim/ybang_16x16_1.gif","ok/u/assets/sprite/fresh/transparent_1x1_1.gif")),r},msgicon_title:function(e,t,n){var r=n.formatters.flag_info(e);return r!=="info-"&&r!==""?strings[["str_msg_list_",r].join("")]:""},get_nested_message_response:function(e,t,n){var r="";return e.detail&&n.renderExpand&&(r=l(n.template.nestedmessagetree,e,n.formatters,e,strings,null,n)),r},nestedmessage:function(e,t,n){var r="",i,s={formatters:n.msgFormatters,template:n.template,parent:n};if(e.detail)for(i=0;i<e.msgs.length;i++)s.renderSubid=i,r+=l(n.template.nestedmessage,e.msgs[i],null,e.msgs[i],strings,null,s);return r},string_unread:function(){return strings["str_msg_list_info-unread"]},str_mark_read_unread:function(){return strings.str_mark_read_unread}},msgFormatters:{id:function(e,t,n){return n.parent._listview._idSub(j,n.renderSubid)},flag_sub_class:function(e,t,n){return[n.parent.isRenderSelected(F,n.renderSubid)?" selected ":" ",F?" subselected ":" ",e.flags.isRead?"":" unread ",e.flags.isFlagged?" flagged ":""].join("")},flag_sub_star:function(e,t,n){return l(n.template.flag_sub_star,e,n.formatters,e,null,null,n)},flag_sub_attachment:function(e,t,n){return e.flags.hasAttachment?n.template.hasAttachment1:""},checked:function(e,t,n){return n.parent._listview&&n.parent.isRenderSelected(F,n.renderSubid)&&n.parent._listview.checkmode?" checked=true ":""},hide_attachments_else1:function(e,t,n){return l(n.template.hide_attachments_else1,e,null,null,e.flags.hasAttachment?strings:null,null,n)},received_date:function(e){return o.dateFormatter(new Date(e.receivedDate*1e3),strings.str_tog_dateformat_header_long_l10n)},receivedDate:function(e,t,n){var r=n.parent.getMsgReceivedDate(e)*1e3;return o.dateFormatter(new Date(r),Neo.getDateFormat(r,!0))},from:function(e){return a(f(e))},from_name:function(e,t,n){var r,i;return n.parent.accountEmails=n.parent.accountEmails||n.parent.getAllAccountEmails(),i=n.parent.getMsgFromEmail(e),n.parent.accountEmails&&n.parent.accountEmails[i]&&O.isDraftFid(n.parent.getMsgFid(e))?r=strings.str_draft_label:(r=O.isDraftFid(n.parent.fid)||O.isSentFid(n.parent.fid)?e.from.name:n.parent.formatFromName(null,null,e.from).name,r=a(f(r))),l(n.template.from_name,r,null,r,strings,null,n)},fromDir:function(e){return NeoConfig.bidi?e.from.nameDir:""},snippetStr:function(e){var t=e.snippet?a(f(e.snippet.replace(/^(\n|\r)+$/,""))):"";return t||""},folder_name:function(e,t,n){return l(n.template.folder_name,e,null,e,strings,null,n)},folderName:function(e,t,n){var r=n.parent.getMsgFid(e),i=O.getSystemFolderName(r,r);return a(f(i))},folder_vis:function(e,t,n){var r=n.parent.getMsgFid(e),s=i.get(r);return r===n.parent.fid||!s||s.isSystem&&!O.isDraftFid(r)?l(n.template.folder_vis,null,null,null,strings,null):""},is_draft:function(e,t,n){return O.isDraftFid(n.parent.getMsgFid(e))?l(n.template.is_draft,null,null,null,strings,null):""},is_draft1:function(e,t,n){return O.isDraftFid(n.parent.getMsgFid(e))?l(n.template.is_draft,null,null,null,strings,null):""},bold1:function(e){return e.flags.isRead?"":"bold"},snippet1:function(e,t,n){return l(n.template.snippet1,e,null,e,strings,null,n)},isFlagged3:function(e,t,n){return e.flags.isFlagged?l(n.template.isFlagged3,e,n.formatters,e,strings
,null,n):""},isFlagged4:function(e,t,n){return e.flags.isFlagged?l(n.template.isFlagged4,e,n.formatters,e,strings,null,n):""},isFlagged5:function(e,t,n){return e.flags.isFlagged?l(n.template.isFlagged5,e,n.formatters,e,strings,null,n):""},isFlagged_else3:function(e,t,n){return e.flags.isFlagged?"":l(n.template.isFlagged_else3,e,n.formatters,e,strings,null,n)},isFlagged_else2:function(e,t,n){return e.flags.isFlagged?"":l(n.template.isFlagged_else2,e,n.formatters,e,strings,null,n)},to_frm_srch_title:function(e,t,n){var r=n.parent.getMsgFid(e);return NeoConfig.strings[O.isSentFid(r)||O.isDraftFid(r)?"str_mas_to_srch_attr":"str_mas_frm_srch_attr"]},flag_sub_info:function(e,t,n){return[n.parent.isRenderSelected(F,n.renderSubid)?" info-selected ":"",F?" info-subselected ":"",e.flags.isRead?"":" info-unread ",e.flags.isFlagged?" info-flagged ":""].join("")},status:function(){return"unread"}},columns:{date:{sortKey:E,sortOrder:S},attachment:{sortKey:E,groupBy:"hasAttachment",sortOrder:S},"sort-flagged":{sortKey:E,groupBy:"flagged",sortOrder:S},unRead:{sortKey:E,groupBy:"unRead",sortOrder:S},subject:{sortKey:"subject",sortOrder:x}},sortList:function(t,n){var r=this,i=!1,s=r.columns,a=strings.str_msg_list_sorting,f=r.sortedColumn,l,c,h;if(t===f.action)return;t==="date-asc"?(t=E,h=x):t==="date-desc"&&(t=E,h=S);if(r.sorting===1||!s[t])return;NeoConfig.timeChunk&&(t!=="date"?r.timeChunk=!1:r.timeChunk=!0),l=o.wcopy(s[t]),l.action=t;if(t===f.action){l.sortOrder=f.sortOrder===S?x:S;switch(t){case"sort-flagged":l.groupBy=f.groupBy==="flagged"?"unFlagged":"flagged";break;case"unRead":l.groupBy=f.groupBy==="unRead"?"read":"unRead";break;case"attachment":l.groupBy=f.groupBy==="hasAttachment"?"noAttachment":"hasAttachment"}i=!0}h&&(l.sortOrder=h),r.folderIDSortCol[r.fid]=r.sortedColumn=l,c=l.sortKey===E&&l.sortOrder===x&&!l.groupBy,i&&t!=="unRead"&&t!=="flagged"?(r._listview.getSelectCount()>1&&r._listview.clearSelection(1),r._listview.reverse(c,a)):(r._listview.setStatus(a),r.sorting=1,e.fire("MailLog",{m:"Sortlist refresh"}),r._listview.refresh(),r._listview.toggleScrollPos(c)),l.sortKey===E&&l.sortOrder!==(NeoConfig.sortOrder||"down")&&!l.groupBy&&(NeoConfig.sortOrder=l.sortOrder),r.sortMenu&&n&&r.sortMenu.updateSortInViewMenu(n),e.one("#btn-conv-view span")&&(e.one("#btn-conv-view span").set("innerHTML",u.getSortKeyString(t)),NeoConfig.previewPanePref===2&&e.one("#btn-togglethread")&&e.one("#btn-togglethread").setStyle("right",e.one("#btn-conv-view").get("offsetWidth")+10+"px")),o.features.enabled("LFTCache")&&M.invalidate(),e.fire("list:sortChange",r.sortedColumn)},bindUI:function(){var t=this;t.currentAccountEmail=NeoConfig.emailAddress,o.features.enabled("LFTCache")&&(t.evt.push(t.before("fidChange",function(e){M.isEnabledForFid(e.prevVal)&&M.set(e.prevVal,t._listmodel.get("list"))})),t.evt.push(e.after("accounts:select",function(e){e.acctId!==e.prevAcctId&&M.invalidate()}))),t.evt.push(t.after("fidChange",function(){t.isSentOrDraftCtx=O.isDraftFid(t.fid)||O.isSentFid(t.fid),t.set("selectCount",0),t.setLabel(),t._listview.once("renderComplete",function(){e.fire("prefetchConversations",{fid:t.fid,cids:t._listview.get("model").get("list")})})}),t._listview.on("beforeRender",function(){t.fire("beforeRender")},t),e.on("previewPane:expanded",function(){t._listview.set("previewPaneEnabled",!0)},t),e.on("previewPane:collapsed",function(){t._listview.set("previewPaneEnabled",!1)},t),e.on("accounts:select",function(e){t.currentAccountEmail=m&&m.getAccountAttribute(e.acctId,"email")||NeoConfig.emailAddress},t),t.on("pageAction",function(e){var n;e.args&&e.args.action&&(e.args.action==="home"?t._listview.scrollToTop():e.args.action==="page"?t._listview.set("page",e.args.val):(n=t._listview[e.args.action],n&&n.call(t._listview,e.args.action)))},t),t._listview.on("renderComplete",function(n){t.fire("renderComplete",n),e.fire("list-stat:renderComplete",{endTime:Date.now()})},t),t.rootNode.on("click",t.clickHandler,t)),t.bindInfiniteScroll()},updateSortDropDown:function(t){this.sortMenu=new e.mail.ui.ListViewControls(t.node,this,"sortoptions"),this.sortMenu.updateSortInViewMenu(t)},clickHandler:function(t){var n=this,r=t.target,i=o.getDataAction(t),s,u,a,f,l,c;switch(i.action){case"selectAll-message":case"selectAll":n._listview.selectAll(!n._listview.hasAnySelected());break;case"select-dd":n.createSelectMenu(i.node);break;case"retry-msglist-load":e.fire("MailLog",{m:"clickHandler refresh"}),n.refresh();break;case"menu":i.node.hasClass("sortby")&&(n.sortMenu=new e.mail.ui.ListViewControls(i.node,n,"sortoptions"),n.sortMenu.setup(n.template));break;case"thrd-read":s=r.ancestor(".list-view-item").hasClass("unread")?"read":"unread";break;case"date":case"date-asc":case"date-desc":case"unRead":case"attachment":case"sort-flagged":n.sortMenu=new e.mail.ui.ListViewControls(i.node,n,"sortoptions"),n.sortList(i.action,r)}r.getAttribute("data-action")==="msg-frm-srch"&&(NeoGV.masStarted=!0,s="frmSrch"),r.hasClass("arrow")&&(a=n._listview.getItem(t),f=t.target.ancestor(".list-view-item"),l=n._listview._getIndexN(f),n._listview._expandItem(a,l,f));if(r.hasClass("flag")||r.ancestor(".flag")){if(r.ancestor(".mb-native-ad"))return;s=r.ancestor(".list-view-item").hasClass("flagged")?"unflagged":"flagged",a=n._listview.getItem(t),u=s==="flagged"?"flag_":"unflag_",u+=a.mid?"thrd_msg":a.totalMsgs>1?"thrd":"message",c=a.mid?[a.mid]:a.msgs.map(function(e){return e.mid}),e.fire("mt:click",{action:u,append:{msgID:c}})}else r.hasClass("delete-msg")?(s="delete",a=n._listview.getItem(t),c=a.mid?[a.mid]:a.msgs.map(function(e){return e.mid}),e.fire("mt:click",{action:a.mid?"msglist_delBtn_thrd_msg":a.totalMsgs>1?"msglist_delBtn_thrd":"msglist_delBtn",append:{msgID:c}})):r.hasClass("archive-msg")?(s="archive",a=n._listview.getItem(t),e.fire("mt:click",{action:a.mid?"msglist_archiveBtn_thrd_msg":a.totalMsgs>1?"msglist_archiveBtn_thrd":"msglist_archiveBtn"})):r.hasClass("restore-msg")?(s="restore",a=n._listview.getItem(t),e.fire("mt:click",{action:
a.mid?"msglist_archiveBtn_thrd_msg":a.totalMsgs>1?"msglist_archiveBtn_thrd":"msglist_archiveBtn"})):r.hasClass("expansion_retry")&&e.fire("mt:click",{action:"retry_expand_thrd"});s&&e.use("mail-ui-proxyevents",function(){a=a||n._listview.getItem(t),e.mail.ui.MailEventsProxy.handleUI({action:s,hasMsgList:!0,target:r},n.getMsgFid(a),n,[a])})},setToolbarElements:function(e){var t=this,n,r;e&&(n=e.one("#pagetoolbar"),n&&(r=e.one(".cbox input"),r&&(t.selectAllNode=r)))},createSelectMenu:function(t){var n=this;n.selectMenu=new e.mail.ui.ListViewControls(t,n,"selectoptions"),n.selectMenu.setup(n.template),n.selectMenuEventListener||(n.selectMenuEventListener=n.on("selectMessages",function(t){var r=t.action;if(n._listview.stop()<=0)return;switch(r){case"all":n._listview.selectAll(!0);break;case"none":n._listview.selectAll(!1);break;case"Read":case"unRead":case"Flagged":case"unFlagged":n._listview.selectSome("is"+r)}e.fire("mt:click",{action:"msglist_selectMnu",args:{fid:n.fid},append:{ltxt:"sel_"+r}})}))}},!0),I.setConvHeaderList=function(e){var t,n;for(t=0,n=e.length;t<n;t++)p.push(e[t])},I.getConvHdrList=function(){return p},I.getNeighbors=function(){},e.mail.ui.ConvList=I},"1.0.0",{requires:["mail-ui-maillist","mail-ui-common-string-utils","mail-ui-conv-maillist-model","mail-ui-conv-maillist-view","mail-controller-conversations","mail-controller-imapin","mail-common-utils-features","mail-persist-meta-data","mail-ui-listview-controls","common-utils","mail-ui-folder-utils"]});


YUI.add("mail-ui-convpane-base",function(e){function C(e){return e.fid||e.folderInfo&&e.folderInfo.fid||e.sourceFolderInfo&&e.sourceFolderInfo.fid}function L(t,n){var r=this;r.message&&t&&(n=n||r.message.cid,!n,e.fire("Y.mail.ui.ConvPane:"+t,n,r.guid))}function A(e){var t=this;e==="async"&&!t.outboundReq&&(t.outboundReq=1)}e.namespace("mail.ui");var t=e.common.Utils,n=t.escapeHtml,r=t.unescapeHtml,i=e.ui.Templates,s=e.mail,o=s.ui.MessagePaneUtils,u=s&&s.Controller?s.Controller.Messages:{},a=s&&s.model?s.model.DataStore.Messages:{},f=a.getPermMidPart,l=a.compareMultiVersionMids,c=s.model.ConvStore.Conversations,h=c.getPermCidPart,p=a.toMessage,d=a.toMessageInfo,v=e.one("#inboxcontainer"),m="mail-ui-convpane-bind",g=s.model.ConvStore,y="ERROR: ConvPaneRead ",b=t.settings.value("previewLoadDelay"),w=6e5,E=15e3,S=1,x={},T=e.mail.ui.FolderUtils,N=t.features,k=function(e){var t=this;k.superclass.constructor.call(t,e),e=e||{},t._evts=[],t.formatters._shared_module_thread_thread_display_rollup=function(){var e=i._shared_module_thread_thread_display_rollup;return t.numSelected&&e?t.sub({s:e.base,f:t.readFormatters}):""},t.oTemplate=i._shared_module_thread_thread_pane,t.statOp="convread",t.stopwatchPreview="MsgInPreview",t.composeWidgets={},t.midObjMap={},t.lftNotifyID=null,t.initialRender=!1,t.dirty=!1,t.primaryMid=null,t.refreshOnActive=!1,t.flagMsgList=[],t.isStale=!1,t.msgTrucationStatus={disabled:{},loading:{}},t.set("handleKeysLocally",1),t.set("charCodes","13, 32, 33, 34, 35, 36, 46, 65, 67, 70, 65+meta, 65+ctrl, 75, 76, 82, 83, 90, 188, 190"),t.set("parentNode",t.parentNode),t.expandMessageTimers={},e.fid&&e.message&&t.set("message",{message:e.message,submessage:e.submessage,neighbors:e.neighbors,fid:e.fid,midtocid:e.midtocid?e.message.mid:null}),t._cancelMarkAsRead=function(){t.tmFireRead&&(clearTimeout(t.tmFireRead),t.tmFireRead=null)}};e.extend(k,e.mail.ui.MailPane,{onKeyDown:function(n){var r=this,i,s,u,a,f,l,c,h,p,d=n.target,v,g=function(n){e.use("common-ui-notification-v2","common-persist-user-data",function(e){var r=n?e.common.persist.UserData.isUsersEmailAddress(n)?strings.str_cont_add_to_cont_alert_user_email_bd:t.substitute(strings.str_cont_add_to_cont_alert_already_in_contacts_bd,{from_email:"["+n+"]"}):strings.str_cont_add_to_cont_alert_select_indivitual_msg_bd,i=n?e.common.persist.UserData.isUsersEmailAddress(n)?"info":"attention":"attention";e.common.ui.NotificationV2.notify(r,{type:i,close:!0,closeOnExternalClick:!0,closeOnNavClick:!0,duration:4e3,customClass:"link-style",speed:"show-fast"})})};if(!r.message)return;l=r.message.msgs;var y=function(){var e=!1,t=r.getRoot().one(".thread-focus"),n;return t?(n=t.next(".thread-item")||t.next(".add-to-conv"),n&&(e=!0,n.hasClass("super-hidden")&&r.superCollapsedNode&&(n=r.superCollapsedNode),n.hasClass("thread-item")?(r.selNode=n,r.focusMessageCard()):n.focus())):(r.selNode=r.getRoot().one(".thread-item.expanded"),r.focusMessageCard(),e=!0),e},b=function(){var e=r.getRoot().one(".thread-focus"),t;e?(t=e.previous(".thread-item"),t&&(t.hasClass("super-hidden")&&(e.hasClass("thread-item")&&r.superCollapsedNode?t=r.superCollapsedNode:e.hasClass("supercollapsed")&&(t=e.previous(".thread-item:not(.super-hidden)"))),t.hasClass("thread-item")?(r.selNode=t,r.focusMessageCard()):t.focus())):(r.selNode=r.getRoot().one(".thread-item.expanded"),r.focusMessageCard())},w=function(e,t){var n;for(n=l.length-1;n>-1;n--){f=l[n];if(!T.isDraftFid(r.getMsgFid(f))){r.initReplyForward(e.action,f,t);return}}};if(r.selNode){if(r.selNode.hasClass("add-to-conv")){var E=r.selNode.previous();u=E.getAttribute("data-mid")}else u=r.selNode.getAttribute("data-mid");a=r.getMessageIdxByMid(u),f=l[a]}if(n.metaKey||n.ctrlKey)return;if(n.keyCode===38||n.keyCode===40)return;n.target&&!n.target.ancestor(".compose-assist")&&n.halt();switch(n.keyCode){case 13:case 32:if(r.selNode){if(r.selNode.hasClass("supercollapsed"))r.expandSuperCollapsedNodes(),r.selNode=r.listNode&&r.listNode.one(".thread-item");else if(r.selNode.hasClass("add-to-conv"))r.initReplyForward("reply-all",f);else{if(r.selNode.hasClass("quickReply"))return;if(!(d.ancestor(".thread-item",!0)&&!d.hasClass("more_recp")&&!d.hasClass("lozengfy")&&!d.hasClass("info-hover")&&!d.hasClass("flag")))return;r.selNode.hasClass("expanded")?r.collapseMessage(r.selNode):(r.scrollOnExpansion=!0,r.parentCW.msgList&&NeoConfig.horzPane?c=!0:c=!1,r.expandMessages(a,"one","no",!1,{scroll_to_msg:c}),r.selNode=r.getMsgNodeByMid(u))}r.focusMessageCard()}break;case 190:y();break;case 188:b();break;case 67:n.shiftKey&&(i="addcontact",f&&(v=f&&f.header&&f.header.from&&f.header.from.email,o.isKnownEmailAddress(v)?g(v):e.use(m,function(){r.handleUI(f,i)})));break;case 65:case 82:case 70:if(r.getRoot()&&r.getRoot().one(".thread-focus")&&r.getRoot().one(".thread-focus").hasClass("quickReply"))break;h={},n.keyCode===65?h.action="reply_all":n.keyCode===82?h.action="reply_sender":n.keyCode===70&&(h.action="forward"),r.composeAction=!0,n.shiftKey||!f?w(h,!0):r.initReplyForward(h.action,f,!0);break;case 75:n.shiftKey||!f?(p=r.message,i=p.totalUnread?"read":"unread",s=p.totalUnread?"read_thrd_hdr":"unread_thrd_hdr",r.handleUI(p,i)):(f.flags.isRead?(i="unread",s="unread_thrd_msg_hdr"):(i="read",s="read_thrd_msg_hdr"),e.use(m,function(){r.handleUI(f,i)}));break;case 76:n.shiftKey||!f?(p=r.message,p.totalFlagged?(i="unflagged",s="unflag_thrd_hdr"):(i="flagged",s="flag_thrd_hdr"),r.handleUI(p,i)):(f.flags.isFlagged?(i="unflagged",s="unflag_thrd_msg_hdr"):(i="flagged",s="flag_thrd_msg_hdr"),e.use(m,function(){r.handleUI(f,i)}));break;case 46:r.parentCW&&r.parentCW.onKeyDown(n);break;default:k.superclass.onKeyDown.call(r,n)}},setMessage:function(n){var r=this,i=!1,s,o,u,a,f,l,c,h;if(!n&&!r.message){o=r.getRoot(),u=o?o.one(".count"):null,u&&u.empty(),r.numSelected=0,r.clearSelection();return}h=t.Stopwatch.get("MsgInPreview")||r.stopwatch,h&&(h.start(1,"Set"),e.fire("MessagePane:inception",n)),clearTimeout(r.slowLoad),clearTimeout(r.loadingTimer),r.isLoaded=0
,r.scrollTop=0,r.disableTruncate=0,r.primaryMid=null,r.numRetries=r.loading_slow=r.loading_error=r.loading_moved=0,r.expandAllMode=!1,r.readBatch=null,n?(s=n.message.length,s===1&&!r.fullView&&(a=r.parentCW,f=a&&a.msgList,l=f&&f._listview,c=l&&l.checkmode),s>1?r.handleMultipleMessagesSelected(n,h):s===1&&(r.fullView||c)?r.handleMultipleMessagesSelected(n,h):(i=!0,r.handleSingleMessageSelected(n))):r.clearSelection(n),r.fire("paneMessage",{content:i})},clearSelection:function(){var e=this;e.numSelected=0,e.registerLFTNotify(),e.neighbors=e.message=null;if(!e.get("visible"))return;e.isPrevPaneVisible()&&e.saveDraftAction(),e.destroyRichCompose(),e.closeAllCompose(),e.render()},handleSingleMessageSelected:function(e){var t=this,n=t.message||{};t.updateSingleMessageSelectedState(e,n);if(!t.get("visible"))return;if(!t.parentNode)return;t.registerLFTNotify();if((!t.parentCW||!t.parentCW.getCurrentView||t.parentCW.getCurrentView()!=="scroll-view-noprev")&&n.cid&&t.message.cid&&n.cid===t.message.cid){if(!t.submessage)return;t.selectMessage(t.submessage)||(t.loadPaneContent(1),t.selectMessage(t.submessage))}else n.cid&&t.abortRequests(),t.fullView?t.loadPaneContent(2):t.debouncedBufferPaneContent()},debouncedBufferPaneContent:t.debounce(function(){this.loadPaneContent(2)},b),updateSingleMessageSelectedState:function(e,t){this.numSelected=1,this.fid=e.fid;if(!t.cid||e.message.cid&&h(t.cid)!==h(e.message.cid)||e.midtocid)this.isPrevPaneVisible()&&this.saveDraftAction(),this.message=e.message,this.destroyRichCompose();this.submessage=e.submessage,this.midtocid=e.midtocid,this.submessage&&(this.scrollOnExpansion=!0),this.neighbors=e.neighbors},handleMultipleMessagesSelected:function(e,t){var n=this;n.isPrevPaneVisible()&&n.saveDraftAction(),n.numSelected=e.message.length,n.neighbors=n.message=null;if(!n.get("visible"))return;n._cancelMarkAsRead(),t&&t.start(2,"PreLoadExtra2"),n.loadExtra(function(){t&&t.start(2,"LoadExtraCB2");try{n.render()}catch(e){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailpane-conv-convpane:1",e,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailpane-conv-convpane:1")}})},destroyRichCompose:function(){var e=this;e.richcompose&&(e.richcompose.cleanupRichCompose(),e.richcompose=null)},getMessage:function(){var e=this,n=e.message?{message:e.message,fid:e.fid}:null,r=t.Stopwatch.get("MsgInPreview")||e.stopwatch;return r&&r.start(1,"Get"),e.numSelected&&!e.message&&(n={message:new Array(e.numSelected),fid:e.fid}),r&&r.start(1,"PostGet"),n},hasMessage:function(){var e=this;return e.message&&e.message.cid},showActionsBar:function(t){var n,r=e.all(".thread-item .thread-actions");r.removeClass("show-actions"),r.addClass("hide-actions"),n=t&&t.one(".thread-actions"),n.removeClass("hide-actions"),n.addClass("show-actions")},getMessageIdxByMid:function(e){var t=f(e);return this.midObjMap[t]},getMessageIdxByMidLookup:function(e,t,n){for(var r=0;r<t.length;r++)if(l(t[r].mid,e))return r;return n?null:0},getMsgFromNode:function(t){var n=this,r,i;if(t){r=t.getAttribute("data-mid"),i=n.getMessageIdxByMid(r);if(e.Lang.isNumber(i))return n.message.msgs[i]}},getMsgNodeByMid:function(e){var t=this.get("parentNode"),n=f(e);if(t)return t.one("div[data-mid='"+n+"']")},getComposeNodeByMid:function(e){var t=this.get("parentNode"),n=f(e);if(t)return t.one("div[data-draftmid='"+n+"']")},refreshMidObjMap:function(e){var t={},n;for(var r=0;r<e.length;r++)n=f(e[r].mid),t[n]=r;return t},removeDraft:function(e){var t=this,n=null,r,i=t.message.msgs,s;for(s=e-1;s>=0;s--){N.enabled("yodaConversationRead")?r=i[e].inReplyToRfc822&&i[e].inReplyToRfc822.indexOf(i[s].messageIdRfc822)>=0:r=i[e].inReplyTo===i[s].mimeMsgId;if(r){n=i[s].mid;break}}n&&delete t.composeWidgets[f(n)]},collapseAllMessageCards:function(){var e=this,t=e.get("parentNode"),n,r;t&&(n=t.all("div.thread-item"),n.each(function(t){!t.hasClass("quickReply")&&!t.hasClass("tall-compose")&&(t.setStyles({height:"auto","margin-top":0}).removeClass("expanded"),r=t.one(".thread-body"),r.setStyles({height:0,opacity:0}),t.setAttribute("aria-expanded","false"),t.one(".thread-footer")&&t.one(".thread-footer").addClass("hidden"),e.fire("MessagePane:unload",t))}),e.selNode=null)},closeAllCompose:function(){var e=this,t=e.composeWidgets,n,r;for(n in t)r=t[n].cv.view,r.draft&&r.draft.state!=="savingAndSending"&&r.draft.state!=="sending"&&r.draft.state!=="captchaing"&&r.closeCompose();e.activeComposeWidget=null,e.composeWidgets={}},getComposeWidgets:function(){var e=this,t=[],n,r;for(n in e.composeWidgets)r=e.composeWidgets[n].cv,t.push(r.view);return t},registerLFTNotify:function(t){var n=this;if(!t)n.lftNotifyID&&(e.fire("ds:conv:unreg",n.lftNotifyID),n.lftNotifyID=null);else if(!n.lftNotifyID||h(n.lftNotifyID)!==h(t))n.lftNotifyID=t,e.fire("ds:conv:reg",n.lftNotifyID)},triggerConvOnboarding:function(){var t=this;t.message.totalMsgs>1&&e.use("mail-ui-onboarding",function(e){e.mail.ui.Onboarding.registerDefaultOnboarding({name:"convTutorial",node:t.hdr&&t.hdr.one(".flag"),offset:[-320,-20],bdText:strings.str_convs_callout_description+"<br/><br/>"+strings.str_convs_settings_link,btnPrimaryText:strings.str_ok,pointer:"left-top",keyVal:Math.round(Date.now()/1e3),classNames:["convTutorial-tooltip"],onLinkClick:function(){e.fire("openOptions",{view:"viewing_email"})}},!0)})},render:function(n){var r=this,i,s,o,u,a=NeoConfig.delayLoadingIcon||1,f=r.getStopwatch(),l=n&&!r.parentNode&&r.message,c=function(){var n=e.one("#inboxcontainer");try{r.renderComplete(),r.paneRendered=!0;if(r.loading_error)return;NeoConfig.showMultitaskTutorial?setTimeout(function(){e.fire("showMultitaskingOnboarding",{queuedObCallback:r.triggerConvOnboarding,ctx:r})},300):t.isCalloutShown("convTutorial")||r.triggerConvOnboarding(),r.wasCached?setTimeout(function(){var e;r.initializeAllDrafts(),T.isDraftFid(r.fid)&&(r.listNode.all(".loadhide").removeClass("loadhide"),e=r.getRoot(),e&&e.one(".conv-loading")&&e.one(".conv-loading"
).addClass("hidden"))},1):r.initializeAllDrafts(),r.bindContentUI&&r.bindContentUI(),e.later(10,null,function(){if(n.hasClass("prevPaneVisible")&&n.getComputedStyle("display")!=="none")return;var e=r.getRoot().one(".thread-item.expanded"),t;e&&(t=e.one(".thread-body"),t?(t.setAttribute("aria-labelledby",r.getMsgContentAriaLabel(e)),t.setAttribute("tabindex",0),t.focus(),e.scrollIntoView(!0),window.scrollTo(0,0)):(e.setAttribute("aria-labelledby",r.getMsgContentAriaLabel(e)),e.setAttribute("tabindex",0),e.focus()))})}catch(i){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailpane-conv-convpane:2",i,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailpane-conv-convpane:2")}};try{r.parentNode=e.one(n)||r.parentNode;if(l){r.loadPaneContent(3);return}f&&f.start(1,"Render");if(!r.parentNode)return;u=r.parentNode,r.set("parentNode",u);if(u){!r.hasStarted&&r.message&&(r.fireEvent("start"),r._cancelMarkAsRead()),r.appendMarkup(),o=u.one(".threadpane .conv-loading.s-loader.hidden"),o&&e.Lang.later(a*1e3,r,function(e){e&&e._node&&e.get("parentNode")&&!e.get("parentNode").one(".thread-item")&&e.removeClass("hidden")},o),e.one("#shellcontent").removeClass("loadingConv"),r.eventsBound||r.bindUI(),r.fullView&&setTimeout(function(){r.setTitle()},0),r.quickReplyBox=r.parentNode.one(".add-to-conv"),i=r.getRoot(),r.listNode=i&&i.one(".thread-item-list"),r.hdr=i&&i.one(".message-header"),r.threadItems=r.listNode&&r.listNode.all(".thread-item"),r.superCollapsedNode=r.listNode&&r.listNode.one(".supercollapsed");if(r.superCollapsedNode&&r.message){var h=0,p=!0;r.threadItems.each(function(e){if(h===0||h===r.message.msgs.length-1){h++;return}T.isSentFid(r.fid)?r.message.msgs[r.getMessageIdxByMid(e.getAttribute("data-mid"))].fid==="Sent"?p=!1:p&&e.addClass("super-hidden"):T.isDraftFid(r.fid)?T.isDraftFid(r.message.msgs[r.getMessageIdxByMid(e.getAttribute("data-mid"))].fid)?(s=e.previous(),s&&s.removeClass("super-hidden"),p=!1):p&&e.addClass("super-hidden"):e.hasClass("unread")?p=!1:p&&e.addClass("super-hidden"),h++})}}r.fireEvent("render"),!r.outboundReq&&r.message&&(r.message.msgs&&r.message.msgs[r.message.msgs.length-1].body&&(r.isLoaded=1),f&&f.start(1,"MessageInDOM"),c(),setTimeout(function(){r.tbarCallBack&&r.tbarCallBack.apply(r.tbarScope,[e])},0))}catch(d){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailpane-conv-convpane:3",d,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailpane-conv-convpane:3")}},setTitle:function(e){var t=this,i=e||(t.message&&t.message.subject?n(r(t.message.subject)):T.isDraftFid(t.fid)?strings.str_tabs_compose:strings["str_msg-view_tab_no_subject"]);t.get("title")!==i&&t.set("title",i)},requestPaneContent:function(t,n,r,i){var s=this,o=t?t.cid||0:0,u,a=s.getStopwatch();s.msgUserUnread&&(s.msgUserUnread=null),s.convUserUnread=!1;if(o||s.midtocid)n.args={fid:s.fid,primeMsg:t,stopwatch:a},s.fireEvent("get"),a&&(a.start(1,"YCMSGGetBegin"),a.YCMSGGetBegin||(a.YCMSGGetBegin=new Date)),r.oldMsgCnt=s.message.msgs&&s.message.msgs.length,e.fire("MailLog",{m:"conversation requestPaneContent"}),NeoConfig.yodaReadEnabled?NeoConfig.loadYodaController.then(function(){u=e.mail.controller.v3.api.getConversation({cfid:r.cfid,mfid:r.mfid,force:r.ovparams&&r.ovparams.force,conversationId:r.cid||t.cid,messageId:r.msg&&r.msg.mid,success:function(e){n.success(e)},oldMsgCnt:r.oldMsgCnt,newMsg:r.newMsg,failure:n.failure,getDisplay:i,showTAE:!n.suppressNotification}),n.notify("async")}):u=e.mail.Controller.Conversations.getConv(r,n,i,t);return u},openComposeCards:function(){var e=this,t=0,n=e.composeWidgets||"",r;if(n)for(r in n)t++;return t},getRemovedMsg:function(e,t){var n=null,r,i,s;if(!e||!t)return null;for(r=0;r<e.length;r++){s=!1;for(i=0;i<t.length;i++)if(e[r].mid===t[i].mid){s=!0;break}if(!s){n=e[r];break}}return n},loadPaneContent:function(n,r,i,s,o,u,a){try{var l=this,c=l.message,h=c?c.cid||0:0,d,v,m=!1,y=!o&&!l.submessage&&(l.midtocid?NeoConfig.hasConvV3:g.Conversations.canBatchLMTGDM(c,l.fid)),b=r&&!i?r:0,w,S;l.fullView||l.statReadStart("CONV","PREVIEW"),l.currentLmtContext=u,o||(w=l.getStopwatch(),S=new t.Stopwatch(y?"LoadConvBatch":"LoadConv")),w&&w.start(2,"Load"),i=i||{},h&&!l.hasStarted&&(l.fireEvent((l.fullView?"tab":"preview")+":start"),l.hasStarted=!0,l._cancelMarkAsRead());if(h||l.midtocid){var x={success:function(n){var r=0,i,a,c,h;l.fullView||l.statReadSuccess("CONV","PREVIEW");try{if(o){if(!u){l.resetRequestLoadingState(!1);return}i=l.lftSendSaveCongruencyCheck(l.message,n,u);if(i.oldIdx>=0||i.newIdx>=0){l.resetRequestLoadingState(!1),v=i.oldIdx!==-1?i.oldIdx:i.newIdx,a=n.msgs[v];if(!a)return;a=p(l.getMsgFid(a),a),i.oldIdx>=0&&(r=1);if(T.isDraftFid(a.fid))u.draftMID||(c=f(u.origin.oMsg.mid),h=l.getComposeNodeByMid(c),h&&h.setAttribute("data-mid",f(a.mid))),l.insertMsgAtPos({insertObj:{msg:a,pos:v,replace:r}});else if(T.isSentFid(a.fid)){if(i&&i.newIdx&&l.message.msgs[i.newIdx]&&l.message.msgs[i.newIdx].mid===u.newMsg.mid)return;l.insertMsgAtPos({insertObj:{msg:a,pos:v,replace:r},render:!0})}}if(!i.remainder||u.newMsg&&T.isDraftFid(u.newMsg.fid))return}if(S===-1){t.assert(0,"successdupcall",1);return}var d=x&&x.respProps&&x.respProps.wasCached,m=x&&x.respProps&&x.respProps.callPerf,g=[n,d,!1,y];w&&(w.start(1,"LMTFetchEnd"),w.YCMSGGetEnd=new Date,w.wasCached=d,w.BECallTime=m),S&&(S.wasCached=d,S.YCMSGGetBegin=w&&w.YCMSGGetBegin,S.YCMSGGetEnd=w&&w.YCMSGGetEnd,S.BECallTime=m,S.stop()),l.registerLFTNotify(n.cid),l.loadExtra(function(){w&&w.start(3,"PreOnSuccess"),l.onSuccess.apply(l,g),s&&s()}),l.isStale=!1,S=-1}catch(b){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailpane-conv-convpane:4",b,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailpane-conv-convpane:4"),e.use("common-utils-error",function(){t.error.report("loadConvSuccessError"
,b,1,1,1)})}},failure:function(t){clearTimeout(l.loadingTimer),l.cleanRefreshTimer(),l.message&&l.message.cid&&l.registerLFTNotify(l.message.cid),l.loadExtra(function(){l.onFailure.apply(l,[t,!1]);if(l.filterFailError&&!m){m=!0,l.requestPaneContent(c,x,N,y);return}l.conv_deleted_error||l.msg_deleted_error?l.statReadSuccess("CONV",l.fullView?"":"PREVIEW"):e.fire("stat:feature_fail",{feature_group:"READ",api:"BatchExecute_listmessagesinthread_getdisplaymessage",visible:"yes",message:"UI_READ_CONV_COMPLETE_FAILURE"})},1)},notify:e.bind(A,l),errorPosition:n||99,suppressCodes:!r&&o&&["*"],suppressNotification:!0,retryCodes:["Server.Malformed-unk"],convOrigin:l.searchQuery?"search":l.midtocid?"mrd":"general"},N,C,k;if(T.isDraftFid(l.fid)&&c.msgs&&(u&&u.newMsg||!c.totalDraft))for(var L=c.msgs.length-1;L>=0;L--){k=c.msgs[L].fid||c.msgs[L].sourceFolderInfo.fid;if(!T.isDraftFid(k)){C=k;break}}else C=l.fid;C||(C=l.fid),x.openedFrom=l.midtocid?"search":n!==3?"pane":C,N={cid:h,ovparams:i,cfid:C},N.msg=l.midtocid?{mid:l.midtocid}:l.submessage,N.mfid=l.midtocid?l.fid:l.getMsgFid(N.msg?N.msg:c.msgs[c.msgs.length-1]),N.checksum=i.checksum?i.checksum:c.checksum,N.silentFetch=o,i.checksum=null,u&&u.newMsg&&(N.newMsg=u.newMsg),l.fireEvent("get"),l.usedPreload?l.preloadedMsg?l.loadExtra(function(){w&&w.start(3,"PreOnSuccess"),l.onSuccess.apply(l,[l.preloadedMsg,!0,!0]),l.preloadedMsg=null}):l.preloadFailure&&l.loadExtra(function(){l.onFailure.apply(l,[l.preloadFailure,!0]),l.preloadFailure=null},1):(d=l.requestPaneContent(c,x,N,y),l.abortRequests(!0),l.outboundReq&&(l.request=d,l.requestType="loadMessage")),l.usedPreload=0,l.isRetrying=b,l.outboundReq&&!a&&(clearTimeout(l.loadingTimer),l.loadingTimer=setTimeout(function(){l.loadExtra(function(){l.outboundReq&&l.render()})},300),clearTimeout(l.slowLoad),l.slowLoad=setTimeout(function(){l.loadExtra(function(){l.handleSlowRequest()},1)},E))}}catch(O){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailpane-conv-convpane:5",O,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailpane-conv-convpane:5")}},insertBody:function(){var e=this,t=e.message,n,r,i,s,o;if(t&&t.msgs){r=t.msgs.length,i=t.msgs;for(n=0;n<r;n++)if(i[n]&&i[n].body){s=e.getMsgNodeByMid(i[n].mid);if(n!==r-1||!T.isDraftFid(e.getMsgFid(i[r-1])))o=s&&s.one(".body"),o&&o.setContent(i[n].body.display)}}},syncDummyBoxState:function(){var e=this,t=C(e.message.msgs[e.message.msgs.length-1]);T.isDraftFid(t)?e.quickReplyBox&&e.quickReplyBox.hide():e.quickReplyBox&&e.quickReplyBox.show()},_syncFlagState:function(){var t=this,n=function(e){var n={};if(!t.message||!Array.isArray(t.message.msgs)||h(t.message.cid)!==h(e.cid)||!Array.isArray(e.msgs))return;t.message.totalFlagged!==e.totalFlagged&&(t.message.totalFlagged=e.totalFlagged,t.updateConvFlagMarkup(t.message.totalFlagged>0)),t.message.totalUnread!==e.totalUnread&&(t.message.totalUnread=e.totalUnread,t.updateConvReadMarkup(t.message.totalUnread>0)),e.msgs.forEach(function(e){n[e.mid]=e}),t.message.msgs.forEach(function(e){if(!n[e.mid])return;e.flags.isRead!==n[e.mid].flags.isRead&&(e.flags.isRead=n[e.mid].flags.isRead,t.updateMessageReadMarkup(e,e.flags.isRead)),e.flags.isFlagged!==n[e.mid].flags.isFlagged&&t.updateMessageFlagMarkup(e,e.flags.isFlagged)})};if(!NeoConfig.yodaReadEnabled||!t.message||!Array.isArray(t.message.msgs))return;e.mail.controller.v3.api.getConversation({cfid:t.message.fid,conversationId:t.message.cid,success:n,getDisplay:!1,showTAE:!1})},debouncedSyncFlagState:t.debounce(function(){this._syncFlagState()},2*b),attach:function(){var t=this;t.msgChangeHandle=e.on("ds:msg:change",function(n,r,i,s,o){var u=t.message,l=i&&i[0],c=t.parentNode,h,p,d,v,m;h=l.mid,p=l&&t.getMessageIdxByMid(h);if(!u||!u.msgs||!e.Lang.isValue(p)||!t.initialRender&&o!=="flag")return;d=u.msgs[p];if(t.fullView&&o==="move"&&a.hasMoved(d.mid,h,t.getMsgFid(d),n)){u.msgs.length>1?(t.dirty=!0,t.handleSingleMsgDelete(d)):t.set("close",1);return}if(d&&l&&f(l.mid)===f(d.mid)&&l.flags&&d.flags&&c&&!t.outboundReq){t.debouncedSyncFlagState(),l.flags.isFlagged!==d.flags.isFlagged&&(t.dirty=!0,t.updateMessageFlagMarkup(l));if(l.flags.isRead!==d.flags.isRead||o==="flag"&&s[0].flags.isRead)t.dirty=!0,t.updateMessageReadMarkup(l,l.flags.isRead);v=t.message.msgs[p],m=v&&v.body&&v.body.display,t.message.msgs[p]=l,m&&l.body&&(t.message.msgs[p].body.display=m)}}),t.convDeleteHandle=e.on("ds:conv:remove",function(e,n,r){var i=t.message,s,o=0;if(!i)return;if(e===t.fid){t.isStepping||(t.arrMessageSequence=null);if(t.fullView&&n&&i.cid)for(s=0;s<n.length;s++)h(i.cid)===h(n[s].cid)&&(o=1);if(o||!n&&r)t.fullView?t.set("close",1):t.set("message",null)}}),t.convChangeHandle=e.on("ds:conv:change",function(n,r,i,s,o,u){var a=t.message,l=t.parentNode,p=r&&r[0],v=i&&i[0],m=s&&s[0],y=o&&o.reason==="savedraft",b,w,E,S,x,C,k,L,A,O,M,_,D,P;if(!a||e.Object.isEmpty(t.midObjMap)||!t.initialRender&&n!=="msg:flag"&&n!=="msg:remove"&&n!=="msg:add")return;if(n==="move"){for(D=0;a&&D<i.length;D++)L=i[D].cid,A=i[D].fid,O=r[D].cid,M=r[D].fid,t.fullView&&h(L)===h(a.cid)&&(t.isStepping||t.set("close",1));return}if(p&&v&&h(p.cid)===h(v.cid)&&c.areSameConvs(v,t.message)&&l){t.debouncedSyncFlagState();if(n==="msg:remove"){P=t.getRemovedMsg(p.midMap,v.midMap);if(!P)return;var H=t.midObjMap[f(P.mid)];if(!e.Lang.isValue(H))return;if(y&&!N.enabled("yodaConversationRead"))return;T.isDraftFid(P.fid)&&!y&&(t.removeDraft(H),t.syncDummyBoxState()),t.message.msgs.splice(H,1),t.message.midMap.splice(H,1),t.message=g.Conversations.calcConvSummary(t.message),S=t.message.msgs,x=S.length,t.midObjMap=t.refreshMidObjMap(S);if(!(x>0)){t.fullView?t.set("close",1):(!y||!t.get("active"))&&t.set("message",null);return}y||(E=t.getMsgNodeByMid(P.mid),E&&(E.remove(),t.fire("MessagePane:unload",E)),t.syncDummyBoxState(),t.updateCount())}else if(n==="msg:add"){w=o[0][0];if(!u.cachedMsg||!T.isSentFid(w.fid)){if(T.isDraftFid(t.fid)&&t.message.msgs.length===1)return;
t.ignoreLMT=!0,b={origin:u.draft.origin,draftMID:u.draftMid,newMsg:{cid:w.cid,fid:w.fid,mid:w.mid}},t.get("active")&&t.loadPaneContent(4,null,{force:!0},null,!0,b,!0);return}_=d(w.fid,u.cachedMsg),t.message.midMap&&(N.enabled("instantCloseOnSend")?t.insertMsgAtPos({insertObj:{msg:_,replace:0},render:!0,anim:!1,ovparams:{no_focus:!0},expand:!0}):t.insertMsgAtPos({insertObj:{msg:_,replace:0},render:!0}))}if(e.Lang.isValue(m.totalFlagged)||e.Lang.isValue(m.totalUnread))p.totalFlagged!==v.totalFlagged&&(k=v.totalFlagged>0?!0:!1,t.message.totalFlagged=v.totalFlagged,t.dirty=!0,t.updateConvFlagMarkup(k)),p.totalUnread!==v.totalUnread&&(C=v.totalUnread>0?!1:!0,t.message.totalUnread=v.totalUnread,t.message.msgCountsByFolder=v.msgCountsByFolder,t.dirty=!0,t.updateConvReadMarkup(C))}})},detach:function(){var t=this;t.stepIndex=t.isStepping=null,t.msgChangeHandle&&t.msgChangeHandle.detach(),t.convChangeHandle&&t.convChangeHandle.detach(),t.convDeleteHandle&&t.convDeleteHandle.detach(),t.threadHeaderHandler&&t.threadHeaderHandler.detach(),t.threadItemHandler&&t.threadItemHandler.detach(),t.refreshHandler&&t.refreshHandler.detach(),t.subjectHandle&&t.subjectHandle.detach(),t.switchThreadItemHandler&&t.switchThreadItemHandler.detach(),NeoConfig.convReplyBtnsInTlbr&&t.newMessageHandler&&t.newMessageHandler.detach();while(t._evts.length)t._evts.pop().detach();t.widthUpdateTimer&&(t.widthUpdateTimer.cancel(),t.widthUpdateTimer=null),e.each(t.expandMessageTimers,function(e){e.cancel()}),t.cleanRefreshTimer(),t.registerLFTNotify()},setRenderFocus:function(){var e=this;e.setFocusNode()},setFocusNode:function(){},isConvActive:function(e){var t=this;return!t.message||!t.message.cid?!1:h(t.message.cid)===h(e)},loadExtra:function(n,r){var i=this,s=r?["mail-ui-convpane-error"]:["mail-ui-convpane-read"],o=t.Stopwatch.get("MsgInPreview")||i.stopwatch,u,a,f;!r&&S&&(i.bindPaneContent&&(a="MsgPaneRead_Preloaded"),S=0),o&&o.start(2,"LoadExtraBody"),f=function(){try{var r=s,u;o&&o.start(2,"LoadExtraUseCB"),i.setFullFormatters&&!i.setFull&&i.setFullFormatters();try{n.apply(i)}catch(a){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailpane-conv-convpane:6",a,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailpane-conv-convpane:6"),e.use("common-utils-error",function(){t.error.report("loadExtraCBApplyError",a,1,1,1)})}if(x)for(u=0;u<r.length;u++)typeof r[u]!="function"&&(x[r[u]]=1)}catch(a){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailpane-conv-convpane:7",a,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailpane-conv-convpane:7")}};for(u=0;u<s.length;u++)x[s[u]]&&(s.splice(u,1),u--);s.length?(s.push(f),e.use.apply(e,s)):f(e),o&&o.start(2,"PostLoadExtraBody")}}),e.mix(k.prototype,{NAME:"ConversationPane",fireEvent:L,updateMessageReadMarkup:function(e,t){if(e){var n=this.getMsgNodeByMid(e.mid),r;n&&(t?n.removeClass("unread"):n.addClass("unread"),r=n.all(".info"),r.setAttribute("title",strings[t?"str_msg_view_markasunread_attr":"str_msg_view_markasread_attr"]),r.setAttribute("aria-label",strings[t?"str_msg_list_read":"str_msg_list_unread"]))}},updateConvReadMarkup:function(t){var n=this.get("parentNode").one(".message-header"),r=n?n.one(".info"):null;n&&(t?n.removeClass("unread"):n.addClass("unread"),r&&(r.set("title",strings[t?"str_convview_conv_click_mark_as_unread":"str_convview_conv_click_mark_as_read"]),r.set("aria-label",strings[t?"str_msg_list_convRead":"str_msg_list_convUnread"])),e.fire("MessagePane:markConvRead",this.message,t))},updateMessageFlagMarkup:function(e){var t,n,r,i;if(!e)return;t=this.getMsgNodeByMid(e.mid);if(!t)return;r=t.one(".flag");if(!r)return;i=e.flags.isFlagged,n=r.one("a"),r.toggleClass("flagged").set("title",strings[i?"str_msg_view_flagged_attr":"str_msg_view_flag_attr"]),r.set("aria-label",strings[i?"str_msg_list_flagged":"str_msg_list_not_flagged"]),n&&n.set("aria-checked",!i)},updateConvFlagMarkup:function(e){var t=this.get("parentNode").one(".message-header .flag");t&&(e?t.addClass("flagged"):t.removeClass("flagged"),t.set("title",strings[e?"str_convview_convflagged_attr":"str_convview_convflag_attr"]),t.set("aria-label",strings[e?"str_msg_list_convflagged":"str_msg_list_not_convflagged"]))},saveDraftAction:function(t,n){var r=this,i;r.saveDrafts?r.saveDrafts(function(r){!n&&!r&&t?(i={hd:strings.str_comp_title_saveasdraftfailmultiple,bd:strings.str_comp_saveasdraftfailmultiple},e.common.ui.DialogHelper.confirm(i,{ok:{handler:function(){t()}},cancel:{}})):t&&t()}):t&&t()},handleSingleMsgDelete:function(e){var t=this,n=t.message,r=n.msgs,i,s,o=e.mid;o&&(i=t.getMsgNodeByMid(o),i&&i.remove(!0),s=t.getMessageIdxByMid(o),r.splice(s,1),t.midObjMap=t.refreshMidObjMap(r))},resetRequestLoadingState:function(e){var t=this;clearTimeout(t.loadingTimer),clearTimeout(t.slowLoad),t.loading_slow=0,t.conv_deleted_error=0,t.loading_error=e?1:0,t.outboundReq=null,t.request=null,t.isRetrying=0},requestAllMessages:function(t,n,r,i,s){var o;s&&(o=new Date,s.stopwatch&&(s.stopwatch.start(1,"YCMSGGetBegin2"),s.stopwatch.YCMSGGetBegin2=o),s.RSstopwatch&&(s.RSstopwatch.YCMSGGetBegin=o)),N.enabled("yodaConversationRead")?NeoConfig.loadYodaController.then(function(){Array.isArray(t)&&t.length>0?e.mail.controller.v3.api.getSimpleBodyofMessages({messageList:t,success:r.success,sourceFid:n,filter:i,sameTick:!1}):r.success([],[])}):u.getMultipleMessages(t,r,this.getMsgFid,i)},getMsgContentAriaLabel:function(e){var t,n="";return t=e.one(".thread-body"),n+=t?(t.get("id")?t.get("id"):t.generateID())+" ":"",n},focusMessageCard:function(){var e=this,t=e.selNode;(!e.parentCW.msgList||!e.parentCW.msgList._listview.get("focused"))&&t&&(t.setAttribute("aria-labelledby",e.getMsgContentAriaLabel(t)),t.focus())},updatePaneContent:function(){var e=this;this.saveDraftAction(function(){e.loadPaneContent(5,null,{force:!0},null,!0,null,!0),clearTimeout(e.slowLoad)}
)},setRefreshTimer:function(t){var n=this,r=t||w;if(T.isDraftFid(n.fid)&&n.message.msgs.length===1)return;n.cleanRefreshTimer(),n.refreshTimer=e.Lang.later(r,n,function(){n.get("active")===1?n.updatePaneContent():n.refreshOnActive=!0})},cleanRefreshTimer:function(){this.refreshOnActive=!1,this.refreshTimer&&this.refreshTimer.cancel()},preload:function(n){var r=this,i=n.mid,s=new t.Stopwatch("PreLoadMessage"),o,u;if(i){var a={success:function(e){if(s===-1){t.assert(0,"successdupcall",1);return}o=a&&a.respProps&&a.respProps.wasCached,r.message?r.loadExtra(function(){r.onSuccess.apply(r,[e,!1,!0])}):r.preloadedMsg=e,s=-1},notify:e.bind(A,r),failure:function(e){r.message?r.loadExtra(function(){r.onFailure.apply(r,[e,!0])},1):r.preloadFailure=e},errorPosition:9,suppressCodes:["*"]};r.usedPreload=1,u=r.requestPaneContent(n,a,{fid:r.fid,msg:n,cachekey:"Prime"}),r.abortRequests(),r.outboundReq&&(r.request=u,r.requestType="preload")}},isChat:function(){return!1},getMsgFid:function(e){return e.fid||e.sourceFolderInfo&&e.sourceFolderInfo.fid||e.folderInfo&&e.folderInfo.fid||this.fid},isPrevPaneVisible:function(){return v.hasClass("prevPaneVisible")&&!v.hasClass("offscreen")}},!0),e.mail.ui.ConvPane=e.mail.ui._ConvPane=k},"1.0.0",{requires:["_shared_module_thread_thread_pane","common-utils","mail-model-datastore","mail-controller-messages","mail-controller-conversations","mail-ui-mailpane-base","mail-persist-meta-data","common-utils-stats","mail-ui-messagepane-utils","mail-model-convstore","mail-ui-folder-utils"]});


YUI.add("mail-ui-convview-base",function(e){function _(){var t=e.mail.ui.ContextButton;t&&t.setNodeMessageListMenu()}var t=e.common.Utils,n=e.mail,r=n.ui,i=r.MessagePaneUtils,s=t.substitute,o=e.ui.Templates,u="div.empty-folder",a="#inboxcontainer",f="hidden",l="invisible",c=NeoConfig,h="%40B%40Bulk",p="%40C%40Chats",d="darlaEvent",v="message",m="renderComplete",g="%40S%40Search",y="title",b="visible",w,E,S,x,T=t.escapeHtml,N=e.mail.Tabs,C=r.FolderUtils,k=C.get,L=C.SpamFolderType,A=C.SentFolderType,O=C.DraftFolderType,M=C.ArchiveFolderType,D=function(t){function u(){function u(t){t.newVal==1?(n.dsFolderChange&&n.dsFolderChange.detach(),n.dsFolderRename&&n.dsFolderRename.detach(),n.footer&&n.footer.setStyle("visibility","hidden")):i?n.dsFolderChange=e.on("ds:folder:change",function(e,t,r,i){if(r&&r.length>0){var s,o;for(s=0,o=t.length;s<o;s++)if(r[s].total!==undefined&&t[s].folderInfo.fid==n.fid){n.renderToolbarsOrEmpty(i==="refresh");break}}}):n.dsFolderRename=e.on("ds:folder:rename",function(e,t){n.msgPane&&n.fid==e.folderInfo.fid&&(n.fid=t.folderInfo.fid,n.msgPane.set("fid",n.fid))})}n.addAttrs({scrollWidth:{value:null}}),n.after("activeChange",n.afterActiveChanged,n);var r=function(){n.msgList&&n.msgList._listview&&n.msgList._listview.updateUlSize()};n.formatters={reply_group:function(){if(NeoConfig.convReplyBtnsInTlbr){var e=n.hasMsgList?n.toolbarMods.Inbox:n.toolbarMods.Conversation;return s(o[e].reply_group,0,0,0,strings)}},non_ad:function(e){return s(o._shared_module_folder_empty_rollup.non_ad,e,n.formatters,0,strings)},random_footer:function(){return""},random_footer_1:function(){return""},random_footer_2:function(){return""},page_conversation_history:function(e){return n.isChat(n.fid)?s(o._shared_module_folder_empty_rollup.page_conversation_history,e,n.formatters,0,strings):""},page_conversation_history_else:function(e){return n.isChat(n.fid)?"":s(o._shared_module_folder_empty_rollup.page_conversation_history_else,e,n.formatters,0,strings)},archiving_disabled:function(e){return c.ssa_enabled?"":s(o._shared_module_folder_empty_rollup.archiving_disabled,e,n.formatters,0,strings)},full_view:function(e){var t=n.isChat(n.fid)?p:n.fid;return i?"":s(o[n.toolbarMods[t]].full_view,e,0,0,strings)},msg_nav_arrows:function(e){var t="minty_module_toolbar_inbox_message_thread";return s(o[t].msg_nav_arrows,e,n.formatters,0,strings)},cancellable:function(e){return n.msgPane&&n.msgPane.fullView?s(o.minty_module_toolbar_inbox_message_thread.cancellable,e,n.formatters,0,strings):""},archiveEnabled:function(e){return NeoConfig.archive?s(o[e.origTmpl].archiveEnabled,e,n.formatters,0,strings):""},showArchive:function(e){var t=n.fid;return C.isArchiveSupported(t)?s(o[e.origTmpl].showArchive,e,n.formatters,0,strings):""},showRestore:function(e){var t=n.fid;return C.isRestoreSupported(t)?s(o[e.origTmpl].showRestore,e,n.formatters,0,strings):""},archiveEnabled_else:function(e){return NeoConfig.archive?"":s(o[e.origTmpl].archiveEnabled_else,e,n.formatters,0,strings)},has_spam_button:function(e){var t=!n.isActualSystemFolder(n.fid,"Sent")&&!n.isActualSystemFolder(n.fid,"Draft")&&n.folderType!==A&&n.folderType!==O;return t?s(o[n.msgToolbarMod].has_spam_button,e,n.formatters,0,strings):""},spam_menu:function(e){var t=C.isSpamMenuSupported(n.fid,e.toolbar_acct_id);return t?s(o[e.origTmpl].spam_menu,e,n.formatters,0,strings):""},spam_menu_else:function(e){var t=C.isSpamMenuSupported(n.fid,e.toolbar_acct_id);return t?"":s(o[e.origTmpl].spam_menu_else,e,n.formatters,0,strings)},has_sms_menu_else:function(e){return strings.str_cfg_tog_hasSMS?"":s(o.minty_module_toolbar_inbox_conversation_thread_rollup.has_sms_menu_else,e,n.formatters,0,strings)},has_sms_menu_else1:function(e){return strings.str_cfg_tog_hasSMS?s(o.minty_module_toolbar_inbox_conversation_thread_rollup.has_sms_menu_else1,e,n.formatters,0,strings):""},is_mon:function(){return strings.str_cfg_tog_monster_ad_empty_l10n?o._shared_module_folder_empty_rollup.is_mon:""},is_lrec:function(){return strings.str_cfg_tog_monster_ad_empty_l10n?"":o._shared_module_folder_empty_rollup.is_lrec},from_search:function(e){var t=N.getActiveTab(),n=t.prevTabId,r,i=!1;return r=N.getTabById(n),r&&r.widgetType==="search"&&(i=!0),i?s(o.minty_module_toolbar_inbox_message_thread.from_search,e,0,0,strings):""}},n.msgList&&n.once("activeChange",function(){var t=n.msgList;t.folder&&e.Lang.isNumber(t.folder.totalConversations)&&t.updateTitle(t.folder.totalConversations),r(),n.checkPreview()}),e.on("msgsview:splitterdone",r),n.on("closeChange",function(e){var t,r=n.subToolbars;for(t in r)r[t].set("close",e.newVal);u(e)}),n.set("children",[n.msgPane,n.msgList]),n.msgPane&&n.msgPane.on(d,function(e){n.fire(d,e)}),n.msgPane&&!n.msgPane.fullView&&n.msgPane.after("paneMessage",function(e){n.setPPToolbarItems(e.content)}),e.on("msgsview:movetonewfolder",function(){var e=N.getActiveTab();n.hasMsgList&&e&&e.widget&&e.widget==n&&n.handleUI({action:"folder-new",tbAction:!0},n.fid,n.msgList)}),i?n.after("contentToolbarChange",function(){n.msgList&&n.msgList.setToolbarElements(e.one("#toolbar"))}):(n.msgPane.on("scrollWidthChange",function(t){n.set("scrollWidth",t.newVal),n.get("active")&&e.fire("ws:fpMsgWidth",t)}),n.on("scrollWidthChange",function(e){e.reset&&n.msgPane.scrollWidthReset()})),n.set(y,i?n.msgList.get(y):n.msgPane.get(y)),n.setToolbars(),u({newVal:0}),i?n.bindMsgList():n.msgPane.on("fidChange",function(e){n.fid=e.newVal,n.setToolbars()}),n.set("charCodes","13,27,32,33,34,35,36,37,38,39,40,46,69,85,186,188,190,"+n.numCodes.join(",")+","+n.keyCodes.join(",")+","+"32+ctrl+shift,73+shift,84+shift,67"),n.set("reuse",t.reuse)}var n=this,i;n.rawAttr=t,D.superclass.constructor.call(n,t),i=n.hasMsgList,t=t||{},n.msgPane=new r.ConvPane(e.mix(t,{fullView:!i&&!t.query,visible:!i||(NeoConfig.previewPanePref?!0:!1)})),t.stopwatch&&(n.msgPane.stopwatch=t.stopwatch),n.callFromLaunch=t.callFromLaunch?t.callFromLaunch:!1,n.msgList=i?t.msgList||new r.ConvList(t):0,n.supportPreview=!0,n._nextprevModule="mail-ui-convpane-next-prev"
,n.darlaActionKey=c.low_bandwidth?"message_tabpane_low":NeoConfig.isSSL?"message_tabpane_ssl":"message_tabpane",n.scrolling=[".list-view-items",".message.content"],u()};e.extend(D,e.mail.ui.MailView),e.mix(D.prototype,{NAME:"ConversationView",msgToolbarMod:"minty_module_toolbar_inbox_message_thread",toolbarMods:{Inbox:"minty_module_toolbar_inbox_default_thread_rollup","%40C%40Chats":"minty_module_toolbar_inbox_conversation_thread_rollup",Draft:"minty_module_toolbar_inbox_drafts_thread_rollup","%40B%40Bulk":"minty_module_toolbar_inbox_spam_thread_rollup",Sent:"minty_module_toolbar_inbox_sent_thread_rollup","%40S%40Search":"minty_module_toolbar_inbox_search_thread_rollup",Conversation:"minty_module_toolbar_fragments_reply_group_conv",INBOX:"minty_module_toolbar_inbox_default_thread_rollup",DRAFT:"minty_module_toolbar_inbox_drafts_thread_rollup",ARCHIVE:NeoConfig.archive?"minty_module_toolbar_inbox_archive_thread_rollup":"minty_module_toolbar_inbox_default_thread_rollup",BULK:"minty_module_toolbar_inbox_spam_thread_rollup",SENT:"minty_module_toolbar_inbox_sent_thread_rollup",TRASH:"minty_module_toolbar_inbox_default_thread_rollup",USER:"minty_module_toolbar_inbox_default_thread_rollup"},_isFolderEmpty:function(){var e;return this.fid&&(e=k(this.fid))&&e.total===0},_hasEmptyFolderRendered:function(){var e=this;return e._emptyFolderRendered},renderEmptyFolder:function(n){var r=this,i=e.one("#lv-folder-empty"),h,p,d=T(n),v=r.msgPane,m,g,y=t.features.enabled("keyTasksPanel")&&NeoConfig.onboarding.taskPanelEnabled&&C.isInboxFid(r.fid);c.previewPanePref&&v&&(v.showMailBoxIcon=!0,v.message||v.appendMarkup()),r.efvEnabled&&!y?(m=e.one(a).one("#emptyFolderVideo"),e.one(a).get("children").each(function(e){e.get("id")!=="emptyFolderVideo"&&e.addClass(f)}),m&&(m.removeClass(l),m.one(".folder-name").setContent(d))):c.previewPanePref?(p=s(strings.str_folder_empty,{folder_name:T(n)},r.formatters,0,strings,o),r.msgList._listview._srcNode.setHTML(""),i&&i.setHTML(p).removeClass("hidden"),m=e.one(a).one(u),g=e.one(a).get("children"),g&&g.removeClass(f),m&&m.addClass(l)):(h=o._shared_module_folder_empty_rollup,m=e.one(a).one(u),n=n.split("/").pop(),m?(p=s(h.non_ad,{folder_name:d,fid:r.fid},r.formatters,0,strings,o),m.one(".col-a").setContent(p)):(p=s(h.base,{folder_name:d,fid:r.fid},r.formatters,0,strings,o),e.one(a).append(p)),m=e.one(a).one(u),e.one(a).get("children").addClass(f),m&&(m.removeClass(l),m.removeClass(f))),r.setToolbars(),(C.isTrashFid(r.fid)||C.isSpamFid(r.fid))&&e.fire("foldersview:resetFocus",r.fid)},isEFVideoActive:function(n){var r=this,i;if(r.efvEnabled){i=t.getVal(e.mail.ui,"Ads.EmptyFolderVideo.isActive");if(i)return i(n)}return!1},renderToolbarsOrEmpty:function(n){var i=this,s=t.features.enabled("keyTasksPanel")&&NeoConfig.onboarding.taskPanelEnabled&&C.isInboxFid(i.fid),o=t.features.enabled("liveNation")&&!i.efvEnabled,h=["_shared_module_folder_empty_rollup"],p=e.one("#lv-folder-empty"),d,v,m,g,y,b;if(i._isFolderEmpty())v=k(this.fid),m=C.getSystemFolderInfoName(i.fid,v).split("/").pop(),c.bidi&&(b=e.Intl.detectDirection(m,c.isRTL?"rtl":"ltr"),m=(b==="rtl"?"\u202b":"\u202a")+m+"\u202c"),i.efvEnabled&&!s?h.push("mail-ui-ads-emptyfolder-video"):o&&!s&&h.push("mail-ui-ads-live-nation"),e.fire("util:ymstats",{name:"empty_folder_conv",tags:{intl:c.intl,folderType:C.getFolderTypeByFid(i.fid)||"unset"},include:{bucket:!0}}),i._emptyFolderRendered=!0,e.use(h,function(){i.renderEmptyFolder.apply(i,[m]),s?(e.fire("emptyfolder-video:hide"),r.Workspace.renderKeyTasksPanel(i.fid,e.one("#empty-folder-msg"),{isEmptyFolder:!0})):i.efvEnabled?e.fire("emptyfolder-video:show",{msgView:i,msgList:i.msgList,fid:i.fid,folderName:m}):o&&e.fire("live-nation:show",{fid:i.fid,folderName:m})});else{if(i.efvEnabled&&n&&i.isEFVideoActive(!0))return;p&&p.addClass("hidden"),g=e.one(a).one(i.efvEnabled?"#emptyFolderVideo":u),y=e.one(a).one(u),y&&y.addClass(l);if(g||!s)d=e.one(a).get("children"),d&&d.removeClass(f),g&&g.addClass(l);i.setToolbars(),i.efvEnabled?e.fire("emptyfolder-video:hide"):o&&e.fire("live-nation:hide")}},createToolbar:function(n){var i=this,s;return s=new r.Toolbar({template:n,menu:{template:function(t,n){var s;t==="btn-move"&&NeoConfig.imapIn?s=["mail-ui-inboxmenu-base","mail-ui-folder-menu"]:s="mail-ui-inboxmenu-base",e.use(s,function(){r.InboxMenu.insert(t,n,i.fid,{enableAddContact:function(e){e(i.isEnableAddToContacts(i))}})})},keys:function(n,s){e.use("mail-ui-inboxmenu-base",function(){var e=r.InboxMenu.getValidKeys(n);n.get("id")==="menu-move"&&(e=e.concat([68,96,97,98,99,100,101,102,103,104,105]),n.on("menu:state",function(e){e.state==="hide"&&!t.isControlActive()&&i.msgList&&i.msgList.get("focusNode")&&i.msgList.get("focusNode").focus()})),s(e)})},enterAccel:function(t){e.use("mail-ui-inboxmenu-base",function(e){t(e.mail.ui.InboxMenu.getEnterAccel())})}}}),s.on("itemSelected",i.handleToolbarSelection,i),s},setToolbars:function(t){var n=this;e.use("mail-ui-button-ctxt",function(){n._setToolbars(t)})},_setToolbars:function(n){function l(){var i=NeoConfig.previewPanePref?!0:!1,f=a===r.msgToolbarMod&&(u===h||r.folderType===L),l=r._isFolderEmpty(),p=0,d=u,v=C.getAcctIdByFid(d),m=r.subToolbars[C.getInboxFid(v)],g,y,T,N,A,O,M,_,D,P,H;r.msgList?(_=r.msgList._listview&&r.msgList._listview.isSelectedThread(),p=r.msgList.vlist.getSelectCount()):r.msgPane&&(r.msgPane&&r.msgPane.message&&r.msgPane.message.msgs&&r.msgPane.message.msgs.length>1&&(_=!0),p=1),T=k(u),strings.str_cfg_tog_use_reedit&&u=="%40S%40Search"&&r.msgPane&&r.msgPane.message.sourceFolderInfo&&r.msgPane.message.sourceFolderInfo.fid=="Sent"&&(d=u+"+Sent");if(!(d in r.subToolbars)){var B=k(d);B&&!B.isSystem&&m?(r.subToolbars[d]=m,m.setButtonContext&&m.setButtonContext(p,_)):(g={previewToggle:strings[i?"str_msg-view_btn_hidepreview":"str_msg-view_btn_showpreview"],spam_data_action:f?"notspam":"spam",str_spam_attr:strings[f?"str_not_spam_attr":"str_spam_conv_attr"],str_spam:strings[f?"str_not_spam":"str_spam"],selectall_class:l?"disabled":"enabled"
,msgliststate:n?_?"hasthreadmsg":"hasonemsg":"hasnomsg",toolbarStyleClass:t.settings.value("toolbarStyleClass"),toolbar_acct_id:v,replyGroupState:r.msgPane.get(b)?r.msgPane.message?"":"disableReplyGroup":"hideReplyGroup",origTmpl:a,strRestore:strings[t.settings.value("restoreToInboxDisplayString")]},y=s(o[a].base,g,r.formatters,0,strings,o),r.subToolbars[d]=r.createToolbar(y))}r.subToolbars[d].setButtonContext&&r.subToolbars[d].setButtonContext(p,_),r.get("contentToolbar")!==r.subToolbars[d]&&r.set("contentToolbar",r.subToolbars[d]),NeoConfig.previewPanePref===1?r.positionToolbarItems(!0):r.positionToolbarItems(!1),N=e.one("#pagetoolbar"),D=N&&N.one("#btn-togglethread"),A=N&&N.one("#btn-prev-msg"),O=N&&N.one("#btn-next-msg"),r.searchQuery&&r.searchQuery.isPrevNextNavigationDisabled?(A&&A.addClass("hidden"),O&&O.addClass("hidden")):NeoConfig.infinitePane&&r.msgPane.fullView&&(A&&A.removeClass("hidden"),O&&O.removeClass("hidden"),w&&w.detach(),E&&E.detach(),S&&S.detach(),x&&x.detach()),!A||A.hasClass("hidden")?(D&&D.setStyle("right",null).removeClass("showText"),c.previewPanePref===2&&e.one("#btn-conv-view")&&D&&D.setStyle("right",e.one("#btn-conv-view").get("offsetWidth")+10+"px")):r.msgPane&&r.msgPane.message&&r.msgPane.fullView&&A&&!A.hasClass("hidden")&&D&&D.setStyle("right",null).addClass("showText"),r.msgList&&e.one("#btn-conv-view span")&&e.one("#btn-conv-view span").set("innerHTML",e.mail.ui.common.StringUtils.getSortKeyString(r.msgList.sortedColumn.action)),n&&(r.showToggleThreadButtonIfManyMsgs(),n&&r.msgPane&&r.msgPane.message&&(r.getCurrentView()!=="scroll-view-prev"||!r.msgPane.isPrevPaneVisible()&&r.msgPane.fullView)&&(M=e.one("#btn-closemsg"),M&&M.removeClass("hidden"))),y||(P=e.one("#btn-ml-cbox input"),H=e.one("#btn-select-dd"),P&&H&&(l?(P.replaceClass("enabled","disabled"),H.replaceClass("enabled","disabled")):(P.replaceClass("disabled","enabled"),H.replaceClass("disabled","enabled"))))}var r=this,i=r.isChat(r.fid),u=i?p:r.fid,a=i||r.hasMsgList?r.toolbarMods[u]:r.msgToolbarMod,f="minty_module_toolbar_inbox_default_thread_rollup";NeoConfig.imapIn&&(C.getAcctIdByFid(u)!==C.PrimaryAcctId?(r.folderType=C.getFolderTypeByFid(u),a=r.hasMsgList?r.toolbarMods[r.folderType]:r.msgToolbarMod):NeoConfig.archive&&C.isArchiveFid(u)&&(a=r.hasMsgList?r.toolbarMods[M]:r.msgToolbarMod)),a||(a=r.hasMsgList?r.toolbarMods.Inbox:r.msgToolbarMod),a===f&&e.ui.Templates[f]?l():a==r.msgToolbarMod&&!n?r.msgPane&&r.msgPane.setToolbar&&r.msgPane.setToolbar(a,r.setToolbars,r):e.use(a,l)},getComposeWidgets:function(){var e=this;if(e.msgPane)return e.msgPane.getComposeWidgets()},getCurrentMsg:function(){var e=this,t,n=e.msgList,r=e.msgPane;return r&&r.message&&r.isLoaded?t=r.message:n._listview&&n._listview.getSelectCount()==1&&n.getSelected&&n.getSelected(function(e){e&&(t=e[0])}),t?t:null},isEnableAddToContacts:function(e,t,n){e=e||this;var r=e.getCurrentMsg(),s,o,u;if(r)return r.totalMsgs>1&&n&&n.hasClass("list-view-item-detail")&&(u=this.msgList._listview._getIndexN(n),r=r.msgs[u[1]]),s=e.getFromEmail(r),o=i.isKnownEmailAddress(s),(!s||o)&&t&&this.showNotification(s),!o;return},getFromEmail:function(e){var t;return e?(t=e.from||e.header&&e.header.from||e.totalMsgs===1&&e.msgs[0]&&e.msgs[0].from||e.totalMsgs===1&&e.recipients&&e.recipients[0],t&&t.email||""):""},singleSelectHandler:function(n){var r=this,s=r.msgPane,o=n.details[0],u=o.message,a=u.msgs&&u.msgs.length>0?u.msgs[0].mid:u&&u.mid,f=s&&s.get(b),l=t.Stopwatch.get("MsgInPreview");if(f){if((s&&s.message&&s.message.mid)==a)return;i.handleMsgInPreviewStopwatch(l,s,o.fid,a);var c=n.submessage?!0:!1,h=u.msgs&&u.msgs[0].from&&u.msgs[0].from.email?u.msgs[0].from.email.split("@"):["",""],p={pp:1,count:u.totalMsgs,unrdCnt:u.totalUnread,drftCnt:u.totalDraft,sndrDmn:h[1],msgID:u.msgs.map(function(e){return e.mid})};e.fire("mt:click",{action:c?n.fid==="Draft"?"open_thrd_drftMsg":"open_thrd_msg":"open_msg",append:p,spid:"msgread_reading_pane"}),NeoConfig.multitask&&u&&r.createRefTab(u)}s&&s.set(v,o),r.msgDetails=u?n.details[0]:null},handleUI:function(t,n,r,i){var s=this;t.msgPane=s.msgPane,e.use("mail-ui-proxyevents",function(){e.mail.ui.MailEventsProxy.handleUI(t,n,r,i)})},updatePreviewPaneToolbar:function(e){var t=this.subToolbars[this.fid],n=t?t.root||t.get("content"):null,r,i;n&&(r=e.newVal===1&&!this.msgList._listview.checkmode&&this.msgPane.get(b),i=n.one("#btn-delete"),n[r?"removeClass":"addClass"]("disableReplyGroup"),i&&i.setAttribute("title",r?strings.str_delete_conv_card_attr:strings.str_delete_conv_attr))},updatePreviewPaneCounter:function(e){var t,n=this.subToolbars[this.fid],r=e.newVal,i;n&&n.setButtonContext&&(t=k(this.fid),i=this.msgList._listview.isSelectedThread(),n.setButtonContext(r,i)),r>1||r===1&&this.msgList._listview.checkmode?(this.msgPane.set(v,{message:new Array(r)}),this.msgDetails=null):r==0&&(this.msgPane.set(v,null),this.msgDetails=null)},bindMsgList:function(){function o(e){var t,n;return e?(t=e.ancestor(".list-view-item"),t?(n=t.ancestor(".list-view-item-subcontainer"),n?!0:!1):!1):!1}var n=this,i=n.msgList,s=n.msgPane;i.on("singleSelect",n.singleSelectHandler,n),i.on("sortList",function(e){this.sortList(e.sortType,e.targetNode,e.currentSortedColumn)}),i.on(d,function(e){n.fire(d,e)}),i.on("toggleToCol",function(){r&&r.MessagesViewColResize&&r.MessagesViewColResize.toggleCol("to",!0)}),s&&s.on("transferFocusChange",function(e){e.newVal&&i.set("focus",1)}),i.on("command",function(t){var r=0,s=t.details[0].message;t.e&&t.e.type!="dblclick"&&(n.msgPane&&n.msgPane.get(b)||strings.str_cfg_tog_open_by_dblclick)&&(r=1);if(r)return;var o=t.submessage?!0:!1,u={pp:r},a=s.msgs&&s.msgs[0].from&&s.msgs[0].from.email?s.msgs[0].from.email.split("@"):["",""];u.count=s.totalMsgs,u.unrdCnt=s.totalUnread,u.drftCnt=s.totalDraft,u.sndrDmn=a[1],u.msgID=s.msgs.map(function(e){return e.mid}),e.fire("mt:click",{action:o?t.fid==="Draft"?"open_thrd_drftMsg":"open_thrd_msg":"open_msg",append:u,spid:"message_tabpane"});var f=n.isChat(t.fid)?["mail-ui-messagesview-base"
,"_shared_module_message_display_fresh_rollup","_shared_module_message_pane_fresh"]:[];e.use(f,function(e){e.fire("openConv",{msg:t.message,submsg:t.submessage,fid:t.fid,neighbors:t.neighbors,sortCol:i.sortedColumn,arrMsgSeq:i._listview.arrItems||i._listview._model&&i._listview._model.get("list"),index:t.index||i._listview.rootSelect&&i._listview.rootSelect.index||null,isThread:!0})})}),i.on("fidChange",function(e){if(n.fid!=e.newVal||!n._isFolderEmpty()&&n.isEFVideoActive())n.msgDetails=null,n.fid=e.newVal,s&&(s.showMailBoxIcon=!0,s.set(v,null)),n.renderToolbarsOrEmpty(),n.toggleColumns(e.prevVal,e.newVal)}),i.on("selectCountChange",n.updatePreviewPaneCounter,n),NeoConfig.convReplyBtnsInTlbr&&i.on("selectCountChange",n.updatePreviewPaneToolbar,n),i.on(m,function(e){n.get("loaded")||n.set("loaded",1),i.get("active")&&!e.silent&&i.handleDarlaEvent(n.isEmpty(n.fid))}),e.one("#msg-list").one("div.list-view-items").on("keydown",function(n){var r=e.UA.os,i=r=="windows"||r=="win";if(i&&n.shiftKey&&n.keyCode==121||!i&&n.ctrlKey&&n.shiftKey&&n.altKey&&n.keyCode==77)n.preventDefault(),t.simulateContextMenu(n.target)}),e.one("#msg-list").one("div.list-view-items").delegate("contextmenu",function(r){function u(){e.mail.ui.InboxMenu.insert("menu-msglist",function(){var s=e.one("#menu-msglist");_(),e.common.ui.MenuHelper.create(i,{menu:s,isContext:!0,xy:[r.clientX,r.clientY],keys:function(t){t(e.mail.ui.InboxMenu.getValidKeys(s))},enterAccel:function(t){t(e.mail.ui.InboxMenu.getEnterAccel())}},function(){var i=s.one('li[data-action="addcontact"]'),u=s.one('a[data-action="fullheader"]'),a=s.one('a[data-action="rawmessage"]');o(r.target)?(u&&u.addClass("enable-menuitem-in-conv"),a&&a.addClass("enable-menuitem-in-conv"),i&&i.addClass("enable-menuitem-in-conv")):(u&&u.removeClass("enable-menuitem-in-conv"),a&&a.removeClass("enable-menuitem-in-conv"),i&&i.removeClass("enable-menuitem-in-conv")),s.on("menuSelected",function(t){var i={action:t.dataAction,contextmenuTarget:r.target};"addcontact"===t.dataAction&&(i.context="msg"),e.mail.ui.MailEventsProxy.handleUI(i,n.fid,n.msgList),e.fire("mt:click",{action:"rt_click_msglst",append:{ltxt:i.action}})}),s.on("menu:state",function(r){var i=NeoConfig.imapIn,o,u;i&&(o="disabled",u=s.all(".primary-only-action")),r.state==="hide"&&!t.isControlActive()?n.msgList&&n.msgList.get("focusNode")&&n.msgList.get("focusNode").focus():r.state==="show"&&i?e.mail.Controller.ImapIn.isPrimaryAccount()?u.removeClass(o):u.addClass(o):r.state==="show"&&r.link.menu.getContextTarget()!==null&&s._hide()})})},n.fid,{isContext:!0,enableAddContact:function(e){e(n.isEnableAddToContacts(null,null,r.currentTarget))}}),e.fire("mt:click",{action:"rt_click_msglst_preview"})}var i=r.currentTarget.ancestor(".list-view-items"),s;r.halt(),e.use("mail-ui-inboxmenu-base",function(e){e.use("common-ui-menu-helper",function(e){s=e.common.ui.MenuHelper,s.createLoadingMenu(i,{isContext:!0,xy:[r.clientX,r.clientY]}),e.use("mail-ui-inboxmenu-base",function(e){e.use("mail-ui-proxyevents",function(){u()})})})})},"div.list-view-item",n)},toggleColumns:function(t,n){t===p?e.one(".list-view").all(".col-hd.info, .col-hd.file").removeClass("hidden"):n===p&&e.one(".list-view").all(".col-hd.info, .col-hd.file").addClass("hidden")},afterActiveChanged:function(t){var n=this,r=n.msgList;t&&(n.hasMsgList&&!e.server?(!n.slidersSet&&e.Lang.later(0,n,n.loadResizersAndSliders),t.newVal&&n.get("loaded")&&r.handleDarlaEvent(n.isEmpty(n.fid))):!n.hasMsgList&&n.msgPane.message&&typeof t.prevVal!="undefined"&&t.newVal&&n.triggerDarlaWithAIC(),r&&r.set(b,t.newVal))},handleDefaultCase:function(e){var n=this,r=e.item,i=e.action,s=n.fid,o=n.msgList,u=n.msgPane,a=n.getComposeWidgets(),f={action:i,id:r?r.get("id"):0,forwardAsAttachment:e.forwardAsAttachment||0,fid:r&&r.getAttribute("data-fid")?r.getAttribute("data-fid"):s,widget:n.type==="messagepane"?n:null,item:r,hasMsgList:n.hasMsgList,tbAction:e.tbAction,hasCompose:a&&a.length,shiftKey:e.shiftKey,subIndexArr:e.subIndexArr},l;e.context&&(f.context=e.context),t.features.enabled("delMsgInConv")&&i==="delete"&&!e.shiftKey&&u&&u.selNode&&u.selNode.hasClass("thread-focus")&&u.message.totalMsgs>1?(f.context="msg",f.id=u.selNode.get("id"),f.cancelCbk=0,f.hasMsgList=!1,l=u.message.msgs[u.selMsgIdx],n.handleUI(f,s,null,[l?l:null])):n.hasMsgList?n.handleUI(f,s,o):(l=u&&u.get(v),i!=="delete"&&i!=="trash"||!(l&&l.message&&l.message.totalDraft||f.hasCompose)?n.handlePostAction(f,s,null,l):n.confirmRemoveDrafts(function(){n.handlePostAction(f,s,null,l)}))},confirmRemoveDrafts:function(t){e.use("common-ui-dialog-helper",function(){var n=e.common.ui;n.DialogHelper.confirm({hd:strings.str_delete_conv_confirm_hdr,bd:strings.str_delete_conv_confirm_bd},{ok:{handler:function(e,n){t(),n.destroy()},text:strings.str_delete}})})},render:function(t){var n=this,r=n.msgList,i=n.msgPane;n.set("parentNode",e.one(t)),(r||i).on(m,function(){n.hasMsgList||!n.callFromLaunch&&setTimeout(function(){n.triggerDarlaWithAIC()},0),n.fire(m)}),r&&r.render(t),(n.fid!==g||r===0)&&i&&i.render(t),n.fid&&n.fid!==g&&(n.set("focusNode",(r||i).get("focusNode")),n.renderToolbarsOrEmpty()),e.after("update:previewPane",function(){n.renderToolbarsOrEmpty()}),e.after("mbEvent:previewpane_expand",function(){n._isFolderEmpty()&&e.fire("mbEvent:hide")})},showToggleThreadButtonIfManyMsgs:function(){var t=this.msgPane.message,n;n=e.one("#btn-togglethread");if(n){if(!t||!t.totalMsgs||t.totalMsgs===1){n.addClass("hidden");return}n.removeClass("hidden"),n.hasClass("thread-cards-collapsed")&&(n.removeClass("thread-cards-collapsed").addClass("thread-cards-expanded"),n.setAttribute("title",strings.str_collapse_all_attr),n.one(".icon-text").setContent(strings.str_collapse_all))}}},!0),e.namespace("mail.ui").ConvView=D},"1.0.0",{requires:["common-ui-contentwidget","common-ui-toolbar-base","mail-ui-mailview-base","mail-ui-convlist-base","mail-ui-convpane-base","minty_module_toolbar_inbox_default_thread_rollup","dom-screen","mail-ui-common-string-utils"
,"mail-common-utils-features","mail-common-utils-settings","common-utils","mail-ui-folder-utils"]});


YUI.add("_shared_module_thread_thread_pane",function(e){e.namespace("ui.Templates"),e.ui.Templates._shared_module_thread_thread_pane={base:'<div role="main" aria-label="{{str_aria_label_main_conversation}}" class="threadpane {{page_message_pane_view}}" {{page_message_pane_view1}}> <div id="{{page_message_pane_view2}}" class="{{page_message_full_view}} thread-content content" role="presentation"> {{page_show_comm_modes}} {{page_show_comm_modes_else}} {{task_panel}} </div></div>',page_message_pane_view:"tripane",user_pref_height:'style="top:{{msg_pane_top}};{{tripane_pos}}:{{msg_list_width}}"',page_message_pane_view1:"{{user_pref_height}}",page_message_pane_view2:"msg-preview",page_message_full_view:"message ",global_spearmint_view:"{{_shared_module_message_prompt}} ",global_spearmint_view_else:'<div class="css-env"> <i class="icon icon-mail-inbox"></i> <h2 class="count">{{num_selected_msgs}}</h2> </div> ',page_show_comm_modes:"{{global_spearmint_view}} {{global_spearmint_view_else}} ",page_show_comm_modes_else:"{{_shared_module_thread_thread_display_rollup}} "}},"1.0.0",{requires:["_shared_module_message_prompt","_shared_module_thread_thread_display_rollup"]});


YUI.add("minty_module_toolbar_inbox_default_thread_rollup",function(e){e.namespace("ui.Templates"),e.ui.Templates.minty_module_toolbar_inbox_default_thread_rollup={base:'<div id="pagetoolbar" class="{{msgliststate}} {{replyGroupState}} {{toolbarStyleClass}}" data-acctid="{{toolbar_acct_id}}"> <div id="match-messagelist-sizing"> <span class="btn btn-hdr cbox collapse-end-space" id="btn-ml-cbox"> <label> <input title="{{str_msg_list_select_all_msgs_attr}}" aria-label="{{str_msg_list_select_all_msgs_attr}}" type="checkbox" class="focusable neoFocusable {{selectall_class}}" tabindex="0" data-action="selectAll-message"> <span class="icon" aria-hidden="true"></span> </label></span><button tabindex="-1" id="btn-select-dd" data-action="select-dd" role="button" aria-haspopup="true" class="btn neoFocusable {{selectall_class}}" aria-label="{{str_msg_list_select_categorized_msgs_attr}}"> <b class="icon icon-chevron-down"></b></button> <button id="btn-conv-view" class="btn btn-absolute btn-view-dd" role="button" tabindex="-1" aria-haspopup="true" title="{{str_view_conv_attr}}" data-action="menu"> <span class="icon-text">{{str_view}}</span> <i class="icon-sort-ascending"></i> <b class="icon icon-chevron-down"></b></button> </div> {{reply_group}} {{archiveEnabled}} {{archiveEnabled_else}} {{spam_menu}} {{spam_menu_else}} <button id="btn-actions" class="btn multimsg" aria-label="{{str_more_actions_attr}}" title="{{str_more_actions_attr}}" data-action="menu" tabindex="-1" aria-haspopup="true"> <i class="icon-more"></i><span class="icon-text">{{str_more}}</span><b class="icon icon-chevron-down"></b> </button> <button id="btn-closemsg" class="btn btn-absolute btn-close-msg hidden" aria-label="{{str_close}}" title="{{str_close}}" data-action="closemsg" tabindex="-1"> <i></i> </button> <button id="btn-togglethread" class="btn thread-cards-expanded hidden" aria-label="{{str_collapse_all_attr}}" title="{{str_collapse_all_attr}}" data-action="thread-toggle" tabindex="-1"> <i class="icon-collapse-list"></i><span class="icon-text">{{str_collapse_all}}</span> </button></div>',archiveEnabled:'<button id="btn-archive" class="btn multimsg" title="{{str_archive_convs_attr}}" aria-label="{{str_archive_convs_attr}}" data-action="archive" tabindex="-1"> <i class="icon-archive"></i><span class="icon-text">{{str_archive}}</span> </button> <button id="btn-move" class="btn multimsg" aria-label="{{str_move_convs_attr}}" title="{{str_move_convs_attr}}" data-action="menu" tabindex="-1" aria-haspopup="true"> <i class="icon-move"></i><span class="icon-text">{{str_move}}</span><b class="icon icon-chevron-down"></b> </button> <button id="btn-delete" class="btn multimsg" aria-label="{{str_delete_conv_attr}}" title="{{str_delete_conv_attr}}" data-action="delete" tabindex="-1"> <i class="icon-delete"></i><span class="icon-text">{{str_delete}}</span> </button> ',archiveEnabled_else:'<button id="btn-delete" class="btn multimsg" aria-label="{{str_delete_conv_attr}}" title="{{str_delete_conv_attr}}" data-action="delete" tabindex="-1"> <i class="icon-delete"></i><span class="icon-text">{{str_delete}}</span> </button> <button id="btn-move" class="btn multimsg" aria-label="{{str_move_convs_attr}}" title="{{str_move_convs_attr}}" data-action="menu" tabindex="-1" aria-haspopup="true"> <i class="icon-move"></i><span class="icon-text">{{str_move}}</span><b class="icon icon-chevron-down"></b> </button> ',spam_menu:'<button id="main-btn-spam" class="btn multimsg collapse-end-space" aria-label="{{str_mspam_conv_attr}}" title="{{str_mspam_conv_attr}}" data-action="{{spam_data_action}}" tabindex="-1"> <i class="icon-spam"></i><span class="icon-text">{{str_spam}}</span> </button> <button id="btn-spam" class="btn multimsg" aria-label="{{str_menu_spam_toggle_attr}}" title="{{str_menu_spam_toggle_attr}}" data-action="menu" tabindex="-1" aria-haspopup="true"> <b class="icon icon-chevron-down"></b> </button> ',spam_menu_else:'<button id="main-btn-spam" class="btn multimsg" aria-label="{{str_spam_attr}}" title="{{str_spam_attr}}" data-action="{{spam_data_action}}" tabindex="-1"> <i class="icon-spam"></i><span class="icon-text">{{str_spam}}</span> </button> ',reply_group:'<button id="btn-reply-sender" class="btn onemsg reply" aria-label="{{str_reply_sender}}" title="{{str_reply_sender}} [{{str_menu_accel_shift_r}}]" data-action="reply_sender" tabindex="-1"> <i class="icon-reply"></i> </button> <button id="btn-reply-all" class="btn onemsg reply-all" aria-label="{{str_reply_all}}" title="{{str_reply_all}} [{{str_menu_accel_shift_a}}]" data-action="reply_all" tabindex="-1"> <i class="icon-reply-all"></i> </button> <button id="btn-forward" class="btn onemsg forward" aria-label="{{str_forward}}" title="{{str_forward}} [{{str_menu_accel_shift_f}}]" data-action="forward" tabindex="-1"> <i class="icon-forward"></i> </button>'}},"1.0.0");


YUI.add("_shared_module_thread_thread_display_rollup",function(e){e.namespace("ui.Templates"),e.ui.Templates._shared_module_thread_thread_display_rollup={base:"{{message_selection}}{{message_selection_else}}",message_selection:'<div class="emptypane"> <div class="css-env"> <i class="icon icon-mail-inbox"></i> <h2 class="count">{{num_selected_msgs}}</h2> </div> </div>',conv_deleted_error:'<div class="message"> {{str_conv_deleted_error}} </div> ',msg_deleted_error:'<div class="message"> {{str_msg_deleted_error}} </div> ',is_perm:"{{str_comp_loading_error_perm}} ",multi_retry:"{{str_comp_multi_retry}} ",multi_retry_else:"{{str_comp_loading_error}} ",is_perm_else:"{{multi_retry}} {{multi_retry_else}} ",can_retry:'<div class="message"> <span class=\'retry\' data-action="retry-conv-load">{{str_try_again}}</span> </div> ',show_tae:'<div class="message error_code">{{str_error_code}} {{tae_code}}</div>',conv_loading_error:'<div class="message"> {{is_perm}} {{is_perm_else}} </div> {{can_retry}} {{show_tae}} ',diff_folder_error:'<div class="message">{{str_error_msg_diff_folder_switch}}</div> ',loading_slow_msg:"{{str_comp_loading_msg}}",loading_slow_conv:"{{str_comp_loading_conv}}",loading_slow_else:'<div class="conv-loading">{{loading_slow_msg}}{{loading_slow_conv}}</div> ',loading_slow:"<div class=\"message\">{{str_comp_slow_loading}}</div> <div class='message'> <span class='retry' data-action=\"retry-conv-load\">{{str_try_again}}</span> </div> ",conv_loading_error_else:"{{loading_slow_else}} {{loading_slow}} ",page_loading:'<div id="loadingpane" class="conv-loadingpane"> {{conv_deleted_error}} {{msg_deleted_error}} {{conv_loading_error}} {{diff_folder_error}} {{conv_loading_error_else}}</div> ',expanded:"expanded",isUnread:"unread",active:"active",hasDraft:"hasdraft",super_collapsed:"super-hidden",loadhide:"loadhide",unread_icon:'<div class="icon info info-hover {{flag_info_hover}}" role="button" aria-label="{{mark_unread}}" title="{{status_title}}" data-action="thread-item-unread" tabindex="0"></div> ',isFlagged:"flagged",isFlagged1:"{{str_msg_view_flagged_attr}}",isFlagged_else:"{{str_msg_view_flag_attr}}",isFlagged2:"{{str_msg_list_flagged}}",isFlagged_else1:"{{str_msg_list_not_flagged}}",flag_icon:'<div tabindex="0" role="button" class="icon flag {{isFlagged}}" data-action="thread-item-flag" title="{{isFlagged1}} {{isFlagged_else}}" aria-label="{{isFlagged2}} {{isFlagged_else1}}"> </div> ',from:'<a class="hcard-mailto" href="mailto:{{from_id}}"> <span class="from lozengfy hcard" data-name = "{{from_name}}" data-address="{{from_id}}" title="{{from_id}}" data-action="contact-card-menu" tabindex="0" role="button" aria-haspopup="true" aria-label="{{str_msg_list_from_name_from}}">{{from_name}} <span>{{sender_email_address}}</span></span> </a> ',to_group:'<div class="table"> <span class="to table-cell" aria-disabled="true" role="presentation">{{str_comp_label_to_fresh}}</span> <div class="table-cell"> {{recipients_built}} {{more_built}} </div> {{hide}} </div> ',cc_group:'<div class="table"> <span class="cc table-cell" aria-disabled="true" role="presentation">{{str_comp_label_cc_fresh}}</span> <div class="table-cell"> {{recipients_built}} {{more_built}} </div> {{hide}} </div> ',bcc_group:'<div class="table"> <span class="bcc table-cell" aria-disabled="true" role="presentation">{{str_comp_label_bcc_fresh}}</span> <div class="table-cell"> {{recipients_built}} {{more_built}} </div> {{hide}} </div> ',recipient_list:'<a class="hcard-mailto" href="mailto:{{rcpt_id}}"> <span class="lozengfy hcard " role="button" tabindex="0" data-action="contact-card-menu" data-name="{{rcpt_name}}" data-address="{{rcpt_id}}" >{{rcpt_name}}</span> </a> ',more_recipients_str:'<span class="more_recp lozengfy hcard more" data-field="{{data_field}}" data-address="{{data_address}}" data-action="more" role="button" tabindex="0" aria-label="{{str_thread_hdr_more_recipients_attr}}"> {{str_hdr_more_recipients}}</span>',hide_recipients_str:'<span class="hide_recp table-cell" data-field="{{data_field}}" data-action="hide" role="button" tabindex="0" aria-label="{{str_thread_hdr_hide_recipients_attr}}">{{str_hdr_hide_recipients}}</span>',recipients:"{{to_group}} {{cc_group}} {{bcc_group}} {{recipient_list}} {{more_recipients_str}} {{hide_recipients_str}} ",hasDraft1:'<span class="draft" role="presentation">{{str_draft}}</span>',hasAttachment:'<div aria-label="{{str_msg_list_attachments}}" title="{{str_msg_list_attachments}}" class="icon file" role="button" tabindex="0"></div>',thread_date:'<div class="thread-info" role="presentation"> {{hasDraft1}} {{hasAttachment}} <span class="thread-date" role="presentation"> <span class="short" title="{{received_date}}" role="presentation">{{date}}</span> </span> </div> ',msg_blocked:'<div class="blocked"><div class="base-blocked" aria-label="{{str_msg_view_heading_blocked_images}}" tabindex="0" role="presentation"> <h3 role="presentation">{{str_msg_view_heading_blocked_images}}</h3> <div class="blocked-image" role="presentation"> <div class="btn show-text" role="presentation"> <a role="button" href="#" tabindex="0" aria-label="{{str_msg_view_btn_show_images_attr}}" title="{{str_msg_view_btn_show_images_attr}}" data-action="show-images">{{str_msg_view_btn_show_images}}</a> </div> <div class="btn options" role="presentation"> <a role="button" tabindex="0" href="#" aria-label="{{str_msg_view_btn_options_attr}}" title="{{str_msg_view_btn_options_attr}}" data-action="mail-options">{{str_msg_view_btn_options}}</a> </div> </div></div></div> ',msg_deleted_error1:'<div class="message"> {{str_msg_deleted_error}} </div> ',is_perm1:"{{str_comp_loading_error_perm}} ",multi_retry1:"{{str_comp_multi_retry}} ",multi_retry_else1:"{{str_comp_loading_error}} ",is_perm_else1:"{{multi_retry1}} {{multi_retry_else1}} ",can_retry1:"<div class='message'> <span class='retry' data-action=\"retry-msg-load\">{{str_try_again}}</span> </div> ",show_tae1:'<div class="message error_code">{{str_error_code}} {{tae_code}}</div>',msg_deleted_error_else
:"<div class='message'> {{is_perm1}} {{is_perm_else1}} </div> {{can_retry1}} {{show_tae1}} ",loading_error:"{{msg_deleted_error1}} {{msg_deleted_error_else}} ",diff_folder_error1:"<div class='message'>{{str_error_msg_diff_folder_switch}}</div> ",loading_slow_else1:'<div class="msg-loading s-loader"></div> ',loading_slow1:"<div class='message'> {{str_comp_slow_loading}} </div> <div class='message'> <span class='retry' data-action=\"retry-msg-load\">{{str_try_again}}</span> </div> ",loading_error_else:"{{loading_slow_else1}} {{loading_slow1}} ",msg_loading:'<div id="loadingpane" class="msg-loadingpane"> {{loading_error}} {{diff_folder_error1}} {{loading_error_else}}</div> ',quoted_text_collapse:'<div class="thread-quoted-text unselectable" title="{{str_qtd_expand}}" role="presentation"> <span class="icon icon-chevron-right qtd-expansion-icon" role="presentation" data-action="quoted-text"></span> <span class="qtd-expansion-text" data-action="quoted-text" tabindex="0" role="button" aria-label="{{str_qtd_expand}}">{{str_qtd_expand}}</span> </div> ',quoted_text_expand:'<div class="thread-quoted-body">{{quoted_text_body}}</div> ',msg_truncated:'<div class="msg-truncated"> <h3>{{str_msg_view_msg_truncated}}</h3> <span class="rht"> <span class="btn left right"><a role="button" href="#" data-action="view-full-msg">{{str_msg_view_btn_view_full}}</a></span> </span></div> ',with_icons:'<div class="thread-footer withicons"> <span class="addconvtitle"> <a tabindex="0" href="#" data-action="reply_sender"> <i class="icon icon-reply"></i>{{str_reply}} </a> <a tabindex="0" href="#" data-action="reply_all"> <i class="icon icon-reply-all"></i>{{str_reply_all}} </a> <a tabindex="0" href="#" data-action="forward"> <i class="icon icon-forward"></i>{{str_forward}} </a> </span> <span class="card-actions-menu"> <a tabindex="0" href="#" data-action="menu"> <i class="icon icon-more"></i>{{str_more}} </a> </span></div>',with_icons_else:'<div class="thread-footer"> <span class="addconvtitle">{{str_reply_options}}</span> <span> | </span> <span class="card-actions-menu"><a tabindex="0" href="#" data-action="menu">{{str_more}}</a></span></div>',thread_item:'<div data-mid="{{mid}}" class="thread-item {{expanded}} {{isUnread}} {{active}} {{hasDraft}} {{super_collapsed}} {{loadhide}}" data-action="select-thread" tabindex="0" aria-expanded="{{ariaExpanded}}" role="section"> <div class="thread-item-header" role="presentation"> <div class="contents" role="presentation"> <div class="icon info info-real {{flag_info}}" title="{{status_title}}" data-action="thread-item-unread"></div> {{unread_icon}} {{flag_icon}} {{from}} <span class="thread-snippet">{{snippet}}</span> <span class="load-error-msg"></span> <div class="recipients" tabindex="0" role="presentation" aria-label="{{ariaStr}}"> {{recipients}} </div> </div> {{thread_date}}</div> <div class="thread-body" role="presentation"> {{msg_blocked}} <div class="body undoreset" tabindex="0"> {{msg_loading}} {{body}} </div> {{quoted_text_collapse}} {{quoted_text_expand}} {{msg_truncated}}</div>{{with_icons}}{{with_icons_else}} </div> ',plus_icon:'<span class="more-icon icon icon-add"></span> ',super_collapsed_btn:'<div class="supercollapsed loadhide" data-action="thread-super-collapse" tabindex="0"> {{plus_icon}} {{str_supercollapsed_show}} </div> ',conv_loading:'<div class="conv-loading s-loader hidden"></div> ',anyUnread:"unread",anyFlagged:"flagged",anyFlagged1:"{{str_convview_convflagged_attr}}",anyFlagged_else:"{{str_convview_convflag_attr}}",anyFlagged2:"{{str_msg_list_convflagged}}",anyFlagged_else1:"{{str_msg_list_not_convflagged}}",mail_search_enabled:"</a>",folder_message:'<div role="presentation" aria-label="{{str_msg-view_message_header}} {{msg_subject}}" class="y-module message-header {{anyUnread}}"> <div aria-label="{{str_msg-view_message_header}}" class="focusholder" role="presentation"></div> <div tabindex="0" role="button" class="icon info info-unread" aria-label="{{ariaLabelStrMsgHeaderUnread}}" title="{{titleStrMsgHeaderUnread}}" data-action="thread-unread"></div> <div tabindex="0" role="button" class="icon flag {{anyFlagged}}" data-action="thread-flag" title="{{anyFlagged1}} {{anyFlagged_else}}" aria-label="{{anyFlagged2}} {{anyFlagged_else1}}"> </div> <h3 "{{msg_subjectDir}}"> <span class="thread-subject" title="{{msg_subject}}">{{msg_subject}}</span> <span class="summary">{{summary}}</span> {{mail_search_enabled}} </h3> </div> ',showAllReplyActions:'<span class="addconvtitle">{{str_comp_click}} {{str_reply_options}}</span> ',showAllReplyActions_else:'<span class="addconvtitle">{{str_comp_click_replyall}}</span> ',squeezeToolbar:"squeeze-toolbar",show_delete_draft_icon:'<span id="btn-draft-delete" class="draft-delete-btn icon icon-delete float-none" data-action="delete" role="button" title="{{str_delete_draft}}"></span> ',page_compose_email_else:"hidden",attached_files_else:"hidden",browser_plus_attach_else:"simple-upload {{attached_files_else}} ",browser_plus_attach:"<h2>{{str_rte_attachments_attach_files}}</h2> <h3>{{str_rte_attachments_drag_files}}</h3> ",transfer_error:"transfer-error",waiting:"in-queue ",image:'<div style="background-image:url({{thumbnailurl}});"></div> ',in_progress:'<div class="prog-indicator"> <div class="progress" style="width:{{progress}}%"></div> </div> ',browser_plus_attach1:'<li role="presentation" class="attachmentVisible {{transfer_error}} {{waiting}} {{type}}"> <div class="file-container"> {{image}} <b/></b> </div> <span class="fname">{{filename}}</span> {{in_progress}}</li>',waiting1:"in-queue ",in_progress1:"downloading ",transfer_error1:"lozengeerror",transfer_warn:"lozengewarn",retry:'<span role="presentation" class="btn lozenge lozengeretry small hidden"><a role="presentation" tabindex="-1" title="{{str_btn_retry_file_attr}}">&nbsp;<b></b></a></span>',transfer_error2:"lozengeerror-remove",browser_plus_attach_else1:'<li role="presentation" class="attachmentVisible {{waiting1}} {{in_progress1}} {{type}}"><div tabindex="-1" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" class="lozengeProgress"></div> <span role="presentation" class="btn lozenge {{transfer_error1}} left small"><a role="option" title="{{filesize}}" tabindex="-1" class="{{transfer_warn}}">{{filename}}</a></span>{{retry}}<span role="presentation" class="btn lozenge lozengeremove {{transfer_error2}} right small"><a role="presentation" tabindex="-1" title="{{str_btn_remove_file_attr}}">&nbsp;<b></b></a></span></li>'
,file_attach_files:"{{browser_plus_attach1}}{{browser_plus_attach_else1}} ",multiple_files_failed:"{{str_rte_attachments_error_mult}}",multiple_files_failed_else:"{{str_rte_attachments_error_single}}",attachments_error:"{{multiple_files_failed}} {{multiple_files_failed_else}} ",attachMenuPlus:'<span class="attach-menu-plus" data-menu-position="above"> <span class="icon icon-attachment attachment-button-attach" title="{{str_comp_attach_singular}}"> </span> <span id="upload_file_selection" aria-hidden="true" class="hidden" title="{{str_comp_attach_singular}}"> <span id="uploader-v2"></span> </span> <span id="attach-btn-menu" aria-hidden="true" class="btn disabled icon icon-chevron-down attach-btn-menu" title="{{str_comp_attach_menu_title_fresh}}" data-action="menu" data-menu-position="above"></span> </span> <input type="file" id="attachment-button-input" multiple="true" name="uploadfile" class="attachment-button-file attach-menu-plus" role="button" aria-label="{{str_comp_attach_singular}}" tabindex="0"/> ',attachMenuPlus_else:'<span class="icon icon-attachment attachment-button-attach" title="{{str_comp_attach_singular}}"> <input type="file" id="attachment-button-input" multiple="true" name="uploadfile" class="attachment-button-file" role="button" aria-label="{{str_comp_attach_singular}}" tabindex="0"/> </span> <span id="upload_file_selection" aria-hidden="true" class="hidden" title="{{str_comp_attach_singular}}"> <span id="uploader-v2"></span> </span> <span id="attach-btn-menu" aria-hidden="true" class="btn disabled icon icon-chevron-down attach-btn-menu" title="{{str_comp_attach_menu_title_fresh}}" data-action="menu"></span> ',show_attachment_icon:'<div role="presentation" class="attachments-pane gwell rte-pane-fresh shaded rp5px" > <div role="group"> <form method="post" enctype="multipart/form-data" class="attachment-button-form" target="" action=""> {{attachMenuPlus}} {{attachMenuPlus_else}} </form> <span class="btn left right menu attachment-button-disabled hidden"> <a role="button" href="#" tabindex="-1" >{{str_comp_attach}}</a> </span> <span role="alert" class="switch-to-basic-link hidden"> {{str_rte_attachments_basic_message}} <a role="button" href="#">{{str_rte_attachments_basic_link_text}}</a>. </span> </div></div>',stationery_icon_placeholder:'<span class="stationeryWrapper loading rich-only" title="{{str_comp_action_stationery}}" role="button"> <span class="btn icon icon-stationery mail-font loading rich-only" title="{{str_comp_action_stationery}}" role="button"> </span> </span> ',is_underline:'<span data-action="underline" tabindex="-1" role="button" class="icon icon-underline" title="{{str_rte_underline_attr}}"> </span> ',is_rtl:'<span id="btn-rtl" data-action="bidi" value="rtl" tabindex="-1" role="button" class="icon icon-rtl" title="{{str_rte_right_to_left}}"> </span> <span id="btn-ltr" data-action="bidi" value="ltr" tabindex="-1" role="button" class="icon icon-ltr" title="{{str_rte_left_to_right}}"> </span> ',is_rtl_else:'<span id="btn-ltr" data-action="bidi" value="ltr" tabindex="-1" role="button" class="icon icon-ltr" title="{{str_rte_left_to_right}}"> </span> <span id="btn-rtl" data-action="bidi" value="rtl" tabindex="-1" role="button" class="icon icon-rtl" title="{{str_rte_right_to_left}}"> </span> ',bidi:"{{is_rtl}} {{is_rtl_else}} ",spellCheckEnabled:'<span id="btn-spellchk" data-action="spellcheck" tabindex="-1" role="button" class="icon icon-check-spelling" title="{{str_rte_check_spelling_attr_fresh}}"> </span> <span id="btn-spell-langs" data-action="menu" data-menu-position="above" tabindex="-1" role="button" aria-haspopup="true" title="{{str_toolbar_spelling_menu_toggle_attr_fresh}}" class="icon icon-chevron-down"> </span> ',show_formatter_well:'<div role="presentation" class="rte-pane-fresh format-pane gwell shaded"> <div role="group" class="format-inner"> {{stationery_icon_placeholder}} <span id="btn-fontnamesize" class="icon icon-choose-font" data-action="menu" data-menu-position="above" tabindex="-1" role="button" title="{{str_comp_font_menu_attr_fresh}}"> </span> <span data-action="bold" class="icon icon-bold" tabindex="-1" role="button" title="{{str_rte_bold_attr}}" > </span> <span data-action="italic" tabindex="-1" role="button" class="icon icon-italic" title="{{str_rte_italic_attr_fresh}}"> </span> {{is_underline}} <span id="btn-forecolor" data-action="menu" data-menu-position="above" tabindex="-1" role="button" aria-haspopup="true" aria-label="{{str_rte_color_attr_fresh}}" class="icon icon-text-highlight" title="{{str_rte_color_attr_fresh}}"></span> <span id="btn-insertunordered" data-action="menu" data-menu-position="above" tabindex="-1" role="button" class="icon icon-list-bullets" title="{{str_rte_list_menu_attr_fresh}}"></span> <span id="btn-indent" data-action="menu" data-menu-position="above" tabindex="-1" role="button" class="icon icon-indent" title="{{str_rte_indentation_menu_attr_fresh}}"></span> <span id="btn-text-align" data-action="menu" data-menu-position="above" tabindex="-1" role="button" aria-haspopup="true" class="icon icon-align-left" title="{{str_rte_text_alignment_menu_attr_fresh}}"></span> {{bidi}} <span data-action="insertlink" tabindex="-1" role="button" class="icon icon-link" title="{{str_rte_link_attr_fresh}}"> </span> <span id="emoticon" data-action="menu" data-menu-position="above" tabindex="-1" role="button" aria-haspopup="true" class="icon icon-emoticons" title="{{str_comp_emoticons}}"> </span> <span class="om-buttons"></span> {{spellCheckEnabled}} <span id="switchtext-plain" class="switchtext btn-isPlain last icon icon-chevron-double-right" tabindex="-1" role="button" title="{{str_rte_richtext}}" target="plain-text"> </span> <span id="switchtext-rich" class="switchtext btn-isRich last hidden icon icon-chevron-double-left" role="button" title="{{str_rte_plaintext}}" target="rich-text"> </span> </div> </div> ',tooltip:"{{str_comp_action_close_compose_assist}}",tooltip_else:"{{str_quick_attach_title}}",ca_icon:'<div class="actions-seperator hidden ca-action-seperator">&nbsp;</div><div class="ca-showhide-ctrl" aria-hidden="true"> <button class="btn-ca-showhide icon-add ca-content-visible icon icon-disabled" title="{{tooltip}}{{tooltip_else}}" disabled></button></div>'
,message_selection_else:'{{folder_message}}  <div class="thread-item-list" tabindex="-1"> {{page_loading}} {{thread_item}} {{super_collapsed_btn}} {{qr_bar}} <div class="add-to-conv loadhide" data-action="thread-item-replyall" aria-label="{{str_comp_click_replyall}}" tabindex="0">  <div class="compose"> <div class = "composeshim"></div> <div class = "composebtnshim"></div> <table role="presentation" border="0" style="margin:0;width:100%;border-spacing:0; border-collapse:collapse;"> <tbody role="presentation"> <tr role="presentation"> <td role="presentation"> <div class="compose-header"> <div class="reply-text"> {{showAllReplyActions}} {{showAllReplyActions_else}} </div> </div> </td> </tr> <tr role="presentation"> <td role="presentation"> <div class="dummy-compose-msg"> </div> </td> </tr> <tr role="presentation"> <td role="presentation" style="padding-bottom:5"> <div tabindex="0" aria-label="{{str_aria_label_attachments}}" class="attachments-well {{page_compose_email_else}} {{browser_plus_attach_else}}"> <div class="attachments-welcome"> {{browser_plus_attach}} </div> <div class="attachments-header hidden"> <div class="error hidden"> <span>{{str_comp_attach_upload_error}}</span> <a role="button" href="#" class="dismiss">{{str_comp_attach_dismiss}}</a> </div> <div class="self-close-msg hidden"> <span></span> </div> <ul class="info hidden"> <li> <h3 id="total-attached"><span class="totalAttached">0</span> {{str_comp_attachments}}</h3> </li> <li> <a class="removeAll" role="button" href="#" aria-labelledby="total-attached" title="{{str_comp_attach_removeall}}">{{str_comp_attach_removeall}}</a> </li> </ul> </div> <ul role="list" aria-label="{{str_aria_label_image_attachments}}" aria-live="polite" class="thumbnails-attach"></ul> <ul role="list" aria-label="{{str_aria_label_file_attachments}}" aria-live="polite" class="file-attach hidden"> {{file_attach_files}} </ul> <div role="alert" class="error transfer-error hidden"> <span class="attachmenterror"> {{attachments_error}} </span> </div></div> </td> </tr> <tr role="presentation"> <td role="presentation" class="footer-separator"> <div class="bottomToolbar {{squeezeToolbar}}"> <span class="btn default" data-action="send" role="button"> <a tabindex="-1" href="#" title="{{str_comp_send_attr}}">{{str_comp_send}}</a> </span> <div class="rte-well-container" role="toolbar">{{show_attachment_icon}}{{show_formatter_well}}</div>{{ca_icon}} {{show_delete_draft_icon}} </div> </td> </tr> </tbody> </table> </div> </div> {{/qr_bar}} {{conv_loading}} </div>'}},"1.0.0");


YUI.add("mail-controller-conversations",function(e){function w(){v&&(v=null),v={gdmHit:0,gdmMiss:0,gdmAdd:0,gdmUsed:0,lmtHit:0,lmtMiss:0,lmtAdd:0,lmtUsed:0,batchHit:0,batchMiss:0}}function E(e,t,n){c.park(t,n)}function S(e,t,n,r){c.unpark(t,r)}function x(t,n,r){var i=n.method,s="passive";NeoGV.isYdod&&(e.common.Utils.settings.value("ydodActiveAPI",[]).indexOf(i)>-1&&(s="active"),e.fire("util:ymstats",{name:"ydodBlock",tags:{api:i,mode:s},include:{farm:!0}}),s==="active"&&r("failure"))}function T(t,n){n.cbk.stopwatch&&(n.cbk.stopwatch.getListBegin=new Date),e.Lang.isUndefined(t.nextprev)||delete t.nextprev}function N(t,n,r){n.cbk.stopwatch&&(n.cbk.stopwatch.getListEnd=new Date),e.fire("LFT:complete");var i=t.conversations.length,u=t.folder,a=[],f,c=0,h,p,d;if(u.total&&!i&&u.folderInfo.fid!=="%40B%40Bulk"){t.code="ResponseCountMismatch",r("failure");return}for(d=0;d<i;d++)f=t.conversations[d].conversation.messageInfo[0],p=f&&f.receivedDate,p&&p>c&&(c=p);h=Date.now();for(d=0;d<i;d++)f=o.toConvInfo(t.folder.folderInfo.fid,t.conversations[d]),f.snapshotTime=c,f.reqTime=h,a.push(f);t.convInfo=a,s.enabled("enableListReconciliation")&&(t.folder.totalConversations=C(a,t.folder.totalConversations)),o.removeFromMovingCache(),o.threadUpdate(a,n.origParms.fid),u&&!n.batch&&!n.origParms.nextprev&&!n.origParms.start&&l.Folders.set(u,null,n.reason)}function C(e,t){var n,r,i,s,u,a,l,c;for(n=0;n<e.length;n++){u=f(e[n].cid),a=e[n].fid,c=o.isConvLocked(u),i=o.isConvRemoved(e[n]),l=e[n].anchorDate;if(i){e.splice(n,1),n--,t--;continue}r=o.isCached(a,u),r&&(r.checksum!==e[n].checksum?o.compareConvSummaries(e[n],r)?o.updateChecksum(u,a,e[n].checksum):(o.areNewMsgsAdded(e[n],r)||(s=o.get(a,u),s&&(e[n]=s)),c||o.removeFromCache(u,a)):(s=o.get(a,u),s&&(e[n]=s))),e[n].anchorDate=l}return t}function k(e,t){o.set(e,t)}function L(){}function A(){}function O(e,t,n){if(e.errors&&e.errors.length!==0)return n("failure"),d._error(t.origParms,e.errors[0])}function M(){}function _(){}function D(e,t,n){if(e.errors&&e.errors.length!==0)return n("failure"),d._error(t.origParms,e.errors[0])}function P(){}function H(e,t,n){function i(e,t){return o.isCached(e,t)?o.get(e,t,!0):null}function s(e,t){return e.checksum&&e.checksum===t.checksum}var r;if((r=i(e.fid,e.cid))&&s(r,e)&&!e.force)return t.cbk&&(t.cbk.respProps={wasCached:!0}),n("success"),r;e.prime=e.cachekey||"Prime",t.cbk&&(t.cbk.respProps={wasCached:!1})}function B(t){var n=t.conv,r;!o.isCached(t.fid,n.conversation.cid)&&n.messageInfo&&e.Lang.isArray(n.messageInfo)&&n.messageInfo.length&&(n.conversation.summary.iDate=o.getAnchorDate(t.fid,n),r=Date.now(),k(n,r),Y(f(n.conversation.cid),!0))}function j(e){var t=e.msgObj;t&&t.mid&&Y(a(t.mid),!1)}function F(t,n,r){var i,s,u=n.origParms;if(t.code&&(t.code===5001||t.code==="EC-4001")&&t.message&&t.message.indexOf("no results returned from filters $..midscids[")>=0){r("failure");return}return t.messageInfo&&e.Lang.isArray(t.messageInfo)&&t.messageInfo.length?(u.cid&&u.cid!=="$(cid)"&&(t.conversation.cid=u.cid),s=t.conversation.cid,u.anchorDate&&(t.conversation.summary.iDate=u.anchorDate),i=Date.now(),k(t,i)):s=t.cid,n.resp&&n.resp.callPerf&&n.cbk&&(n.cbk.respProps=n.cbk.respProps||{},n.cbk.respProps.callPerf=n.resp.callPerf),o.get(u.fid,s,!0)}function I(t){if(t.code==="Client.InvalidConvId"||t.code==="Server.InvalidConvId")t.convPermDeleted=!0;t.fault&&t.fault.detail&&e.Lang.isArray(t.fault.detail)&&t.fault.detail[0].status===500&&e.use("mail-controller-folders",function(e){e.mail.Controller.Folders.triggerCheckMail(1e-4)})}function q(t,n,r,u){function O(){t.silentFetch||K(x,T,r),n&&n.success(L)}function M(e){return n&&n.taeUiCbk?n.taeUiCbk(e):!1}var c,p,d,v,m,g,y,w,E,S,x,T,N={},C=!s.enabled("migrateGetCIDs"),k={api:C?"map":h,methodName:C?"GetCids":h,batchId:C?"getcids":h,source:C?"getcids.midscids[0].cid":"getmessagev3.messages[0].oldSearchV2Cid",filterName:C?"getcid":"convIDFromV3GetMessage"},L,A=[];return c=l.batch(),t.cid||(S=o.midToConv(t.cfid,t.msg.mid),S?(t.cid=S.cid,t.checksum=S.checksum):A.push(c.Conversations[k.api]({chain:{id:k.batchId,api:k.methodName},fid:t.cfid,mids:[t.msg.mid]},function(e,t,r){r==="failure"&&n&&n.failure(e)}))),w={chain:{id:"listmessagesinthread",api:"ListMessagesInThread"},fid:t.cfid},t.cid?(w.cid=t.cid,w.checksum=t.checksum):(NeoConfig.hasConvV3&&(w.chain.filter=U(k.filterName),w.cid="$(cid)",C||(w.fid="$(fid)")),w.chain.parameter=[{source:k.source,destination:"listmessagesinthread.cid"}],w.chain.dependency=[k.batchId]),t.ovparams.force&&(w.force=t.ovparams.force),m=n&&n.openedFrom||"missing",A.push(c.Conversations.get(w,{success:function(s,u,a){var l,c,h,d,v,m,g=!0;a!=="aborted"&&a!=="failure"&&(!s||!s.cid||!s.msgs||!s.msgs[0])&&(g=!1,e.fire("MailLog",{m:"Invalid conversation response",condt:a,cid:s?s.cid:"",mid:s?e.Lang.isArray(s.msgs)?s.msgs[0].mid:"Invalid msg list":""}));if(a==="failure"||!g)n&&n.failure(s);else{u&&u.respProps&&(n.respProps=u.respProps,x=u.respProps.wasCached===!0),d=f(s.cid),t.silentFetch||(x||Y(d,!0),Z(d,!0)),L=s,h=L.msgs.length,x&&r&&(s.chainedLMTMsg=NeoConfig.hasConvV3?X(t.cfid,L,W(t.cfid,L)):L.msgs[0],s.chainedLMTId="listmessagesinthread");for(l=0;l<L.msgs.length;l++){L.msgs[l].header||(L.msgs[l]=i.Messages.toMessage(t.cfid,L.msgs[l]));if(b.isDraftFid(L.msgs[l].fid)&&t&&t.newMsg){v=t.oldMsgCnt||0;for(c=0;c<L.msgs.length;c++)if(L.msgs[c].mid===t.newMsg.mid){m=L.msgs[c];break}m&&m.inReplyTo===L.msgs[l].inReplyTo&&L.msgs.length-1>v&&(L.msgs.splice(l,1),L.midMap.splice(l,1))}}h!==L.msgs.length&&(L=o.calcConvSummary(L)),L.msgs=J(L.msgs),L.msgs.reverse(),L.midMap=$(L);if(!r){O();return}p&&(L.fullmsg=p,O())}},notify:n.notify,errorPosition:n.errorPosition||100,suppressNotification:n.suppressNotification,convOrigin:n.convOrigin||"regular",taeUiCbk:M,retryCodes:n.retryCodes,openedFrom:m})),r&&(t.fid==="%40C%40Chats"&&(N={displayPref:"text/json",urlDetection:!1,emailDetection:!1,annotateOption:{annotateText:"none"}}),E={chain:{id:"getdisplaymessage",api:"GetDisplayMessage"},fid:t.mfid
,snapshotTime:t.snapshotTime,ovparams:N,cachekey:"Prime"},t.msg?(E.msg=t.msg,E.mid=t.msg.mid):(NeoConfig.hasConvV3&&(E.chain.filter=z(t.cfid,u),E.fid="$(fid)"),E.chain.parameter=[{source:"listmessagesinthread.messageInfo[0].mid",destination:"getmessage.message[0].mid"}],E.chain.dependency=["listmessagesinthread"]),E.ofid=t.mfid||t.cfid||null,A.push(c.Messages.get(E,function(r,i,s){var o,u=!0;s!=="failure"&&s!=="aborted"&&(!r||!r.mid)&&(e.fire("MailLog",{m:"Invalid GDM response",condt:s}),u=!1),s==="failure"||!u?n&&n.failure(r):s==="success"&&(i&&i.respProps&&(n.respProps=i.respProps,T=i.respProps.wasCached===!0),o=a(r.mid),t.silentFetch||(T||Y(o,!1),Z(o,!1)),p=r,L&&(L.fullmsg=p,O()))}))),d=n&&n.errorPosition||100,v=n&&n.suppressCodes||[],y=n&&n.convOrigin,g=n&&n.retryCodes,c.setAsReadOp(!0),c.execute({errorPosition:d,suppressCodes:v,suppressNotification:n.suppressNotification,openedFrom:m,taeUiCbk:M,retryCodes:g,convOrigin:y}),A}function R(e,t,n,r,i){function h(e,t,n){n!=="failure"&&(Q(e,t,n),t&&t.respProps&&t.respProps.wasCached===!0&&(e.chainedLMTMsg=NeoConfig.hasConvV3?X(e.fid,e,W(e.fid,e)):e.msgs[0],e.chainedLMTId=l))}var s,u,a,f,l,c;if(c=o.get(n,r.cid,!1))u=NeoConfig.hasConvV3?X(n,c,W(n,c)):c.msgs[0];NeoConfig.hasConvV3?(l="LMT_"+t,u?s=u.sourceFolderInfo.fid:(l="LMT_"+t,s=b.isDraftFid(n)?n:"$(fid)",u=r.msgs[0],e.Conversations.get({chain:{id:l,api:"ListMessagesInThread"},fid:n,cid:r.cid,checksum:r.checksum,cachekey:i,anchorDate:r.anchorDate,prefetch:!0},{success:h,suppressCodes:["*"],backgroundLogs:["*"]}),a={id:"GDM_"+t,api:"GetDisplayMessage",filter:z(n,r),parameter:[{source:"listmessagesinthread.messageInfo[0].mid",destination:"getmessage.message[0].mid"}],dependency:[l]}),f={fid:s,msg:null,cachekey:i,prefetch:[u]},a&&(f.chain=a),e.Messages.get(f,{success:G,suppressCodes:["*"],backgroundLogs:["*"]})):(u||(e.Conversations.get({fid:n,cid:r.cid,checksum:r.checksum,cachekey:i,anchorDate:r.anchorDate,prefetch:!0},{success:h,suppressCodes:["*"],backgroundLogs:["*"]}),u=r.msgs[0]),e.Messages.get({fid:V(u),msg:null,cachekey:i,prefetch:[u]},{success:G,suppressCodes:["*"],backgroundLogs:["*"]}))}function U(e,t){var n;switch(e){case"latest":case"eu":case"folder":n={iterator:e==="latest"?"$..messageInfo[0]":e==="eu"?"$..messageInfo[?(@.flags.isRead==0)]":"$..messageInfo[?(@.sourceFolderInfo.fid=='"+t+"')]",select:{mid:"$..mid",fid:"$..sourceFolderInfo.fid"}},e==="eu"?n.range="[-1:]":e==="folder"&&(n.range="[0]");break;case"getcid":n={iterator:"$..midscids[0]",select:{cid:"$..cid"}};break;case"convIDFromV3GetMessage":n={select:{cid:"$..messages[0].oldSearchV2Cid",fid:"$..messages[0].folder.oldV2Fid"}}}return n}function z(e,t){return U(W(e,t),e)}function W(e,t){return b.isDraftFid(e)||b.isSentFid(e)?"folder":t.totalUnread>0&&t.totalMsgs>1?"eu":"latest"}function X(e,t,n){var r,i,s;for(r=0;r<t.msgs.length;r++){i=t.msgs[r];if(n==="latest")return i;if(n==="folder"&&t.msgs[r].sourceFolderInfo.fid===e)return i;i.flags.isRead===0&&(s=i)}return s||(s=t.msgs[0]),s}function V(e){return e.fid||(e.folderInfo&&e.folderInfo.fid?e.folderInfo.fid:e.sourceFolderInfo&&e.sourceFolderInfo.fid?e.sourceFolderInfo.fid:this.fid)}function $(e){var t=[],n,r;for(n=0;n<e.msgs.length;n++)r=e.msgs[n],t.push({mid:r.mid,fid:r.fid});return t}function J(e){var t,n=[],r=[],i,s;for(t=0;t<e.length;t++){if(b.isDraftFid(e[t].sourceFolderInfo.fid)){n.push(e[t]);continue}i=0,s=n.length;while(s>0&&i<s)e[t].mimeMsgId===n[i].inReplyTo?(n[i].oMsgMid=e[t].mid,r.push(n.splice(i,1)[0]),s--):i++;r.push(e[t])}i=0,s=n.length;while(s>0)r.push(n.splice(0,1)[0]),s--;return r}function K(e,t,n){v[e?"lmtHit":"lmtMiss"]++,n&&(v[t?"gdmHit":"gdmMiss"]++,v[e&&t?"batchHit":"batchMiss"]++)}function Q(e,t,n){var r;n!=="failure"&&(!t||!t.respProps||!t.respProps.wasCached)&&(r=f(e.cid),Y(r,!0))}function G(e,t,n){var r;n!=="failure"&&(!t||!t.respProps||!t.respProps.wasCached)&&(r=a(e.mid),Y(r,!1))}function Y(e,t){var n=t?g:y;n[e]&&tt(t),n[e]=0,v[t?"lmtAdd":"gdmAdd"]++}function Z(e,t){var n=t?g:y;n[e]|=1}function et(e){var t=0;for(var n in e)(e[n]&3)===1&&(e[n]|=2,t++);return t}function tt(e){var t=e?g:y;v[e?"lmtUsed":"gdmUsed"]+=et(t)}function nt(){d.hook("list",{pre:x},t.ydodCheck),d.hook("list",{pre:T,success:N,failure:L}),d.hook("get",{pre:x},t.ydodCheck),d.hook("get",{pre:H},t.cacheCheck),d.hook("get",{success:F,failure:I}),NeoConfig.hasConvPerf&&(d.hook("get",{pre:E},t.gdmDelay),d.hook("get",S,t.unpark)),d.hook("map",{pre:A,success:O,failure:P}),d.hook("getmessagev3",{pre:_,success:D,failure:M})}var t,n=e.mail,r=n.model.ConvStore,i=n.model.DataStore,s=e.common.Utils.features,o=r.Conversations,u=i.Messages,a=u.getPermMidPart,f=o.getPermCidPart,l=n.Controller,c=n.ParkQueue,h=n.net.Transport.v3MethodConstants.GET_MESSAGE_V3,p={passthru:{list:"ListFolderThreads",get:"ListMessagesInThread",map:"GetCids"}},d,v,m=43e3,g={},y={},b=e.mail.ui.FolderUtils;p.passthru[h]=h,p.batchable=p.passthru,p.entity="cids",d=l.extend("Conversations",p),d.bulkOps={remove:{bs:100,min:100,max:1e3},flag:{bs:100,min:100,max:1e3},move:{bs:100,min:100,max:1e3},spam:{bs:10,min:10,max:20,fixed:10}},t=p.order,e.mix(d,{getConv:q,batchAddConvPrefetch:R,preset:B,presetMsg:j,_reconcileListConvs:C}),nt(),w(),setInterval(function(){tt(!0),tt(!1),w()},m)},"1.0.0",{requires:["launch-utils","mail-controller-parkqueue","mail-controller-base","mail-controller-folders","common-persist-user-data","mail-net-transport","mail-model-convstore","mail-model-datastore","mail-ui-folder-utils","mail-common-utils-features","mail-common-utils-settings"]});


YUI.add("mail-model-convstore",function(e){function y(t){try{e.fire.apply(e,t)}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-model-convstore:1",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-model-convstore:1"),e.use("common-utils-error",function(){var e=t[1]&&h.isString(t[1])?t[1]:"";p.error.report("convstore error for "+t[0]+e,n,1,1,1)})}}function b(t){m.getBuilder||(m.getBuilder=e.mail&&e.mail.controller&&e.mail.controller.v3&&e.mail.controller.v3.converter&&e.mail.controller.v3.converter.getParticipantListBuilder),m._toV3MsgHdr||(m._toV3MsgHdr=function(e){var t=e&&(e.header&&e.header.from||e.from);return{headers:{from:[{email:t&&t.email,name:t&&t.name}]}}}),m._getMsgAtIndexFromConv||(m._getMsgAtIndexFromConv=function(e,n){return e&&e.midMap&&e.midMap[n]&&t.get(e.midMap[n].fid,e.midMap[n].mid)})}e.namespace("mail.model");var t="ds:conv:",n="ds:msg:",r="change",i="refresh",s="remove",o="reg",u="unreg",a="Trash",f="%40B%40Bulk",l="invalidarg",c=e.mail,h=e.Lang,p=e.common.Utils,d=1e4,v=c.model.ConvStore={},m={getBuilder:null,_toV3MsgHdr:null,_getMsgAtIndexFromConv:null},g=e.mail.ui.FolderUtils;e.mix(v,{Conversations:function(){function N(e,t){return C(e,t)}function C(e,t){return k(t)[z(e)]}function k(e){var t=e===a?e:"Norm";return v[t]=v[t]||{},v[t]}function L(e,t,n){var r,i,s,o,u,a,f;if(!(u=C(t,e)))return null;if(n&&u){a=S.olist;for(s=0;s<a.length;s++)if(a[s].cid===t){o=a.splice(s,1),a.push(o[0]);break}}f=p.wcopy(u);if(f.sparse)return f;f.msgs=[],G();for(s=0;s<f.midMap.length;s++){r=T.get(f.midMap[s].fid,f.midMap[s].mid);if(!r)return null;i=r.header?T.toMessageInfo(f.midMap[s].fid,r):r,f.msgs.push(i)}return f}function A(e,t,n){var r={messageInfo:e.messageInfo,folder:{folderInfo:{fid:t}},conversation:{cid:e.cid,summary:e.summary}};M(r,n)}function O(e){var t;t=z(e.cid),k(e.fid)[t]=e,w[t]={fid:e.fid}}function M(e,n){function x(e,t){var n=0,r,i,s,o,u;u=e.fid,o=S.olist,s=N()+t;while(n<o.length&&s>S.maxmsgs)E[z(o[n].cid)]?n++:(r=o.splice(n,1),r[0].cid!==e.cid&&(i=R(r[0].cid,r[0].fid,!0),i&&(s-=i.midMap.length)));o.push({fid:e.fid,cid:e.cid})}function N(){var e,t,n=0;for(t in v)for(e in v[t])v[t][e].sparse||(n+=v[t][e].midMap.length);return n}function C(e,t){var n,r,i=e.messageInfo,s=e.folder.folderInfo.fid,o=U(s,e.conversation,i[0]);o.reqTime=t,o.midMap=[],x(o,i.length);for(r=0;r<i.length;r++)n=i[r],o.midMap.push({mid:n.mid,fid:q(n,s)}),_(n,o);return O(o),$(o),o}var r=h.isArray(e),s=r?e:[e],o=e.fireEvent===!1?!1:!0,u=[],a,f,l,c,d,m,g,b,w;G();for(l=0;l<s.length;l++){c=s[l],a=B(c.folder.folderInfo.fid,c.conversation.cid);if(a)for(d=0;d<a.midMap.length;d++){m=a.midMap[d],w=T.get(m.fid,m.mid);if(w){for(g=0;g<c.messageInfo.length;g++){b=c.messageInfo[g];if(b.mid===m.mid)break}(g>=c.messageInfo.length||q(b,c.folder.folderInfo.fid)!==m.fid)&&T.removeConvMsg(m.fid,m.mid,!1)}}f=C(s[l],n),u.push(p.wcopy(f))}u.length&&o&&y([t+i,"lmt",null,u])}function _(e,t){F(e,t.cid),I(e,q(e,t.fid)),T.syncConvHeader(q(e,t.fid),e)}function D(e,t){var n=t.conversation,r=n.recentMsg?n.recentMsg:n.messageInfo[0],i=U(e,n,r);return F(r,i.cid),i.msgs=[p.wcopyWrapper(r)],i}function P(e,t){var n,r,i,s,o=p.wcopy(t);o.msgs=[],o.anchorDate=null,G();for(n=0;n<t.midMap.length;n++){s=t.midMap[n].fid===e,r=T.get(t.midMap[n].fid,t.midMap[n].mid);if(!r)break;i=r.header?T.toMessageInfo(t.midMap[n].fid,r):p.wcopy(r),i.fid||(i.fid=t.midMap[n].fid),o.msgs.push(i);if(s&&!o.anchorDate||g.isDraftFid(e))o.anchorDate=i.receivedDate}return o.midMap=null,o}function H(e,t){var n;for(n=0;n<t.messageInfo.length;n++)if(t.messageInfo[n].sourceFolderInfo.fid===e)return t.messageInfo[n].receivedDate;return null}function B(n,r){var i=h.isString(r)||!r?r:r.cid,s,o,u;(!n||!i)&&e.error(t+"get:"+l),G(),s=C(i,n);if(s&&!s.sparse){for(o=0;o<s.midMap.length;o++){u=T.get(s.midMap[o].fid,s.midMap[o].mid);if(!u)return!1}return s}return!1}function j(e,t){var n,r,i;G();if((r=T.get(e,t))&&r.cid&&(i=B(e,r.cid)))for(n=0;n<i.midMap.length;n++)if(T.getPermMidPart(i.midMap[n].mid)===T.getPermMidPart(r.mid))return i;return null}function F(e,t){e.cid=t}function I(e,t){e.fid=t}function q(e,t){return e.fid||(e.folderInfo&&e.folderInfo.fid?e.folderInfo.fid:e.sourceFolderInfo&&e.sourceFolderInfo.fid?e.sourceFolderInfo.fid:t)}function R(e,t,n){var r,i=C(e,t);if(i){if(!i.sparse)for(r=0;r<i.midMap.length;r++)T.removeConvMsg(i.midMap[r].fid,i.midMap[r].mid,n);delete k(t)[z(e)]}return i}function U(t,n,r){var i={cid:n.cid||"",fid:t,snapshotTime:r.receivedDate,checksum:n.summary.checksum,totalMsgs:n.summary.totalMsgs,totalUnread:n.summary.unreadMsgs,totalFlagged:n.summary.flaggedMsgs,totalDraft:n.summary.hasDraft?1:0,totalHasAttach:n.summary.hasAttachment?1:0,subject:n.summary.totalMsgs>1?n.summary.subject:r.subject,subjectDir:n.summary.totalMsgs>1?n.summary.subjectDir:r.subjectDir,anchorDate:n.summary.iDate,recipients:n.summary.participantList,msgCountsByFolder:n.summary.msgCountsByFolder,flags:r.flags?e.clone(r.flags):{},recentmid:r.mid,snippet:r.snippet,receivedDate:r.receivedDate,classification:r.classification};return i}function z(e){var t;return h.isString(e)?(t=e.lastIndexOf("_"),t++):t=-1,t<0?e:e.substr(t)}function W(e,t){return e===a?t===a:t!==a}function X(e,t){return e&&t&&z(e.cid)===z(t.cid)&&W(e.fid,t.fid)}function V(e,t){return!e||!t||g.isDraftFid(t)?!1:NeoConfig.hasConvV3?!0:e.totalMsgs===1?!0:t==="Sent"?!1:e.totalUnread===0&&e.msgs&&(e.msgs[0].fid&&!g.isDraftFid(e.msgs[0].fid)||e.msgs[0].sourceFolderInfo&&!g.isDraftFid(e.msgs[0].sourceFolderInfo.fid))?!0:!1}function $(t){function f(n,r,i,s){var o,f;o=T.get(i,s),a&&a.nextMsg(u._toV3MsgHdr(o));if(!o){e.common.Utils.log({m:"msgInfo is undefined",cid:t.cid,msgfid:i,msgmid:s},!0,"UndefinedObject");return}f=o.flags,ut(n.msgCountsByFolder,f.isRead,i),n.totalUnread+=f.isRead?0:1,n.totalFlagged+=f.isFlagged?f.isFlagged:0,n.totalDraft+=g.isDraftFid(q(o,r))?1:0,n.totalHasAttach+=f.hasAttachment?f.hasAttachment:0}var n,r,i,s,o,u=m,a=null;b(T),t
.totalMsgs=t.midMap.length,t.recentmid=t.totalMsgs?t.midMap[0].mid:"",i={totalUnread:0,totalFlagged:0,totalDraft:0,totalHasAttach:0,msgCountsByFolder:[]},u.getBuilder&&(s=u._toV3MsgHdr(u._getMsgAtIndexFromConv(t,0)),o=u._toV3MsgHdr(u._getMsgAtIndexFromConv(t,t.totalMsgs-1)),a=u.getBuilder(s,o));for(n=0;n<t.totalMsgs;n++)f(i,t.fid,t.midMap[n].fid,t.midMap[n].mid);a&&(i.recipients=a.getParticipants()),y(["ConvStore:calcConvSummary",t,i]);for(r in i)t[r]=i[r];return t}function J(e,t,n,r,i,s,o,u){var a,f,l;G();for(var c in t)c&&(a=C(c,n))?(f=p.wcopy(a),u&&u.func&&(l=u.func(f,u.args)),$(f),k(n)[z(c)]=f):f=a={cid:c,sparse:!0,moved:!0},i.push(p.wcopy(f)),r.push(a),s.push(p.diff(f,a)),o&&o.push(l)}function K(e,n,i,s){function g(t,n){var r,i,s,f,l;for(i=0;i<n.data.length;i++){f=n.data[i],l=q(f,t.fid);for(r=t.midMap.length-1;r>=0;r--){s=T.get(t.midMap[r].fid,t.midMap[r].mid);if(s){u=s.receivedDate||s.header&&s.header.receivedDate;if(u>=f.receivedDate)break}}o=T.get(l,f.mid),t.midMap.splice(r+1,0,{mid:f.mid,fid:l}),o?T.syncConvInfo(l,{mid:f.mid,cid:e,newmsg:f}):_(f,t)}return a}var o,u,a=h.isArray(i)?i:[i],f=n?"Trash":"Inbox",l=[],c=[],p=[],d=[],v={},m="msg:add";G(),v[e]=1,J(m,v,f,c,l,p,d,{func:g,args:{data:a}}),s&&(s.cachedMsg=o),y([t+r,m,c,l,p,d,s])}function Q(){v={},w={},E={},S={olist:[],maxmsgs:d,sync:{}},T=null}function G(){T||(T=c.model.DataStore.Messages,T.setConvStore(c.model.ConvStore.Conversations))}function Z(e,n,i,s,o,u,l){var c,h=i?i.length:0,p,d={},v=u||"",m=[],g=[],b=[],w={},E="msg:"+o;w.fid=e,w.srcFid=v,w.mids=[];if(o.indexOf("conv_")===0)return;for(c=0;c<h;c++)o==="move"&&v!==a&&v!==f&&e!==a&&e!==f&&R(i[c].cid,i[c].fid,!1),i[c].cid&&(p=i[c].cid,d[p]||(d[p]=1),w.mids[c]=i[c].mid);w=e===v?{}:w,J(E,d,e,g,m,b),l&&l.fromSearch&&(w.fromSearch=l.fromSearch),l&&l.fromConv&&(w.fromConv=l.fromConv),y([t+r,E,g,m,b,w])}function et(e,n,i,s,o){function b(e,t){var n,r;for(n=0;n<t.data.length;n++)for(r=0;r<e.midMap.length;r++)if(e.midMap[r].mid===t.data[n].mid){e.midMap.splice(r,1);break}}var u,l,c="msg:remove",p=h.isArray(n)?n:[n],d={},v=[],m=[],g=[];if(!i&&s&&s!==a&&s!==f&&e!==a&&e!==f)return;G();for(u=0;u<p.length;u++)l=p[u].cid,d[l]||(d[l]=1);J(c,d,e,m,v,g,null,{func:b,args:{data:p}}),y([t+r,c,m,v,g,o])}function tt(e){var t=z(e);E[t]||(E[t]=0),E[t]++}function nt(t){var n=z(t);e.Lang.isUndefined(E[n])||(E[n]--,E[n]<=0&&delete E[n])}function rt(n,r){var s,o,u;for(s=0;s<n.length;s++)o=z(n[s].cid),!e.Lang.isUndefined(E[o])&&E[o]>0&&(u=u||{},u[o]=n[s]);u&&y([t+i,"lft",r,u])}function it(e,t){var n=0;if(e.msgs){for(n=0;n<e.msgs.length;n++)if(e.msgs[n].flags.isRead!==t.isRead)return!1;return!0}return e.flags?e.flags.isRead===t.isRead:!1}function st(n,i,s,o){var u,a,f,l,c=s.flags,d,v,m,g=[],b=[],w=[],E=c.isRead!==undefined;h.isArray(i)||(i=[i]),G();for(d=0;d<i.length;d++){u=i[d];if(u.cid&&(a=B(n,u.cid))){for(v=0;v<a.midMap.length;v++)T.update(a.midMap[v].fid,{mid:a.midMap[v].mid},s,o);m={},m[u.cid]=1,J(o,m,n,g,w,b)}else{if(E&&it(u,c))continue;a=u,f=p.wcopy(u),f.msgCountsByFolder&&(f.msgCountsByFolder[0].fid=f.msgCountsByFolder[0].fid==="Bulk%20Mail"&&f.flags&&f.flags.isSpam?"%40B%40Bulk":f.msgCountsByFolder[0].fid),e.Lang.isUndefined(c.isFlagged)||(f.totalFlagged=c.isFlagged?f.totalMsgs:0),e.Lang.isUndefined(c.isRead)||(f.totalUnread=c.isRead?0:f.totalMsgs,ot(f.msgCountsByFolder,c.isRead)),f.sparse=1,l={},T.applyDiff(l,u.msgs[0],s),f.msgs=[l],O(f),w.push(p.wcopy(f)),g.push(a),b.push(p.diff(f,a))}}g.length&&y([t+r,o,g,w,b,undefined,s])}function ot(e,t){var n;if(e)for(n=0;n<e.length;n++)t?e[n].unread=0:e[n].unread=e[n].total}function ut(e,t,n){var r,i=-1;for(r=0;r<e.length;r++)e[r].fid===n&&(i=r);i===-1&&(i=e.length,e.push({fid:n,total:0,unread:0})),e[i].total+=1,e[i].unread+=t?0:1}function at(e,n,i,s,o){var u,a,l,c,h,d=[],v=[],m=[],b=0;while(u=i[b++])a=p.wcopy(x[u]||{cid:u,fid:e}),x[u]&&(x[u]={receivedDate:x[u].receivedDate,fid:x[u].fid,movedAt:x[u].movedAt}),a.msgs&&(a.msgs.splice(1,a.msgs.length-1),c=q(a.msgs[0],e)),l=p.wcopy(a),l.fid=n,l.sparse=1,l.msgs&&(h=!g.isDraftFid(c)&&!g.isSentFid(c)?n:c,l.msgs[0].folderInfo={fid:h,name:h},l.msgs[0].sourceFolderInfo={fid:h,name:h}),n!==f&&R(u,n,!1),d.push(a),v.push(l),m.push(p.diff(l,a));d.length&&y([t+r,o,d,v,m])}function ft(n,r,i){var o,u,a,f,c,d=[],v=S.olist,m=Date.now(),g=!i;h.isArray(r)||(r=[r]),G(),n||e.error(t+"remove:"+l);for(o=0;o<r.length;o++){a=r[o];if(!a||!a.cid)continue;f=R(a.cid,n,!1);for(u=0;u<v.length;u++)if(v[u].cid===a.cid){v.splice(u,1);break}a&&!a.fid&&(a.fid=n),c=p.wcopy(a),x[a.cid]=c,x[a.cid].fid=n,x[a.cid].movedAt=m,d.push(c)}y([t+s,n,d.length&&d,g,i])}function lt(e){if(!e){x={};return}e=h.isArray(e)?e:[];for(var t=0;t<e.length;t++)delete x[e[t].cid]}function ct(e,t){return e.receivedDate>t.receivedDate}function ht(e,t){return e.totalUnread===t.totalUnread&&e.totalMsgs===t.totalMsgs&&e.totalFlagged===t.totalFlagged&&e.totalDraft===t.totalDraft&&e.receivedDate===t.receivedDate&&p.congruent(e.msgCountsByFolder,t.msgCountsByFolder)?!0:!1}function pt(t){return!e.Lang.isUndefined(E[t])&&E[t]>0}function dt(e){var t=x[e.cid];return t&&t.fid===e.fid&&t.receivedDate===e.receivedDate?t:null}function vt(e,t,n){var r=k(t)[e];return r?(r.checksum=n,!0):!1}var v={},w={},E={},S={olist:[],maxmsgs:d,sync:{}},x={},T=null;return e.on(n+r,Z),e.on(n+s,et),e.on(t+o,tt),e.on(t+u,nt),{set:M,get:L,getCache:k,setPrefetch:A,getPermCidPart:z,areSameConvs:X,canConvOverlapInFids:W,toConvInfo:D,toConvInfoEvent:P,getAnchorDate:H,isConvLocked:pt,isConvRemoved:dt,updateChecksum:vt,compareConvSummaries:ht,areNewMsgsAdded:ct,removeFromCache:R,removeFromMovingCache:lt,canBatchLMTGDM:V,threadUpdate:rt,msgAdd:K,update:st,move:at,remove:ft,calcConvSummary:$,getParam:function(e){return w[z(e)]},isCached:B,midToConv:j,hit:N,cacheSize:function(e){!isNaN(e)&&e>0&&(S.maxmsgs=e)},olist:function(){return S.olist},flush:Q,_msgCntConv:ot,_msgCntMsg:ut,_isFlagMatch:it}}()})},"1.0.0",{requires:["common-utils","mail-ui-folder-utils","mail-common-utils-features"]});


YUI.add("mail-model-liststore",function(e){e.namespace("mail.model");var t=2*NeoConfig.pageSize,n=9,r=e.mail.ui.FolderUtils,i=[r.isInboxFid,r.isDraftFid,r.isSentFid,r.isArchiveFid,r.isUserFid],s=e.mail.model.ListStore={};e.mix(s,{ListCache:function(){function u(e){var t=o.indexOf(e);t!==-1&&o.splice(t,1)}function a(e){o.indexOf(e)===-1&&o.push(e)}function f(){return o}function l(e){var t=i.length,n;for(n=0;n<t;n++)if(i[n](e))return!0;return!1}function c(e,t){h(e,t)}function h(i,o){var a;if(!l(i)||!o.length){d(i);return}if(e.Object.keys(s).length>=n)for(a in s)if(r.isUserFid(a)){d(a);break}s[i]=JSON.parse(JSON.stringify(o.slice(0,Math.min(o.length,t)))),u(i)}function p(t){return v(t)&&m(t)?(setTimeout(function(){e.fire("stat:feature_invoke",{message:"UI_LFT_CACHE_SUCCESS",feature_group:"LIST"})},0),JSON.parse(JSON.stringify(s[t]||[]))):[]}function d(e){if(e){s[e]&&delete s[e];return}s={},o.length=0}function v(e){return!!s[e]}function m(e){return s[e]?s[e].length:0}var s={},o=[];return e.on("ds:folder:change",function(t,n,i){var o,u,f;if(e.Object.keys(s).length&&i)for(f in i)i[f]&&(e.Lang.isNumber(i[f].unread)||e.Lang.isNumber(i[f].total))&&(o=n[f],u=o&&o.folderInfo&&o.folderInfo.fid,r.isSentFid(u)||r.isDraftFid(u)?d(u):a(u))}),{set:c,get:p,unmarkDirty:u,getDirtyFids:f,invalidate:d,isCached:v,cacheLength:m,isEnabledForFid:l}}()})},"1.0.0",{requires:["common-utils","mail-ui-folder-utils"]});


YUI.add("mail-ui-mailpane-base",function(e){e.namespace("mail.ui");var t=e.common.Utils,n=t.substitute,r=e.ui?e.ui.Templates:{},i=e.mail,s=i.ui,o=e.Lang,u=t.settings.value("previewLoadDelay",250),a=i&&i.Controller?i.Controller.Messages:{},f="ERROR: MessagePaneRead ",l=0,c=NeoConfig.isRTL,h=function(t){var n=this;h.superclass.constructor.call(n,t),n.NAME="MessagePane",n.numSelected=0,n.hasStarted=!1,n.loading_slow=n.loading_error=n.loading_moved=n.tmPendingLoad=n.tbarMod=n.tbarCallBack=n.tbarScope=n.tmFireRead=n.slowLoad=n.loadingTimer=n.widthUpdateTimer=n.neighbors=n.message=n.outboundReq=n.request=null,n.isLoaded=n.nextPrevCounter=n.stepTimer=n.isStepping=n.scrollWidth=n.scrollWidthIncr=n.scrollWidthKill=n.fid=0,n.fullView=t.fullView,n.parentNode=t.parentNode||null,n.type="message",n.guid=e.guid(),n.sortedColumn=t.sortedColumn||null,n.extras=t.extras||null,n.searchQuery=t.searchQuery||null,n.arrMessageSequence=t.arrMessageSequence||null,n.arrMessageSequenceStartIndex=t.arrMessageSequenceStartIndex,n.inspectedMids=[],n.stopwatch=null,n.showMailBoxIcon=n.fullView?!1:!0,n.oTemplate=null,n.statOp=null,n.stopwatchPreview="PaneInPreview",n.threadContainer,n.formatters={page_show_comm_modes:function(){return!n.numSelected&&!n.get("close")?n.sub({s:n.oTemplate.page_show_comm_modes}):""},page_show_comm_modes_else:function(){return n.numSelected&&!n.get("close")?n.sub({s:n.oTemplate.page_show_comm_modes_else}):""},global_spearmint_view_else:function(){var e=n.oTemplate.global_spearmint_view_else;return n.get("close")?"":n.sub({s:e})},horzPane:function(){return n.sub({s:n.oTemplate.horzPane})},vertPane:function(){return n.sub({s:n.oTemplate.vertPane,o:{msgLink:"http://help.yahoo.com/kb/index?page=content&y=PROD_MAIL_ML&locale=en_ZZ&id=SLN15123&actp=productlink"}})},page_message_pane_view:function(){return t.fullView?"":n.oTemplate.page_message_pane_view},page_message_pane_view1:function(){return t.fullView?"":n.oTemplate.page_message_pane_view1},page_message_pane_view2:function(){return t.fullView?"":n.oTemplate.page_message_pane_view2},page_message_full_view:function(){return t.fullView?n.oTemplate.page_message_full_view:""},message_selection:function(){return n.numSelected>0&&!n.message?n.oTemplate.message_selection:""},is_fresh:function(){return n.sub({s:n.oTemplate.is_fresh})},is_fresh_else:function(){return""}},n.on("closeChange",function(e){var t;if(e.newVal){n.message&&n.fire("MessagePane:unload"),n.detach();if(!n.get("reuse"))try{n.parentNode&&(t=n.parentNode.one("div.tripane .content")||n.parentNode.one("div.message.content"),n.set("parentNode",null),n.parentNode=null),t&&t.destroy()}catch(r){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailpane-base-mailpane:1",r,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailpane-base-mailpane:1")}}else n.attach()}),!n.get("close")&&n.attach(),n.addAttrs({fid:{setter:function(e){n.fid=e}},message:{setter:function(e){n.message&&n.fire("MessagePane:unload"),n.setMessage(e)},getter:function(){return n.getMessage()}},visible:{setter:function(e){var t=n.get("rootNode");t&&t.setStyle("display",e?"block":"none")},value:typeof t.visible=="undefined"?1:t.visible,lazyAdd:!0},vertical:{setter:function(t){var r=n.get("rootNode"),i=e.common.persist.getCookie(),s,o={},u=c?"right":"left",a;t?(s=i.get("pos.h2slider"),s=s&&s.charAt(0)==="a"?s.substr(1):s,s&&parseInt(s,10)<NeoConfig.minMessagelistWidth&&(s=NeoConfig.minMessagelistWidth),o.top="0px",o[u]=s||(NeoConfig.vertPane?330:630)):(a=parseInt(i.get("pos.vslider"),10),a&&parseInt(a,10)<NeoConfig.minBottomPreviewHeight&&(a=NeoConfig.minBottomPreviewHeight),o.top=a||NeoConfig.minBottomPreviewHeight,o[u]="0px"),r&&r.setStyles(o)},value:t.vertical,lazyAdd:!0},transferFocus:{},scrollWidth:{value:null},scrollWidthActive:{value:!0}}),n.neoEvent("rendered",{emitFacade:!0,broadcast:1})};e.extend(h,s.BaseWidget,{scrollWidthReset:function(){var e=this;e.scrollWidthKill||(e.scrollWidth=e.scrollWidthIncr=0,e.set("scrollWidth",null))},scrollWidthUpdate:function(){},scrollWidthNotify:function(){var e=this,t=e.parentNode.one(".msg-body");t&&(l===0&&(l=parseInt(t.getStyle("marginRight"),10)+parseInt(t.getStyle("marginLeft"),10)),e.scrollWidthUpdate({scrollWidth:t.get("scrollWidth")+l}))},scrollWidthStartTimer:function(){},resetScrollPosition:function(){var e=this,t,n;e.resetScroll&&(t=this.get("parentNode"),n=t?t.one("div.tripane .content")||t.one("div.message.content"):0,n&&(n.set("scrollTop",0),e.resetScroll=0))},bindUI:function(){var n=this,r=n.getStopwatch();r&&r.start(2,"BindUI");var i=n.getRoot();e.UA.webkit&&i&&i.get("id")!=="msg-preview"&&(i.setStyle("-webkit-user-select","none"),e.later(1e3,null,function(){var e=n.getRoot();e&&e.setStyle("-webkit-user-select","")},0,!1)),n.message?(r&&r.start(2,"PreLoadExtra1"),n.loadExtra(function(){try{r&&r.start(2,"LoadExtraCB1"),n.bindPaneContent()}catch(e){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailpane-base-mailpane:2",e,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailpane-base-mailpane:2")}})):i&&!n.rootBound&&(r&&r.start(2,"DelegateClick"),i.delegate("click",function(r){var i=t.getDataAction(r).action;switch(i){case"compose":e.fire("mt:click",{action:"compose_new_nav_toolbar",spid:"compose_new"}),e.fire("newMessage");break;case"new-conv":break;case"loadContent":break;case"switchpane":n.parentCW.switchView(NeoConfig.horzPane?"scroll-view-prev-beside":"scroll-view-prev")}r.preventDefault()},".media-modes span"),i.on("scroll",function(){n.resetScroll=1}),n.rootBound=1),i=null},renderComplete:function(){var e=this,t=e.getStopwatch();t&&t.start(1,"postRender"),e.fireEvent("complete");try{e.fire("renderComplete")}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailpane-base-mailpane:3",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailpane-base-mailpane:3"
)}e.scrollWidthStartTimer(),e.hasStarted=!1,e.setRenderFocus(),e.postRender()},insertPreviewContentNode:function(i){var s=this,o=s.message,u,a,f=e.mail.Tabs,l=f.getActiveTab(),c=l&&l.widget&&l.widget.fid;c||(c=e.one("div.listnav-outter .sysfolder.selected")&&e.one("div.listnav-outter .sysfolder.selected").getAttribute("data-fid")),a=s.numSelected?s.oTemplate.page_show_comm_modes_else:s.oTemplate.page_show_comm_modes,u=n(a,o,s.formatters,null,strings,r),o===null&&s.numSelected===0&&NeoConfig.onboarding&&NeoConfig.onboarding.taskPanelEnabled&&t.features.enabled("keyTasksPanel")&&c&&e.mail.ui.FolderUtils.isInboxFid(c)&&NeoConfig.previewPanePref?(e.mail.ui.Workspace.renderKeyTasksPanel(c,i,{insertPreview:function(){i.setContent(u),s.insertBody(i),i.one(".css-env").hide()}}),!NeoConfig.hasConv&&!i.one(".key-task-panel").hasAttribute("data-view")&&i.one(".key-task-panel").setAttribute("data-view","nonconv")):(i.setContent(u),s.insertBody(i))},updatePreviewContent:function(){var e=this,t=e.getMessageContentNode();t&&e.insertPreviewContentNode(t)},previewContentUpdater:function(){var e=this;return{now:function(){e.updatePreviewContent()},later:function(){e.previewContentUpdateTimer=setTimeout(function(){e.updatePreviewContent()},2*u)},cancel:function(){clearTimeout(e.previewContentUpdateTimer)}}},getMessageContentNode:function(){var e=this,t=e.get("parentNode"),n=t&&(t.one("div.tripane .content")||t.one("div.message.content"));return n},appendMarkup:function(){try{var n=this,r=n.get("parentNode"),i,s=n.previewContentUpdater(),o;if(!r)return;s.cancel(),i=n.getMessageContentNode(),i?(n.numSelected||n.showMailBoxIcon?(s.now(),n.showMailBoxIcon=!1):n.numSelected===0&&s.later(),n.scrollTop&&(o=n.get("rootNode"))&&setTimeout(function(){var e=o.one(n.scrollNodeSelector);e.set("scrollTop",n.scrollTop)},200)):(r.append(n.getMarkup()),i=r.one("div.tripane .content")||r.one("div.message.content"),n.insertBody(i)),n.get("rootNode")||(n.set("rootNode",i.get("parentNode")),n.setRootNodeTabIndex())}catch(u){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailpane-base-mailpane:4",u,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailpane-base-mailpane:4"),e.use("common-utils-error",function(){t.error.report(f+"appendMarkupError",u,1,1,1)})}},getRoot:function(){var e=this,t=e.parentNode;return t&&(t.one(".messagepane")||t.one(".threadpane"))},sub:function(e){var t=e.s||"",r=e.o||0,i=e.f||this.formatters,s=e.a||0,o=e.strs||strings;return n(t,r,i,s,o)},onKeyDown:function(t){var n=this;if(t.keyCode===38||t.keyCode===40){var r=t.currentTarget.one(".base-card");r.set("tabIndex","0"),r.focus();return}if(t.keyCode!==65)t.stopPropagation();else{var i=n.parentNode.one("div.tripane .content")||n.parentNode.one("div.message.content"),s=e.Node.getDOMNode(i),o;window.getSelection?(o=window.getSelection(),o.selectAllChildren(s)):(o=document.body.createTextRange(),o.moveToElementText(s),o.select()),t.halt()}!n.threadContainer&&(t.keyCode===33||t.keyCode===34||t.keyCode===35||t.keyCode===36)&&(n.threadContainer=n.listNode&&n.listNode.getDOMNode());switch(t.keyCode){case 33:n.threadContainer&&(n.threadContainer.scrollTop=n.threadContainer.scrollTop-n.threadContainer.clientHeight);break;case 34:n.threadContainer&&(n.threadContainer.scrollTop=n.threadContainer.scrollTop+n.threadContainer.clientHeight);break;case 35:n.threadContainer&&(n.threadContainer.scrollTop=n.threadContainer.scrollHeight);break;case 36:n.threadContainer&&(n.threadContainer.scrollTop=0)}},setToolbar:function(e,t,n){var r=this;r.tbarMod=e,r.tbarCallBack=t,r.tbarScope=n},onFocus:function(){return this.fullView&&!this.message},getMarkup:function(){var e=this,t=n(e.oTemplate.base,e.message,e.formatters,null,strings,r);return t},getStopwatch:function(){var e=this;return t.Stopwatch.get(e.stopwatchPreview)||e.stopwatch},setDocRole:function(){this.get("rootNode").set("role","document")},setRootNodeTabIndex:function(){},abortRequests:function(e){var t=this,n=t.request,r;if(n){n=o.isArray(n)?n:[n];for(r=0;r<n.length;r++)n[r].abort();e&&t.statReadSuccess(NeoConfig.hasConvView?"CONV":"MESSAGE","ABORT")}t.request=null},retryPrefix:function(e){var t=e>=0?e:this.isRetrying;return t?t===20?"retrySL_":"retry_":""},requestMessage:function(t,n,r,i){var s=this,o=t?t.mid||0:0,u,f=r.ovparams||{},l=i||s.getStopwatch();return o&&(n.args={fid:s.fid,primeMsg:t,stopwatch:l},s.isChat(t)&&(f.displayPref="text/json",f.urlDetection=!1,f.emailDetection=!1,f.annotateOption={annotateText:"none"},r.ovparams=f),s.fireEvent("get"),l&&(l.start(1,"YCMSGGetBegin"),l.YCMSGGetBegin||(l.YCMSGGetBegin=new Date)),NeoConfig.noCache&&(f.dontCache=!0,r.dontCache=!0),NeoConfig.yodaReadEnabled?(n.notify&&n.notify("async"),NeoConfig.loadYodaController.then(function(){u=e.mail.controller.v3.api.getSimpleBodyofMessages({messageList:[t],sourceFid:r.fid,filter:f,success:function(e,t,r){r||n.success(e[0])}})})):u=a.get(r,n)),u},statReadSuccess:function(t,n,r){n=n?"_"+n:"",r&&e.fire("stat:feature_latency",{message:"UI_READ_"+t+n+"_COMPLETE",feature_group:"READ",value:Date.now()-r}),e.fire("stat:feature_complete",{message:"UI_READ_"+t+n+"_COMPLETE_SUCCESS",feature_group:"READ"})},statReadStart:function(t,n){n=n?"_"+n:"",e.fire("stat:feature_invoke",{message:"UI_READ_"+t+n+"_START_SUCCESS",feature_group:"READ"})},setupReadSuccessStatsInPane:function(e){var t=Date.now(),n=NeoConfig.hasConvView?"CONV":"MESSAGE",r=this;r.statReadStart(n,e),r.renderCompleteOnUpdateHandler&&r.renderCompleteOnUpdateHandler.detach(),r.renderCompleteOnUpdateHandler=r.once("read-stat:renderCompleteOnUpdate",function(){r.statReadSuccess(n,e,t)})},inspectMessageForBadContent:function(t,n){var r,i,s,o="",u,a;try{u=n&&n.mid;if(!t||this.inspectedMids[u])return;r=t.one("iframe"),i=t.one("frameset"),s=t.one("script"),this.inspectedMids[u]=!0;if(r||i||s)o+=(r?"1":"0")+(i?"1":"0")+(s?"1":"0"),a=t.getContent()||"",e.fire("MailLog",{m:"tmp_bad_message",yid:NeoConfig.loginId
,host:NeoConfig.hostName,browser:NeoConfig.browser,mid:u,type:o,conv:NeoConfig.hasConvView,msg:typeof btoa=="function"&&btoa(encodeURIComponent(escape(a)))||a},!0,"tmp_bad_message"),e.fire("util:ymstats",{name:"tmp_bad_message",tags:{agent:NeoConfig.browser,conv:NeoConfig.hasConvView,type:o},include:{farm:!0}})}catch(f){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailpane-base-mailpane:5",f,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailpane-base-mailpane:5")}},logLinkClicks:function(t){var n=this,r=t.target,i=r.getAttribute("href"),s=r.getContent(),o=NeoConfig.hasConvView?r.ancestor(".thread-item"):null,u=NeoConfig.hasConvView?"thrd_msg_lnk_clk":"msg_lnk_clk",a,f,l,c,h,p;NeoConfig.hasConvView?o&&(h=n.getMsgFromNode(o),h&&(a=n.getMsgFid(h),f=h.header,p=h.mid,f&&f.from&&f.from.email&&(l=f.from.email),f&&f.subject&&(c=f.subject))):(a=n.message.fid,f=n.message.header,p=n.message.mid,f&&f.from&&f.from.email&&(l=f.from.email),f&&f.subject&&(c=f.subject)),i&&e.fire("mt:click",{action:u,append:{mHref:i,mSndr:l,mSubj:c,mFldr:a,mCntnt:s,msgID:p}})},insertBody:function(){},attach:function(){},detach:function(){},setMessage:function(){},getMessage:function(){},render:function(){},requestPaneContent:function(){},loadPaneContent:function(){},setRenderFocus:function(){},setFocusNode:function(){},loadExtra:function(){}}),s.MailPane=s._MailPane=h},"1.0.0",{requires:["common-utils","mail-model-datastore","mail-controller-messages","mail-ui-basewidget","mail-persist-meta-data","common-utils-stats","mail-ui-messagepane-utils"]});


YUI.add("mail-ui-mailview-base",function(e){var t=[48,49,50,51,52,53,54,55,56,57],n=[strings.str_cfg_sc_keycode_reply_to_all,strings.str_cfg_sc_keycode_message_forward,strings.str_cfg_sc_keycode_movemenu_display,strings.str_cfg_sc_keycode_mark_as_read,strings.str_cfg_sc_keycode_flag_selected_messages,strings.str_cfg_sc_keycode_reply_to_sender,strings.str_cfg_sc_keycode_print,strings.str_cfg_sc_keycode_toggle_preview_pane,strings.str_cfg_sc_keycode_close_tab],r=["density-regular","density-compact","density-open"],i={},s=[65,70,68,75,76,82,80,86,220],o=n.length,u=NeoConfig,a=e.common,f=a.Utils,l=f.features,c=f.escapeHtml,h=f.unescapeHtml,p=e.contacts,d=e.mail,v=d.ui,m=a.persist.UserData,g=v.MessagePaneUtils,y=v.FolderUtils,b="%40C%40Chats",w="%40B%40Bulk",E="darlaEvent",S="delete",x="archive",T="message",N="move",C="inbox-move",k="visible",L="scroll-view-prev",A="scroll-view-prev-beside",O="scroll-view-noprev",M,_=!1,D=e.mail.Tabs,P=e.one("#nav"),H,B;for(M=0;M<o;++M)i[n[M]]=s[M];var j=function(t){function s(){j.superclass.constructor.call(n,t),n.evt.push(e.on("MailOptions:PreviewPaneCollapse",function(){n.previewPaneUIChange(!1)}),e.on("MailOptions:PreviewPaneExpand",function(){n.previewPaneUIChange(!0)}),e.on("MailOptions:PreviewPaneUIChange",function(e){var t=e&&e.view;n.handlePreviewPanePrefChange(t)}),e.on("mailview:relcalculateToolbarPositions",function(){n.positionToolbarItems()}),e.after("update:previewPane",function(){if(n.msgPane.fullView)return;n.updateListDensity(),n.toggleExpandOrCollapseAll(),n.toggleCloseButton()}))}function o(e){var t;return e?(t=y.get(e))&&t.total===0:0}var n=this,r,i;n.statOp=null,n.evt=[],t=t||{},r=t.fid||0,i=t.msgList!==0,t.vertical=n.verticalPreview=e.one("#rail-resize-vert")?1:0,n.isSearch=t.query===""||t.query,n.searchQuery=t.searchQuery||null,n.subToolbars={},n.bottomToolbars={},n.supportPreview=!0,n.efvEnabled=NeoConfig.hasAds&&f.features.enabled("videoEmptyFolder"),e.mix(n,{fid:r,hasMsgList:i,isEmpty:o,msgList:null,msgPane:null,type:function(){var e=u.hasConv;return n.isSearch?"searchlist":i?e?"convlist":"messagelist":e?"convpane":"messagepane"}()},!0),s()};e.extend(j,e.mail.ui.BaseWidget),e.mix(j.prototype,{NAME:"MailView",keyCodes:n,numCodes:t,verticalPreview:null,isChat:function(e){var t=this;return t.isActualSystemFolder(e,b)},isActualSystemFolder:function(e,t){var n=this,r=n.msgPane&&n.msgPane.get&&n.msgPane.get(T),i=r&&r.message&&r.message.sourceFolderInfo&&r.message.sourceFolderInfo.fid||e;switch(t){case"Sent":return y.isSentFid(i);case"Draft":return y.isDraftFid(i);case"Trash":return y.isTrashFid(i);default:return i===t}},showNotification:function(t){e.use("common-ui-notification-v2","common-persist-user-data",function(e){var n=t?e.common.persist.UserData.isUsersEmailAddress(t)?strings.str_cont_add_to_cont_alert_user_email_bd:f.substitute(strings.str_cont_add_to_cont_alert_already_in_contacts_bd,{from_email:"["+t+"]"}):strings.str_cont_add_to_cont_alert_select_indivitual_msg_bd,r=t?e.common.persist.UserData.isUsersEmailAddress(t)?"info":"attention":"attention";e.common.ui.NotificationV2.notify(n,{type:r,close:!0,closeOnExternalClick:!0,closeOnNavClick:!0,duration:1e4,customClass:"link-style",speed:"show-fast"})})},refreshMessage:function(e){var t=this;!t.hasMsgList&&t.msgPane&&(u.hasConvView||t.msgPane.set(T,{fid:e.fid,message:e.msg}),u.hasConvView&&e.submsg&&(t.msgPane.selectMessage(e.submsg)||(t.msgPane.loadPaneContent(106),t.msgPane.selectMessage(e.submsg))))},handlePreviewPanePrefChange:function(e){var t=this;switch(e){case 0:t.getCurrentView()!==O&&t.switchView(O,undefined,"settings");break;case 1:t.getCurrentView()!==A&&t.switchView(A,undefined,"settings");break;case 2:t.getCurrentView()!==L&&t.switchView(L,undefined,"settings")}},handlePostAction:function(t,n,r,i){var s,o,a,f,l,c;if(!t)return;s=this,o=t.action,a=s.msgPane,f=s.goOnMessageDelete(),f&&(c=f==="prevMsg"?"prevMsg":"next"),n!==w&&f&&o==="folder-new"&&(t.preHandle=function(t){e.use(s._nextprevModule,function(){a&&a.stepMail(u.stepMessageAction||"next",t,1)})}),l=function(){s.handleUI(t,n,r,i&&i.message?[i.message]:null)},s.type!=="messagepane"&&s.type!=="convpane"||n===w||n===b||o!==S&&o!==N&&o!==C&&o!=="trash"&&o!=="spam"&&o!=="archive"&&o!=="restore"&&o!=="sendercompromised"&&o!=="phished"&&o!=="notmymail"||!f?l():e.use(s._nextprevModule,function(){y.isTrashFid(n)&&o===S?a&&a.dialogThenStep(s,i,t,1):o===S?a&&a.stepMail(c,l,1):a&&a.stepMail(c||o,l,1)})},loadResizersAndSliders:function(){var t=this,n=[];if(t.slidersSet)return;n.push("mail-ui-messagesview-resize"),t.verticalPreview&&n.push("mail-ui-messagesview-vertical"),u.useDD&&n.push("mail-ui-messagesview-dd"),n.push(function(e){v&&v.MessagesViewResize&&t.supportPreview&&(t.verticalPreview?t.horizResizer=new v.MessagesViewVertical(t):t.vertResizer=new v.MessagesViewResize({messagesview:t})),u.useDD&t.supportPreview&&typeof e.mail=="object"&&typeof e.mail.MessagesViewDD=="object"&&d.MessagesViewDD.setDD(t)}),e.use("contacts-api","contacts-api-utils",function(){p&&p.utils&&!p.utils.areContactsLoaded()&&p.api.load()}),e.use.apply(e,n),t.slidersSet=!0},positionPreview:function(t,n,r){var i=this,s;e.use("mail-ui-messagesview-vertical",function(){if(t&&(r!==undefined?!r:!v.MessagesViewVertical.canGoVert()))return;i.verticalPreview=t,s=t?1:2,i.horizResizer?i.horizResizer.setDisplay(t):t&&(i.horizResizer=new v.MessagesViewVertical(i)),i.vertResizer?i.vertResizer.setDisplay(!t):t||(i.vertResizer=new v.MessagesViewResize({messagesview:i})),i.msgList.set("vertical",t),i.msgList.set("fullpane",!1),i.msgPane&&i.msgPane.set("vertical",t),u.horzPane=!t,u.vertPane=t,n&&n(),u.previewPanePref!==s&&(u.previewPanePref=s,e.fire("update:previewPane",{previewpane:s})),e.fire("verticalPreview",i),i.positionToolbarItems()})},updateListDensity:function(){var t=e.one("body"),n=t.one("#inboxcontainer"),i=t.one("#toolbar"),s=r[u.msgListDensity];u.previewPanePref!==0?t.addClass("previewpane-on"):t.removeClass("previewpane-on"),u.previewPanePref===1?(t.
addClass("vp-on").removeClass("vp-off"),n.addClass("vp"),i.addClass("vp"),s="density-open"):(t.removeClass("vp-on").addClass("vp-off"),n.removeClass("vp"),i.removeClass("vp")),e.fire("update:density",{density:s})},isToolBarFit:function(){var t=e.all(".bottomToolbar")._nodes,n,r,i,s=0,o=0;for(r=0;t&&r<t.length;r++)if(t[r].clientWidth>300){n=t[r];break}o=n&&n.clientWidth,i=n&&n.childNodes;for(r=0;i&&r<i.length;r++)i[r].nodeType!==3&&i[r].clientWidth&&(s+=i[r].clientWidth);return s+50>=o?!1:!0},toggleExpandOrCollapseAll:function(){var t=this.msgPane.message,n=u.previewPanePref===0||!t||!t.totalMsgs||t.totalMsgs===1,r=e.one("#btn-togglethread");r&&r[n?"addClass":"removeClass"]("hidden")},toggleCloseButton:function(){var t=this.msgPane.message,n=u.previewPanePref!==1||!t,r=e.one("#btn-closemsg");r&&r[n?"addClass":"removeClass"]("hidden")},previewPaneUIChange:function(t,n){var r=this,i=r.msgList,s=r.msgPane,o,a,l,c,h;r.verticalPreview&&t&&(n!==undefined?!n:!v.MessagesViewVertical.canGoVert())&&r.positionPreview(),e.fire(t?"previewPane:expanded":"previewPane:collapsed",r),r.verticalPreview?r.horizResizer&&r.horizResizer.setDisplay(t):r.vertResizer&&r.vertResizer.setDisplay(t),i.set("fullpane",!t),s.set(k,t),h=r.get("contentToolbar").root,u.convReplyBtnsInTlbr&&h&&(t?(h[r.msgPane.message?"removeClass":"addClass"]("disableReplyGroup"),h.removeClass("hideReplyGroup")):h.addClass("hideReplyGroup")),t&&(o=f.Stopwatch.get(r.statOp),a=s.get(T),l=a&&a.message&&a.message.mid,c=a&&a.fid,c&&l&&(o=g.handleMsgInPreviewStopwatch(o,s,c,l)),s.set(T,a)),o&&o.start(1,"SetDisplay"),u.horzPane=!r.verticalPreview,u.vertPane=r.verticalPreview},togglePreviewPane:function(t,n){var r=this;try{var i=r.msgList,s=r.msgPane,o;if(!i||!s)return;o=!u.previewPanePref,r.previewPaneUIChange(o,n),o?(i.isPreviewVisible=!0,l.enabled("scrollToSearchV2")&&i.setScrollToSearchV1View()):(i.isPreviewVisible=!1,l.enabled("scrollToSearchV2")&&i.setScrollToSearchV2View()),r.verticalPreview&&r.positionToolbarItems(),u.previewPanePref=o?r.verticalPreview?1:2:0,u.horzPane=u.previewPanePref===2?!0:!1,u.vertPane=u.previewPanePref===1?!0:!1,t||(u.previewPanePersistedPref=u.previewPanePref,e.fire("update:previewPane",{previewpane:u.previewPanePref})),r.checkPreview(),i.vlist.updateUlSize(),e.one("#inboxcontainer").hasClass("prevPaneVisible")?e.one("#inboxcontainer").removeClass("prevPaneVisible"):e.one("#inboxcontainer").addClass("prevPaneVisible"),e.fire("ws:previewChange",o)}catch(a){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailview-base-mailview:1",a,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailview-base-mailview:1")}},positionToolbarItems:function(){var t=this;t.checkWidth(),t.resizeEvent||(t.resizeEvent=e.on("windowresize",function(){t.checkWidth()}),t.evt.push(t.resizeEvent))},checkWidth:function(){var t=e.one("#toolbar"),n=f.getCachedWindowSize().width;t&&(t.hasClass("with-backsearch")?n<1120?t.addClass("long-tb"):t.removeClass("long-tb"):t.removeClass("long-tb"))},checkPreview:function(){var e=this,t=u.previewPanePref?!0:!1,n;try{t&&(n=e.verticalPreview?e.horizResizer:e.vertResizer,n&&n.checkDisplay())}catch(r){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailview-base-mailview:2",r,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailview-base-mailview:2")}},getCurrentView:function(){return u.previewPanePref?u.previewPanePref===2?L:A:O},switchView:function(t,n,r){var i=this,s=function(s){var o=t===L||t===A,u=i.getCurrentView(),a=function(){var e=i.msgPane.richcompose;e&&e.cleanupRichCompose(),(u===O&&o||u!==O&&!o)&&i.togglePreviewPane(!1,n),e&&e.reInitRichCompose()};e.fire("mt:click",{action:s,append:{source:r||"keyBoard"}}),i.verticalPreview&&t===L||!i.verticalPreview&&t===A?i.positionPreview(t===A,a,n):a()};switch(t){case L:s("mView_bottom_prv");break;case A:s("mView_right_prv");break;case O:s("mView_no_prv")}},handleDarlaEvent:function(){var e=this;e.hasMsgList?e.msgList.handleDarlaEvent():e.fire(E,{action:e.darlaActionKey})},triggerDarlaWithAIC:function(t){var n=this,r,i,s;r=y.get(n.fid),s=t||n.msgPane.message,i=y.getSystemFolderInfoName(n.fid,r),n.fire(E,{action:n.darlaActionKey,value:{siteAttr:e.mail.ui.MessagePaneUtils.getAdSiteAttribsFromMesgObj(s,n.fid),foldername:i,message:s}})},goOnMessageDelete:function(){var e=this,t=m.get("userUIPref.goOnMessageDelete");return t==="prevMsg"?"prevMsg":e.searchQuery&&e.searchQuery.isPrevNextNavigationDisabled?!1:t==="msg"},setPPToolbarItems:function(t){var n=this,r=e.one("#toolbar"),i=n.msgPane,s=i.message,o;if(i.isPrevPaneVisible&&!i.isPrevPaneVisible())return;r&&s?(o=r.one("#btn-closemsg"),o&&o[t&&u.previewPanePref===1?"removeClass":"addClass"]("hidden"),o=r.one("#btn-togglethread"),s.totalMsgs&&s.totalMsgs>1&&(o&&!o.hasClass("thread-cards-expanded")&&(o.replaceClass("thread-cards-collapsed","thread-cards-expanded"),o.setAttribute("title",strings.str_collapse_all_attr),o.one(".icon-text").setContent(strings.str_collapse_all)),o&&o[t&&u.previewPanePref!==0?"removeClass":"addClass"]("hidden"))):(o=r.all("#btn-togglethread, #btn-closemsg"),o&&o.addClass("hidden"))},handleToolbarSelection:function(t){var n=this,r=t?t.dataAction||t.currentTarget._node.getAttribute("data-action"):0,i=t?t.item?t.item:t.currentTarget:0,s=n.msgPane,o=n.msgList,l=n.fid,c={append:{}},h,p,d=e.mail.ui.ContextButton,v=n.get("contentToolbar")?n.get("contentToolbar").root:e.one("#pagetoolbar"),m,g=!0,w,E,S,x=t&&t.item&&t.item.one("i.coupons"),N=!1,C=e.mail.persist.MetaData,k="neo.pref.coupons.showExpiringCoupons";if(!r||d&&!d.buttonEnabled({item:i,root:v,action:r}))return;e.fire("mailview:toolbar-action",r);if(n.type==="messagepane"||o&&o.get("selectCount")===1)switch(r){case"edit":c.spid="compose_draft";break;case"reply_sender":case"reply_all":case"forward":c.spid="compose_"+r;break;case"open":c.spid="message_tabpane",c.append.rspns="new";break;
case"delete":case"spam":case"sendercompromised":case"phished":case"notspam":case"move":n.type==="messagepane"&&(n.goOnMessageDelete()?w="message_tabpane":y.isInboxFid(l)||y.isDraftFid(l)||y.isSentFid(l)||y.isTrashFid(l)?w="folderview_"+n.fid.toLowerCase():y.isSpamFid(l)?w="folderview_bulk":l===b?w="folderview_chat":w="folderview_custom",c.append.rspns="new",c.spid=w);break;case"print":case"fullheader":case"set_encodings":case"addcontact":c.append.rspns="pop";break;case"prev":case"next":c.spid="message_tabpane";break;case"selectAll-message":case"select-dd":case"sender":case"recipient":case"subject":case"date":case"date-asc":case"date-desc":case"unRead":case"attachment":case"sort-flagged":o&&(t.target=i,o.clickHandler(t)),g=!1;break;case"coupons":N=!0}else if(r.indexOf("-view")===-1)switch(r){case"spam":case"sendercompromised":case"phished":break;case"selectAll-message":case"select-dd":case"sender":case"recipient":case"subject":case"date":case"date-asc":case"date-desc":case"unRead":case"attachment":case"sort-flagged":o&&(t.target=i,o.clickHandler(t)),g=!1;break;case"coupons":N=!0;break;default:c.append.rspns="pop"}N&&(f.features.enabled("expiringCoupons")&&x&&(C.get(k)==="0"?(x.addClass("icon-checkmark"),C.set(k,"1"),e.fire("toggleCoupons",{action:"show"})):(x.removeClass("icon-checkmark"),C.set(k,"0"),e.fire("toggleCoupons",{action:"hide"}))),g=!1);if(i.hasClass("menu-active-item"))m=e.one(".list-view-footer .btn.pressed"),p=i.ancestor(".optionMenu"),h=p.get("id").replace("menu","menusel"),c.append.ltxt=r;else{m=i.ancestor(".list-view-footer"),h=r;if(u.infinitePane)switch(h){case"prev":h="left";break;case"next":h="right"}}c.action=["tlbr_",h,m?"_btm":""].join(""),n.hasMsgList?o.getSelected(function(e){e[0]&&e[0].mid?S=e.map(function(e){return e.mid}):S=e.reduce(function(e,t){return e.concat(t.msgs.map(function(e){return e.mid}))},[])}):(E=s&&s.get(T),E&&E.message&&(E.message.mid?S=[E.message.mid]:S=E.message.msgs.map(function(e){return e.mid}))),c.append.msgID=S,n.hasMsgList||(c.append.sec=m?"msgReadTlbrBtm":"msgReadTlbr"),r&&(c.append.t3view=r),e.fire("mt:click",c);switch(r){case"prev":case"next":e.use(n._nextprevModule,function(){u.stepMessageAction=r,s&&s.stepMail(r)});break;case"closemsg":n.msgPane&&(n.msgPane.fullView?u.multitask&&!u.tabs?(n.handleTabSwitch(),u.backButtonFull&&e.fire("removePage")):n.set("close",1):(n.msgPane.hasMessage()&&(n.msgPane.showMailBoxIcon=!0,o.vlist.selectAll(0)),n.setPPToolbarItems()));break;case L:case A:case O:n.switchView(r);break;case"themes":e.use("mail-ui-themes",function(e){e.mail.ui.Themes.showThemesDialog()});break;case"addcontact":n.handleDefaultCase({action:r,context:"msg"});break;case"tab":e.use("common-ui-navtabs",function(){a.ui.NavTabs.setTabs(1)});break;case"recent":e.use("common-ui-navtabs",function(){a.ui.NavTabs.setTabs(0)});break;case"mailOptions":e.fire("openOptions",{view:"viewing_email"});break;case"switch_convview":e.fire("setUdbKey",{threading:u.hasConvView===1?-1:1},{success:function(){window.location.reload()},failure:function(){e.use("common-ui-notification-v2",function(e){e.common.ui.NotificationV2.notify(strings.str_modal_convoo_error,{type:"error",close:!0,closeOnExternalClick:!0,closeOnNavClick:!0,duration:5e3,customClass:"link-style",speed:"show-fast"})})}});break;case"rawmessage":n.handleRawMessage();break;default:g&&n.handleDefaultCase({action:r,item:i,tbAction:!0})}},handleRawMessage:function(){var t=this,n=t.msgPane,r="",i,s;t.hasMsgList?t.msgList.getSelected(function(e){i=e&&e[0],s=i&&(i.mid||i.msgs[0].mid)}):(i=n&&n.get(T),s=i&&i.message&&(i.message.mid||i.message.msgs[0]&&i.message.msgs[0].mid)),r=e.Mail.Core.Net.Helpers.V3RequestHelper.getV3RequestUrl("rawmessage",{id:s}),window.open(r,"_blank","")},handleFullscreenNavigation:function(e){var t=this;t.handleToolbarSelection(e)},onFocus:function(){if(!this.hasMsgList)return this.msgPane.onFocus()},sortKeys:function(e){if(this.hasMsgList)switch(e){case 65:return this.msgList.sortList("attachment",null),!0;case 68:return this.msgList.sortList("date",null),!0;case 75:return this.msgList.sortList("unRead",null),!0;case 76:return this.msgList.sortList("sort-flagged",null),!0}return!1},onKeyDown:function(t){function M(){var t=e.one(document.activeElement),n=e.one("#yucs"),r=e.one("#yucs-top-bar");return t&&(n&&n.contains(t)||r&&r.contains(t))?!0:!1}function D(){var t=e.one(document.activeElement),n=e.one("#storm-listnav");return t&&n&&n.contains(t)?!0:!1}var n=this,r=t.keyCode,s,o=t.metaKey,a=t.shiftKey,f=t.ctrlKey,l=t.altKey,c=t.metaKey||t.ctrlKey,h=y.isDraftFid(n.fid),p=n.isChat(n.fid),d=!1,v=n.msgPane,m=n.msgList,b=e.UA,w,E=e.one("#app-list"),C,k,L=e.UA.ie,A=e.mail.ui.Boss,O;r=c?r:i[r]||r,r>=96&&r<=105&&(r-=48);if(A&&A.isActive())return A.handleKeydown({keyCode:r}),!0;if(r===186){_=!0;return}if(_){if(this.sortKeys(r)){_=!1;return}_=!1}if(h&&(r===65&&!c||r===82||r===70||r===68))return!1;if(p&&(!a&&r===65||r===82||r===70||r===68||r===75))return!1;switch(r){case 13:s=t.target.one(".list-view-item.selected")?"open":null;break;case 33:case 34:if(t.ctrlKey)return;case 35:case 36:case 32:case 38:case 40:if(M())return;if((r===38||r===40)&&D())return;case 188:if(o)return;case 190:case 37:case 39:if(t.target&&t.target.ancestor(".compose-assist"))return;if(!u.infinitePane&&(r===37||r===39))return;if(!m&&(f&&(r===188||r===190)||r===37||r===39))e.use(n._nextprevModule,function(){u.stepMessageAction=r===188||r===37?"prev":"next",v&&v.stepMail(u.stepMessageAction,null,null,!0)});else if(m)m.set("active",1),m._listview._keydown(t);else{v.onKeyDown(t);if(t.keyCode===38||t.keyCode===40)return}t.halt();break;case 46:if(!E||E&&!E.contains(t.target))s=S;break;case 68:!l&&!c&&(a&&NeoConfig.imapIn?s="move-find-menu":s="move-menu");break;case 69:y.isArchiveSupported(n.fid)&&(!E||!E.contains(t.target))&&(s=x);break;case 75:m?t.shiftKey?s="unread":s="read":v&&v.onKeyDown(t);break;case 76:m?(s=null,w=e.one(".list-view-item.selected"),s=w?w.hasClass("flagged")?"unflagged":"flagged":null):v&&v.onKeyDown
(t);break;case 65:!a&&!l&&c?(m.vlist.selectAll(!m.vlist.hasAnySelected()),t.halt()):u.hasConvView?v&&v.onKeyDown(t):(s=a?"":"reply_all",!c&&!l&&(C=L));break;case 82:u.hasConvView?v&&v.onKeyDown(t):a||(s="reply_sender",C=L);break;case 70:u.hasConvView?v&&v.onKeyDown(t):(!l&&!a&&!c?(s="forward",C=L):a&&l&&(d=!0,s="forward",l=!1,t.halt()),(!b.gecko||b.os!=="macintosh")&&!a&&!o&&(a||!c)&&t.preventDefault());break;case 27:var j=e.one(".card-v1 .user-email a");if(j&&j.getStyle("visibility")!=="hidden")e.mail.ContactPopup&&e.mail.ContactPopup.hideMini();else{if(n.type==="messagepane"||n.type==="convpane")return u.multitask&&!u.tabs?n.handleTabSwitch():n.set("close",1),!0;if(e.mail.Tabs.getActiveTab().get("id")==="tabinbox"&&n.msgPane&&n.msgPane.hasMessage())return n.msgPane.showMailBoxIcon=!0,n.msgList.vlist.selectAll(0),!0;if(A)return A.toggle(null,!0),!0}break;case 220:if(o||f)if(n.type==="messagepane"||n.type==="convpane")return u.multitask&&!u.tabs?n.handleTabSwitch():n.set("close",1),!0;break;case 80:if(c&&!l&&!a){t.halt(!0);try{event&&(event.keyCode=0)}catch(F){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailview-base-mailview:3",F,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailview-base-mailview:3")}}!l&&!a&&n.handleDefaultCase({action:"print",item:0});break;case 77:case 89:if((o||f)&&a&&p&&strings.str_cfg_tog_hasSMS){var I=r===89?"reply-sms":"reply-im",q=n.getCurrentMsg();return n.handleUI({action:I},n.fid,n.msgList,q?[q]:null),!0}break;case 73:case 84:a&&l&&e.mail.ui.Tray&&e.mail.ui.Tray.toggle();break;case 48:case 49:case 50:case 51:if(r===51&&a&&!f&&!l&&!o){s=S;break};case 52:case 53:case 54:case 55:case 56:case 57:if(r>=49&&r<=57)if(l)switch(r){case 49:case 50:case 51:case 52:case 53:case 54:H||(H=P.all(".nav-item")),B=H.item(r-49);if(B)return e.fire("nav:"+B.getAttribute("data-nav"),t),!0}else if(A&&A.handleKeydown({keyCode:r}))return!0;var R=t.target.ancestor("div",!0);if(o||f||l||a||!R||R.get("id")!=="menu-move"||!strings.str_tog_use_num_accel)break;return y.get(null,{success:function(t){var i=t,s,o=[],u,a;a=i?i.length:0;for(u=0;u<a;u++)i[u].isSystem||o.push(i[u]);s=r===48?"Inbox":o[r-49],s=e.Lang.isString(s)?s:s?s.folderInfo.fid:0,s&&n.handlePostAction({action:N,fid:s},n.fid,n.hasMsgList?m:null,n.hasMsgList?null:v.get(T))}}),!0;case 67:if(a&&!(c||l||o||f))return w=m&&m._listview.get("activeItem"),n.isEnableAddToContacts(null,!0,w)&&(w&&w.hasClass("list-view-item-detail")&&(O=m._listview._getIndexN(w)),n.handleDefaultCase({action:"addcontact",context:u.hasConvView?"":"msg",subIndexArr:O})),!0;if(c){var U=e.mail.Tabs.getActiveTab().elContent;if(U){var z,W,X="",V,$=U.one(".message-header .lozengeContainer.pressed .lozenge");V=document.activeElement,$&&(z=$.getAttribute("data-address"),W=$.getAttribute("data-name"),W?X=W+" <"+z+">":X=z,g.initializeCopyText(),g.copyToClipboard(X,null,V))}}return;default:}return s&&!o&&!f?(k=function(){n.handleDefaultCase({action:s,item:0,forwardAsAttachment:d,shiftKey:a})},C?setTimeout(k,0):k(),!0):!1},handleTabSwitch:function(){var t=this,n,r=e.contacts.ui.ContactsView,i,s,o;i=t.tab.prevTabId;if(i){s=D.getTabById(i);if(s&&s.widgetType==="search"){D.switchToTab(s),o=s.elContent.one("#msg-list"),o!==null&&e.UA.safari>0&&(o.addClass("toggle-to-force-repaint"),setTimeout(function(){o.removeClass("toggle-to-force-repaint")},1));return}n=r&&i===r.tab.get("id");if(n){D.switchToTab(r.tab);return}}D.switchToTab(D.tabs[0])},ondestroy:function(){var t,n=this;for(t in n.evt)e.detach(n.evt[t])},createRefTab:function(t){var n="",r,i,s,o,a="",f,l,p,v,m={fid:t.fid};u.hasConvView?(l=d.model.ConvStore.Conversations,v=l.getPermCidPart,i=e.mail.ui.ConvView,m.cid=v(t.cid),a=t.subject,r=t.recipients,r&&r.length&&(n=c(h(r[r.length-1].name))),s="convpane",m.tabKey="cid"):(f=d.model.DataStore.Messages,p=f.getPermMidPart,i=e.mail.ui.MessagesView,m.mid=p(t.mid),t.header&&(o=t.header,a=o.subject,n=e.mail.ui.PaneUtils.getName(o.from)),s="messagepane",m.tabKey="mid"),a=a||strings["str_msg-view_tab_no_subject"],a=c(h(a)),e.fire("tab:addRef",{data:m,p_label:n,s_label:a,isRemovable:!0,widgetType:s,init:function(n,r){var s,o=e.mix({msgList:0,message:t,isRemovable:!0},m);s=new i(o),n.widget=s,e.fire("bindContentWidget",{cw:s,tab:n}),r()}})}},!0),e.namespace("mail.ui"),e.mail.ui.MailView=j},"1.0.0",{requires:["mail-ui-basewidget","common-persist-user-data","mail-ui-messagepane-utils","mail-model-datastore","common-utils","mail-common-utils-features","mail-ui-pane-utils","mail-ui-folder-utils","mail-core-net-helpers-v3-request-helper","mail-persist-meta-data"]});


YUI.add("mail-ui-pane-utils",function(e){function h(e){return e.filename?u(a(e.filename)):""}var t=e.mail,n=t.ui,r=e.common,i=e.common.Utils,s=t&&t.Controller?t.Controller.Messages:{},o=i.substitute,u=i.escapeHtml,a=i.unescapeHtml,f=e.Lang.trim,l=r.persist.UserData,c=function(e){var t=e.s||"",n=e.o||0,r=e.f,i=e.a||0;return o(t,n,r,i,strings)};e.namespace("mail.ui").PaneUtils={getBlockedMsgMarkup:function(e,t){var n=e?e.imgAttachments||[]:[],r=e.inboxservices||[],i=l.get("userUIPref.imageBlocking")==="b",o=n.length&&e.blockImages==="all",u=e&&(e.hasBlockedImages||(strings.str_cfg_tog_old_imageblock?o:o&&!s.isCertified(r)&&!(i&&e&&e.flags&&e.flags.inAddressBook)));return u?c({s:t.msg_blocked,o:e}):""},getAttPhotosMarkup:function(e,t,n){var r,i=e?e.imgAttachments||[]:[],s=i.length,o=[],u=e.blockImages==="all"&&!(l.get("userUIPref.imageBlocking")==="b"&&e&&e.flags&&e.flags.inAddressBook)&&!strings.str_cfg_tog_show_imageblock_thumbnail;for(r=0;r<s;r++){var a=i[r];u?a.blocked_images="img":a.blocked_images_else=t.blocked_images_else,strings.str_cfg_tog_show_imageblock_thumbnail&&!a.thumbnailurl&&(a.thumbnailurl=strings.str_cfg_url_imageblock_thumbnail),o.push(c({s:t.attached_photos,o:a,f:{image:function(){return a.thumbnailurl?c({s:t.image,o:a,f:n}):""},filename:function(){return h(a)}}}))}return o.join("")},getAttFilesMarkup:function(e,t){var r,i=e?e.nonImgAttachments||[]:[],s=i.length,o=[];for(r=0;r<s;r++){var u=i[r];o.push(c({s:t.attached_files,o:u,f:{image1:function(){return u.thumbnailurl?c({s:t.image,o:u}):""},type:function(){return n.AttachFileType.getType(u.filename)},filename:function(){return u.filename===".eml"&&(u.filename=strings.str_comp_nosubject+".eml"),h(u)}}}))}return o.join("")},getDownloadUrlHost:function(e){var t=e&&e.part||[],n;return t.some(function(e){return e.downloadUrl?(n=i.extractHostFromUrl(e.downloadUrl),!0):!1}),n},switchInlineImageSrc:function(e,t,n){var r=this.getDownloadUrlHost(t),s=i.getTransparentSVG(),o;r&&(o=e.all("img"),o&&o.each(function(e){var t=e.getAttribute(n?"data-src":"src");t&&t.indexOf(r)!==-1&&(e.setAttribute("src",n?t:s),e.setAttribute("data-src",n?"":t))}))},extractQuotedText:function(t,n,r,s,u){if(t&&t.body){var a=this,f,l=[],c,h,p,d,v=0,m,g=[];try{if(t.yqtClassId){f=e.Node.create("<div/>"),f.setHTML(t.body.display),m=t.yivPrefixNumber||[];if(m.length>0)for(c=0;c<m.length;c++)g.push("."+m[c]+t.yqtClassId);l=f.all(g.join(",")+", ."+t.yqtClassId),l&&l.each(function(s){i.features.enabled("onDemandFetchInlineImageInQuotedBody")&&a.switchInlineImageSrc(s,t,!1),p=s.get("innerHTML"),d=v?"":o(n,null,null,null,strings),d+=o(r,{quoted_text_body:p},null,null,strings),h=e.Node.create(d),s.replace(h),v++}),t.body.display=f.get("innerHTML")||t.body.display}!s[t.mid]&&u>0&&t.header.subject.indexOf("Fw: ")&&(s[t.mid]=!0)}catch(y){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-ui-mailpane-base-paneutils:1",y,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-ui-mailpane-base-paneutils:1")}}},getName:function(e){var t;return e?(t=f(e.name),u(a(t))||u(a(e.email))||""):""},getAddress:function(e){return e&&e.email?u(a(e.email)):""},getMsgSub:function(e){return e&&e.subject?u(a(e.subject)):strings["str_msg-view_no_subject"]},getMsgSubDir:function(e){var t="";return e&&e.header&&e.header.subjectDir&&(t=" dir='"+e.header.subjectDir+"'"),t},getNameDir:function(e){return NeoConfig.bidi&&e&&e.nameDir?e.nameDir:""},getDataName:function(e){var t="";return e&&e.name!==e.email&&(t=u(a(f(e.name)))),t},createRecipientList:function(e,t,n,r,i,s){var o=[],u=r?Math.min(r,e.length):e.length,a;for(a=0;a<u;a++)o.push(c({s:t,o:i&&i(e[a]),f:n,a:e[a]}));return a=e.length,typeof s===undefined?o.join(","):o.join(s)},isOwnEmail:function(e){return this.allAccounts=this.allAccounts||this.getAllAccountEmails(),this.allAccounts&&this.allAccounts[e]},getAllAccountEmails:function(){var e={},t=l.get("externalAccounts.extAccount")||[],n=l.get("aliases.alias")||[],r=l.get("disposableAddresses.deaName")||[],i=t.concat(n,r),s={defaultID:l.get("userSendPref.defaultID"),defaultFromAddress:l.get("userSendPref.defaultFromAddress")},o,u,a=i.length;e[s.defaultID]=1,e[s.defaultFromAddress]=1;for(u=0;u<a;u++)if(o=i[u].address)e[o]=1;return e},displaySenderAddress:function(e){var t=this,n=t.getName(e),r=t.getAddress(e);return n!==r?"&lt;"+r+"&gt;":""}}},"1.0.0",{requires:["mail-controller-messages","common-utils","mail-persist-meta-data","mail-common-utils-features"]});


YUI.add("common-utils-stats",function(e){function u(e,t){while(e)e.d=t-e.s,e=e.sb,e=e&&e[e.length-1]}function a(e){function i(e,t){var s=0;while(s<e.length)n=e[s++],r+=t+n.n+":"+n.d+"\n",(n=n.sb)&&i(n,t+"-")}var t=this,n,r="";i([e],r),e.rtComment=r,r=(e.title||"")+r}var t=e.namespace("common.Utils"),n=window.NeoConfig&&NeoConfig.RTFirePercentage||0,r={},i,s=function(){return i||new Date},o=t.Stopwatch=function(t){var n=this;n.n=t,i=n.s=s(),n.start.apply(n,e.Array(arguments,1)),i=0};o.get=function(t){var n=e.Array(arguments,1),s=r[t],u;return n.length&&(u=n.shift(),s&&u&&s.stop(u),s=0,n.shift()&&(s=new o(t),i=s.s,s.start.apply(s,n),i=0),r[t]=s),s},o.prototype={start:function(e){var t,n,r=this,i=r,o=e,a=arguments,f=0,l=s();typeof o=="number"?f=1:o=-1;while(r.sb&&--o)i=r,r=i.sb,r=r[r.length-1];for(;f<a.length;f++)t=r.sb=r.sb||[],(n=t.length)&&u(i=t[n-1],l),i={n:a[f],s:l},t.push(i)},stop:function(t){var n=this;e.Lang.isNumber(n.d)||(n.n=t||n.n,u(n,s()),a(n))}}},"1.0.0",{});


YUI.add("common-utils",function(e){e.namespace("common.Utils");var t=e.common.Utils,n=t.features,r=t.settings,i=e.Object,s=e.Lang,o=s.trim,u=/{{([^{}]*)}}/g,a=Object.freeze({height:window.innerHeight,width:window.innerWidth});e.mix(t,{NAME:"Utils",isEmpty:function(e){var t;if(e)for(t in e)return!1;return!0},isYuiNode:function(t,n){return t?t instanceof e.Node?!0:(n&&e.fire("SplunkLog","debug_isYuiNode",{outerHTML:t.outerHTML?t.outerHTML.substr(0,300):"unknown"},"sample"),!1):!1},getCachedWindowSize:function(){return a},cacheWindowSize:function(e){a=Object.freeze({height:e.height,width:e.width})},size:function(e){var t,n=0;for(t in e)n++;return n},congruent:function(n,r,o,u){if(!e.Lang.isValue(r))return e.Lang.isValue(n)?!1:!0;var a=n===r||o||t.size(n)===t.size(r),f;return s.isString(n)&&(a=n===r),a&&n!==r&&i.some(n,function(e,n){return f=r[n],a=u&&!!u[n]||(s.isObject(e)?t.congruent(e,f,o):e===f),!a},null,!0),a},diff:function(e,n,r){var o,u=r?e:t.merge({},e);return n&&i.each(u,function(e,r){o=s.isObject(e)?t.diff(e,n[r],!0):e!==n[r],o||delete u[r]},null,!0),(!t.isEmpty(u)||e&&!n)&&u},getSecureURL:function(t){if(t&&t.indexOf("http://")!==-1){var n=e.Lang.trim(t);return n=n.replace(/^http:\/\/[ld]\d?\./,"https://s."),n=n.replace(/^http:\/\//,"https://"),n}return t},extractHostFromUrl:function(e){var t=document.createElement("a");return t.href=e,t.hostname},extractOriginFromUrl:function(e){var t=document.createElement("a");return t.href=e,t.origin},extractPathFromUrl:function(e){var t=document.createElement("a");return t.href=e,t.pathname},_observeFunction:function(t){var n,r=t.length;for(n=0;n<r;n++)t[n].name!=="_~yuim~_"&&window.alert("ERROR!!!! You must clone this object before modifying it. \nName: "+t[n].name+"\n"+"Object: "+e.JSON.stringify(t[n],null,4))},merge:function(e,n,r,i,o){var u,a,f;if(s.isObject(n)){e=s.isObject(e)&&e||{};for(u in n){if(i&&!n.hasOwnProperty(u))continue;if(s.isArray(n[u])){a=n[u];if(!e[u]||r)e[u]=[];for(f=0;f<a.length;f++)e[u].push(t.merge(e[u][f],a[f],r,i,o))}else if(s.isObject(n[u]))e[u]||(e[u]={}),e[u]=t.merge(e[u],n[u],r,i,o);else if(r&&e[u]!==n[u]||s.isUndefined(e[u]))if(!o||o&&n[u]!==null)e[u]=n[u]}}else e=n;return e},assert:function(n,r,i,s){n||(r=r||"assertfail",e.use("common-utils-error",function(){var e=s&&s()||"";t.error.report(r+" "+e,1,i,1)}))},log:function(t,n,r){t&&(e.Lang.isString(t)&&(t={m:t}),e.fire("MailLog",t,n,r))},guid:function(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return function(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}(),substitute:function(e,n,r,i,s,o,a){if(typeof e!="string")return;return a&&(e=a.str||e,n=a.obj||n,r=a.formatters||r,i=a.args||i,s=a.strings||s,o=a.templates||o),e.replace(u,function(e,f){var l,c,h=t.substitute;return r&&(l=a&&a.formatters?a.formatters[f]:r[f])?l(n,i,a)||"":n&&f in n?(c=n[f],typeof c=="string"&&c.match(u)?h(c,n,r,i,s,o,a):c):s&&f in s?(c=s[f],c.match(u)?h(c,n,r,i,s,o,a):c):o&&f in o?h(o[f].base||o[f],n,r,i,s,o,a):""})},ezSub:function(e,n,r){if(typeof e!="string")return;return e.replace(u,function(e,i){var s,o=t.ezSub;if(n&&i in n)return s=n[i],typeof s=="function"?s(n):typeof s=="boolean"&&r?s?r[i].match(u)?o(r[i],n,r):r[i]:"":typeof s=="number"&&r?s>0?r[i].match(u)?o(r[i],n,r):r[i]:"":typeof s=="string"?s.match(u)?o(s,n,r):s:"";return strings&&i in strings?(s=strings[i],s.match(u)?o(s,n,r):s):""})},regexpEscape:function(e){return e==null?null:(e=""+e,e.replace(/([\^\/.*+?|()[\]{}\\=!:$])/g,"\\$1"))},getNormalizedMessageCount:function(e){return e>9999?"9999+":e},escapeHtml:function(e,t){return e==null?null:(e=""+e,e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/\"/g,"&quot;"),e=e.replace(/\'/g,"&#39;"),e=e.replace(/\\/g,"&#92;"),e=e.replace(/{/g,"&#123;"),e=e.replace(/&(?:amp;)+/g,"&amp;"),t&&(e=e.replace(/&amp;#([A-Za-z0-9]+);/g,"&#$1;")),e)},unescapeHtml:function(e){return e==null?null:(e=""+e,e=e.replace(/&amp;/g,"&"),e=e.replace(/&lt;/g,"<"),e=e.replace(/&gt;/g,">"),e=e.replace(/&quot;/g,'"'),e=e.replace(/&#39;/g,"'"),e=e.replace(/&#92;/g,"\\"),e=e.replace(/&#123;/g,"{"),e)},escapeStringField:function(e){return t.escapeHtml(t.unescapeHtml(e))},escapeEmailObject:function(e){return{email:t.escapeStringField(e.email),name:t.escapeStringField(e.name)}},escapeEmailObjectArray:function(e){var n=e.length,r=[],i=0;for(;i<n;i++)r.push(t.escapeEmailObject(e[i]));return r},remove:function(e){e&&e.empty().remove(!0)},removeHtml:function(e){return e==null?null:(e=""+e,e=e.replace(/<[^>]*>/g,""),e)},isProcessDefaultEnabled:function(e){return e.target.getAttribute("process-default")==="true"},getDataAction:function(e){var t=e.target,n=e.currentTarget,r=t.ancestor(function(e){return e.getAttribute("data-action")||e===n},!0),i=r?r.getAttribute("data-action"):0;return{node:r,action:i}},dateFormatter:function(e,t){return Neo&&Neo.dateFormatter?Neo.dateFormatter(e,t):""},getDateLabel:function(e,t){return Neo&&Neo.getDateLabel?Neo.getDateLabel((new Date).setHours(0,0,0,0),e,t):""},getDateString:function(e){return Neo&&Neo.getDateString?Neo.getDateString(e):""},triggerDarla:function(t,n){!NeoConfig.noDarla&&e.use("mail-ui-darla",function(e){var r=e.mail.ui.darla;r&&r.trigger(t,n)})},loadDarlaAndExecute:function(t,n){var r=NeoConfig.useTictacAds?"tictac-ads-darla":"mail-ui-darla";n?e.use(r,function(){t(e),e.use("mail-track")}):e.use(r,"mail-track",function(){t(e)})},parseQueryString:function(t){var n,r={};return t=t||window.location.search.replace(/^\?/,""),t&&t.length>1&&(n=t.split("?"),r=e.QueryString.parse(n.length>1?n[1]:n[0])),r},sanitizeString:function(e){var t=/[\u0000-\u001f\u007f]/g;return typeof e=="string"?o(e.replace(t,"")):e},mergeQueryString:function(n,r){var i;return e.Lang.isObject(r)&&(i=n.replace(/\?.*$/,""),r=e.merge(t.parseQueryString(n),r),n=i+"?"+e.QueryString.stringify(r)),n},replaceQueryString:function(n,r){var i,s;if(e.Lang.isObject(r)){i=n.replace(/\?.*$/,""),s=t.parseQueryString(n);for(var o in r
)r.hasOwnProperty(o)&&s[o]&&(r[o]===undefined||r[o]===null?delete s[o]:s[o]=r[o]);n=i+"?"+e.QueryString.stringify(s)}return n},setSelect:function(t,n){typeof t.addClass!="undefined"&&(t=[t]),e.Array.each(t,function(t){var r=e.Node.getDOMNode(t);typeof r.onselectstart=="object"?r.onselectstart=function(){return(window.event.srcElement||window.event.target).tagName==="INPUT"?!0:n}:typeof r.style.MozUserSelect!="undefined"?r.style.MozUserSelect=n?"inherit":"-moz-none":r.onmousedown=function(){return n}})},onDemand:function(t,n){return function(){var r=this,i=arguments;e.use(n,function(){r[t].apply(r,i)})}},escapeRegexp:function(e){var t=/([\[|\]|\(|\)|])/g;return e.replace(t,"\\$1")},simulateContextMenu:function(t,n){var r,i=2,s,o;return t?(t=t._node?t._node:t,t.ownerDocument.createEvent?(s=e.one(t),o=s.getXY(),n!==!1&&o[1]-e.DOM.docScrollY()<0&&(s.scrollIntoView(),o=s.getXY()),o[1]-=e.DOM.docScrollY(),r=t.ownerDocument.createEvent("MouseEvents"),r.initMouseEvent("contextmenu",!0,!0,t.ownerDocument.defaultView,1,0,0,o[0],o[1],!1,!1,!1,!1,i,null),!t.dispatchEvent(r)):t.ownerDocument.createEventObject?(r=t.ownerDocument.createEventObject(),r.button=i,t.fireEvent("oncontextmenu",r)):!1):!1},makeHttpsUrl:function(e){return e&&typeof e=="string"&&(e=e.replace(/^http:/,"https:"),e=e.replace(/:80\//,":443/")),e},debounce:function(e,t,n){var r;return function(){var i=this,s=arguments,o=function(){r=null,e.apply(i,s)},u=n&&!r;clearTimeout(r),r=setTimeout(o,t),u&&e.apply(i,s)}},createPoll:function(e,t){e=e||{};var n=0,r=e.sec>0?e.sec:10,i=e.exponential;return function s(){var e=r;i&&(e=r*Math.pow(2,n),n++),t.apply(null,arguments),setTimeout(function(){s.apply(null,arguments)},e*1e3)}},getBootcampURL:function(){return n.enabled("bootcampUE")?r.value("unifiedEdgeURL")+r.value("bootcampUEPath"):r.value("bootcamp_psearch_url")},getMailBoxQueryParams:function(e){var t={mailboxid:NeoConfig.V3MailboxId||"",mailboxemail:NeoConfig.V3MailboxEmail||"",mailboxtype:NeoConfig.V3MailboxType||""};return e&&e==="array"?Object.keys(t).map(function(e){return e+"="+t[e]}):t},fireUnifiedStat:function(t,n){var r,i;if(!e.Lang.isObject(t)||!e.Lang.isString(t.name))return;if(n==="yamas"||n==="all")r=t,e.Lang.isString(t.src)&&(r.tags.src=t.src);if(n==="rapid"||n==="all")i={action:t.name},e.Lang.isString(t.src)&&(i.suffix=t.src),e.Lang.isObject(t.tags)&&(i.append=t.tags);r&&e.fire("util:ymstats",r),i&&e.fire("mt:click",i)},isQualifiedForCoupons:function(t){var i=n.enabled("expiringCoupons"),s=i&&e.Lang.isString(t)?t.toLowerCase().split("@")[1]:undefined;return s?Object.keys(r.value("couponVendorNames")).some(function(e){return s.indexOf(e)!==-1}):i},rAF:function(){var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){e()};return e.bind(t,window)}(),parseJSON:function(t){return t?e.common.Utils.json.tryParse(t):null},getVal:function(e,t,n){var r=t.split(".");for(var i=0,s=r.length;i<s;i++){var o=r[i];if(!(e!==null&&typeof e=="object"&&o in e))return n;e=e[o]}return e},_parseHeader:function(t){var n=o(t).split("\r\n"),r={};return e.Array.each(n,function(e){var t=o(e).split(":");t[0]!==""&&(r[o(t[0]).toLowerCase()]=o(t[1]))}),r},parseMultiPartResponse:function(t,n){var r=n?o(n):"",i="\r?\n?[-]*"+r+"[-]*\r?\n?",s,u,a,f,l,c,h,p,d,v,m,g,y,b=[];s=new RegExp(i,"igm"),u=t.split(s);for(l=0;l<u.length;l++){a=o(u[l]);if(a&&a!==""&&a!=="--"&&a!=="\r\n"){a=this._parseMultiPartBlockHeader(a);if(/StatusResponse/.test(a)){d=e.JSON.parse(a);if(d.StatusResponse){p=d.StatusResponse.failedRequests.length;if(p>0)for(c=0;c<p;c++)y=d.StatusResponse.failedRequests[c],g=y.id,m=this._getMethodName(g),h=y.error||{code:y.httpCode&&"HTTPError."+y.httpCode||""},f='{ "id" : "'+g+'", "ErrorResponse":'+e.JSON.stringify(h)+', "key" : "'+m+'Response", "'+m+'Response" : '+e.JSON.stringify(y)+', "success": false, "not_requested": false}',b.push(f)}else b.push(a)}else a&&b.push(a)}}return v="["+b.join(",")+"]",v},_parseJSON:function(t){var n=e.common.Utils.json,i,s,o;return i=n.tryParse(t),i?o={blockJSON:i,filteredBlock:t}:(s=this._sanitizeJSON(t),s&&(o=n.tryParse(s,function(t,n){e.fire("SplunkLog","debug_block_parseJSON",{error:n.message},r.value("SplunkLogLevel","sample"))}))),o},_sanitizeJSON:function(t){var n,i,s,u=/\r?\n?<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>\r?\n?/gi,a=/^\{/igm;if(t.match(u))return e.fire("SplunkLog","debug_sanitizejson",{message:"batch response parse failed because of script from new parser"},r.value("SplunkLogLevel","sample")),e.fire("util:ymstats",{name:"v3_parse_fail",tags:{agent:NeoConfig.browser,part:"json",v3failedcase:"script"},include:{farm:!0}}),t.replace(u,"");n=o(t).split("\n");if(n.length>1){e.fire("SplunkLog","debug_sanitizejson",{message:"batch response parse failed because of unexpected newline in JSON body"},r.value("SplunkLogLevel","sample")),e.fire("util:ymstats",{name:"v3_parse_fail",tags:{agent:NeoConfig.browser,part:"json",v3failedcase:"newline"},include:{farm:!0}});for(s=0;s<n.length;s++){i=o(n[s]);if(i.match(a))return i}}return""},_parseMultiPartBlockHeader:function(t){var n,i,s,u,a,f,l,c,h,p=!1,d,v;if(!t)return;l=t.indexOf("\r\n\r\n");if(l<0)return;return f=t.substr(0,l),a=this._parseHeader(f),n=o(t.substr(l+1)),a&&(i=a["content-requestid"],s=a["status-code"],u=a["content-type"]),i||(e.fire("SplunkLog","debug_parseMultiPartBlockHeader",{headerText:f,header:a},r.value("SplunkLogLevel","sample")),e.fire("util:ymstats",{name:"v3_parse_fail",tags:{agent:NeoConfig.browser,part:"header",v3failedcase:"emptyheader"},include:{farm:!0}})),u&&u.indexOf("application/json")!==-1?(v=this._parseJSON(n),c=v.blockJSON,n=v.filteredBlock,d=this._getMethodName(i),p=this._extractError(c,d),c?p?h='{ "id" : "'+i+'", "key" : "'+d+'Response", "ErrorResponse" : '+e.JSON.stringify(p)+', "success": false}':h='{ "id" : "'+i+'", "key" : "'+d+'Response", "'+d+'Response" : '+n+', "success": true}':(p={code:"parse",message:"JSON Parse Error for unknown reason"},e.fire("util:ymstats"
,{name:"v3_parse_fail",tags:{agent:NeoConfig.browser,part:"body",v3failedcase:"unknown"},include:{farm:!0}}),h='{ "id" : "'+i+'", "key" : "'+d+'Response", "ErrorResponse" : '+e.JSON.stringify(p)+', "success": false}')):s!=="200"&&parseInt(s,10)>=400&&u&&u.indexOf("html")!==-1&&(d=this._getMethodName(i),p={code:"HTTPError."+s,message:"Server Error:HTTPError."+s},h='{ "id" : "'+i+'", "key" : "'+d+'Response", "ErrorResponse" : '+e.JSON.stringify(p)+', "success": false}'),h},_extractError:function(e,t){var n;return e?(n=e.result,!n&&e.error?e.error:t==="GetCids"&&n&&n.errors&&n.errors.length?n.errors[0]:!1):{}},_getMethodName:function(e){var t;if(!e)return;return e&&(e.indexOf("LMT_")>=0||e==="listmessagesinthread")?t="ListMessagesInThread":e&&(e.indexOf("GDM_")>=0||e==="getdisplaymessage")?t="GetDisplayMessage":e&&e==="getcids"?t="GetCids":t=e,t},isSSL:function(){return window.location.protocol==="https:"},rand:function(e){return Math.floor(Math.random()*e)},verify:function(e,t){if(e)return;throw new Error(t)},isControlActive:function(t){var n=e.one("html"),r=n.one("body"),i=document.activeElement&&e.one(document.activeElement),s={INPUT:1,TEXTAREA:1,SELECT:1,BUTTON:1};if(n.hasClass("dlg-show")||n.hasClass("themes")||r.hasClass("boss"))return!0;if(i&&typeof i.ancestor=="function")if(i.ancestor(".optionMenu",!0)||i.ancestor(".modal",!0)||!t&&(i.ancestor('[contenteditable="true"]',!0)||s[i.get("nodeName")]))return!0;return!1},convertToBoolString:function(e){return(!!e).toString()},isLaunchOnboardingShown:function(){return NeoConfig.onboarding&&NeoConfig.onboarding.isLaunchOnboardingShown?!0:!1},setLaunchOnboardingShown:function(e){NeoConfig.onboarding.isLaunchOnboardingShown=e?1:0},isCalloutShown:function(t){return NeoConfig.onboardingList?e.mail.ui.onboarding&&e.mail.ui.onboarding.calloutListModel?e.mail.ui.onboarding.calloutListModel.isShown(t):!1:!0},wcopyWrapper:function(e,r){return n.enabled("dataStoreDeepObserved")?t.wcopyWithProcessor(e,r,function(e){typeof e=="object"&&Object.observe&&Object.observe(e,t._observeFunction)}):n.enabled("dataStoreReference")?e:t.wcopy(e,r)},wcopy:function(e,n){return t.wcopyWithProcessor(e,n)},wcopyWithProcessor:function(e,n,r){var i=Array.isArray(e),s,o=e?i?[]:{}:e;n=n||{};for(s in e)e.hasOwnProperty(s)&&typeof e[s]=="object"&&e[s]?o[s]=n[s]?e[s]:t.wcopy(e[s]):e.hasOwnProperty(s)&&(o[s]=e[s]);return typeof r=="function"&&r(o),o},truncateString:function(e,t,n){var r="";return e=e||"",t=t||0,n=n!==undefined?n:"...",r=e,e.length>t&&(r=e.substr(0,t-n.length)+n),r},getSegmentData:function(e){var t={activeDays:-1,currSegScore:-1,inactiveDays:-1,prevSegScore:-1};return typeof NeoConfig.athenaSegData=="object"&&e&&NeoConfig.athenaSegData[e]?NeoConfig.athenaSegData[e]:t},getPhoneNumber:function(){return NeoConfig.recoveryPhone||""},getPhoneNumberWithoutCC:function(e){var t=/^(1-)?(\d{10})$/,n="",r;if(e){e=e.toString(),r=e.match(t);if(r)return r[2]}return n},getFormattedPhoneNumber:function(e){var t=/^(1-)?(\d{3})(\d{3})(\d{4})$/,n="";return e&&(e=e.toString(),e.replace(t,function(e,t,r,i,s){n="+1 ("+r+") "+i+"-"+s})),n},isValidUSPhoneNumber:function(e){var t=/^(1-)?(\d{10})$/;return e?(e=e.toString(),t.test(e)):!1},removeYUIIdAttributes:function(e){var t=e.all('[id^="yui_3_"]');return t.size()&&t.removeAttribute("id"),e},getTransparentSVG:function(){return t.escapeHtml("data:image/svg+xml,"+encodeURIComponent('<svg width="10" height="10" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><rect height="10" width="10" y="0" x="0" fill-opacity="0.4" fill="#BBBBBB"/></g></svg>'))},norrinOptInXhrCall:function(){var n="/neo/optin?ymreqid="+(e.common.net.Session.genReqID?e.common.net.Session.genReqID():"NO_YMREQID_LOADED")+"&ncrumb="+NeoConfig.ncrumb,r={method:"GET",on:{complete:function(e,n){t.fireNorrinOnboardStat("norrin_optin_status",{status:n.status}),window.location=t.settings.value("norrinUrl","https://mg.mail.yahoo.com/d/folders/1")}}};return e.io(n,r)},fireNorrinOnboardStat:function(t,n){var r={name:t,include:{bucket:!0}};n&&(r.tags=n),e.fire("util:ymstats",r),e.fire("mt:click",{action:t})},isEligibleForUnsubSuggestion:function(t){var r=t?!0:e.mail.model.DataStore.Accounts.getCurrentAccount().isPrimary,i=!1,s=this.getSegmentData("webMail").currSegScore;for(var o in NeoConfig.accounts)if(o!=="primaryAccount"&&o!=="imapInAccounts"&&o!=="ALL"){i=!0;break}return n.enabled("unsubscribe")&&r&&!i&&s&&s<5?!0:!1}});if(window.hasOwnProperty&&window.hasOwnProperty("getComputedStyle")){var f=window.getComputedStyle,l=window.Window&&window.Window.prototype||Object.getPrototypeOf(window);delete window.getComputedStyle,l.getComputedStyle=function(e,t){return f.call(this||window,e,t)}}},"1.0.0",{requires:["querystring-parse-simple","querystring-stringify-simple","launch-utils","common-utils-jsonparse","mail-common-utils-features","mail-common-utils-settings","oop"]});


YUI.add("common-utils-apihook",function(e){var t=e.Lang,n=e.common.Utils;n.ApiHook=function(r){var i={};return r.hook=function(e,s,o){var u,a;o=o||10;if(!!s)return n.assert(e&&s),n.assert(t.isObject(s)),n.assert(!t.isArray(s)),u=i[e]=i[e]||[],u=u[o]=u[o]||[],s.hId={o:o,i:u.push(s)-1},s.hId;for(a in e)r.hook(a,e[a],o)},r.unhook=function(e,r){var s,o,u,a;if(r)n.assert(e&&(r||r===0)),n.assert(t.isString(e)&&t.isObject(r)&&t.isNumber(r.o)&&t.isNumber(r.i)),n.assert(i[e]),n.assert(i[e][r.o][r.i].hId==r),i[e][r.o][r.i]=0;else for(s in i){u=i[s];for(o in u){a=u[o];for(r in a)a[r]==e[s]&&(a[r]=0)}}},function(r,s,o,u,a){function b(){function w(e,n){if(t.isString(e))s=e,h=p=0,n&&(r=n,m=i[r]||[]),c=m[0];else{l=l||1;if(t.isFunction(e))return y.abort=function(){var t=e();return l=2,t===undefined?1:t},v("async",r,u),function(e,t,n){return l==1&&(v("resume",r,u),o=e||o,y.abort=g,l=0,t&&(s=t,p=0,h=n||0),b()),l==1};if(e){if(!t.isObject(e)){l=0,o=n||o,b();return}y.abort(),y.abort=function(){return e.abort()}}l=2}}while(h<m.length){c=m[h];while(c&&!l&&p<c.length){f=c[p++];if(f){t.isFunction(f)||(f=f[s]);try{o=f&&f(o,u,w,s)||o}catch(E){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-utils-apihook:1",E,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-utils-apihook:1"),d=["HookFailure",r,s,h,p-1].join("_"),e.use("common-utils-error",function(){n.error.report("apihook:"+d,E,1,1,1)})}}}if(l)break;h++,p=0}if(!l){l=2,y.abort=function(){},f=a;if(f){t.isFunction(f)||(f=f[s]);try{f&&f(o,a,s,u)}catch(E){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-common-utils-apihook:2",E,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-common-utils-apihook:2"),d="CbkFailure_"+r+"_"+s,e.use("common-utils-error",function(){n.error.report("apihook:"+d,E,1,1,1)})}}}return y}var f,l,c,h=0,p=0,d,v=a&&a.notify||function(){},m=i[r]||[],g=function(){return l=2,1},y={abort:g};return n.assert(t.isFunction(v)),b()}}},"1.0.0",{requires:["common-utils"]});


YUI.add("common-user-session",function(e){var t=e.common,n=t.persist,r,i;t.UserSession={getState:function(){var e=n.getCookie("Y"),t=e&&e.get("l");return{user:t,newuser:t&&t!==i,loggedout:!t}},update:function(){var e=this.getState();i=e.user},same:function(){var e=this.getState();return!e.newuser&&!e.loggedout}},r=NeoConfig.initCookieData||t.UserSession.getState(),i=r.user},"1.0.0",{requires:["common-persist-cookie-data","common-utils"]});


YUI.add("mail-controller-parkqueue",function(e){e.namespace("mail");var t=function(){var e=this;e.parkQueue=[],e.parkIt=0,e.parkTimer=0};e.mix(t.prototype,{park:function(e,t){function i(){if(e.parkIdx===undefined)return;n.parkQueue[e.parkIdx]=0;var t=n.parkQueue.length;while(t--)if(n.parkQueue[t])return;n.parkIt=0}function s(){return}function o(){n.parkTimer=0,n.parkIt&&(n.parkIt=0,n.doUnpark())}var n=this;try{if(e.batch){if(e.batchOps.parkMethod){e.batchOps.resumeCtx&&e.batchOps.resumeCtx.method!==e.method&&e.batchOps.resumeCtx.resumeFn.push({ctx:e,resumeFn:t(s)});return}e.batchOps.parkMethod=e.method}n.parkIt?(e.parkIdx=n.parkQueue.push(e)-1,e.batch&&(e.batchOps.resumeCtx={method:e.method,resumeFn:[]}),e.resume=t(i)):(n.parkTimer&&clearTimeout(n.parkTimer),n.parkTimer=setTimeout(o,3e4)),e.unparkIt=1,n.parkIt=1}catch(r){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-parkqueue:1",r,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-parkqueue:1")}},unpark:function(e,t){var n=this;t!=="pre"&&e.unparkIt&&(e.unparkIt=0,setTimeout(function(){n.doUnpark.apply(n,arguments)},0))},doUnpark:function(){function r(e){return e.parms.msg||e.parms.msgs||!e.parms.prefetch}function i(n){var i,s,o,u=[],a=t.parkQueue.length;while(a--)if((i=t.parkQueue[a])&&(!n||r(i))){t.parkQueue[a]=0;if(n)while(a--)(s=t.parkQueue[a])&&!r(s)&&(t.parkQueue[a]=0);t.parkIt=0,i.batchOps&&i.batchOps.resumeCtx&&i.batchOps.resumeCtx.resumeFn.length>0&&(u=e.clone(i.batchOps.resumeCtx.resumeFn),i.batchOps.resumeCtx=null),i.resume(i.parms,"pre");for(o=0;o<u.length;o++)u[o].resumeFn(u[o].ctx.params,"pre");return 1}n||(t.parkIt=0,t.parkQueue.length=0)}var t=this;try{i(1)||i()}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-parkqueue:2",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-parkqueue:2")}}}),e.mail.ParkQueue=new t});


YUI.add("mail-controller-base",function(e){function v(e,t,n){return{reason:t,data:e,fault:n,code:n&&n.code}}function m(t,n,r,s,o,u,a){function d(e,t,n,r){var i;p.api=e,p.method=t,p.cfg=h&&h[e],p.canLeadToYdod=!1,r&&(p.reason=r);if(t==="FlagMessages"||t==="FlagThreads"){f=n.setFlags;if(f.spam||f.ham||f.sendercompromised||f.phished||f.notmymail)p.cfg=h.spam}p.parms=n;if(typeof n=="object"){c=p.origParms={};for(i in n)c[i]=n[i];c=p.modParms={};for(i in n)c[i]=n[i]}else p.origParms=p.modParms=n;p.cfg&&n[p.batchOps.entity]&&n[p.batchOps.entity].length>250*p.cfg.bs&&(p.canLeadToYdod=!0)}var f,c,h=t.bulkOps,p={controller:t,api:n,method:r,reason:a,cfg:h&&h[n],custom:{},start:0,size:0,batchOps:s,batch:s.batch,getBatch:function(){return p.batch=1,_(s)},newApi:d,opNum:l++,deBatch:1};return i[t.ns].entity&&(p.batchOps.entity=i[t.ns].entity),a||(p.reason=n,o=o||{},!u&&(o.success||o.failure)&&(u=o,o={}),u=u||{}),p.cbk=u,s.cbk||(u=s.cbk=e.Object(u),u.success=u.failure=0),d(n,r,o),p.batchIdx=s.push(p)-1,s.count++,p}function g(e,t,n,r,s,o){n||(n=[],n.count=0,n.waitCnt=0);var u=m(this,e,t,n,r,s,o);return u.abort=i[this.ns].ch(e,"pre",u.parms,u,u.cbk),u.abort}function y(e,t,r,i){if(t.deBatch&&i!=="pre"){var s=t.batchOps;t.deBatch=0,s[t.batchIdx]=0,s.count--,typeof t.waitIdx!="undefined"&&(c[t.waitIdx]=0,s.waitCnt--),n||x("deBatchHook")}}function b(e,t,n,r){if(t.batch&&r!=="pre"){var i,s=t.batchOps,o=s.cbk,u=s.response.result.response[t.batchIdx]={};u[t.method+"Response"]=e,s.envCnt++,s.envCnt===s.length&&o&&(i=o.success,i&&i(u))}}function w(t,r,s){var o,u=0,a=r.batchOps,f=r.method,l=i[r.controller.ns],h=l.noDelay,p=l.isdup,d=function(){c[r.waitIdx]=0,a[r.batchIdx]=0,a.waitCnt--,a.count--},v=function(){o.dups[r.dupIdx]=0};if(p&&(p=p[f]))while(u<c.length)if((o=c[u++])&&o.method===f&&p(o.parms,t,o,r,s)){y(t,r),o.dups=o.dups||[],r.dupIdx=o.dups.push(r)-1,r.resume=s(v);return}a.batch||(a.ready=1),a.waitCnt++;if(a.batch||!h||!h[r.api]){r.waitIdx=c.push(r)-1;if(n||!a.ready||a.waitCnt!==a.count)r.resume=s(d),r.delayed=1;else{S(),u=0;while(u<a.length)(r=a[u++])&&r.delayed&&(r.delayed=0,r.resume())}}e.fire("BaseController:delayHook",r,n)}function E(){r&&(clearTimeout(r),r=0)}function S(){E(),r=setTimeout(function(){x("resetForceResumeTimer")},NeoConfig.controllerForceResume||3e4)}function x(e){S();var t,n,r,i=0,s=0,o=c.length;while(i<o){n=c[i++];if(n){r=1,t=n.batchOps;if(t.ready&&t.waitCnt===t.count){s=t.length;while(s)n=t[--s],n&&(c[n.waitIdx]=0,n.delayed=0,n.resume()||(t[n.batchIdx]=0,t.waitCnt--,t.count--));if(t.count!==0&&!t.readonly)return}}}r||(c.length=0),E()}function T(e,t,n){var r=0,i=t.batchOps,s=function(){return o()},o=function(){while(r<i.length)t=i[r++],t&&(c[t.waitIdx]=0);x("transportHook")};t.resume=n(s),t.parms=e,t.deBatch=0,--i.waitCnt||(o=M(i,i.cbk))}function N(e,t,n,r){var i,s=t.dups;if(s)while(s.length)i=s.shift(),i&&i.resume(e,r)}function C(e,t){var n,r=e.cfg,i=e.parms,s=i[t];if(r&&s&&(e.count=n=s.length))return e.time=n*(e.cost=1e3/r.bs),e.time}function k(e,t){var n,r,i,s,o=0,u=0,a=new Date,f=a-t.bst,l=a-t.st;if(f){t.bst=a,u=800/f-.8,t.ie+=f-1e3,u-=.5*t.ie/l,t.la&&(i=.5*u*u*(1+1/t.la),i=i<-0.5?-0.5:i>.5?.5:i,u+=i),t.la=u;while(e[o])s=e[o++],n=s.cfg,n&&(r=n.bs,r+=r*u,n.min>r&&(r=n.min),n.max<r&&(r=n.max),n.bs=r)}}function L(t,n,r){try{var i,s,o,u=r.body.result,a,f=0,l;NeoConfig.enable_spdy_support?a=r.getResponseHeader("X-Server-Chain")||"":a=r.responseHeaders&&r.responseHeaders["X-Server-Chain"]||"",o=O(r);while(n[f]){i=n[f],i.cnd="success",s=u;if(t)if(NeoConfig.hasConvV3&&r.multipart){for(l=0;l<u.response.length;l++)if(i.origParms.chain&&u.response[l].id===i.origParms.chain.id||!i.origParms.chain&&u.response[l].hasOwnProperty(i.method+"Response")){s=u.response[l];if(s.success||s.not_requested)s=s[i.method+"Response"];else{s=s.ErrorResponse,i.cnd="failure";if(i.bulk)return s}break}}else{s=u.response[f];if(s.success)s=s[i.method+"Response"];else{s=s.ErrorResponse,i.cnd="failure";if(i.bulk)return s}}f++,i.start+=i.size,i.cfg&&i.resp&&i.resp.mid&&s.mid&&(s.mid=i.resp.mid.concat(s.mid)),i.resp=s,e.mix(i.resp,{callPerf:o}),NeoConfig.log_error_yapache&&i.method==="GetDisplayMessage"&&e.mix(i.resp,{allHeadersText:r.allHeadersText||"",request:r.request||"",responseText:r.responseText||""})}}catch(c){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-base:1",c,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-base:1")}}function A(e,t,n){var r,i,s,o;return e==="failure"?n:t==="ListFolders"||t==="ListMessages"?"<filtered>":t==="ListFolderThreads"?n?(!n.folder||!n.conversations?r={LFTErrorResp:n}:r={total:n.folder.total,conv:n.conversations.length},r):"":t==="GetDisplayMessage"?n?(i=n.message[0]?n.message[0].mid:"",o=n.folder&&n.folder.folderInfo?n.folder.folderInfo.fid:"",r={mid:i,fid:o,perf:n.callPerf},r):"":t==="ListMessagesInThread"?n?(s=n.conversation?n.conversation.cid:"",o=n.folder&&n.folder.folderInfo?n.folder.folderInfo.fid:"",r={cid:s,fid:o,perf:n.callPerf},r):"":n}function O(e){var t={},n;return e.curlTime&&(t.curlTime=e.curlTime),e.getResponseHeader&&(n=parseInt(e.getResponseHeader("X-Response-Time"),10)||parseInt(e.getResponseHeader("X-Server-Response-Time"),10))&&(t.serverTime=n),t}function M(t,n){function $(){r=m=p=l=0,b=[],w=[];while(r<t.length){i=t[r++];if(i){g&&i.size&&(g.processed+=i.size);if(i.complete)c[i.waitIdx]=0,t[i.batchIdx]=0,i.resume(i.resp,i.cnd),f[i.method]--;else{C(i,V)&&(l+=i.cost,p+=i.time,m+=i.count);if(!g||!i.size)f[i.method]=f[i.method]||0,f[i.method]++;b.push(i)}}}l&&(U=1e3/l|0),(I=t[0])&&(I=I.cfg)&&I.fixed&&(U=I.fixed,t[0].parms[V].length<U*2.5&&(R=0)),y||(y=1,p<2e3?U*=9:R&&(y={ie:0,la:0,bn:0},y.bst=y.st=new Date,g={processed:0,total:m})),g&&(g.timeleft=p),F=0,r=0,a=[],W=[];while((i=b[r++])&&(i.cfg||!F)){z=i.parms.chain,T=z||{},T[E=i.method]=O={},_=i.parms,delete _.chain;for(var e in _)_.hasOwnProperty(e)&&(O[e]=_[e]);a.push(T),i.cbk=i.cbk||{},i.cbk.method=i.cbk.method||E,q=T.
id||i.parms&&i.parms.id,q&&(i.cbk.id=q),W.push(i.cbk),w.push(i);if(i.cfg){i.size=U,j=N=i.start,N+=U,O[V]=O[V].slice(j,N);if(_[V].length>N){i.bulk=F=1;continue}}i.complete=1}B=a.length,B>1&&(X.batchopcbk=W,P=!0);if(!M){try{g&&n&&(A=n.progress,A&&A(g))}catch(o){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-base:2",o,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-base:2")}B&&(P?a.length/h<=1?s=u.net.Transport.request(H?"BatchExecuteGDM":"BatchExecute",{call:a},X,!0):J(a,X,!0,!1):s=u.net.Transport.request(E,O,X,!0))}(M||!B)&&x("transport")}function J(e,t,n,r){var i=e.slice(0,h),s=e.slice(h);u.net.Transport.request("BatchExecute",{call:i},{success:function(e){var n=e&&e.body&&e.body.result,i=r&&r.body&&r.body.result;i&&n&&(n.response=n.response.concat(i.response)),s.length>=1?J(s,t,!0,e):t.success(e)},failure:function(e){t.failure(e)}},!0)}function K(e){var t=w[0]&&w[0].canLeadToYdod,n=w[0]&&o.getVal(w[0],"controller.ydodRequiredDelay"),r=0;return t&&n&&e>0&&(r=n-e),Math.max(0,r)}var r,i,s,a,l,p,m,g,y,b,w,E,T,N,A,O,M,_,D,P,H,B,j,F,I,q="",R=1,U=0,z,W,X=e.Object(n||{}),V=t.entity?t.entity:"mid";return X.success=function(t){var n=0;S(),t&&(e.fire("util:ymstats",{name:"webservice_latency",unit:"ms",type:"duration",dataum:t.curlTime,tags:{api:E},include:{farm:!0}}),e.fire("SplunkLog","webservice_latency",{farm:NeoConfig.farm,isForce:o.features.enabled("force"),feColo:NeoConfig.colo,mbColo:NeoConfig.mbColo,userColo:NeoConfig.ABOriginColo||"NA",country:NeoConfig.ipCountry,api:E,duration:t.curlTime,size:t.responseText&&t.responseText.length},"sample")),k(w,y),L(P,w,t),n=K(t.curlTime),n===0?$():e.later(n,this,$)},X.failure=function(e){e.body&&e.body.result&&L(P,w,e),D(e,"failure")},$(),D=function(e,n){if(!M){e=e||{fault:"aborted"},M=!0,r=0;while(r<t.length)i=t[r++],i&&(c[i.waitIdx]=0,i.complete=1,i.cnd!=="success"&&(i.cnd=n||"aborted",i.resp=v(e,d.failed,e.fault)));n!=="aborted"&&$(),s&&s.abort(),x("abort")}},D}function _(t){var r=t.intf;if(r)return r;var s,u,f,l;r=t.intf={execute:function(r){return t.ready=1,t.cbk=r,e.fire("BaseController:execute",t,n,c),n||x("makeBatch"),{abort:function(){var e=0;while(e<t.length)l=t[e++],l&&l.abort()}}},setAsReadOp:function(e){t.readonly=e||!1}},t.envCnt=0,t.response={error:null,result:{response:[]}};for(s in i){u=i[s].batchable;if(u){r[s]=o.wcopy(r),r[s].ns=s,r[s].bulkOps=a[s].bulkOps;for(f in u)r[s][f]=e.bind(g,r[s],f,u[f],t)}}return t.batch=1,t.count=t.length,t.waitCnt=0,r}function D(t,n,r){function f(){var n;if(r.status===500||r.status===400){i=r.fault.code,NeoConfig.hasConvV3&&!r.body&&(r.body=e.JSON.parse(r.responseText),i=r.body.code,a=r.body.message);if(/SessionIdReissue/.test(i)||/Reissuing session ID/.test(a))s=402;else if(/Credentials/.test(i)||/Credentials/.test(a))s=401,n={stat:i+"_"+o.method}}t.callDefault(s,n,1)}var i,s=null,o,a;if((o=r.callback)&&o.service==="mail")return e.use("mail-error",function(e){u.Error?u.Error.handle(t,n,r):f()}),t.isdone()||t.async(f)}var t,n,r,i={},s=e.common.net.Error,o=e.common.Utils,u=e.mail,a=u.Controller={},f={},l=0,c=[],h=10,p={fixParms:2,cacheCheck:4,ydodCheck:8,dupcheck:12,optimistic:14,gdmDelay:16,delay:18,transport:20,deBatch:2,unpark:4,dupcbk:6,cache:8,resume:10,envelope:12,usercbk:30},d={notfound:1,moved:2,request:3,failed:4,baddata:5,wserror:6,_reservedIdx:20};a.extend=function(n,r){var s,u,f,l=a[n];l||(l=a[n]=e.clone(t),l.ns=n,i[n]={},i[n].ch=o.ApiHook(l)),r=r||{},r.ch=i[n].ch,r.order=p,e.mix(i[n],r,0,0,0,1),u=r&&r.passthru;if(u)for(s in u)l[s]=e.bind(g,l,s,u[s],0),l.hook(s,{pre:w},p.delay),l.hook(s,{pre:T},p.transport),l.hook(s,N,1),l.hook(s,y,p.deBatch),l.hook(s,b,p.envelope);f=r&&r.batchable;if(f)for(s in f)u[s]||(l.hook(s,{pre:w},p.delay),l.hook(s,{pre:T},p.transport),l.hook(s,y,p.deBatch),l.hook(s,b,p.envelope));return l},a.batch=function(){return _([])},t={Error:d,abort:function(e){e&&e.abort()},_error:v},s.onError(D)},"1.0.0",{requires:["mail-net-transport","common-net-error-base","common-utils","common-utils-apihook","mail-common-utils-features"]});


YUI.add("mail-controller-messages",function(e){function I(t){e.use("mail-debug",function(){confirm("Y! Internal: Found invalid message query param.\nPlease click OK to send for Y!Mail Engineering diagnosis.")&&n.Debug.emailIssue(t)})}function R(t,n,r){var i=n.method,o="passive";NeoGV.isYdod&&(s.settings.value("ydodActiveAPI",[]).indexOf(i)>-1&&(o="active"),e.fire("util:ymstats",{name:"ydodBlock",tags:{api:i,mode:o},include:{farm:!0}}),o==="active"&&r("failure"))}function U(e,t,n){var r,i;if(F.isDraftFid(t))return"none";switch(e){case"0":i="none";break;default:i="all"}return strings.str_cfg_tog_old_imageblock?e==="b"&&(i=t==="%40B%40Bulk"?"all":"none"):(F.isSpamFid(t)&&(i="all"),e==="b"&&n&&(r=n.flags)&&r.inAddressBook&&(i="none")),i}function z(t){e.fire("util:ymstats",{name:t,unit:"requests",type:"gauge",dataum:1,tags:{bandwidth:NeoConfig.bandwidthMode?NeoConfig.bandwidthMode:"broadband",isMailPlus:NeoConfig.hasAds?0:1}})}function W(e){var t,n,r,i,s;if(e.batch&&e.batchOps&&(s=e.origParms.chain)&&(n=e.batchOps.response)&&s.dependency&&n.result&&(r=n.result.response))for(t=0;t<r.length;t++)if(r[t]&&(i=r[t].ListMessagesInThreadResponse)&&i.chainedLMTMsg&&i.chainedLMTId===s.dependency[0])return i;return null}function X(e,t,n){function r(){k[t.parkIdx]=0;var e=k.length;while(e--)if(k[e])return;L=0}function i(){A=0,L&&(L=0,$())}if(NeoConfig.hasConvPerf){f.park(t,n);return}L?(t.parkIdx=k.push(t)-1,t.resume=n(r)):(A&&clearTimeout(A),A=setTimeout(i,3e4)),t.unparkIt=1,L=1}function V(e,t,n,r){if(NeoConfig.hasConvPerf){f.unpark(t,r);return}r!=="pre"&&t.unparkIt&&(t.unparkIt=0,setTimeout($,0))}function $(){function e(e){var t,n,r=k.length;while(r--)if((t=k[r])&&(!e||t.parms.msg)){k[r]=0;if(e)while(r--)(n=k[r])&&!n.parms.msg&&(k[r]=0);return L=0,t.resume(t.parms,"pre"),1}e||(L=0,k.length=0)}e(1)||e()}function J(t,n,r){function O(e,t){var n,r=c(e.mid),o=t&&t.truncateAt,u;return n=!t||!r||s.congruent(t,r,!0,{truncateAt:1}),n&&(u=i.get(m,e))&&u.part&&(!u.isTruncated||o&&r.truncateAt>o||u.isTruncated&&typeof o=="undefined")&&u}function D(e){var n=e.mid,r=c(n),i=NeoConfig.low_bandwidth||parseInt(NeoConfig.noLiveWords,10)===1||strings.str_cfg_tog_disable_livewords?"none":"inline",o;return S.lw&&(i=S.lw==="1"?"inline":"none"),o=r?s.merge({},r):{fid:m,prime:t.cachekey,enableRetry:!0,textToHtml:!0,urlDetection:!0,emailDetection:!0,qtAnnotate:{enable:!0},emailComposeUrl:"mailto:%e%",truncateAt:h,charsetHint:"",annotateOption:{annotateText:i},bidiDetection:NeoConfig.bidi},e.charset&&(o.charsetHint=e.charset),NeoConfig.mentos_enabled&&(o.MessageHeaders=["Authentication-Results","X-Rocket-Track"]),b&&s.merge(o,b,!0),u.isNumber(o.truncateAt)||delete o.truncateAt,delete o.midRequest,o}function H(e,n){var r=e.mid,i=c(r),o=i&&i.midRequest,u=o?s.merge({},o):{blockImages:U(L,m==="$(fid)"?t.ofid:m,e),restrictCSS:!0,expandCIDReferences:!0,enableWarnings:!0,bidiDetection:NeoConfig.bidi};return b&&s.merge(u,b.midRequest||{},!0),u.mid=r,u.cachekey=e.cachekey||t.cachekey,u.cachekey||(u.cachekey=n?"PrimeOther":"Other"),u}function F(e){var t=c(e.mid),n=t&&t.midRequest.cachekey||"Neighbors";return v[n]||(v[n]=0),v[n]++,n}function R(){I("GDM Multi primeMsg bad param:\n\n"+e.JSON.stringify(y||{}))}function W(){var e,t,n;for(o=0;f&&o<f.length;o++){l=f[o];if(!l)continue;s.assert(!NeoConfig.isInternal||l.mid,"badparam-get",1,R),C&&C.no_scroll_to_msg&&delete C.no_scroll_to_msg,t=C.midRequest&&C.midRequest.blockImages=="none",n=O(l,C),e=!n||t;if(l.mid&&e){A||(g++,z(B));if(E&&s.congruent(E,D(l),!0)||(E=D(l)))a<P?x.push(H(l,!1)):N.push(H(l,!1).mid),a++}else n&&(z(j),d=F(l),p[l.mid]|=1,T.push(n))}}var o,a=0,f=t.msgs,l,m=t.fid,y=t.prefetch,b=t.ovparams,w=t.chain,E,x=[],T=[],N=[],C=b,k=n.custom,L=e.common.persist.UserData.get("userUIPref.imageBlocking"),A=n.parkIdx!==undefined;if(!(t&&t.fid&&(t.msgs||t.message&&t.message.length||t.chain&&t.chain.dependency))){r("failure");var q=e.JSON.stringify(t||{});return s.netError("GDMBadParams:multi:"+q+":"+NeoConfig.loginId),e.fire("MailLog",{m:"GDMBadParams:multi",info:q,id:NeoConfig.loginId}),s.assert(!NeoConfig.isInternal,"badparam-get",1,function(){I("GDM Bad param sent:\n\n"+q)}),_(t,M.request)}n.cbk&&(n.cbk.respProps={wasCached:!0}),W();if(x.length<=0&&T.length>0)return r("success"),T;if(E){n.cbk&&n.cbk.respProps&&(n.cbk.respProps.wasCached=!1),n.cachedMsgs=T,s.assert(x.length),E.message=x,E.skippedMessage=N,k.rparams=s.merge({},E);for(o=0;o<x.length;o++)delete x[o].cachekey}return w&&E&&(E.chain=w),E&&x.length?E:r("nomsgs")}function K(t,n,r){function K(t,n){var r,o=c(t.mid),u=n&&n.truncateAt,a;return r=!n||!o||s.congruent(n,o,!0,{truncateAt:1}),e.log(r&&(a=i.get(l,t))&&a.part&&(!a.isTruncated||u&&o.truncateAt>u||a.isTruncated&&typeof u=="undefined")&&a,t.mid),r&&(a=i.get(l,t))&&a.part&&(!a.isTruncated||u&&o.truncateAt>u||a.isTruncated&&typeof u=="undefined")&&a}function Q(e){var n=e.mid,r=c(n),i=NeoConfig.low_bandwidth||parseInt(NeoConfig.noLiveWords,10)===1||strings.str_cfg_tog_disable_livewords?"none":"inline",o;return S.lw&&(i=S.lw==="1"?"inline":"none"),o=r?s.merge({},r):{fid:l,prime:t.cachekey,enableRetry:!0,textToHtml:!0,urlDetection:!0,emailDetection:!0,qtAnnotate:{enable:!0},emailComposeUrl:"mailto:%e%",truncateAt:h,charsetHint:"",annotateOption:{annotateText:i},bidiDetection:NeoConfig.bidi},e.charset&&(o.charsetHint=e.charset),NeoConfig.mentos_enabled&&(o.MessageHeaders=["Authentication-Results","X-Rocket-Track"]),w&&s.merge(o,w,!0),u.isNumber(o.truncateAt)||delete o.truncateAt,delete o.midRequest,o}function G(e,n){var r=e.mid,i=c(r),o=i&&i.midRequest,u=o?s.merge({},o):{blockImages:U($,l==="$(fid)"?t.ofid:l,e),restrictCSS:!0,expandCIDReferences:!0,enableWarnings:!0,bidiDetection:NeoConfig.bidi};return w&&s.merge(u,w.midRequest||{},!0),u.mid=r,u.cachekey=e.cachekey||t.cachekey,u.cachekey||(u.cachekey=n?"PrimeOther":"Other"),u}function Y(e){var t=c(e.mid),n=t&&t.midRequest.cachekey||"Neighbors";return v[n]||(v[n]=0),v[n]++,n}function Z(){I("GDM Prefetch bad param:\n\n"+e.JSON.stringify(b||
{}))}var o,a,f=0,l=t.fid,y=t.msg,b=!t.dontCache&&t.prefetch,w=t.ovparams,E=t.chain,C=E&&E.parameter&&E.parameter[0].destination,k,L=[],A,D=!!t.noCache,P,H=n.custom,F=null,q,R,X,V,$=e.common.persist.UserData.get("userUIPref.imageBlocking"),J=n.parkIdx!==undefined;y&&b&&(a=e.clone(t),a.msg=null,t.prefetch=null,b=null,setTimeout(function(){O.get(a,{suppressCodes:["*"]})},0)),C&&C.match(/\.mid$/)&&(F=W(n),F&&(P=F.chainedLMTMsg,l=P.sourceFolderInfo.fid,b?b=[P]:y=t.msg=P),F||(P={},b?b=[{mid:N}]:(y=t.msg={},y.mid=N)));if(!(t&&t.fid&&(t.msg&&t.msg.mid||t.prefetch||t.message&&t.message.length||t.chain&&t.chain.dependency)))return r("failure"),R=n.cbk&&n.cbk.errorPosition||0,X=e.clone(t||{}),e.mix(X,{errorPos:R,conv:NeoConfig.hasConvView}),V=e.JSON.stringify(X),s.netError("GDMBadParams:singl:"+V+":"+NeoConfig.loginId),e.fire("MailLog",{m:"GDMBadParams:singl",info:V,id:NeoConfig.loginId}),s.assert(!NeoConfig.isInternal,"badparam-get",1,function(){I("GDM Bad param sent:\n\n"+V)}),_(t,M.request);if(y){T=x(),A=!D&&K(y,w);if(A)return J&&(m--,g--),d=Y(y),p[A.mid]|=1,s.traceMsg(["CachedMessage: ","MID => ",A.mid," | ","Cache => ",d," | ","Algorithm => ",NeoConfig.preCacheModule||"unknown"].join("")),n.cbk&&(n.cbk.respProps={wasCached:!0}),r("success"),z(j),A;J||(++m,z(B)),n.cbk&&(n.cbk.respProps={wasCached:!1});if(t.cacheOnly)return r("failure"),_(y,M.notfound);J||g++,k=Q(y),L=[G(y,!0)],n.cbk&&(n.cbk.urlParams={debugmid:y.mid||"",cachekey:t.cachekey||""}),n.batch&&n.cbk&&(n.cbk.suppressNotification=!0)}for(o=0;b&&o<b.length;o++){q=b[o];if(q){s.assert(!NeoConfig.isInternal||q.mid,"badparam-get",1,Z);if(q.mid&&!K(q,w)){J||g++;if(k&&s.congruent(k,Q(q),!0)||(k=Q(q))){if(!(f<10))break;L.push(G(q,!1)),f++}}}}if(k){s.assert(L.length),k.message=L,H.rparams=s.merge({},k);for(o=0;o<L.length;o++)delete L[o].cachekey}return E&&k&&(k.chain=E),k&&L.length?k:r("nomsgs")}function Q(t,n){function I(t){var n,r,s,o,u=T||[],a=t.mid,f=i.isSearchMid(a,w);if(!e.Lang.isArray(u))return null;for(n=0;n<u.length;n++){r=u[n],o=r.sourceFolderInfo&&r.sourceFolderInfo.fid||w;if(l(a,r.mid))break;if(a===N){u.length!==1&&e.fire("MailLog",{m:"Batch chaining expects only one mid",length:u.length,curmid:r.mid}),E=u[n],t.mid=u[n].mid;break}if(i.hasMoved(a,r.mid,w,w)){(s=o!==w)||i.flush(w);break}}return n===u.length?null:{pos:n,key:t,fid:f&&w||o,msg:r,moved:s}}function q(t){var n=t.search(/<script[^>]*>/i),r,i,s,o,u={};if(n>=0){r=t.length,i=Math.max(t.search(/<\/script>/i),r),s=n!==0||i!==r?t.substring(n,i):t,o=/\bYAHOO\.Shortcuts\.mailCategories\s*=\s*(.*);/.exec(s);if(o&&o[1])try{u.categories=e.JSON.parse(o[1])}catch(a){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-messages:2",a,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-messages:2"),u.categories={}}o=/\bYAHOO\.Shortcuts\.annotationSet\s*=\s*({[\s\S]*?})\s*;/.exec(s);if(o&&o[1])try{u.annotations=e.JSON.parse(o[1])}catch(a){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-messages:3",a,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-messages:3"),u.annotations=null}return e.fire("SplunkLog","debug_shortcut",u,"critical"),u}return null}var r,o,u,a,f,h,d,v,m,g,b=n.origParms,w=b.fid,E,x=!b.dontCache,T=t.message||t,C=t.code,k,L,A,_,P=[],B=n.custom.rparams,j=B&&B.skippedMessage,F=B&&B.message;for(r=0;r<b.msgs.length;r++)j&&j.length?j.indexOf(b.msgs[r].mid)<0&&P.push(b.msgs[r]):P.push(b.msgs[r]);if(F&&(T||C)){delete B.message;for(r=0;r<P.length;r++)if(n.cachedMsgs)for(f=0;f<n.cachedMsgs.length;f++)P[r].mid===n.cachedMsgs[f].mid&&(P[r]=n.cachedMsgs[f]);for(r=0;r<F.length;r++){a=!0,k=v=null,h=I(F[r]);if(h){k=h.msg,h.moved&&(i.remove(w,F[r]),i.set(h.fid,k,"move"),v=M.moved),A=e.clone(B),A.midRequest=F[r];if(x){!b.forceCache&&(d=i.get(h.fid,k))&&(d.part&&s.congruent(c(k.mid),A,!0)?(k=d,a=!1):d.flags&&(k.flags=d.flags));if(a){i.set(h.fid,k,n.reason,!0,function(e){return O._process(e,h),e},A),p[k.mid]&&ut(),p[k.mid]=0,y++,z(H),k=i.get(h.fid,k);if(k.extend)for(o in k.extend)delete k.extend[o];else k.extend={};k.body&&k.body.display&&(k.extend.shortcuts=q(k.body.display))}}else k._param=A,O._process(k,h),i.extend(k)}else v=M.wserror;v===M.wserror&&(m=Z(F[r],C,w),g=m?m.code:"NotFound",L="GDM_Code_"+g+"_"+(b.cachekey||""),_=F[r].mid,e.use("common-utils-error",function(e){var r=tt(b.cachekey,m),i=[r,r+"_"+L,"E_getdisplaymessage"],s,o;s=et(b.cachekey,m),e.fire("util:ymstats",{name:s?"client_error":"ue_client_error",tags:{tae:4,api:"GetDisplayMessage",code:g},include:{env:!0,farm:!0}}),g==="ERROR"&&(o=G(E,t),e.fire("util:ymstats",{name:"GDM_CODE_ERROR",tags:{fid:o==="custom"?"custom":w,folderType:o,prime:s?0:1,mrd:S.umid&&S.action&&S.action==="showLetter"?1:0,conv:NeoConfig.hasConvView},include:{farm:!0}})),t.yid=D,t.isGetMulti=1,t.ua=navigator.userAgent,t.conv=NeoConfig.hasConvView?1:0,t.pp=NeoConfig.previewPanePref?1:0,t.build=NeoConfig.buildNumber,t.errorPos=n.cbk&&n.cbk.errorPosition||299,t.chained=_==="$(mid)"?1:0,m&&delete t.responseText}));for(u=0;u<P.length;u++){if(k&&P[u].mid===k.mid){P[u]=k;break}P[u].mid===_&&(P[u].msgPermDeleted=nt(m))}}}else for(r=0;r<t.length;r++)P[r].mid===t[r].mid&&(P[r]=t[r]);return P}function G(e,t){return t&&t.folder&&t.folder.folderInfo?e&&i.isSearchMid(e.mid,t.folder.folderInfo.fid)?"search":t.folder.isSystem?"system":"custom":"missing"}function Y(t,n,r){function q(t){var n,r,s,o,u=T||[],a=t.mid,f=i.isSearchMid(a,w);if(!e.Lang.isArray(u))return null;for(n=0;n<u.length;n++){r=u[n],o=r.sourceFolderInfo&&r.sourceFolderInfo.fid||w;if(l(a,r.mid))break;if(a===N){u.length!==1&&e.fire("MailLog",{m:"Batch chaining expects only one mid",length:u.length,curmid:r.mid}),E=u[n],t.mid=u[n].mid;break}if(i.hasMoved(a,r.mid,w,w)){(s=o!==w)||i.flush(w);break}}return n===u.length?null:{pos:n,key:t,fid:f&&w||o,msg:r,moved:s}}function R(t){var n=t.search(/<script[^>]*>/i),r,i,s,o,u={};if(n>=0){r=t
.length,i=Math.max(t.search(/<\/script>/i),r),s=n!==0||i!==r?t.substring(n,i):t,o=/\bYAHOO\.Shortcuts\.mailCategories\s*=\s*(.*);/.exec(s);if(o&&o[1])try{u.categories=e.JSON.parse(o[1])}catch(a){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-messages:4",a,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-messages:4"),u.categories={}}o=/\bYAHOO\.Shortcuts\.annotationSet\s*=\s*({[\s\S]*?})\s*;/.exec(s);if(o&&o[1])try{u.annotations=e.JSON.parse(o[1])}catch(a){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-messages:5",a,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-messages:5"),u.annotations=null}return e.fire("SplunkLog","debug_shortcut",u,"critical"),u}return null}var o,a,f,h,d,v,m,g,b=n.origParms,w=b.fid,E=b.msg,x=!b.dontCache,T=t.message,C=t.code,k,L,A,P,B=n.custom.rparams,j,F=B&&B.message,I=null;if(F&&(T||C)){delete B.message,E||(I=W(n))&&I.chainedLMTMsg&&(E=I.chainedLMTMsg);for(o=0;o<F.length;o++){f=!0,k=v=null,h=q(F[o]);if(h){k=h.msg,h.moved&&(k.moved=!0),A=e.clone(B),A.midRequest=F[o],A.fid==="$(fid)"&&(A.fid=n.resp.folder.folderInfo.fid),h.fid==="$(fid)"&&(h.fid=n.resp.folder.folderInfo.fid);if(x){!b.forceCache&&(d=i.get(h.fid,k))&&(d.part&&s.congruent(c(k.mid),A,!0)?(k=d,f=!1):d.flags&&(k.flags=d.flags));if(f){i.set(h.fid,k,n.reason,!0,function(e){return O._process(e,h),e},A),p[k.mid]&&ut(),p[k.mid]=0,y++,z(H),k=i.get(h.fid,k);if(k.extend)for(a in k.extend)delete k.extend[a];else k.extend={};k.body&&k.body.display&&(k.extend.shortcuts=R(k.body.display))}}else k._param=A,O._process(k,h),i.extend(k)}else v=M.wserror;v===M.wserror&&(k={debug_mid:F[o].mid||""},m=Z(F[o],C,w),g=m?m.code:"NotFound",L="GDM_Code_"+g+"_"+(b.cachekey||""),P=F[o].mid,e.use("common-utils-error",function(e){var r=tt(b.cachekey,m),i,s,o=r+"_"+L+"_MRD",a=!1;if(S.umid&&S.action){S.umid=S.umid.replace(/ /g,"+");if(E&&S.action==="showLetter"&&S.umid===E.mid){if(u.isUndefined(S.referer)||u.isUndefined(S.src)||S.referer==="unknown"&&S.src==="unknown")k.isBlockableMRD=a=!0;t.requestSrc="MRD:"+(S.src||"unknown")+":"+(S.referer||"unknown")}}i=et(b.cachekey,m),e.fire("util:ymstats",{name:i?"client_error":"ue_client_error",tags:{tae:4,api:"GetDisplayMessage",code:g},include:{env:!0,farm:!0}}),g==="ERROR"&&(s=G(E,t),e.fire("util:ymstats",{name:"GDM_CODE_ERROR",tags:{fid:s==="custom"?"custom":w,folderType:s,prime:i?0:1,mrd:S.umid&&S.action&&S.action==="showLetter"?1:0,conv:NeoConfig.hasConvView},include:{farm:!0}})),t.yid=D,t.isGetMulti=0,t.ua=navigator.userAgent,t.conv=NeoConfig.hasConvView?1:0,t.pp=NeoConfig.previewPanePref?1:0,t.build=NeoConfig.buildNumber,t.chained=P==="$(mid)"?1:0,t.errorPos=n.cbk&&n.cbk.errorPosition||299,m&&delete t.responseText})),E&&F[o].mid===E.mid&&(j={err:v,msg:k})}}else b.chain&&!E&&(E=t);n.resp&&n.resp.callPerf&&n.cbk&&(n.cbk.respProps=n.cbk.respProps||{},n.cbk.respProps.callPerf=n.resp.callPerf);if(j)return j.err?(r("failure"),_(j.msg,v,m)):(p[j.msg.mid]|=1,j.msg);E||r("noprime")}function Z(e,t,n){var r,i,s=e.mid,o=t&&t.length||0;if(s==="$(mid)"&&o===1)return t[0];for(i=0;i<o;i++){r=t[i];if(l(s,r.mid)&&r.code!=="WARN")return r}}function et(e,t){return e!=="Prime"||nt(t)}function tt(e,t){return et(e,t)?"TAE4":"UE_ALERT_TAE4"}function nt(e){return e&&e.code&&(e.code.indexOf("MessageIdsDeleted")!==-1||e.code.indexOf("MessageNotFoundInNonBulk")!==-1)}function rt(e,t,n){var r=e.startInfo,i=u.isNumber;if(NeoConfig.hasConv||NeoConfig.grid||NeoConfig.vertPane)e.responseFields={messages:{all:!0}};if(i(r)&&r<0)return n("failure"),_(e,M.request);t.cbk.stopwatch&&(t.cbk.stopwatch.getListBegin=new Date)}function it(t,n,r){n.cbk.stopwatch&&(n.cbk.stopwatch.getListEnd=new Date),e.fire("LM:complete");var s=t.folder,o=s.folderInfo.fid,u=t.messageInfo,f,l,c,h=u?u.length:0,p,d;for(d=0;d<h;d++){p=u[d];if(p&&p.errorflag==="true"){l=1;break}}if(l)return r("failure"),_(n.parms,M.baddata);n.parms&&(c=t.startInfo+n.parms.numInfo>=s.total?t.startInfo+u.length<s.total:u.length<n.parms.numInfo,c&&(s.total=t.startInfo+u.length,w||(w=1))),n.parms&&n.parms.maxMessagesToScanForContacts&&(n.reason="ruefc"),o==="%40C%40Chats"&&(f=[],e.Array.each(u,function(t){var n=e.Array.some(t.inboxservices||[],function(e){if(e.name==="src")return e.value==="mmc"?s.total--:f.push(t),!0});n||s.total--}),t.messageInfo=u=f),s&&!n.batch&&!t.startInfo&&a.Folders.set(s,null,n.reason),i.syncHeaders(o,u),n.parms&&!n.parms.autoCheckMail&&setTimeout(function(){ot(o,t.messageInfo)},500)}function st(t,n,r,i){var s,o,u,f,l=i||{},c,h=[],p,d=[],v=[],m=0;for(c=0;c<t.length;c++)p=r(t[c])||n.failure("Valid fid was not found in getMultipleMessages."),h[p]||(h[p]=[],d.push(p)),h[p].push(t[c]);n&&(n.respProps={wasCached:!0}),s=a.batch(),f=function(r,i,s,a){var f,l=[],h=[],p,g;v=v.concat(r),e.fire("MessageController:getMultipleMessagesSuccess",v),m++,i&&i.respProps&&n&&(n.respProps.wasCached=n.respProps.wasCached&&i.respProps.wasCached,a&&a.resp&&a.resp.callPerf&&!n.respProps.callPerf&&(n.respProps.callPerf=a.resp.callPerf)),g=v.length;if(m===d.length){f=[];for(c=0;c<g;c++)if(v[c].data&&v[c].data.msg)for(p=0;p<v[c].data.msg.length;p++)f[v[c].data.msg[p].mid]=v[c].data.msg[p];else f[v[c].mid]=v[c];for(c=0;c<t.length;c++)u=f[t[c].mid]||"",o=u.body||"",o?l.push(u):h.push(u);n&&n.success(l,h)}};for(c=0;c<d.length;c++)s.Messages.getMulti({fid:d[c],msgs:h[d[c]],cachekey:"Prime",ovparams:l},f);s.execute({suppressCodes:["*"]}),e.fire("MessageController:getMultipleMessages",t)}function ot(e,t){var n=NeoConfig.msgCacheUnread.split(","),r=n[0],i=n[1],s=x()-T,o={Trash:1,"%40B%40Bulk":1};if(r>0&&i>0&&s<i*60*1e3){var u=0,a,f=(new Date).getTime()/1e3-18e3,l=[];while(r>0&&u<t.length){a=t[u++];if(!(a&&!a.flags.isRead&&f<a.receivedDate&&!o[e])||!a.flags.inAddressBook&&NeoConfig.prefetchMsgsCheckMail!==1)break;l.push(a),r--}l.length>0&&O.get({fid:e,msg:null,prefetch:l,cachekey:"List"},{
suppressCodes:["*"]})}}function ut(){for(var e in p)(p[e]&3)===1&&(p[e]|=2,b++)}var t,n=e.mail,r=n.model.DataStore,i=r.Messages,s=e.common.Utils,o=s.ymmastats,u=e.Lang,a=n.Controller,f=n.ParkQueue,l=i.compareMultiVersionMids,c=i.getParam,h=NeoConfig.truncateAt||5e4,p={},d,v={Neighbors:0},m=0,g=0,y=0,b=0,w=0,E=NeoConfig.msgCacheInterval||3e4,S=s.parseQueryString()||{},x=function(){return Date.now()},T=x(),N=NeoConfig.hasConvV3?"$(mid)":"_chainedbatch",C={passthru:{send:"SendMessage",get:"GetDisplayMessage",getMulti:"GetDisplayMessage",list:"ListMessages",search:"SearchMessages",save:"SaveMessage",scan:"VirusScanAttachments"},isdup:{ListMessages:function(e,t){return e&&t&&e.fid===t.fid&&e.numInfo===t.numInfo&&e.sortKey===t.sortKey&&e.sortOrder===t.sortOrder&&e.startInfo===t.startInfo}},noDelay:{get:1}},k=[],L=0,A=0,O,M,_,D="[NONE]",P=10,H="msg_cache_add",B="msg_cache_miss",j="msg_cache_hit",F=n.ui.FolderUtils;C.batchable=C.passthru,C.entity="mid",O=a.extend("Messages",C),M=O.Error,_=O._error,t=C.order;try{D=NeoConfig.userDataObj.userSendPref.loggedInAlias}catch(q){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-controller-messages:1",q,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-controller-messages:1")}O.bulkOps={remove:{bs:100,min:100,max:1e3},flag:{bs:100,min:100,max:1e3},move:{bs:100,min:100,max:1e3},spam:{bs:20,min:20,max:50,fixed:20}},NeoConfig.forceDS||(O.bulkOps.flag={bs:300,min:300,max:1e3},O.bulkOps.move={bs:300,min:300,max:1e3}),O.ydodRequiredDelay=1200,e.mix(O,{_process:function(){},_preset:function(t){var n=NeoConfig.low_bandwidth||parseInt(NeoConfig.noLiveWords,10)===1||strings.str_cfg_tog_disable_livewords?"none":"inline";S.lw&&(n=S.lw==="1"?"inline":"none");var r=t.fid,s=t.msgObj,o={fid:r,enableRetry:!0,textToHtml:!0,urlDetection:!0,emailDetection:!0,emailComposeUrl:"mailto:%e%",truncateAt:h,charsetHint:"",annotateOption:{annotateText:n},qtAnnotate:{enable:!0},bidiDetection:NeoConfig.bidi,midRequest:t.request||{blockImages:U(e.common.persist.UserData.get("userUIPref.imageBlocking"),r,s),restrictCSS:!0,expandCIDReferences:!0,enableWarnings:!0,bidiDetection:NeoConfig.bidi,cachekey:"launch"}};s&&s.part&&s.flags&&i.set(r,s,"launch",!0,function(e){return O._process(e,{fid:r,key:o.midRequest,msg:s}),e},o)},isCertified:function(t){var n=/images|all/;return e.Array.some(t,function(e){return e.name==="allow"&&n.test(e.value)})},getQueryParams:function(e,t){var n=c(e.mid)||e._param;return t&&n&&n[t]||n},getAttachmentUrl:function(e,t,n,r,i){var o="/ya/download";e==="INBOX"&&(e="Inbox"),i&&(i=i.replace(/\?/g,"x"),i=encodeURIComponent(i));var u=(new Date).getTime().toString(),a;return t=encodeURIComponent(t),a=[NeoConfig.launch_protocol,location.hostname,o,"?fid=",encodeURIComponent(e),"&mid=",t,"&pid=",n,"&tnef=",r,"&YY=",u],i&&a.push("&file_name=",i),a.push("&appid="+s.settings.value("appid")),a.join("")},getMultipleMessages:st},!0),O.hook("get",{pre:R},t.ydodCheck),O.hook("get",{pre:K},t.cacheCheck),O.hook("get",{success:Y},t.cache),O.hook("getMulti",{pre:R},t.ydodCheck),O.hook("getMulti",{pre:J},t.cacheCheck),O.hook("getMulti",{success:Q},t.cache),O.hook("list",{pre:R},t.ydodCheck),O.hook("list",{pre:rt,success:it}),O.hook("get",{pre:X},t.gdmDelay),O.hook("get",V,t.unpark),NeoConfig.hasConvPerf&&(O.hook("getMulti",{pre:X},t.gdmDelay),O.hook("getMulti",V,t.unpark)),setInterval(function(){var e,t=NeoConfig.preCacheAlgorithm||0;for(e in v)v[e]=0;ut(),m=y=g=b=0},E),e.use("mail-controller-processbody"),e.namespace("mail.test.controller"),e.mail.test.controller.Messages={cacheMsg:ot}},"1.0.0",{requires:["launch-utils","ymma-stats","mail-controller-parkqueue","mail-controller-base","mail-controller-folders","common-persist-user-data","mail-ui-folder-utils","mail-common-utils-settings"]});


YUI.add("mail-controller-folders",function(e){"use strict";function S(e,t,n){var r;n&&n.failure&&(r=n.failure)!==undefined&&r(l._error(e,t),n.args)}function x(e,t){var n;t&&t.success&&(n=t.success)!==undefined&&n(e,t.args)}function T(t){var r=NeoConfig.checkmailExt?{forced:!1,accountId:""}:{};t=t||n.settings.value("checkMailInterval",3),l.yTimerObj&&l.yTimerObj.cancel&&l.yTimerObj.cancel(),l.yTimerObj=e.later(t*m,null,function(){d++,l.refresh(r,{success:function(){e.fire("nav:refreshCalendar"),l.triggerCheckMail()},failure:function(){l.triggerCheckMail()}})},[])}function N(e,t,n){var i=e&&e.length,s=l.Error,o=e,u;return t!==undefined&&(o=t+e),i?i>40?u=s.oversize:r.getFolderByName(o,n)||b.hasOwnProperty(e.toLowerCase())||b.hasOwnProperty(e)?u=s.exists:r.isFolderNameValid(e)||(u=s.baddata):u=s.empty,u}function C(e,t){var n,r,i,s,o,u=e&&(e.folder||[e]);for(n=0;u&&n<u.length;n++)r=u[n],r&&(s=r.folderInfo)&&(i=s.fid)?(s.fid=i=i.replace(/%2f/g,"%5c"),o=y[i],o&&(s.name=o)):t&&t.push(r);return t.length===0&&e}function k(e,t,n){var r;if(t.reason==="get"){r=u.get(e);if(r)return n("success"),r;t.reason="refresh",e={bidiDetection:NeoConfig.bidi}}else e={fid:e};return e}function L(t,n,r){var i=t&&t.forced||d>=NeoConfig.resetUnseenMsgsRefreshLimit?!0:!1,s={resetMessengerUnseen:i},o,u,l=[],c,h,p,v,m,g,y;i&&(d=0),s.bidiDetection=NeoConfig.bidi;if(t&&typeof t.accountId=="string"){c=n.cbk||{},v=t.accountId,y=function(t){var n,r,i,s,o=[],u;if((n=t.fetchResults)&&(i=n.length)){for(r=0;r<i;r++)(s=n[r].status)!=="success"&&o.push({userName:l[r].userName,status:s,server:l[r].address||l[r].server});o.length&&e.use("mail-error",function(e){u=e.mail.Error,u&&u.extFetchError(o)})}},m=E&&E.length;if(m){if(NeoConfig.am||NeoConfig.imapIn)for(u=0;u<m;u++)p=E[u],f(p.loginId)&&f(p.serverUri)&&(v===""||v===p.address)&&(g=p.serverUri.match(/^(.+?:\/\/)?(.+?)(:\d+)?$/)[2],l.push({protocol:"pop3",userName:p.loginId,server:g}));else for(u=0;u<m;u++)p=E[u],f(p.username)&&f(p.server)&&(v===""||v===p.address)&&l.push({protocol:p.protocol,userName:p.username,server:p.server});l.length&&(r(),h=e.clone(c),h.failure=null,h.success=y,o=a.batch().Folders,o.fetchExtMail({externalAccounts:l},h),o.refresh(s,c,n.reason),o.execute({suppressCodes:c&&c.suppressCodes||[]}))}}return s}function A(t,n,i){var s=n.reason,o=n.origParms,a=n.api==="refresh"||s==="refresh",f;a&&(t.folder.sort(function(e,t){var n=e.isSystem,r=t.isSystem;return n&&!r?-1:!n&&r?1:t&&t.folderInfo?e.folderInfo.name.localeCompare(t.folderInfo.name):-1}),e.common.Utils.features.enabled("emitCheckmailData")&&(f=u.getFoldersByAccount(),e.Array.forEach(f,function(n){if(!r.isInboxFid(n.folderInfo.fid))return;e.Array.forEach(t.folder,function(t){if(t.folderInfo.fid!==n.folderInfo.fid)return;e.fire("checkmail",{reason:s,fid:t.folderInfo.fid,oldUnreadCount:n.unread,newUnreadCount:t.unread})})})),l.set(t,null,s));if(n.api==="get")return a&&!(t=u.get(o))?(i("failure"),l._error(o,l.Error.notfound)):t}function O(e,t){var n,r=t.reason,i=t.origParms;n=r.match(/\.([\w\W]+)/),n=n&&n[1]||r,/^create/.test(r)?u.add(e,n):/^remove/.test(r)?u.remove(i.fid,n):/^rename/.test(r)&&u.rename({folderInfo:i},e,n),u.flush()}function M(e,t,r){var i,s,o=n.wcopy(t);e=n.sanitizeString(f(e)),i=N(e),o&&(o.success=o.failure=null),i?l.callFailure(e,i,t):(s=a.batch().Folders,s.create({name:e,bidiDetection:NeoConfig.bidi},function(e,n,r){var i=t&&t[r];i&&setTimeout(function(){i(e,n)},0)},"create"+(r?"."+r:"")),s.refresh({}),s.execute(o))}function _(e,t,r){var i=a.batch().Folders,s=n.wcopy(t);s&&(s.success=s.failure=null),i.remove({fid:e},t,"remove"+(r?"."+r:"")),i.refresh({}),i.execute(s)}function D(e,t,r){var i,s,o=n.wcopy(t);e.name=e&&e.name?n.sanitizeString(f(e.name)):"",e.bidiDetection=NeoConfig.bidi,i=N(e.name),o&&(o.success=o.failure=null),i?l.callFailure(e.name,i,t):(s=a.batch().Folders,s.rename(e,t,"rename"+(r?"."+r:"")),s.refresh({}),s.execute(o))}function P(e,t,n){var r=[];e=C(e,r),e?(u.set(e,n),l.callSuccess(e,t)):l.callFailure(r,l.baddata,t)}function H(t,n,r){var i,s=0,a=0,f,l=r==="remove",c=l&&!n,h=r==="move"||r==="add",p=l&&-1||h&&1||0,d,v,m=u.get(t);if(m){e.log("ds:folder handling message event, reason "+r+" orig unread = "+m.unread+" total  = "+m.total+" size = "+m.size);for(i=0;i<n.length;i++){d=n[i],f=d.flags&&d.flags.isRead,o.isNumber(f)&&(h?s+=f?0:1:l?s+=f?0:-1:s+=f?-1:1);if(h||l)a+=d.header&&d.header.size||0}l&&(a=-a),u.set(v={folderInfo:{fid:t},unread:c?0:m.unread+s,total:c?0:m.total+n.length*p,size:c?0:m.size+a},"ds:msg:"),(v.unread<0||v.total<0)&&e.log("Negative Folder Count: {\n	fid="+v.folderInfo.fid+"\n	reason="+r+"\n	unread="+v.unread+"\n	total="+v.total+"\n}")}}function B(t,n,i){function c(e){if(!n||e!==n)o&&!r.isSpamFid(n)&&(o.total+=l[e].total,o.unread+=l[e].unread),f&&(f.total-=l[e].total,f.unread-=l[e].unread,u.set(f,"ds:conv:"))}var s,o,a,f,l={};for(s=0;s<i.length;s++)j(l,i[s]);n&&(o=e.clone(u.get(n)));for(a in l)f=e.clone(u.get(a)),r.isSentFid(t)?r.isSentFid(a)&&c(a,n):r.isTrashFid(t)||r.isSpamFid(t)?c(a,n):r.isDraftFid(t)?r.isDraftFid(a)&&c(a,n):!r.isSentFid(a)&&!r.isDraftFid(a)&&c(a,n);o&&(o.unread!==u.get(n).unread||o.total!==u.get(n).total)&&u.set(o,"ds:conv:")}function j(e,t){var n,r;if(t.msgCountsByFolder)for(r=0;r<t.msgCountsByFolder.length;r++){n=t.msgCountsByFolder[r].fid;if(n==="@B@Bulk"||n==="Bulk%20Mail"&&t.flags&&t.flags.isSpam)n="%40B%40Bulk";e[n]=e[n]||{total:0,unread:0},e[n].total+=t.msgCountsByFolder[r].total,e[n].unread+=t.msgCountsByFolder[r].unread}}function F(n,i){if(e.Lang.isUndefined(i)||e.Lang.isUndefined(i.isRead))return;e.Array.each(n,function(n){var s=n.fid;if(r.isDraftFid(s))return;e.Array.each(n.msgCountsByFolder,function(e){var s=u.get(e.fid==="Bulk%20Mail"&&n.flags&&n.flags.isSpam?"%40B%40Bulk":e.fid),o=t.model.ConvStore.Conversations,a=o.isCached(e.fid,n),f;if(s===null||r.isDraftFid(e.fid)||a)return;f=e.unread||e.total,i.isRead===0?s.unread+=f:s.unread-=f,s.unread=s.unread<0?0:s.unread,u.set(s,"ds:conv:",1)})})}var t=e.mail,n=e.common.Utils,r=e.mail
.ui.FolderUtils,i=t.model.DataStore,s=e.common.persist.UserData,o=e.Lang,u=i.Folders,a=t.Controller,f=o.trim,l,c,h,p,d=0,v,m=6e4,g="%40S%40Search",y={"%40B%40Bulk":strings.spam||"Spam","%40C%40Chats":strings.str_nav_conversations||"Conversations",Draft:strings.str_nav_drafts||"Drafts"},b={},w={passthru:{refresh:"ListFolders",empty:"EmptyFolder",get:"ListFolders"},batchable:{create:"CreateFolder",refresh:"ListFolders",rename:"RenameFolder",remove:"RemoveFolder",fetchExtMail:"FetchExternalMail"}},E;l=a.extend("Folders",w),c=l.Error,p=c._reservedIdx,NeoConfig.am||NeoConfig.imapIn?E=NeoConfig.accounts.popAccounts||[]:(E=s.get("externalAccounts")||{},E=E.extAccount||[]),b[strings.str_folder_reserved_inbox]=b[strings.str_folder_reserved_conversations]=b[strings.str_folder_reserved_drafts]=b[strings.str_folder_reserved_sent]=b[strings.str_folder_reserved_spam]=b[strings.str_folder_reserved_trash]=b[strings.str_folder_reserved_search]=b[strings.str_folder_reserved_inbox_lower]=b[strings.str_folder_reserved_conversations_lower]=b[strings.str_folder_reserved_drafts_lower]=b[strings.str_folder_reserved_sent_lower]=b[strings.str_folder_reserved_spam_lower]=b[strings.str_folder_reserved_trash_lower]=b[strings.str_folder_reserved_search_lower]=b[strings.str_folder_reserved_inbox_upper]=b[strings.str_folder_reserved_conversations_upper]=b[strings.str_folder_reserved_drafts_upper]=b[strings.str_folder_reserved_sent_upper]=b[strings.str_folder_reserved_spam_upper]=b[strings.str_folder_reserved_trash_upper]=b[strings.str_folder_reserved_search_upper]=1,h={success:O},l.hook({create:h,remove:h,rename:h,empty:{pre:k,success:function(t,r){n.assert(r.parms&&r.parms.fid),NeoConfig.hasConv?e.mail.model.ConvStore.Conversations.remove(r.parms.fid,null,!1):i.Messages.remove(r.parms.fid,null,!0)}},get:{pre:k,success:A},refresh:{pre:L,success:A}}),e.mix(l,{yTimerObj:v,callFailure:S,callSuccess:x,triggerCheckMail:T,validateName:N,validateFolders:C,create:M,remove:_,rename:D,set:P,_updateFolderUnreadCounts:F,_updateConvCountsOnMove:B}),NeoConfig.imapIn&&e.use("mail-controller-folders-v3"),e.mix(c,{empty:p++,oversize:p++,exists:p++}),e.on("debug:cm",function(e){l.triggerCheckMail(e)}),e.on("ds:msg:change",function(e,t,r,i,s){var o,u;if(e===g)for(o=0;o<r.length;o++)(u=r[o].sourceFolderInfo&&r[o].sourceFolderInfo.fid)&&H(u,[i[o]],s),n.assert(u);else H(e,i,s)}),e.on("ds:conv:change",function(e,t,n,i,s,o){var u,a;e==="msg:add"?(u=s[0]&&s[0].length?s[0][0].fid:null,a=s[0],u&&r.isDraftFid(u)&&H(u,a,"add")):e==="conv_flag"&&NeoConfig.checkMailListFix&&F(t,o&&o.flags)}),e.on("ds:msg:remove",function(e,t,r,i,s){var o,u,a="remove";if(e===g)for(o=0;o<t.length;o++)u=t[o].sourceFolderInfo&&t[o].sourceFolderInfo.fid&&s.reason!=="savedraft",u&&H(u,[t[o]],a),n.assert(u);else H(e,t,a)}),e.on("ds:conv:remove",function(e,t,n,r){B(e,r,t)}),e.on("net:suspended",function(){l.yTimerObj&&l.yTimerObj.cancel()}),e.on("net:resumed",function(){l.triggerCheckMail()}),e.on("compose:rte:active",function(){l.yTimerObj&&l.yTimerObj.cancel()}),e.on("compose:rte:blur",function(){l.triggerCheckMail()}),e.on("search:bulk:complete",function(){l.triggerCheckMail(0)}),e.on("net:online",function(){n.features.enabled("autoCheckNetwork")?l.triggerCheckMail(0):l.triggerCheckMail()}),e.on("net:offline",function(){l.yTimerObj&&l.yTimerObj.cancel()}),e.once(NeoConfig.tictac?"tictacs-loaded:ws:postLoad":"ws:postLoad",function(){NeoConfig.checkmailExt&&E?l.triggerCheckMail(10):l.triggerCheckMail()})},"1.0.0",{requires:["mail-common-utils-features","mail-model-datastore","mail-controller-base","common-persist-user-data","mail-common-utils-settings","mail-ui-folder-utils"]});


YUI.add("mail-controller-processbody",function(e){e.namespace("mail.Controller");var t=e.common.Utils,n={expandCidRefOnClient:t.features.enabled("expandInlineAttachedImageUrlOnClient",!1),blockDownloadSpam:t.features.enabled("blockDownloadSpam",!1)},r={maxInlineAttInGDM:t.settings.value("maxInlineAttachmentsInGDM",150)},i=function(){function s(t,n){t&&(n&&n.fid==="%40C%40Chats"||t.sourceFolderInfo&&t.sourceFolderInfo.fid==="%40C%40Chats"?(o(t),(t.body||(t.body={}))&&(t.body.display||(t.body.display="")),t.conversationBody=t.part[0].text):n&&e.mail.ui.FolderUtils.isSpamFid(n.fid)?(t=c(t),l(t,n)):l(t,n))}function o(e){e.body=e.body||{stationery:"",inlineAttachments:[],isPlainText:0},e.imgAttachments=e.imgAttachments||[],e.nonImgAttachments=e.nonImgAttachments||[],e.attachments=e.attachments||[],e.isTruncated=!1,e.yivPrefixNumber=[],e.hasForwardedMsg=!1}function u(e,t){e.attachments=e.attachments.concat(t.attachments||[]),e.imgAttachments=e.imgAttachments.concat(t.imgAttachments||[]),e.nonImgAttachments=e.nonImgAttachments.concat(t.nonImgAttachments||[]),e.isTruncated=t.isTruncated||e.isTruncated,e.body.inlineAttachments=e.body.inlineAttachments.concat(t.body&&t.body.inlineAttachments||[]),t.body&&t.body.display&&(e.body.display=[e.body.display,t.body.display].join("")),e.yivPrefixNumber=e.yivPrefixNumber.concat(t.yivPrefixNumber||[])}function a(e){if(e)return{from:t.escapeEmailObject(e.from),subject:t.escapeStringField(e.subject),to:t.escapeEmailObjectArray(e.to),cc:t.escapeEmailObjectArray(e.cc),bcc:t.escapeEmailObjectArray(e.bcc),replyto:t.escapeEmailObjectArray(e.replyto),xapparentlyto:t.escapeStringField(e.xapparentlyto)}}function f(e,n,r){var i=/<img[^>]+?src\s*?=\s*?["']cid:([^"']+)["'][^>]*?>/ig,s=0,o=t.getTransparentSVG();return e=e.replace(i,function(e,i){var u=n[i],a="",f="",l="";return u?(s+=1,s>r?(l=o,a="<a href=\"#\" onClick=\"this.querySelector('img').src='"+t.escapeHtml(u.downloadUrl)+"'\">",f="</a>"):(u.referencedInline=!0,u.disposition="inline",a="",f="",l=u.downloadUrl),a+e.replace("cid:"+i,l)+f):e}),e}function l(t,i){var s=/\<div[^>]+?yahoo_quoted[^>]+?display:none[^>]+?>/g,l={};t.cookedHeader=a(t.header);if(t.part){var c=0,p=t.part,d;o(t);while(d=p[c++])h(t,d,i),u(t,d);n.expandCidRefOnClient&&p.forEach(function(e){var t;if(!e.contentId||typeof e.contentId!="string")return;t=e.contentId.match(/<(.+?)>/),t&&(l[t[1]]=e)})}(t.body||(t.body={}))&&(t.body.display||(t.body.display="")),t.hasForwardedMsg&&(t.body.display=[strings.str_comp_reply_fwdHeader,"<br/><br/>",t.body.display].join("")),t.body&&t.body.display&&e.Lang.isString(t.body.display)&&(t.body.display=t.body.display.replace(s,function(e){return e.replace("display:none","")}),n.expandCidRefOnClient&&Object.keys(l).length>0&&(t.body.display=f(t.body.display,l,r.maxInlineAttInGDM)))}function c(t){var n,r;if(t.part){var i=0,s=t.part,o;while(o=s[i])o.type==="text"&&(n=e.Node.create('<div id="__testMsg">'+o.text+"</div>"),r=n.all("a"),r.removeAttribute("href"),r.addClass("removed-link"),t.part[i].text=n.get("innerHTML")),i++}return t}function h(e,t,n){t.size||(t.size=t.size||0);var r=t.isTruncated&&(t.disposition==="inline"||!t.disposition)&&!t.referencedInline&&(t.subtype==="plain"||t.subtype==="html");t.isTruncated=r;switch(t.type){case"text":d(e,t,n);break;case"image":v(e,t,n);break;case"message":m(e,t,n);break;default:g(e,t,n)}}function p(e,t){t.filename||(t.filename=t.partId+".txt"),e.attachments.push(t),e.nonImgAttachments.push(t)}function d(e,t){if(typeof t.text=="string"||t.disposition==="attachment"||t.disposition==="inline")t.disposition!=="inline"&&!!t.disposition||!!t.referencedInline||t.subtype!=="plain"&&t.subtype!=="html"?p(e,t):typeof e.body.display=="undefined"?(e.body.display=t.text,e.body.isPlainText=t.subtype==="plain"):e.body.display+="<br />"+t.text}function v(e,t){var n=(t.subtype||"").toLowerCase(),r=n in i||0;t.referencedInline||r||g(e,t),t.filename||(t.filename=strings.str_nav_left_untitled+t.partId+"."+t.subtype),r&&(t.isDisplayable=!0,e.imgAttachments.push(t),e.attachments.push(t))}function m(e,t,n){var r=(t.subtype||"").toLowerCase(),i,s;if(r==="rfc822"){if(t.partId!=="TEXT"||e.part.length===2)e.attachments.push(t),e.nonImgAttachments.push(t);t.disposition===""&&(e.hasForwardedMsg=!0);if(s=t.message)t.filename||(i=s.header.subject.substring(0,240)||strings.str_comp_nosubject,t.filename=i+".eml"),l(s,n),u(e,s)}}function g(t,r){var i=(r.subtype||"").toLowerCase(),s=(r.type||"").toLowerCase(),o=r.attachments,u=n.blockDownloadSpam&&e.mail.ui.FolderUtils.isSpamFid(t.fid),a,f,l=0,c=t.attachments,h=t.nonImgAttachments;if(s==="application"&&i==="ms-tnef"&&o&&o.length){a=o.length;for(l;l<a;l++)f=o[l],f&&f.name&&(f.filename=f.name,u&&(f.downloadUrl=null,f.downloadUrlV3=null),f.tnefId=f.id);h=t.nonImgAttachments=h.concat(o)}else r.filename||(r.filename=strings.str_nav_left_untitled+r.partId),u&&(r.downloadUrl=null,r.downloadUrlV3=null),c.push(r),h.push(r)}strings=window.strings||{forwarded_msg_attached:"Note: Forwarded message is attached.",str_nav_left_untitled:"untitled"};var i={jpg:1,jpe:1,pjpg:1,pjpe:1,pjpeg:1,bmp:1,jpeg:1,png:1,gif:1,tiff:1,"x-png":1};e.mix(e.mail.Controller.Messages,{_process:function(e,t){e&&!e.body&&s(e,t)}},!0)};new i},"1.0.0",{requires:["common-utils","mail-ui-folder-utils","common-utils-stats"]});


YUI.add("mail-model-datastore",function(e){function y(e,t){var n,r,i;if(h.isObject(e)){r=e.extend=e.extend||{},i=t&&t.extend||{};for(n in i)r[n]||(r[n]={},d.merge(r[n],i[n]))}}function b(t){try{e.fire.apply(e,t)}catch(n){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-model-datastore:1",n,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-model-datastore:1"),e.use("common-utils-error",function(){d.error.report("datastore error for "+t[0],n,1,1,1)})}}e.namespace("mail.model");var t="ds:folder:",n="ds:msg:",r="ds:conv:",i="ds:account:",s="invalidarg",o="change",u="add",a="rename",f="remove",l="%40S%40Search",c=e.mail,h=e.Lang,p=/^[0-9]_[0-9]_/,d=e.common.Utils,v=function(){return{extend:{}}},m=70,g=c.model.DataStore={};e.mix(g,{Folders:function(){function r(e){return h.isString(e)?e:e&&e.folderInfo&&e.folderInfo.fid}function i(e){try{return h.isObject(e)&&r(e)}catch(t){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-model-datastore:2",t,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-model-datastore:2")}return!1}function p(e){return e&&e.folder&&h.isArray(e.folder)}function m(e,t,r,i){var s=n,o,u,a;for(u=0,a=s.length;u<a;u++){o=s[u];if(r&&e===o.folderInfo.name||e===o.folderInfo.fid){if(i&&o.acctId!==i)continue;return t?u:o}}return t?-1:null}function w(i,o){var u=!i||h.isObject(i)&&d.isEmpty(i),a=v(),f,l,c,p,g;if(u){l=[];for(c in n)l.push(d.wcopy(n[c],a));f=l.length?l:null}else(p=r(i))||e.error(t+"get:"+s),g=m(p),g&&o&&(g=g[o]),typeof g=="object"?f=d.wcopy(g,a):f=g;return f}function E(e){var t=n,r=t.length,i=[],s;for(s=0;s<r;s++)t[s].acctId===e&&i.push(t[s]);return i}function S(e){var t=n,r=t.length,i=c.ui.FolderUtils,s,o;for(o=0;o<r;o++){s=t[o];if(s.acctId===e&&s.types[0]===i.InboxFolderType)return s.folderInfo.fid}}function x(e,t){return d.wcopy(m(e,!1,!0,t),v())}function T(e){return d.wcopy(m(e,!1,!1),v())}function N(u,a,f){function B(e){for(var t=0,n=e.length;t<n;t++)if(m(e[t].folderInfo.fid,!0)===-1)return!0}function j(o,u){d.assert(i(o));var a=r(o),c,h={},p,v;if(O&&u)return;if(a&&a!==l){if(O)v=o,c=d.merge({},o),n.push(c);else{p=m(a,!0);if(p===-1){if(u)return;e.error(t+"set:"+s)}h=n[p]||h,o.size===null&&h.size!==null&&(o.size=h.size),o.totalConversations===null&&h.totalConversations!==null&&(o.totalConversations=h.totalConversations),v=f?o:d.diff(o,h),v&&(NeoConfig.imapIn?(v=F(v),c=d.wcopy(h),c=d.merge(c,v,!0,!1,!0)):(c=f?{}:d.wcopy(h),c=d.merge(c,v,!0)),!u&&n.splice(p,1,c))}v&&(y(c,h),k.push(d.wcopy(c,C)),M&&M.push(h),_&&_.push(v))}else L.push(o)}function F(e){return e.hasOwnProperty("isSystem")&&(e.isSystem=null),e.folderInfo&&e.folderInfo.hasOwnProperty("name")&&(e.folderInfo.name=null),e.folderInfo&&e.folderInfo.hasOwnProperty("index")&&(e.folderInfo.index=null),e}var h,w,S,x,T=u.numberOfFolders,N,C=v(),k=[],L=[],O=n.length===0,M=!O&&[],_=!O&&[],D,P,H;!i(u)&&!(x=p(u))&&e.error(t+"set:"+s);if(x){h=u.folder,S=h.length,N=!O&&T&&(T!==n.length||B(u.folder));if(N){for(w=0;w<S;w++)j(h[w],N);k.length&&b([t+o,M,k,_,a]),A(),O=!0,k=[],L=[],M=_=!1}for(w=0;w<S;w++)j(h[w])}else j(u);var I=e.mail.Tabs&&e.mail.Tabs.getActiveTab();if(I&&I.widget&&I.widget.fid){var q=!1;for(w=0;w<k.length;w++)k[w]&&k[w].folderInfo&&k[w].folderInfo.fid===I.widget.fid&&(q=!0)}if(a==="refresh"||a==="autorefresh")NeoGV.cancelViewBeacon=!0;return NeoConfig.imapIn&&M===!1&&a!=="launch"&&(D=c.ui.FolderUtils,P=g.Accounts.getCurrentAccount(),H=P?P.id:D.PrimaryAcctId,k=E(H)),k.length&&b([t+o,M,k,_,a]),L}function C(i,o){r(i)||e.error(t+"add:"+s),n.push(d.merge({},i)),b([t+u,i,o])}function k(i,o,u){var f=r(i),l=m(f,!0),c=n[l];(!f||!c)&&e.error(t+"rename:"+s),d.merge(o,c),n.splice(l,1,o),b([t+a,c,d.wcopy(o,v()),u])}function L(i,o){var u=r(i),a=m(u,!0);(!u||a===-1)&&e.error(t+"remove:"+s),n.splice(a,1),b([t+f,h.isObject(i)?i:{folderInfo:{fid:u}},o])}function A(){n.length=0}var n=[];return{get:w,getByName:x,set:N,remove:L,rename:k,add:C,extend:y,flush:A,getFoldersByAccount:E,getPrimaryFolderByAccount:S,getByFid:T}}()}),(NeoConfig.imapIn||NeoConfig.am)&&e.mix(g,{Accounts:function(){function l(e){var t={id:"1",email:NeoConfig.emailAddress,isPrimary:!0};r=e&&e.ALL||[t],e.primaryAccount?a=e.primaryAccount[0]:(a=t,k({fallback:!0,type:1,account:e})),!a.email&&t.email!==""&&a.type==="PHONE"&&a.status==="DISABLED"?(a.email=t.email,k({fallback:!0,type:2,account:e})):!a.email&&t.email===""&&k({fallback:!1,type:0,account:e}),o=a}function c(e){r.push(e),!NeoConfig.multipleAccounts&&e.status==="ENABLED"&&(NeoConfig.multipleAccounts=1),b([i+u,e])}function h(e){var t=g(e.id);if(t>-1){if(!e.description||e.description.trim()==="")e.isPrimary?e.description=NeoConfig.strings.str_branding:e.description=e.email;r[t]=e}e.isPrimary&&(a=e),b([i+"update",e])}function p(){return a}function m(n){var o=n.id,u=g(o);!o||u===-1?e.error(t+"remove:"+s):(r.splice(u,1),NeoConfig.multipleAccounts&&S("ENABLED").length===0&&(NeoConfig.multipleAccounts=0),b([i+f,n]))}function g(e){var t;for(t=0;t<r.length;t++)if(e===r[t].id)return t;return-1}function y(e){var t,i,s,o,u;if(e){i=r.length;for(o=0;o<i;o++){t=r[o];if(t.id===e)return d.wcopy(t)}return null}s=v(),u=[];for(o in r)(r[o].isPrimary||r[o].type===n)&&u.push(r[o]);return u.length?d.wcopy(u,s):null}function w(){return d.wcopy(r)}function E(e){var t=r.length,n=[],i;for(i=0;i<t;i++)r[i].type===e&&n.push(r[i]);return d.wcopy(n)}function S(e){var t=r.length,n=[],i;for(i=0;i<t;i++)r[i].type==="IMAPIN"&&r[i].status===e&&n.push(r[i]);return d.wcopy(n)}function x(){var e=r.length,t={},n;for(n=0;n<e;n++)r[n].isSelected&&(t=r[n]);return d.wcopy(t)}function T(e){var t=g(e);t===-1?o=a:o=r[t],b(["imapin:currentAccountSet",o])}function N(){return o}function C(e){r=e}function k(t){var n={fallback:t.fallback,type:t.type};e.fire("util:ymstats",{name:"compose_mode",tags:n,include:{farm:!0}}),n.account=t.account,e.fire("SplunkLog","compose_mode",n,"critical")}var n="IMAPIN",r=[],o,a;return e
.on("imapin:accountAdded",c),e.on("imapin:accountRemoved",m),e.on("imapin:accountUpdated",h),e.on("imapin:accountRefreshed",C),{get:y,set:l,create:c,remove:m,update:h,_findAccount:g,getPrimaryAccount:p,setCurrentAccount:T,getCurrentAccount:N,getAll:w,getAccountsByType:E,getImapInAccountsByStatus:S,_fireComposeFallbackStats:k,getSelectedAccount:x}}()}),e.mix(g,{Messages:function(){function x(e){var t;return e&&h.isString(e)?t={mid:e}:(t=h.isObject(e)&&e.mid&&e,T(t)),t}function T(e){e&&e.inReplyTo&&(e.inReplyToV3MsgRef=e.inReplyTo,e.inReplyTo=void 0)}function N(t,r,o){var u,a,f,l,c,p,m=h.isString(r)||!r?r:r.mid;(!t||!m)&&e.error(n+"get:"+s),u=i[t]||{},a=u[m];if(o&&a&&a.part){c=g.olist,p=c.length;for(f=0;f<p;f++)if(c[f].fid===t&&c[f].mid===m){l=c.splice(f,1),c.push(l[0]);break}}if(!a&&V(m)){m=z(m);for(l in u)if(z(l)===m){a=u[l];break}}return d.wcopyWrapper(a,v())}function C(){return i}function k(t,r){var o,u,a=h.isString(r)||!r?r:r.mid;return(!t||!a)&&e.error(n+"get:"+s),o=i[t]||{},!!(u=o[a])&&!!u.part}function L(t,r,a,f,l,c){function _(e,n){var r,s,o,u,a;(r=x(e))?(u=r.mid,i[t]=i[t]||{},s=i[t][u]||{},a=d.diff(r,s),a&&(o=f?{}:d.wcopy(s,A),o=d.merge(o,f?r:a,!0),m=m&&(d.isEmpty(s)||a.part&&!s.part),s.snippet&&(o.snippet=s.snippet),w&&(s.cid&&(o.cid=s.cid),s.sourceFolderInfo&&(o.sourceFolderInfo=d.wcopy(s.sourceFolderInfo)),!s.header&&o.header&&s.receivedDate&&(o.header.receivedDate=s.receivedDate),s.inReplyTo&&(o.inReplyTo=s.inReplyTo),s.inReplyToV3MsgRef&&(o.inReplyToV3MsgRef=s.inReplyToV3MsgRef),s.messageIdRfc822&&(o.messageIdRfc822=s.messageIdRfc822),s.inReplyToRfc822&&(o.inReplyToRfc822=s.inReplyToRfc822),s.csid&&(o.csid=s.csid),s.srvmap&&(o.srvmap=s.srvmap),s.inboxservices&&(o.inboxservices=s.inboxservices),s.mimeMsgId&&(o.mimeMsgId=s.mimeMsgId),s.decos&&(o.decos=s.decos),s.cardConversationId&&(o.cardConversationId=s.cardConversationId)),!M&&G(t,l?l(o):o,m,n),y(o,s),C.push(d.wcopy(o,A)),N.push(s),L.push(a))):k.push(e)}var p,m=f,E=h.isArray(r),S=E?r:[r],T=h.isArray(c)?c:[c],N=[],C=[],k=[],L=[],A=v(),O,M;if("Sent"===t&&"add"===a&&h.isString(r)||NeoConfig.noCache===1)g.sync[t]=M=!0;t||e.error(n+"set:"+s);for(p=0;p<S.length;p++)_(S[p],T[p]);return C.length&&(O=[n+(m?u:o),t],O=O.concat(m?[C,a]:[N,C,L,a]),b(O)),k}function A(e,t){var n,r,s,o=g.sync,u,a;if(o[e]&&(s=i[e])&&t){for(n=0;n<t.length;n++)r=s[t[n].mid],r&&(r.flags?r.flags=t[n].flags:s[t[n].mid]=R(e,t[n]));o[e]=0}u=S[e];if(u)for(n=0;n<t.length;n++)a=u[z(t[n].mid)],a&&d.merge(t[n],a,!0)}function O(e,t){var n,r;r=i[e]=i[e]||{},n=r[t.mid],n?n.flags?n.header?(t.cid&&(n.cid=t.cid),t.receivedDate&&(n.header.receivedDate=t.receivedDate),t.snippet&&(n.snippet=t.snippet),t.inReplyToRfc822&&(n.inReplyToRfc822=t.inReplyToRfc822),n.flags=t.flags):r[t.mid]=t:r[t.mid]=R(e,t):r[t.mid]=t}function M(e,t){var n,r;r=i[e]=i[e]||{},n=r[t.mid],n&&n.header&&(t.cid&&(n.cid=t.cid),t.newmsg&&!n.header.receivedDate&&(n.header.receivedDate=t.newmsg.receivedDate))}function _(e,t,n){var r,s,o,u=g.olist;r=i[e];if(r&&r[t]){o=r[t].part;if(!n||!o){delete r[t];for(s=0;s<u.length;s++)if(u[s].fid===e&&u[s].mid===t){u.splice(s,1);break}}}}function D(e,t,n){var r,i,s,o,u=0;for(r in t)i=e[r]=t[r],n&&r in n&&(s=n[r],typeof s=="object"?(o={},e[r]=o,u|=D(o,i,s)):i!==s&&(u=1,e[r]=s));for(r in n)r in t||(s=n[r],typeof s=="object"?(o={},e[r]=o,u|=D(o,{},s)):(u=1,e[r]=s));return u}function P(t,r,s,u){var a,f,l,c=e.clone(s,1),p=s.flags,m=0,g=v(),y=[],w=[],E=[];p&&p.isSpam&&delete c.flags.isRead,h.isArray(r)||(r=[r]),i[t]=i[t]||{};for(;m<r.length;m++){f={};if(typeof r[m]!="string"&&this.applyDiff(f,a=i[t][r[m].mid]||r[m],s)){i[t][a.mid]=f,y.push(a),a.flags.isRead?w.push(c):w.push(s);for(l in g)f[l]=g[l];E.push(d.wcopy(f,g))}}y.length&&b([n+o,t,y,E,w,u])}function H(e,t,r,s,u,a){var f,l,h,p,m,g,y,w=[],S=[],x=v(),T=[],N=0;f=i[e]=i[e]||{};while(l=r[N]){h=s[N++],m={mid:h,srcMid:l,folderInfo:{fid:t}},g={},this.applyDiff(g,E[l]||{},m),p=z(h),c[p]&&(c[p].fid=t),delete E[l],g.extend={},w.push({});for(y in x)g[y]=x[y];S.push(d.wcopy(g,x)),T.push(m)}b([n+o,t,w,S,T,u,e,a])}function B(t,r,o,u,a){var l,c,p,d,v,m,y,w,S=[],T=g.olist,N=!r||h.isArray(r)?r:[r];t||e.error(n+"remove:"+s),l=i[t];if(!N){delete i[t],c=0;while(c<T.length)T[c].fid===t?T.splice(c,1):c++}else for(c=0;c<N.length;c++){m=x(N[c]),w=m.mid,(y=l&&l[w])&&delete l[w];for(p=0;p<T.length;p++)if(T[p].fid===t&&T[p].mid===w){T.splice(p,1);break}y&&y.header&&(d=m.header)&&(v=d.size)&&(y.header.size=v),y=y||m,E[w]=y,S.push(y)}b([n+f,t,S.length&&S,o,u,a])}function j(e){i={},g={olist:[],max:m,sync:{}},e&&(E={})}function F(e){w=e}function I(e){var t,r,s,o;for(t in i){r=i[t];for(s in r)(o=r[s].extend)&&delete o[e]}b([n+"flushExt",e])}function q(e){this.mid=e}function R(e,t){function n(n){return t.mid&&V(t.mid,e)&&n.replace(/\^_/g,"")||n}function r(e){var t=e&&e[0];return t?{email:t.email||t.address||"",name:t.name||t.displayname||""}:e}var i,s=0;if(t&&t.mid){for(i in t)s++;if(s===1)return new q(t.mid||"")}t=t||{};var o=t.subject||"",u=t.from,a=t.toEmail,f={mid:t.mid||"",cid:t.cid||"",flags:t.flags||{},fromConnection:t.fromConnection||{},folderInfo:t.folderInfo||{},sourceFolderInfo:t.sourceFolderInfo||{},snippet:t.snippet||"",header:{from:u?r(u):{email:"",name:""},to:[],subject:n(o),subjectDir:NeoConfig.bidi&t.subjectDir?t.subjectDir:"",xapparentlyto:t.xapparentlyto||"",snippet:t.snippet||"",externalPopServer:t.externalPopServer||"",receivedDate:t.receivedDate||t.date||"",size:t.size||0}};return f.fid=Z(t)||e,a&&(f.header.to[0]={name:a,email:""}),t.mimeMsgId&&(f.mimeMsgId=t.mimeMsgId),t.inReplyTo&&(f.inReplyTo=t.inReplyTo),t.inReplyToV3MsgRef&&(f.inReplyToV3MsgRef=t.inReplyToV3MsgRef),t.messageIdRfc822&&(f.messageIdRfc822=t.messageIdRfc822),t.inReplyToRfc822&&(f.inReplyToRfc822=t.inReplyToRfc822),t.srvmap&&(f.srvmap=t.srvmap),t.inboxservices&&(f.inboxservices=t.inboxservices),t.csid&&(f.csid=t.csid),t.decos&&(f.decos=t.decos),t.cardConversationId&&(f.cardConversationId=t.cardConversationId),f.cookedHeader={from:u?d.escapeEmailObject(f.header.from):"",subject
:o?d.escapeStringField(f.header.subject):"",to:a?d.escapeEmailObjectArray(f.header.to):[]},f}function U(e,t){t=t||{};var n=t?t.header||{}:{},r={mid:t.mid||"",cid:t.cid||"",csid:t.csid||"",flags:t.flags||{},from:n.from||"",fromConnection:t.fromConnection||{},folderInfo:{fid:e||"",name:""},sourceFolderInfo:t.sourceFolderInfo||{},toEmail:n.to?n.to.name||n.to[0]&&(n.to[0].name||n.to[0].email)||"":"",subject:n.subject||"",xapparentlyto:n.xapparentlyto||"",externalPopServer:n.externalPopServer||"",snippet:t.snippet||"",receivedDate:n.receivedDate};return t.inReplyTo&&(r.inReplyTo=t.inReplyTo),t.inReplyToV3MsgRef&&(r.inReplyToV3MsgRef=t.inReplyToV3MsgRef),t.messageIdRfc822&&(r.messageIdRfc822=t.messageIdRfc822),t.inReplyToRfc822&&(r.inReplyToRfc822=t.inReplyToRfc822),t.csid&&(r.csid=t.csid),t.mimeMsgId&&(r.mimeMsgId=t.mimeMsgId),t.srvmap&&(r.srvmap=t.srvmap),t.inboxservices&&(r.inboxservices=t.inboxservices),t.decos&&(r.decos=t.decos),t.cardConversationId&&(r.cardConversationId=t.cardConversationId),r}function z(t){return h.isString(t)?p.test(t)?t.substr(t.lastIndexOf("_")+1):t:(e.fire("MailLog",{m:"Invalid mid during getPermMidPart: "+t}),t)}function W(e){return e.replace(/\+/g,"-").replace(/\//g,"_")}function X(e,t){var n=[],r=[],i,s,o,u;e=""+e,t=""+t,n.push(e),r.push(t),n.push(z(e)),r.push(z(t)),i=n[1],s=r[1],n.push(W(e)),r.push(W(t)),n.push(W(i)),r.push(W(s));for(o=0;o<n.length;o++)for(u=0;u<r.length;u++){if(!n[o]||!r[u])continue;if(n[o]===r[u])return!0}return!1}function V(e,t){return/^1_0_/.test(e)||t===l||e.lastIndexOf("_")<0}function $(e,t,n,r){return!V(e,n)&&!V(t,r)&&e!==t&&z(e)===z(t)}function J(e,t,n){var r=i[e],s;for(s in r){if(!r[s].flags)return 0;r[s].flags[t]=n}return 1}function K(e,t){var n=g.olist,r=n.length,s,o,u,a;o=e.folderInfo.fid,a=i[o];if(a){delete i[o],u=t.folderInfo.fid,i[u]=a;for(s=0;s<r;s++)n[s].fid===o&&(n[s].fid=u)}}function Q(e,t,i,s){var o,u,a,f,l;if(s===n||s===r)return;for(o=0;i&&o<i.length;o++){a=i[o],u=t[o],f=u.folderInfo.fid;if(!h.isUndefined(a.total)||!h.isUndefined(a.unread)){l=a.unread===u.total||a.unread===0?u.unread?0:1:undefined;if(!NeoConfig.hasConvView||l!==undefined)J(f,"isRead",l),g.sync[f]=l===undefined}h.isUndefined(a.folderHash)&&h.isUndefined(a.unread)&&h.isUndefined(a.total)||b([n+"flush",f,i,s])}}function G(e,t,n,r){var s,o=t.mid,u=z(o),a=g.olist,f,l;n&&(a.length>=g.max&&(s=a.shift(),d.assert(i[s.fid]),i[s.fid]&&(f=i[s.fid][s.mid],f&&(f.cid&&w&&w.hit(f.cid,s.fid)?i[s.fid][s.mid]=U(s.fid,f):delete i[s.fid][s.mid]))),a.push({fid:e,mid:t.mid})),r&&r.charsetHint&&(l=t.header)&&(S[e]=S[e]||{},S[e][u]=l),i[e][o]=t,c[u]=r}function Z(e){return e.fid||e.sourceFolderInfo&&e.sourceFolderInfo.fid||e.folderInfo&&e.folderInfo.fid}var i={},c={},g={olist:[],max:m,sync:{}},w=null,E={},S={};return q.prototype={flags:{},fromConnection:{},folderInfo:{},sourceFolderInfo:{},inboxservices:{},header:{from:{email:"",name:""},to:[],subject:"",subjectDir:"",xapparentlyto:"",snippet:"",externalPopServer:"",receivedDate:"",size:0},cookedHeader:{from:{email:"",name:""},to:[],subject:""}},e.on(t+a,K),e.on(t+o,Q),{get:N,getAll:C,set:L,move:H,update:P,remove:B,extend:y,flush:j,flushExt:I,toMessage:R,toMessageInfo:U,getPermMidPart:z,compareMultiVersionMids:X,hasMoved:$,isSearchMid:V,isCached:k,syncHeaders:A,syncConvHeader:O,syncConvInfo:M,removeConvMsg:_,setConvStore:F,applyDiff:D,cacheSize:function(e){!isNaN(e)&&e>0&&(g.max=e)},getParam:function(e){return c[z(e)]}}}()})},"1.0.0",{requires:["common-utils","json-stringify","event-custom","mail-ui-folder-utils"]});


YUI.add("mail-net-transport",function(e){e.namespace("mail.net");var t,n="getMessageV3";e.mail.net.Transport=function(){function y(t,n,r){var i,o=e.JSON.stringify,u="badparam_",a,f;r?f=w(n):(delete n.api,f={method:t,params:[n]}),i=o(f)||"";if(!/method/.test(i))a=i===""?"empty_":"nomethod_";else if(t==="GetDisplayMessage"||t==="MoveMessage"||t==="FlagMessage")if(!i.match(/\"mid\"/)||i.match(/\"mid\":\"\"/)||i.match(/\"mid\":\[\]/))a="nomid_";return a&&(a=u+a+t,s.assert(0,u,1,function(){return NeoConfig.isInternal&&window.alert(["Bad param sent:",t,a,"Pl. contact yahoo-mail-dev-support@yahoo-inc.com"].join(" ")),[a,i,"params",n?o(s.merge({},n)):n].join(" ")})),i}function b(e,t){var n;if((e==="BatchExecute"||e==="BatchExecuteGDM")&&t.call)for(n=0;n<t.call.length;n++)if("ListMessagesInThread"in t.call[n])return!0;return!1}function w(e){var t,n,r,i={},s={requests:[]};for(t=0;t<e.call.length;t++)n=e.call[t],r=E(n.id,n.api,n[n.api]),i[n.id]=r,n.dependency||s.requests.push(r);for(t=0;t<e.call.length;t++)n=e.call[t],n.dependency&&N(i[n.id],i[n.dependency[0]],n.filter);return s}function E(e,n,r){var i=t[n];return i?i.buildBatchReqPayload(e,n,r):S(e,n,r)}function S(e,t,n){return{id:e,uri:"/ws/mail/v2.0/jsonrpc",method:"POST",payloadType:"embedded",payload:{method:t,params:[n]}}}function x(e){return typeof e=="string"?e.replace(/\+/g,"-").replace(/\//g,"_"):e}function T(e,t,r){var i="id:"+x(r.mids[0]),s="/ws/v3/mailboxes/@.id=="+window.encodeURIComponent(NeoConfig.V3MailboxId)+"/messages/@.select==q?q="+window.encodeURIComponent(i)+"&oldSearchV2Mids=1";return t!==n?{}:{id:e,uri:s,method:"GET"}}function N(e,t,n){n&&(t.filters=n),t.requests=parent.requests||[],t.requests.push(e)}function C(e){function t(e){var t,n={};for(t in e)e[t]!==undefined&&(n[t]=e[t]);return n}var n=["&o=json"],r=i.formatQueryParams(t(e),!0);return r.length&&n.push("&",r),n.join("")}function k(e,t,n){if(!e.id)return t[n];for(var r=0;r<t.length;r++)if(e.id===t[r].id)return t[r];return t[n]}function L(t,n){function r(){var t=s.result.response,n,r,i,o,a=[],f;for(f=0;f<t.length;f++)n=t[f],o=d.batchopcbk[f]||{},r=null,!n.success&&!n.not_requested?(n.not_requested,r=n.ErrorResponse||{},r.status=500,r.fault=u(r.code||"Server.MalformedFault",r.string,{idx:f})):d.isV3||o.method&&(i=A(n[o.method+"Response"]),i&&(r={fault:i,code:i.code,status:200})),r&&(r.callback=e.mix((d.isV3?k(n,d.batchopcbk,f):o)||{},{suppressCodes:d.suppressCodes,service:"mail",serviceCredType:"strict",exceptCodes:d.exceptCodes,suppressLogs:d.suppressLogs,exceptLogs:d.exceptLogs},!1),r.fault&&(r.fault.id=n.id||""),a.push(r));return a.length&&u("BatchItemError",null,a)}var s=n.body||{},a,f=n.fault,l=g(t.request.url),c,h=n.status,p=n.responseText||"",d=n.callback;NeoConfig.hasConvV3&&!e.Object.isEmpty(s)&&(s=e.JSON.parse(n.responseText));if(f)f.code===o.parse&&(p.match(/<code>Server.ServiceTemporarilyUnavailable<\/code>/)?f.code="Server.ServiceTemporarilyUnavailable":(c=n.allHeadersText,c=c.indexOf("system.hostname")>-1?"-mail":"-unk",f.code="Server."+(f.detail.respTxt===""?"NoResponse":(a=i.isHtml(n))?"HTMLResponse":"Malformed")+c,f.subcode=a));else{if(s.error||s.fault)s=s.error||s.fault;h===500?(f=u(s.code||"Server.MalformedFault",s.message,s.detail||n),n.body=s):h===200&&(l?n.body={result:s}:d.batchopcbk?f=r():s.result&&(f=A(s.result))),n.fault=f}}function A(e){var t;if(!e)return;return e.returnCodes&&e.returnCodes.length?(t=e.returnCodes[0],t.partialFault=!0):e.error&&e.error.length&&(t=e.error[0],t.partialFault=!0),t}function O(e,t,n){var r={},i,o,u,a,f=!1,c=!1,d=l,w=n&&n.appid||s.settings.value("appid");t=t||{};if(!e)throw new Error("CascadeMethod");if(t.call)for(u=0;u<t.call.length;u++)a=t.call[u],a&&a.SendMessage&&a.SendMessage.headers&&(r.headers=a.SendMessage.headers,delete a.SendMessage.headers);else r.headers=t.headers,delete t.headers;NeoConfig.hasConvV3&&(c=b(e,t)),d=c?v:l,i=r.url=(m[e]||d).replace(/_APPID_/,w)+(c?"":e);if(e===h||e===p)i=r.url=i+"&prime="+(t.prime==="Prime"?"1":"0"),delete t.prime;else if((e==="BatchExecute"||e==="BatchExecuteGDM")&&t.call)for(u=0;u<t.call.length;u++)a=h in t.call[u]?h:p in t.call[u]?p:null,a&&(f||(i=r.url=i+"&prime="+(t.call[u][a].prime==="Prime"?"1":"0"),f=!0),delete t.call[u][a].prime);return g(i)&&(o=C(t),i.length+o.length>=2048?o=null:r.url+=o),o||(r.post=function(n){return y(e==="BatchExecuteGDM"?"BatchExecute":e,n||t,c)}),r.callback=P(n,e,t,c),r.useV3=c,r}function M(e,t){var n=a.format[t.callback.responseType];n&&n(e,t)}function _(t){var n,r,i;i=t.status;if(i===200)try{NeoConfig.enable_spdy_support?r=t.getResponseHeader("Content-Type").split("boundary=")[1]:r=t.responseHeaders["Content-Type"].split("boundary=")[1],n=s.parseMultiPartResponse(t.responseText,r),t.responseText=D(n),t.multipart=1}catch(o){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-net-transport:1",o,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-net-transport:1"),e.fire("MailLog",{m:"Can't parse MultiPartResponse",errMsg:o.message,respHeader:t.responseHeaders})}return t}function D(t){var n,r,i={},s,o,u,a=[],f,l,c;try{n=t&&e.JSON.parse(t)}catch(h){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-net-transport:2",h,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-net-transport:2"),e.fire("MailLog",{m:"JSON Parse error in formatV3Response!",error:h.message}),e.fire("util:ymstats",{name:"v3_parse_fail",tags:{agent:NeoConfig.browser,part:"v3format",v3failedcase:"format"},include:{farm:!0}})}f=n.length,i={error:null,result:{response:[]}};for(o=0;o<f;o++){c=n[o],u=c.id,s={};if(c.ErrorResponse){if(a[u])continue;l=c.ErrorResponse,s.ErrorResponse=l,a[u]=!0}else l=c[c.key],s[c.key]=l.result||l.error;s.id=u,s.success=c.success,s.not_requested=c.not_requested||!1,i.result.response.push(s)}return r=e.JSON.stringify(i),r}function P(t,n,r,i){return t||(t={}),e.mix(t,{responseType:"json",method:n,service:"mail",serviceCredType
:"strict",isV3:i,formatter:a.formatter,parseMultiPartResponse:a.parseMultiPartResponse,suppressCodes:[],exceptCodes:[],suppressLogs:[],exceptLogs:[],timeout:NeoConfig.mailwstimeout},!1),t}function H(e){return a.queue?a.queue(e):e}var r=e.common.net,i=r.SessionMgr,s=e.common.Utils,o=r.Error,u=i.makeFaultObject,a,f="/jsonrpc?appid=_APPID_&m=",l="/ws/mail/v2.0"+f,c="/ws/mailPreferences/v1"+f,h="GetDisplayMessage",p="ListMessagesInThread",d="?appid=_APPID_",v="/ws/v3/batch"+d,m={GetUserPreferences:c,SetUserPreferences:c},g=function(e){return/formrpc/.test(e)};return t={getMessageV3:{buildBatchReqPayload:T}},a={request:function(e,t,n,r){var s,o=O(e,t,n),u,a;if(!o)return;u=o.headers||{},s=H(i.request(o.url,o.post,o.callback,o.post?"POST":"GET",null,null,o.useV3)),u.Accept="application/json, multipart/form-data";for(a in u)s.setHeader(a,u[a]);r&&s.send()},formatter:M,parseMultiPartResponse:_,formatV3Response:D,format:{json:L},v3MethodConstants:{GET_MESSAGE_V3:n}},a}();var r=e.common.persist.NeoData.get("mailnetQueue");(r||typeof r=="undefined")&&e.use("mail-net-queue",function(){}),e.use("mail-net-diag")},"1.0.0",{requires:["ymma-stats","common-net-sessionmgr","json-stringify","common-persist-neo-data","mail-common-utils-settings"]});


YUI.add("mail-net-queue",function(e){function c(e,t){return t&&e==="BatchExecute"?!1:!l[e]}function h(e,t){t=t||{};var n=t.method,i=/prime=0/.test(e.request.url);s||(r=r||t.service==="mail"&&c(n,i))}function p(t,u){var l,h=u.service==="mail"?!0:!1,p=s?h:h&&c(u.method);s&&h&&t.tries===1&&i--,u=u||{};if(p){r=!1;if(n.length>0){if(s&&n[0].blockingRequest&&i!==0)return;l=n.shift(),l.blockingRequest&&(o=!1),e.fire(a,l,n.length),s?i<f&&(i++,i===f&&(r=!0),n.length===0&&(o=!1),l.send()):l.send()}}}function d(t,a,l,h){h&&i>0&&(o=!0,t.blockingRequest=!0),!s&&c(a)&&(r||n.length>0)||s&&(r||o)&&l==="mail"?(n.push(t),e.fire(u,t,n.length)):(s&&l==="mail"&&(i++,i===f&&(r=!0)),t.send())}function v(t){var r,i;for(r=0,i=n.length;r<i;r++)if(t.id===n[r].id){n.splice(r,1),e.fire(a,t,n.length,!0);return}t&&t.abort()}function m(e){function t(e){this.send=function(){d(e,this._callback.method,this._callback.service,this.blockingRequest)},this.abort=function(){v(e)}}return t.prototype=e,new t(e)}var t=e.mail.net.Transport,n=[],r=!1,i=0,s=NeoConfig.parallelRequests||!1,o=!1,u="mailnet:queue",a="mailnet:dequeue",f=5,l={GetDisplayMessage:1,GetMessage:1};e.on("net:start",h),e.on("net:complete",p),e.on("net:abort",p),e.mix(t,{queue:m},!0)},"1.0.0",{requires:["mail-net-transport"]});


YUI.add("mail-net-diag",function(e){e.namespace("mail.net"),e.mail.net.Diag=function(){function i(e){return e&&e.service==="mail"}function s(e,n){return i(n)&&{log:[u(e,n),"Request :",t.stringify(e.request).substring(0,500)].join(" ")}}function o(e,n){var s=n.callback,o,u,a,f="request.time.total";try{i(s)&&n.responseHeaders&&(NeoConfig.enable_spdy_support?o=n.getResponseHeader("X-Ywsc-Debug"):o=n.responseHeaders["X-Ywsc-Debug"],o=r.tryParse(o)||{},o[f]||(NeoConfig.enable_spdy_support?o[f]=n.getResponseHeader("X-Response-Time"):o[f]=n.responseHeaders["X-Response-Time"]),a&&a>1e3&&(a='<span style="color:red">'+a+"</span>"),u={log:t.stringify(o),dbgui:["ws :",a||"X"," ms"].join("")})}catch(l){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-net-diag:1",l,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-net-diag:1")}return u||""}function u(e,n){function r(e){var n;try{return(n=e.postdata)&&t.parse(n).params[0]}catch(r){typeof globals!="undefined"&&globals.report?globals.report("caughterror:..-build-mail-net-diag:2",r,"TRY_CATCH",1,1,1):window.console&&console.log&&console.log("caughterror:..-build-mail-net-diag:2")}}if(i(n)){var s,o=e.request,u,a,f,l,c,h="";if(f=n.batchop)c="<br/> ---",h=f.join(c);else if(h==="ListMessages")h=(a=o.url.match(/startInfo=(\d)+/))&&a[0];else if(h==="GetDisplayMessage"&&(l=(u=r(o))&&u.message))for(s=0;l&&s<l.length;s++)h+=" "+l[s].mid;return h}}var t=e.JSON,n=e.common.net.Diag,r=e.common.Utils.json;n.addLogger("net:start",s),n.addLogger("net:end",o)}()},"1.0.0",{requires:["common-net-diag","json-stringify","json-parse","common-utils-jsonparse"]});


YUI.add("mail-ui-messagepane-utils",function(e){function i(e){e&&(e.hRenderedEvent&&e.hRenderedEvent.detach(),delete e.hRenderedEvent)}function s(t,n){var i,s,o,u,a,f=[],l,c,h,p=[];if(t&&!NeoConfig.targetingOptOut&&NeoConfig.intl==="us"&&!NeoConfig.partnerType){if(t.extend&&t.extend.shortcuts){i=t.extend.shortcuts.categories;if(e.Lang.isArray(i)){a=i.length;for(u=0;u<a;u++)l=i[u][0],f.push(l)}s=t.extend.shortcuts.annotations;for(u in s)o=s[u],o&&o.text&&o.capAbtScore>.5&&p.push(s[u].text)}f=f.join(","),!r.isDraftFid(n)&&n!=="%40C%40Chats"&&!r.isSentFid(n)&&(t.header&&t.header.from&&t.header.from.email?(h=t.header.from.email.split("@"),c=h[1]):t.chainedLMTMsg&&t.chainedLMTMsg.from&&t.chainedLMTMsg.from.email?(h=t.chainedLMTMsg.from.email.split("@"),c=h[1]):t.msgs&&t.msgs[0]&&t.msgs[0].header&&t.msgs[0].header.from&&t.msgs[0].header.from.email?(h=t.msgs[0].header.from.email.split("@"),c=h[1]):t.from&&t.from.email&&(h=t.from.email.split("@"),c=h[1]))}return{category:f,domain:c,terms:p}}function o(t,o,u,a){var f,l;if(!t||t.mid!==a)t=n.Stopwatch.get("MsgInPreview","MsgInPreviewAbort",1),t.title="MsgInPreview Stopwatch\n",t.mid=a,t.isConv=NeoConfig.hasConvView,t.hRenderedEvent&&t.hRenderedEvent.detach(),t.hMsgReadAppEvent&&t.hMsgReadAppEvent.detach(),o&&(f=r.get(u),l=r.getSystemFolderInfoName(u,f),t.hRenderedEvent=o.once("renderComplete",function(){var r;i(t),t.stop(),n.Stopwatch.get("MsgInPreview",0),NeoConfig.low_bandwidth?r="msgread_reading_pane_low":NeoConfig.isSSL?r="msgread_reading_pane_ssl":r="msgread_reading_pane",o&&o.get("active")&&n.rAF(function(){o.fire("darlaEvent",{action:r,value:{siteAttr:s(e.mail.model.DataStore.Messages.get(u,a),u),foldername:l}})})}));return t}function u(t){if(e.contacts&&e.contacts.utils&&e.contacts.api){var n=e.contacts,r=n.utils,i=n.api,s=e.common.persist.UserData;return!t||t===""?1:s.isUsersEmailAddress(t)||r.isEmailKnown(t,!0)?1:r.areContactsLoaded()?0:(i.load(),1)}return 1}function a(t){var n,r,i=800;return!t||!t.getDOMNode()?!1:(n=t.getDOMNode().textContent,n===null?!1:n.length<i?!0:(r=e.Node.create(t.getDOMNode().innerHTML),r.all("style").remove(),n=r.getDOMNode().textContent,n.length<i?!0:!1))}function f(t){var n=!0;return t?(e.Array.each(t,function(e){if(e&&e.disposition==="attachment")return;e&&e.type==="text"&&(e.subtype==="plain"?n=n&&!0:n=n&&!1)}),n):!1}function l(e){var t=e.getDOMNode(),n=t.querySelectorAll&&t.querySelectorAll("*[style]")||[],r=0,i;for(r=0;r<n.length;r++)i=n[r].attributes.getNamedItem("style"),i.value=i.value.replace(/position\s*?:\s*?(fixed|absolute)/ig,""),i.value=i.value.replace(/([^a-z-])height\s*:|^height\s*:/gi,"$1min-height:"),i.value=i.value.replace(/max-height/gi,"overflow-y:auto;max-height"),i.value=i.value.replace(/max-width/gi,"overflow-x:auto;max-width"),i.value=i.value.replace(/white-space\s*?:\s*?pre\s*?;|white-space\s*?:\s*?pre\s*?$/gi,"white-space:pre-wrap;"),i.value=i.value.replace(/display:none/gi,"")}function c(t){var n=e.Node.create("<div/>");return n.setHTML(t),l(n),"<div class='email-wrapped'>"+n.get("innerHTML")+"</div>"}e.namespace("mail.ui.MessagePaneUtils");var t=e.mail.ui.MessagePaneUtils,n=e.common.Utils,r=e.mail.ui.FolderUtils;e.mix(t,{getAdSiteAttribsFromMesgObj:s,handleMsgInPreviewStopwatch:o,cleanUpStopwatch:i,isKnownEmailAddress:u,plainTextMessage:f,processBodyMarkup:c,hasOnlyNonDisplayableContent:a})},"1.0.0",{requires:["common-utils-stats","mail-ui-messagepane-utils-shared","mail-ui-folder-utils"]});


YUI.add("mail-ui-messagepane-utils-shared",function(e){function n(e){var t="",n,r,i,s,o=e.toLowerCase(),u;if(o.indexOf("http://")===0||o.indexOf("https://")===0||o.indexOf("ftp://")===0)return"";o.indexOf("mailto:")===0&&(e=e.substring(7)),n=e.indexOf("?"),n>-1&&(e=e.substring(0,n));if(e&&e.length){r=/\s*([^@ ;,<>]+@[^@ ;,<>]+\.[^@^? ;,<>]+)*/ig,i=e.match(r);for(u=0;u<i.length;u++)s=i[u].replace(/^\s+/,""),s.length&&(t+=t.length?","+s:s)}return t}function r(t){var n=t?e.one(t).one("body"):e.one("body");if(!n.one("#copyText")){var r=500;n.append('<input type = "text" value = "" style = "opacity: 0;  filter: alpha(opacity = 0); position:absolute; width:1px; height: 1px; left:'+r+'px;" id = "copyText">')}}function i(t,n,r){var i=n?e.one(n).one("body"):e.one("body"),s=i.one("#copyText");s._node.value=t,s.setY(i.get("scrollTop")+20),s.focus(),s.select(),setTimeout(function(){r&&r.focus()},200)}e.namespace("mail.ui.MessagePaneUtils");var t=e.mail.ui.MessagePaneUtils;e.mix(t,{extractEmailAddress:n,initializeCopyText:r,copyToClipboard:i})},"1.0.0");


YUI.add("mail-ui-common-string-utils",function(e){e.namespace("mail.ui.common.StringUtils");var t=e.mail.ui.common.StringUtils,n=e.mail.ui.FolderUtils;e.mix(t,{getSystemFolderName:function(e,t,r){return n.getSystemFolderName(e,t,r)},getSystemFolderInfoName:function(t,r,i){return n.getSystemFolderName(t,e.common.Utils.getVal(r,"folderInfo.name"),i)},getTabName:function(e){switch(e){case"tabcalendar":return strings.str_tabs_calendar;case"tabcontacts":return strings.str_tabs_contacts;case"tabnotepad":return strings.str_tabs_notepad;default:return""}},getSortKeyString:function(e){switch(e){case"date":case"date-asc":case"date-desc":return strings.str_menu_view_sortby_date;case"unRead":return strings.str_menu_view_sortby_unread;case"sender":return strings.str_menu_view_sortby_sender;case"recipient":return strings.str_menu_view_sortby_recipient;case"relevance":return strings.str_menu_view_sortby_relevance;case"subject":return strings.str_menu_view_sortby_subject;case"attachment":case"attachmentcount":return strings.str_menu_view_sortby_attachment;case"sort-flagged":return strings.str_menu_view_sortby_flagged;default:return strings.str_menu_view_sortby_btn}}})},"1.0.0",{requires:["common-utils","mail-ui-folder-utils"]});


YUI.add("mail-ui-navkeys",function(e){e.namespace("mail.ui");var t=window.Mousetrap;t.bind(["command+shift+s","ctrl+shift+s"],function(){e.common.Utils.features.enabled("listenr")&&e.fire("Listenr:launch")},"keydown"),t.bind("shift+m",function(){e.fire("checkmail:pressed",!0)},"keydown"),t.bind("m",function(){e.fire("checkmail:pressed",!1)},"keydown"),t.bind("n",function(t){setTimeout(function(){var t={};e.fire("newMessage",t)},0);var n=new e.DOMEventFacade(t,t.currentTarget);n.preventDefault()},"keydown"),t.bind("b",function(){var t=e.one("#btn-delete");t&&t.focus()},"keydown"),t.bind(";",function(){e.fire("openOptions")},"keydown"),t.bind("s",function(t){var n=new e.DOMEventFacade(t,t.currentTarget);n.preventDefault(),e.common.Utils.features.enabled("search")?e.fire("search:focus"):e.use("mail-ui-searchbar",function(e){e.mail.ui.SearchBar.focus()})},"keydown"),t.bind("?",function(){e.use("mail-ui-shortcuts-dialog",function(e){e.mail.ui.ShortcutsDialog.show()})},"keydown"),t.bind("ctrl+shift+l",function(){e.fire("printLog")},"keydown"),t.bind("c",function(t){var n=e.one("#custom-folders li.selected:hover"),r=new e.DOMEventFacade(t,t.currentTarget);n&&(r.currentTarget=n,e.fire("#custom-folders.li:keydown",r))},"keydown"),t.bind("e",function(t){var n=e.one("#custom-folders li:hover"),r=e.one("#storm-listnav li.sysfolder:hover"),i=new e.DOMEventFacade(t,t.currentTarget);r&&(i.currentTarget=r,e.fire("#storm-listnav li.sysfolder:keydown",i)),n&&(i.currentTarget=n,e.fire("#custom-folders.li:keydown",i))},"keydown"),t.bind(["command+shift+e","ctrl+shift+e"],function(t){var n=new e.DOMEventFacade(t,t.currentTarget);n.preventDefault(),n.target.getAttribute("id")==="menu-move"?e.fire("msgsview:movetonewfolder"):e.fire("newfolder:pressed")}),t.bind(["command+shift+,","command+shift+/","ctrl+shift+,","ctrl+shift+/"],function(t){e.use("common-ui-dialog-helper",function(e){var n=e.common.ui.DialogHelper,r=[],i,s,o=[];NeoGV.sp&&(o.push("SpaceId:"),o.push(NeoGV.sp),o.push(" "),r.push(o.join(" ")));for(s in NeoGV.ads)NeoGV.ads.hasOwnProperty(s)&&(i=[],i.push("Position:"),i.push(s),i.push(" "),i.push("BookingID:"),i.push(NeoGV.ads[s].bookId),r.push(i.join(" ")));NeoGV.keywords&&r.push("Keywords: "+NeoGV.keywords),n.alert({modal_classes:"lg",hd:"Ad Information",bd:"<pre>"+(r.length>0?r.join("\n"):"No items to display in this view")+"</pre>"}),t.preventDefault()})}),t.bind("esc",function(t){var n=new e.DOMEventFacade(t,t.currentTarget);n.preventDefault()},"keydown"),t.bind("backspace",function(t){var n=new e.DOMEventFacade(t,t.currentTarget);n.preventDefault()},"keydown")},"1.0.0",{requires:["mail-controller-folders","event-custom-complex","mail-common-utils-features"]});


YUI.add("mail-ui-searchbar",function(e){var t=function(){function i(){return NeoConfig&&NeoConfig.searchField||e.one(n)}function s(){var e=i();e&&e.focus()}function o(t,n){var s=t||i().get("value"),o=!1,u;n&&n.typeTag&&typeof s=="string"&&(o=!0,u={keyword:s,typeTag:n.typeTag}),r.isSet?e.fire(r.event,{query:s}):e.fire("search:input",{newSearch:!0,query:o?u:s})}function u(e){!e.mode||e.mode==="default"?(r.isSet=!1,r.event=""):(r.isSet=!0,r.event=e.event||"omsearch:input")}function a(){if(Neo.searchBtnClicked){var t="",n=NeoConfig.searchField;n&&(t=n.get("value")),t&&e.Global.fire("ucs:verticalSearchAction",{query:t}),Neo.searchBtnClicked=!1}}function f(){e.on("search:config",u),e.on("fireSearch",o);var t=i();e.Global.on("ucs:verticalSearchAction",function(t){function n(t){var n;NeoConfig.currentQuery=t.query,o(t.query,{typeTag:"search_uh_box_click"}),e.fire("mt:click",{action:"mail_search",spid:"search_results"}),n=new e.EventTarget,n.publish("ucs:mailSearch",{broadcast:2,emitFacade:!0}),n.fire("ucs:mailSearch")}var r=!0,i=arguments;if(e.Tictac&&!e.Tictac.contactdetails)r=!1;else if(!e.Tictac){e.once("tictacs-loaded:ws:postLoad",function(){n.apply(undefined,i)});return}n(t)}),e.Global.once("ucs:uhSearchInterfaceReady",a),t&&t.on("keydown",function(e){switch(e.keyCode){case 65:(e.ctrlKey||e.metaKey)&&e.stopPropagation()}}),NeoConfig.bidi&&t&&t.on("focus",function(){!t.bidiTextEntry&&e.Plugin.BidiTextEntry&&t.plug(e.Plugin.BidiTextEntry)}),strings.str_cfg_tog_show_search_desc&&e.use("mail-ui-searchdesc",function(e){e.mail.ui.SearchDesc.bindSearchDesc()})}function l(){f()}var t=this,n="input.yucs-search-input, #UHSearchBox",r={event:"",isSet:!1};e.mix(t,{render:l,getSearchField:i,focus:s})};e.namespace("mail.ui"),e.mail.ui.SearchBar=new t},"1.0.0",{requires:["common-utils","node-pluginhost"]});


YUI.add("mail-ui-folder-utils",function(e){var t=/[@#$%&*?\/;\'\":\[\]\{\}<>|\\\~\n\r\f\t]+/,n=/[%\\\/\n\r\f\t]+/,r="TRASH",i="BULK",s="DRAFT",o="INBOX",u="ARCHIVE",a="CHATS",f="SENT",l="USER",c="EXTERNAL_ALL",h="INVISIBLE",p="ALERTSTORE",d="1",v=e.common.Utils,m=v.escapeHtml,g=e.mail,y="Inbox",b="Sent",w="Draft",E="%40B%40Bulk",S="Trash",x={INBOX:y,SENT:b,DRAFT:w,BULK:E,TRASH:S},T="types",N="acctId",C={},k;k={isFolderNameValid:function(e){return NeoConfig.imapIn?!n.test(e):!t.test(e)},getSystemFolderForFid:function(e){var t={Inbox:strings.str_folder_reserved_inbox,Draft:strings.str_folder_reserved_drafts,Sent:strings.str_folder_reserved_sent,"@B@Bulk":strings.str_folder_reserved_spam,Trash:strings.str_folder_reserved_trash};return t[e]||e},_isImapIn:NeoConfig.imapIn,SpamFolderType:i,TrashFolderType:r,DraftFolderType:s,InboxFolderType:o,ChatsFolderType:a,ArchiveFolderType:u,ExternalAllFolderType:c,SentFolderType:f,UserFolderType:l,AlertFolderType:p,PrimaryAcctId:d,SystemFolderTypes:[o,f,s,r,i,u,a,p],VisibleFolderTypes:[o,f,s,r,i,u,l,a],InvisibleFolderTypes:[h],getFolderDir:function(t,n){var r=t.dir;return r||(e.Intl&&e.Intl.detectDirection?r=e.Intl.detectDirection(n,NeoConfig.isRTL?"rtl":"ltr"):r=""),r},getEscapedFullName:function(e,t){var n=m(e);return NeoConfig.bidi&&(t==="ltr"?n="\u202a"+n+"\u202c":t==="rtl"&&(n="\u202b"+n+"\u202c")),n},getSystemFolderName:function(e,t,n){return k.isInboxFid(e)?n?strings.str_nav_email_from_ctcts:strings.str_nav_inbox:k.isDraftFid(e)?strings.str_nav_drafts:k.isTrashFid(e)?strings.str_nav_trash:k.isSentFid(e)?strings.str_nav_sent:k.isSpamFid(e)?strings.str_nav_spam:e==="Archive"||k.isArchiveFid(e)?strings.str_nav_archive:e==="%40C%40Chats"?NeoConfig.hasConv?strings.str_nav_IM:strings.str_nav_conversations:e==="%40S%40Search"?strings.str_tabs_search:t?decodeURIComponent(t):""},getSystemFolderInfoName:function(e,t,n){return k.getSystemFolderName(e,v.getVal(t,"folderInfo.name"),n)},isEmptyFolderAllowed:function(e){return e&&e.isSystem?!1:!0},isArchiveFid:function(e){return k._isTypeByFid(u,e)},isUserFid:function(e){return k._isTypeByFid(l,e)},isDraftFid:function(e){return k._isTypeByFid(s,e)},isSpamFid:function(e){return k._isTypeByFid(i,e)},isTrashFid:function(e){return k._isTypeByFid(r,e)},isSentFid:function(e){return k._isTypeByFid(f,e)},isInboxFid:function(e){return k._isTypeByFid(o,e)},_getAcctId:function(t){return typeof t=="undefined"?e.mail.Controller.ImapIn.getCurrentAccountId():t},getInboxFid:function(e){return k._getFidByType(o,e)},getChatsFid:function(e){return k._getFidByType(a,e)},getArchiveFid:function(e){return k._getFidByType(u,e)},getDraftFid:function(e){return k._getFidByType(s,e)},getSentFid:function(e){return k._getFidByType(f,e)},getSpamFid:function(e){return k._getFidByType(i,e)},getTrashFid:function(e){return k._getFidByType(r,e)},_isTypeByFid:function(e,t){var n,r;return x[e]===t?!0:typeof t=="undefined"?!1:k._isImapIn?(r=t+":"+e,n=C[r],typeof n=="undefined"&&(n=C[r]=k.getFolderTypeByFid(t)===e),n):!1},_getFidByType:function(e,t){var n;return k._isImapIn?(n=g.Controller.ImapIn.getFolderByType(e,k._getAcctId(t)),n?n.folderInfo.fid:null):x[e]},getFolderByIndex:function(e){var t=k.getAll(),n=t.length,r=""+e,i,s;for(s=0;s<n;s++){i=t[s];if(i.folderInfo.index+""===r)return i}return null},get:function(t,n){var r=e.mail.model.DataStore.Folders,i,s,o;NeoConfig.imapIn?!t&&k._isImapIn?(o=e.mail.Controller.ImapIn,s=o.getCurrentAccountId(),i=o.getFoldersByAcct(s)):i=r.get(t):i=r.get(t);if(i)return n&&n.success(i),i},getAll:function(){return e.mail.model.DataStore.Folders.get()},getFolderTypeByFid:function(t){var n;if(k._isImapIn){n=e.mail.model.DataStore.Folders.get(t,T);if(n){if(n.indexOf(l)>-1)return l;if(n.indexOf(o)>-1)return o;if(n.indexOf(s)>-1)return s;if(n.indexOf(f)>-1)return f;if(n.indexOf(i)>-1)return i;if(n.indexOf(r)>-1)return r;if(n.indexOf(u)>-1)return u}return n&&n[0]}switch(t){case y:return o;case w:return s;case b:return f;case E:return i;case S:return r;default:return l}},getFolderByName:function(t,n){var r=e.mail.model.DataStore.Folders;return k._isImapIn?r.getByName(t,k._getAcctId(n)):r.getByName(t)},getFoldersByAcctId:function(t,n){var r;return k._isImapIn?r=e.mail.Controller.ImapIn.getFoldersByAcct(t):r=k.getAll(),n&&n.success(r),r},getAcctIdByFid:function(t){return t&&k._isImapIn?e.mail.model.DataStore.Folders.get(t,N):d},isSpamMenuSupported:function(e,t){return k.isSpamFid(e)||t!==d?!1:!0},isArchiveSupported:function(e){return NeoConfig.archive&&!k.isSpamFid(e)&&!k.isDraftFid(e)&&!k.isArchiveFid(e)?!0:!1},isRestoreSupported:function(e){return NeoConfig.archive&&k.isArchiveFid(e)?!0:!1}},e.namespace("mail.ui").FolderUtils=k},"1.0.0",{requires:["common-utils","mail-common-utils-features","mail-model-datastore"]});


YUI.add("_shared_module_message_prompt",function(e){e.namespace("ui.Templates"),e.ui.Templates._shared_module_message_prompt={base:"<h2>{{str_msg-view_click_above}}</h2>"}},"1.0.0");


YUI.add("minty_module_toolbar_inbox",function(e){e.namespace("ui.Templates"),e.ui.Templates.minty_module_toolbar_inbox={base:'<div class="switcher shaded hidden"> <span class="btn left {{has_im_else}}" id="main-btn-new"><a title="{{compose_str}}" href="{{global_url_base}}/minty/page/compose" data-action="compose" draggable="false">{{compose_str}}</a></span>{{has_im}}</div>',has_im_else:"right",has_im:'<span class="btn right menu" id="btn-new" data-action="menu"><a href="#" title="{{str_toolbar_comp_menu_toggle_attr}}" draggable="false"><b></b></a></span>'}},"1.0.0");


YUI.add("mail-core-net-helpers-v3-request-helper",function(e){var t="/ws/v3/mailboxes/@.id=="+NeoConfig.V3MailboxId,n={getV3RequestUrl:function(n,r){var i;r=r||{};switch(n){case"folders":i=t+"/folders"+(r.id?"/@.id=="+r.id:"");break;case"filters":i=t+"/attributes/@.id==messageFilters";break;case"accounts":i=t+"/accounts"+(r.id?"/@.id=="+r.id:"");break;case"messages":i=t+"/messages/@.select==q?q=folderId:"+(r.id?r.id:"")+(r.async?"&async="+r.async:"");break;case"tasks":i=t+"/tasks/@.id=="+(r.id?r.id:"");break;case"alerts":i=t+"/alerts"+(r.id?"/@.id=="+r.id:"");break;case"rawmessage":r.id&&(r.id=r.id.replace(/\+/g,"-").replace(/\//g,"_")),i=e.common.Utils.settings.value("jwsApiUrl"),i+=t+"/messages"+(r.id?"/@.id=="+r.id:"")+"/content/rawplaintext?appid=YahooMailNeo",i+="&wssid="+NeoConfig.wssid+"&ymreqid="+e.common.net.Session.genReqID()}return i}};e.namespace("Mail.Core.Net.Helpers").V3RequestHelper=n},"1.0.0",{requires:["mail-common-utils-settings","common-net-session"]});


window.strings=strings;};
